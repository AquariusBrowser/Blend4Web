(function(f){var k=function(){var k=65,va={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},M=function(b,c){var g=L(b);g.r=Math.round(1E3*Math.pow(g.r/255,2.2))/1E3;g.g=Math.round(1E3*Math.pow(g.g/255,2.2))/1E3;g.b=Math.round(1E3*Math.pow(g.b/255,2.2))/1E3;f(c).data("colorpicker").fields.eq(1).val(g.r).end().eq(2).val(g.g).end().eq(3).val(g.b).end()},S=function(b,c){f(c).data("colorpicker").fields.eq(4).val(b.h).end().eq(5).val(b.s).end().eq(6).val(b.b).end()},
A=function(b,c){f(c).data("colorpicker").fields.eq(0).val(N(b)).end()},T=function(b,c){f(c).data("colorpicker").selector.css("backgroundColor","#"+N({h:b.h,s:100,b:100}));f(c).data("colorpicker").selectorIndic.css({left:parseInt(150*b.s/100,10),top:parseInt(150*(100-b.b)/100,10)})},x=function(b,c){f(c).data("colorpicker").hue.css("top",parseInt(150-150*b.h/360,10))},ba=function(b,c){f(c).data("colorpicker").currentColor.css("backgroundColor","#"+N(b))},W=function(b,c){f(c).data("colorpicker").newColor.css("backgroundColor",
"#"+N(b))},X=function(b){b=b.charCode||b.keyCode||-1;if(b>k&&90>=b||32==b)return!1;!0===f(this).parent().parent().data("colorpicker").livePreview&&P.apply(this)},P=function(b){var c=f(this).parent().parent(),g;if(0<this.parentNode.className.indexOf("_hex")){g=c.data("colorpicker");var t=this.value,k=6-t.length;if(0<k){for(var w=[],C=0;C<k;C++)w.push("0");w.push(t);t=w.join("")}t=Q(ca(t));g.color=g=t}else 0<this.parentNode.className.indexOf("_hsb")?c.data("colorpicker").color=g=da({h:parseInt(c.data("colorpicker").fields.eq(4).val(),
10),s:parseInt(c.data("colorpicker").fields.eq(5).val(),10),b:parseInt(c.data("colorpicker").fields.eq(6).val(),10)}):(g=c.data("colorpicker"),t=parseInt(c.data("colorpicker").fields.eq(1).val(),10),k=parseInt(c.data("colorpicker").fields.eq(2).val(),10),w=parseInt(c.data("colorpicker").fields.eq(3).val(),10),t={r:Math.min(255,Math.max(0,t)),g:Math.min(255,Math.max(0,k)),b:Math.min(255,Math.max(0,w))},g.color=g=Q(t));b&&(M(g,c.get(0)),A(g,c.get(0)),S(g,c.get(0)));T(g,c.get(0));x(g,c.get(0));W(g,c.get(0));
c.data("colorpicker").onChange.apply(c,[g,N(g),L(g)])},oa=function(b){f(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")},wa=function(){k=0<this.parentNode.className.indexOf("_hex")?70:65;f(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus");f(this).parent().addClass("colorpicker_focus")},xa=function(b){var c=f(this).parent().find("input").focus();b={el:f(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?
360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:b.pageY,field:c,val:parseInt(c.val(),10),preview:f(this).parent().parent().data("colorpicker").livePreview};f(document).bind("mouseup",b,ea);f(document).bind("mousemove",b,fa)},fa=function(b){b.data.field.val(Math.max(0,Math.min(b.data.max,parseInt(b.data.val+b.pageY-b.data.y,10))));b.data.preview&&P.apply(b.data.field.get(0),[!0]);return!1},ea=function(b){P.apply(b.data.field.get(0),[!0]);b.data.el.removeClass("colorpicker_slider").find("input").focus();
f(document).unbind("mouseup",ea);f(document).unbind("mousemove",fa);return!1},ya=function(b){b.preventDefault();b={cal:f(this).parent(),y:f(this).offset().top};b.preview=b.cal.data("colorpicker").livePreview;f(document).bind("mouseup touchend",b,pa);f(document).bind("mousemove touchmove",b,qa)},qa=function(b){var c=b;"undefined"!==typeof event&&event.touches&&(c=event.touches[0]);P.apply(b.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,c.pageY-b.data.y)))/
150,10)).get(0),[b.data.preview]);return!1},pa=function(b){M(b.data.cal.data("colorpicker").color,b.data.cal.get(0));A(b.data.cal.data("colorpicker").color,b.data.cal.get(0));f(document).unbind("mouseup touchend",pa);f(document).unbind("mousemove touchmove",qa);return!1},za=function(b){b.preventDefault();b={cal:f(this).parent(),pos:f(this).offset()};b.preview=b.cal.data("colorpicker").livePreview;f(document).bind("mouseup touchend",b,ga);f(document).bind("mousemove touchmove",b,ra)},ra=function(b){var c=
b;"undefined"!==typeof event&&event.touches&&(c=event.touches[0]);P.apply(b.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,c.pageY-b.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,c.pageX-b.data.pos.left))/150,10)).get(0),[b.data.preview]);return!1},ga=function(b){M(b.data.cal.data("colorpicker").color,b.data.cal.get(0));A(b.data.cal.data("colorpicker").color,b.data.cal.get(0));f(document).unbind("mouseup touchend",ga);f(document).unbind("mousemove touchmove",
ra);return!1},Aa=function(b){f(this).addClass("colorpicker_focus")},Ba=function(b){f(this).removeClass("colorpicker_focus")},Ca=function(b){b=f(this).parent();var c=b.data("colorpicker").color;b.data("colorpicker").origColor=c;ba(c,b.get(0));b.data("colorpicker").onSubmit(c,N(c),L(c),b.data("colorpicker").el)},Da=function(b){var c=f("body"),g=c.data("colorpickerId"),t=f(this).data("colorpickerId");g&&g===t?(f(document).trigger("mousedown"),c.data("colorpickerId",null)):(sa.call(this,b),c.data("colorpickerId",
t))},sa=function(b){var c,g,t=f("#"+f(this).data("colorpickerId"));t.data("colorpicker").onBeforeShow.apply(this,[t.get(0)]);var k=f(this).offset(),w="CSS1Compat"==document.compatMode;b=window.pageXOffset||(w?document.documentElement.scrollLeft:document.body.scrollLeft);c=window.pageYOffset||(w?document.documentElement.scrollTop:document.body.scrollTop);g=window.innerWidth||(w?document.documentElement.clientWidth:document.body.clientWidth);var x=k.top+this.offsetHeight,k=k.left;x+176>c+(window.innerHeight||
(w?document.documentElement.clientHeight:document.body.clientHeight))&&(x-=this.offsetHeight+176);k+356>b+g&&(k=Math.max(0,k-356));t.css({left:k+"px",top:x+"px"});0!=t.data("colorpicker").onShow.apply(this,[t.get(0)])&&t.show();f(document).bind("mousedown",{cal:t},ta);return!1},ta=function(b){Ea(b.data.cal.get(0),b.target,b.data.cal.get(0))||(0!=b.data.cal.data("colorpicker").onHide.apply(this,[b.data.cal.get(0)])&&b.data.cal.hide(),f(document).unbind("mousedown",ta))},Ea=function(b,c,g){if(b==c)return!0;
if(b.contains)return b.contains(c);if(b.compareDocumentPosition)return!!(b.compareDocumentPosition(c)&16);for(c=c.parentNode;c&&c!=g;){if(c==b)return!0;c=c.parentNode}return!1},da=function(b){return{h:Math.round(Math.min(360,Math.max(0,b.h))),s:Math.round(Math.min(100,Math.max(0,b.s))),b:Math.round(Math.min(100,Math.max(0,b.b)))}},ca=function(b){b=parseInt(-1<b.indexOf("#")?b.substring(1):b,16);return{r:b>>16,g:(b&65280)>>8,b:b&255}},Q=function(b){var c={h:0,s:0,b:0},g=Math.min(b.r,b.g,b.b),f=Math.max(b.r,
b.g,b.b),g=f-g;c.b=f;c.s=0!=f?255*g/f:0;c.h=0!=c.s?b.r==f?(b.g-b.b)/g:b.g==f?2+(b.b-b.r)/g:4+(b.r-b.g)/g:-1;c.h*=60;0>c.h&&(c.h+=360);c.s*=100/255;c.b*=100/255;c.h=Math.round(c.h);c.s=Math.round(c.s);c.b=Math.round(c.b);return c},L=function(b){var c,g,f;c=Math.round(b.h);var k=Math.round(255*b.s/100);b=Math.round(255*b.b/100);if(0==k)c=g=f=b;else{var k=(255-k)*b/255,w=c%60*(b-k)/60;360==c&&(c=0);60>c?(c=b,f=k,g=k+w):120>c?(g=b,f=k,c=b-w):180>c?(g=b,c=k,f=k+w):240>c?(f=b,c=k,g=b-w):300>c?(f=b,g=k,
c=k+w):360>c?(c=b,g=k,f=b-w):f=g=c=0}return{r:Math.round(c),g:Math.round(g),b:Math.round(f)}},C=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];f.each(c,function(b,f){1==f.length&&(c[b]="0"+f)});return c.join("")},N=function(b){return C(L(b))},ha=function(){var b=f(this).parent(),c=b.data("colorpicker").origColor;b.data("colorpicker").color=c;M(c,b.get(0));A(c,b.get(0));S(c,b.get(0));T(c,b.get(0));x(c,b.get(0));W(c,b.get(0))};return{init:function(b){b=f.extend({},va,b||{});
if("string"==typeof b.color)b.color=Q(ca(b.color));else if(void 0!=b.color.r&&void 0!=b.color.g&&void 0!=b.color.b)b.color=Q(b.color);else if(void 0!=b.color.h&&void 0!=b.color.s&&void 0!=b.color.b)b.color=da(b.color);else return this;return this.each(function(){if(!f(this).data("colorpickerId")){var c=f.extend({},b);c.origColor=b.color;var g="collorpicker_"+parseInt(1E3*Math.random());f(this).data("colorpickerId",g);g=f('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",
g);c.flat?g.appendTo(this).show():g.appendTo(document.body);c.fields=g.find("input").bind("keyup",X).bind("change",P).bind("blur",oa).bind("focus",wa);g.find("span").bind("mousedown touchstart",xa).end().find(">div.colorpicker_current_color").bind("click",ha);c.selector=g.find("div.colorpicker_color").bind("touchstart mousedown",za);c.selectorIndic=c.selector.find("div div");c.el=this;c.hue=g.find("div.colorpicker_hue div");g.find("div.colorpicker_hue").bind("mousedown touchstart",ya);c.newColor=
g.find("div.colorpicker_new_color");c.currentColor=g.find("div.colorpicker_current_color");g.data("colorpicker",c);g.find("div.colorpicker_submit").bind("mouseenter touchstart",Aa).bind("mouseleave touchend",Ba).bind("click",Ca);M(c.color,g.get(0));S(c.color,g.get(0));A(c.color,g.get(0));x(c.color,g.get(0));T(c.color,g.get(0));ba(c.color,g.get(0));W(c.color,g.get(0));c.flat?g.css({position:"relative",display:"block"}):f(this).bind(c.eventName,Da)}})},showPicker:function(){return this.each(function(){f(this).data("colorpickerId")&&
sa.apply(this)})},hidePicker:function(){return this.each(function(){f(this).data("colorpickerId")&&f("#"+f(this).data("colorpickerId")).hide()})},setColor:function(b){if("string"==typeof b)b=Q(ca(b));else if(void 0!=b.r&&void 0!=b.g&&void 0!=b.b)b=Q(b);else if(void 0!=b.h&&void 0!=b.s&&void 0!=b.b)b=da(b);else return this;return this.each(function(){if(f(this).data("colorpickerId")){var c=f("#"+f(this).data("colorpickerId"));c.data("colorpicker").color=b;c.data("colorpicker").origColor=b;M(b,c.get(0));
S(b,c.get(0));A(b,c.get(0));x(b,c.get(0));T(b,c.get(0));ba(b,c.get(0));W(b,c.get(0))}})}}}();f.fn.extend({ColorPicker:k.init,ColorPickerHide:k.hidePicker,ColorPickerShow:k.showPicker,ColorPickerSetColor:k.setColor})})(jQuery);b4w.register("viewer_main",function(f,k){function $a(a,d){if(!d)return console.log("b4w init failure"),null;window.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1};window.ondragstart=function(a){a.preventDefault();a.stopPropagation();return!1};u.enable_controls();window.addEventListener("resize",Ea,!1);var b=document.createEvent("CustomEvent");b.initEvent("resize",!1,!1);window.dispatchEvent(b);H.detect_mobile()||m(["gyro_use"],"disable");var Ma=u.get_url_params();Na.enqueue([["manifest",
Na.AT_JSON,"assets.json"]],function(a,d,b,c){E=a;ua=document.getElementById("info_left_down");z=document.getElementById("lights_cont");document.getElementById("build_date").innerHTML=Oa.date();e(qa,"quality","string");switch(y.get("quality")){case y.P_ULTRA:var G=0;break;case y.P_HIGH:G=1;break;case y.P_LOW:G=2;break;case y.P_CUSTOM:G=3}document.getElementById("quality").options[G].selected=!0;$("#quality").selectmenu("refresh");u.set_onclick("reset_memory",pa);u.set_onclick("auto_rotate_cam",bb);
u.set_onclick("pause",za);u.set_onclick("resume",ra);u.set_onclick("auto_view",ta);a=document.getElementById("manifest");if(E){b="";d=(d=u.get_url_params())&&d.load?d.load.split("/"):["dev","logo.json"];d="Home ("+d[d.length-1]+")";b=b+"<div class='min_font' id='default_scene'>"+("<h6 class='ui-collapsible-heading'><a class='ui-mini ui-btn ui-btn-icon-right ui-icon-home'>"+d+"</a></h6>");b+="</div>";for(d=0;d<E.length;d++){G=E[d];c=G.name;for(var G=G.items,f="",f=f+"<div data-role='collapsible' data-mini='true' >",
f=f+("<h6>"+c+"</h6>"),f=f+"<ul data-role='listview' data-mini='true' data-inset='true' style='margin: -10px 0;'>",h=0;h<G.length;h++)var k=G[h].name,f=f+("<li data-mini='true'><a href='#' class='min_font' id='"+("MANIFEST_ITEM_"+k+"__SEPARATOR__"+c)+"'>"+k+"</a></li>");f+="</ul>";f+="</div>";b+=f}$("#"+a.id).append(b);$("#"+a.id).trigger("create");a.addEventListener("mouseup",W,!1)}else a.innerHTML="<p style='color: red;'>Failed loading scenes list.</p><p>Maybe a syntax error?</p>";ba();e(C,"anim_active_object",
"string");e(C,"animation","string");e(C,"anim_mix_factor","number");e(C,"anim_slot","number");e(C,"anim_cyclic","bool");e(C,"anim_frame_current","number");u.set_onclick("anim_play",da);u.set_onclick("anim_stop",ca);u.set_onclick("get_max_bones",Q);e(L,"shape_key_obj","string");e(L,"shape_key_name","string");e(L,"shape_key_value","number");e(U,"material_name","string");I(U,"material_diffuse_color");e(U,"material_reflectivity","number");e(U,"material_fresnel","number");e(U,"material_fresnel_factor",
"number");e(U,"material_parallax_scale","number");e(U,"material_parallax_steps","number");e(q,"material_name","string");e(q,"shore_smoothing","bool");e(q,"absorb_factor","number");e(q,"sss_strength","number");e(q,"sss_width","number");I(q,"water_fog_color");e(q,"water_fog_density","number");I(q,"shallow_water_col");e(q,"shallow_water_col_fac","number");I(q,"shore_water_col");e(q,"shore_water_col_fac","number");e(q,"foam_factor","number");e(q,"norm_uv_velocity","number");e(q,"water_dynamic","bool");
e(q,"waves_height","number");e(q,"waves_length","number");e(q,"dst_noise_scale0","number");e(q,"dst_noise_scale1","number");e(q,"dst_noise_freq0","number");e(q,"dst_noise_freq1","number");e(q,"dir_min_shore_fac","number");e(q,"dir_freq","number");e(q,"dir_noise_scale","number");e(q,"dir_noise_freq","number");e(q,"dir_min_noise_fac","number");e(q,"dst_min_fac","number");e(q,"waves_hor_fac","number");e(Fa,"environment_energy","string");I(Fa,"horizon_color");I(Fa,"zenith_color");e(Y,"light_name","string");
I(Y,"light_color");e(Y,"light_energy","number");e(Y,"light_spot_size","number");e(Y,"light_spot_blend","number");e(Y,"light_distance","number");I(J,"sky_color");e(J,"rayleigh_brightness","number");e(J,"mie_brightness","number");e(J,"spot_brightness","number");e(J,"scatter_strength","number");e(J,"rayleigh_strength","number");e(J,"mie_strength","number");e(J,"rayleigh_collection_power","number");e(J,"mie_collection_power","number");e(J,"mie_distribution","number");e(Ga,"date","string");e(Ga,"day_time",
"number");e(Pa,"sun_horizontal_position","number");e(Pa,"sun_vertical_position","number");e(cb,"max_sun_angle","number");u.set_onclick("run_sun",db);u.set_onclick("stop_sun",eb);e(Z,"csm_first_cascade_border","number");e(Z,"csm_last_cascade_border","number");e(Z,"self_shadow_polygon_offset","number");e(Z,"self_shadow_normal_offset","number");e(Z,"first_cascade_blur_radius","number");e(Z,"last_cascade_blur_radius","number");e(g,"ssao_quality","string");e(g,"ssao_hemisphere","bool");e(g,"ssao_blur_depth",
"bool");e(g,"ssao_blur_discard_value","number");e(g,"ssao_radius_increase","number");e(g,"ssao_influence","number");e(g,"ssao_dist_factor","number");e(g,"ssao_only","bool");e(g,"ssao_white","bool");e(Ha,"fog_density","number");e(Ha,"fog_density1000","number");I(Ha,"fog_color");e(ia,"dof_distance","number");e(ia,"dof_front","number");e(ia,"dof_rear","number");e(ia,"dof_power","number");e(ia,"dof_on","bool");e(Ia,"god_rays_intensity","number");e(Ia,"god_rays_max_ray_length","number");e(Ia,"god_rays_steps",
"number");e(na,"brightness","number");e(na,"contrast","number");e(na,"exposure","number");e(na,"saturation","number");e(Ba,"sfx_mix_mode","bool");a=Number("true"===r.get("sfx_mix_mode"));document.getElementById("sfx_mix_mode").options[a].selected=!0;$("#sfx_mix_mode").slider("refresh");e(Ca,"anaglyph_use","bool");a=Number("true"===r.get("anaglyph_use"));document.getElementById("anaglyph_use").options[a].selected=!0;$("#anaglyph_use").slider("refresh");e(Da,"gyro_use","bool");a=Number("true"===r.get("gyro_use"));
document.getElementById("gyro_use").options[a].selected=!0;$("#gyro_use").slider("refresh");e(Qa,"wind_dir","number");e(Qa,"wind_strength","number");e(Ja,"bloom_key","number");e(Ja,"bloom_blur","number");e(Ja,"bloom_edge_lum","number");e(Ra,"wireframe_mode","string");I(Ra,"wireframe_edge_color","object");e(Aa,"show_hud_debug_info","bool");e(sa,"outlining_overview_mode","bool");a=""==r.get("outlining_overview_mode")?1:Number("true"===r.get("outlining_overview_mode"));document.getElementById("outlining_overview_mode").options[a].selected=
!0;$("#outlining_overview_mode").slider("refresh");u.set_onclick("make_screenshot",fb);a=Number("true"===r.get("show_hud_debug_info"));document.getElementById("show_hud_debug_info").options[a].selected=!0;$("#show_hud_debug_info").slider("refresh");va();a=T();X(a,!1,!1,Ma&&Ma.load)},null)}function va(){$(document).ready(function(){$(".ui-slider-handle").off("keydown");$(".ui-slider-handle").on("keydown",function(a){var d=this.parentElement.parentElement.children[0].getAttribute("id"),b=parseFloat(document.getElementById(d).value),
c=parseFloat(document.getElementById(d).getAttribute("step"));188==a.keyCode&&h(d,b-c);190==a.keyCode&&h(d,b+c)})})}function M(a){if(ua){$("#material_warning")[0].style.display="none";a.preventDefault&&a.preventDefault();var d=a.clientX;a=a.clientY;var b=D;b&&l.clear_outline_anim(b);(D=d=l.pick_object(d,a))?Sa(d):Ta();A();R||(d?(R=d,A(),u.enable_object_controls(d),v.create_kb_sensor_manifold(d,"QUIT",v.CT_SHOT,v.KEY_Q,function(a,d,b,c){R=null;A();u.disable_object_controls(a)})):S())}}function S(){var a=
l.get_active_camera();R=a;A();u.enable_camera_controls();v.create_kb_sensor_manifold(a,"QUIT",v.CT_SHOT,v.KEY_Q,function(a,d,b,c){R=null;A();u.disable_camera_controls(a);v.remove_sensor_manifold(a,"ZOOM_TO")});var d=v.create_keyboard_sensor(v.KEY_Z),b=v.create_keyboard_sensor(v.KEY_DEC_POINT);v.create_sensor_manifold(a,"ZOOM_TO",v.CT_SHOT,[d,b],function(a){return a[0]||a[1]},function(a,d,b){(d=D)&&Ua.zoom_object(a,d)})}function A(){if(ua){var a="CONTROLLED: "+(R?String(R.name):"NONE")+" | SELECTED: "+
(D?String(D.name):"NONE"),d=D;d&&(d=l.get_type_mesh_object(d))&&(a+=" | TYPE: "+d);d=R;D&&d&&"CAMERA"===d.type&&(a+=" | DISTANCE: "+Va);ua.innerHTML=a}}function T(){var a=r.get("last_item_name");if(!a)return null;for(var d=0;d<E.length;d++){var b=E[d];if(ja.keyfind("name",a,b.items)[0])return{category:b.name,item:a}}return null}function x(a,d){var b=document.getElementById(a);b.innerHTML="";for(var c=0;c<d.length;c++){var e=document.createElement("option");e.text=e.value=d[c];0===c&&(e.selected=!0);
b.appendChild(e)}$("#"+a).selectmenu();$("#"+a).selectmenu("refresh")}function ba(){var a=document.getElementById("default_scene");a&&(a.onclick=function(){ka=!1;clearTimeout(Ka);X(null,!0,!1,!0)})}function W(a){a=a.target.id;if(-1!=a.indexOf("MANIFEST_ITEM_")){var d=a.split("__SEPARATOR__");a=d[1];d=d[0].split("MANIFEST_ITEM_")[1];ka=!1;clearTimeout(Ka);X({category:a,item:d},!0,!1,!1)}}function X(a,d,b,c){if(z)for(var e=0;e<z.children.length;e++)z.children[e].style.visibility="hidden";if((e=u.get_url_params())&&
e.load){var f=e.load.split("/");aa={load_file:e.load,name:f[f.length-1].split(".")[0],animated_objects:[]}}else aa={load_file:y.get_std_assets_path()+"dev/logo.json",name:"Logo",animated_objects:[]};K=n=null;if(!c)if(a){c=ja.keyfind("name",a.category,E)[0];c=ja.keyfind("name",a.item,c.items)[0];for(var g in c)aa[g]="load_file"==g?y.get_std_assets_path()+c[g]:c[g];r.set("last_item_name",a.item)}else r.set("last_item_name","");d&&(H.clear_render_callback(),La.cleanup());H.get_canvas_elem().removeEventListener("mousedown",
M);B.clear_errors_warnings();a=aa.name;d=aa.load_file;g=document.getElementById("current_file");g.innerHTML=a;g.setAttribute("title",a+" ("+d+")");La.load(d,P,wa,b)}function P(a){H.get_canvas_elem().addEventListener("mousedown",M,!1);D=null;xa(aa);S();u.enable_debug_controls();ga()&&gb.enable_mixer_controls();y.get("gyro_use")&&hb.enable_camera_rotation();H.set_render_callback(ya);ka&&(Ka=setTimeout(oa,1E3));a=v.create_elapsed_sensor();v.create_sensor_manifold(l.get_active_camera(),"TO_OBJ",v.CT_CONTINUOUS,
[a],null,function(a,b,c){if(1==c&&D){if(c=D)b=ib,jb.get_object_center(c,!0,b),a=Ua.get_eye(a,kb),Va=lb.dist(b,a).toFixed(3);A()}})}function oa(){var a=T();if(a){var d=a.item,a=ja.keyfind("name",a.category,E)[0],d=ja.keyfind("name",d,a.items)[0],d=a.items.indexOf(d);if(d=a.items[d+1])a={category:a.name,item:d.name};else if(a=E.indexOf(a),a=E[a+1])a={category:a.name,item:a.items[0].name};else{ka=!1;return}}else a=E[0],d=a.items[0],a={category:a.name,item:d.name};X(a,!0,!0,!1)}function wa(a,d){document.getElementById("loading_progress").innerHTML=
a+"% ("+Math.round(10*d/1E3)/10+"s)";var b=B.get_error_quantity(),c=B.get_warning_quantity();if(La.is_primary_loaded()){var e=B.num_vertices(),f=B.num_triangles(),g=B.num_draw_calls(),h=B.num_shaders();document.getElementById("info_right_up").innerHTML=e+" verts, "+f+" tris, "+g+" draw calls, "+h+" shaders";var e=B.geometry_stats(),f=B.num_textures(),g=B.num_render_targets(),h=Math.round(10*(e.ibo_memory+e.vbo_memory))/10,k=Math.round(10*f.memory)/10,l=Math.round(10*g.memory)/10,m=Math.round(10*(h+
k+l))/10;document.getElementById("info_right_down").innerHTML="Geometry: "+h+" MiB ("+e.ibo_number+"+"+e.vbo_number+")<br>Textures: "+k+" MiB ("+f.number+")<br>RTs: "+l+" MiB ("+g.number+")<br><br>Total: "+m+" MiB";e=B.get_error_quantity();(f=B.get_warning_quantity())||e?z.setAttribute("title","Errors: "+e+", Warnings: "+f+"\nSee browser console for more info"):z.setAttribute("title","Loaded OK");c||b||(z.children[0].style.visibility="hidden",z.children[1].style.visibility="hidden",z.children[2].style.visibility=
"visible")}c&&!b&&(z.children[0].style.visibility="hidden",z.children[1].style.visibility="visible",z.children[2].style.visibility="hidden");b&&(z.children[0].style.visibility="visible",z.children[1].style.visibility="hidden",z.children[2].style.visibility="hidden")}function xa(a){for(var d=l.get_active(),b=l.get_scenes(),e=0;e<b.length;e++){var f=b[e];if(f!==d){var g=fa(f,a);ea(f,g)}}g=fa(d,a);ea(d,g);Sa=function(a){var d=V.get_materials_names(a);x("material_name",d);Wa(a,d[0]);a=V.get_water_material_params(a,
d[0]);d="shallow_water_col shallow_water_col_fac shore_water_col shore_water_col_fac water_fog_color water_fog_density absorb_factor sss_strength sss_width foam_factor norm_uv_velocity waves_height waves_length dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac water_dynamic shore_smoothing".split(" ");a?(m(d,"enable"),l.get_water_mat_params(a),a.shallow_water_col&&O("shallow_water_col",
a.shallow_water_col),a.shallow_water_col_fac&&h("shallow_water_col_fac",a.shallow_water_col_fac),a.shore_water_col&&O("shore_water_col",a.shore_water_col),a.shore_water_col_fac&&h("shore_water_col_fac",a.shore_water_col_fac),a.water_fog_color&&(O("water_fog_color",a.water_fog_color),h("water_fog_density",a.water_fog_density)),h("absorb_factor",a.absorb_factor),h("sss_strength",a.sss_strength),h("sss_width",a.sss_width),h("foam_factor",a.foam_factor),h("norm_uv_velocity",a.norm_uv_velocity),h("waves_height",
a.waves_height),h("waves_length",a.waves_length),h("dst_noise_scale0",a.dst_noise_scale0),h("dst_noise_scale1",a.dst_noise_scale1),h("dst_noise_freq0",a.dst_noise_freq0),h("dst_noise_freq1",a.dst_noise_freq1),h("dir_min_shore_fac",a.dir_min_shore_fac),h("dir_freq",a.dir_freq),h("dir_noise_scale",a.dir_noise_scale),h("dir_noise_freq",a.dir_noise_freq),h("dir_min_noise_fac",a.dir_min_noise_fac),h("dst_min_fac",a.dst_min_fac),h("waves_hor_fac",a.waves_hor_fac)):m(d,"disable")};mb();a=l.get_all_objects("LAMP");
d=[];for(e=0;e<a.length;e++)d.push(a[e].name);x("light_name",d);0<a.length&&Xa(a[0]);nb();c();ab();ob();pb();t();qb();rb();sb();tb();ub();Ta();$("#wireframe_mode").val("WM_NONE");$("#wireframe_mode").selectmenu("refresh",!0);$("#wireframe_edge_color div").css("backgroundColor","#333");e=new Date(document.getElementById("date").value);Ga({date:e})}function fa(a,d){function b(a,d){for(var c in a)d[c]=a[c];return d}var c=d.scene_settings;if(c&&c[a]){var e={};b(d,e);b(c[a],e);delete e.scene_settings;
return e}return d}function ea(a,d){l.set_active(a);var b=l.get_active_camera();d.camera_target&&vb.append_follow(b,d.camera_target);for(var c=[],b=l.get_all_objects(),e=0;e<b.length;e++){var f=b[e];p.is_animated(f)&&(n||(n=f),c.push(l.get_object_name(f)))}e="anim_active_object anim_slot animation anim_cyclic anim_frame_range anim_mix_factor anim_frame_current anim_play anim_stop get_max_bones".split(" ");n?(m(e,"enable"),x("anim_active_object",c),C({anim_active_object:l.get_object_name(n)})):m(e,
"disable");c=[];for(e=0;e<b.length;e++)f=b[e],la.check_shape_keys(f)&&(K||(K=f),c.push(l.get_object_name(f)));b=["shape_key_obj","shape_key_name","shape_key_value"];K?(m(b,"enable"),x("shape_key_obj",c),L({shape_key_obj:l.get_object_name(K)})):m(b,"disable")}function ya(a,d){l.get_active_camera();if(n){var b=parseInt(document.getElementById("anim_slot").value),c=Math.round(p.get_frame(n,b));parseInt($("#anim_frame_current").val())!==c&&h("anim_frame_current",c);c=document.getElementById("anim_status");
p.is_play(n,b)?c.innerHTML="PLAYING":c.innerHTML="STOPPED"}}function qa(a){r.set("quality",a.quality);setTimeout(function(){window.location.reload()},100)}function pa(){r.cleanup();window.location.reload()}function za(){H.pause()}function ra(){H.resume()}function ga(){return"true"===r.get("sfx_mix_mode")?!0:!1}function Aa(a){r.set("show_hud_debug_info",a.show_hud_debug_info);window.location.reload()}function Ba(a){r.set("sfx_mix_mode",a.sfx_mix_mode);window.location.reload()}function Ca(a){r.set("anaglyph_use",
a.anaglyph_use);window.location.reload()}function Da(a){r.set("gyro_use",a.gyro_use);window.location.reload()}function sa(a){r.set("outlining_overview_mode",a.outlining_overview_mode);window.location.reload()}function ta(){ka=!0;oa()}function Ea(a){u.resize_to_container();a=H.get_canvas_elem();document.getElementById("info_left_up").innerHTML=a.width+"x"+a.height+" ("+a.width/a.clientWidth+":1)"}function da(){var a=document.getElementById("animation").value,d=parseInt(document.getElementById("anim_slot").value);
"None"!==a&&p.play(n,null,d)}function ca(){document.getElementById("animation");var a=parseInt(document.getElementById("anim_slot").value);p.stop(n,a)}function Q(){H.pause();var a=wb.determine_max_bones();document.getElementById("max_bones").innerHTML=a.max_bones;document.getElementById("max_bones_no_blending").innerHTML=a.max_bones_no_blending;H.resume()}function L(a){if("shape_key_obj"in a){K=l.get_object_by_name(a.shape_key_obj);var d=la.get_shape_keys_names(K);d.length?(x("shape_key_name",d),
ma=d[0],d=la.get_shape_key_value(K,ma),h("shape_key_value",d)):x("shape_key_name",["N/K"])}"shape_key_name"in a&&(ma=a.shape_key_name,d=la.get_shape_key_value(K,ma),h("shape_key_value",d));"shape_key_value"in a&&la.set_shape_key_value(K,ma,a.shape_key_value)}function C(a){if("anim_active_object"in a){n=l.get_object_by_name(a.anim_active_object);var d=p.get_anim_names(n);if(d.length){for(var c=[],e=0;e<d.length&&8>e;e++)c.push(e);d.push("None");x("animation",d);x("anim_slot",c);d=parseInt(document.getElementById("anim_slot").value);
N(n,d);ha(n,d)}else x("animation",["N/A"]);b(n)}if("anim_slot"in a){if(!n)return;d=a.anim_slot;N(n,d);ha(n,d);b(n)}"animation"in a&&(d=parseInt(document.getElementById("anim_slot").value),p.get_current_anim_name(n,d),"None"==a.animation?p.remove_slot_animation(n,d):(p.apply(n,a.animation,d),p.play(n,null,d)),ha(n,d),b(n));"anim_cyclic"in a&&(d=document.getElementById("animation").value,d=p.get_slot_num_by_anim(n,d),p.set_behavior(n,a.anim_cyclic?p.AB_CYCLIC:p.AB_FINISH_RESET,d));"anim_frame_current"in
a&&(d=parseInt(document.getElementById("anim_slot").value),p.is_play(n,d)||(c=parseInt(a.anim_frame_current),p.set_frame(n,c,d)));"anim_mix_factor"in a&&p.set_skel_mix_factor(n,a.anim_mix_factor)}function N(a,d){for(var b=p.get_current_anim_name(a,d),b=b||"None",c=$("#animation"),e=c.children(),f=0;f<e.length;f++){var g=e[f];if(g.value==b){g.selected=!0;c.selectmenu();c.selectmenu("refresh");break}}}function ha(a,d){h("anim_cyclic",Number(p.get_behavior(a,d)==p.AB_CYCLIC));var b=document.getElementById("anim_frame_range"),
c=p.get_anim_start_frame(a,d),e=p.get_anim_length(a,d);-1!=c&&-1!=e?(e=c+e,b.innerHTML=c+" - "+e,b=document.getElementById("anim_frame_current"),b.min=""+c,b.max=""+e):b.innerHTML="N/A"}function b(a){for(var d=$("#anim_slot-listbox").find("a"),b=parseInt(document.getElementById("anim_slot").value),c=p.get_anim_type(a,b),b=0;b<d.length;b++){c=p.get_anim_type(a,b);switch(c){case p.OBJ_ANIM_TYPE_ARMATURE:c="ARMATURE";break;case p.OBJ_ANIM_TYPE_OBJECT:c="OBJECT";break;case p.OBJ_ANIM_TYPE_PARTICLES:c=
"PARTICLES";break;case p.OBJ_ANIM_TYPE_VERTEX:c="VERTEX";break;case p.OBJ_ANIM_TYPE_MATERIAL:c="MATERIAL";break;case p.OBJ_ANIM_TYPE_STATIC:c="STATIC";break;default:c="NONE"}d.eq(b);c=b+" ("+c+")";$("#anim_slot").children().eq(b).text(c)}$("#anim_slot").selectmenu();$("#anim_slot").selectmenu("refresh")}function c(){var a=l.get_ssao_params(),d="ssao_quality ssao_hemisphere ssao_blur_depth ssao_blur_discard_value ssao_radius_increase ssao_influence ssao_dist_factor ssao_only ssao_white".split(" ");
if(a){m(d,"enable");for(var b=document.getElementById("ssao_quality"),d=a.ssao_quality,b=b.options,c=0;c<b.length;c++){var e=b[c];e.selected=e.value==d?!0:!1}$("#ssao_quality").selectmenu("refresh");d=Number(a.ssao_hemisphere);document.getElementById("ssao_hemisphere").options[d].selected=!0;$("#ssao_hemisphere").slider("refresh");d=Number(a.ssao_blur_depth);document.getElementById("ssao_blur_depth").options[d].selected=!0;$("#ssao_blur_depth").slider("refresh");h("ssao_blur_discard_value",a.blur_discard_value);
h("ssao_radius_increase",a.radius_increase);h("ssao_influence",a.influence);h("ssao_dist_factor",a.dist_factor);d=Number(a.ssao_only);document.getElementById("ssao_only").options[d].selected=!0;$("#ssao_only").slider("refresh");d=Number(a.ssao_white);document.getElementById("ssao_white").options[d].selected=!0;$("#ssao_white").slider("refresh")}else m(d,"disable")}function g(a){l.get_ssao_params();var d={};"ssao_quality"in a&&(d.ssao_quality=w(document.getElementById("ssao_quality")));"ssao_hemisphere"in
a&&(d.ssao_hemisphere=Number(a.ssao_hemisphere));"ssao_blur_depth"in a&&(d.ssao_blur_depth=Number(a.ssao_blur_depth));"ssao_blur_discard_value"in a&&(d.ssao_blur_discard_value=a.ssao_blur_discard_value);"ssao_radius_increase"in a&&(d.ssao_radius_increase=a.ssao_radius_increase);"ssao_influence"in a&&(d.ssao_influence=a.ssao_influence);"ssao_dist_factor"in a&&(d.ssao_dist_factor=a.ssao_dist_factor);"ssao_only"in a&&(d.ssao_only=Number(a.ssao_only));"ssao_white"in a&&(d.ssao_white=Number(a.ssao_white));
l.set_ssao_params(d)}function t(){var a=l.get_color_correction_params(),d=["brightness","contrast","exposure","saturation"];a?(m(d,"enable"),h("brightness",a.brightness),h("contrast",a.contrast),h("exposure",a.exposure),h("saturation",a.saturation)):m(d,"disable")}function na(a){var d=l.get_color_correction_params();d&&(d={},"brightness"in a&&(d.brightness=parseFloat(a.brightness)),"contrast"in a&&(d.contrast=parseFloat(a.contrast)),"exposure"in a&&(d.exposure=parseFloat(a.exposure)),"saturation"in
a&&(d.saturation=parseFloat(a.saturation)),l.set_color_correction_params(d))}function w(a){a=a.options;for(var d=0;d<a.length;d++){var b=a[d];if(b.selected)return b.value}}function ab(){var a=l.get_fog_color_density();.2<a[3]?h("fog_density",a[3]):h("fog_density1000",1E3*a[3]);O("fog_color",a)}function Ha(a){var d=l.get_fog_color_density();"fog_density"in a&&(d[3]=a.fog_density);"fog_density1000"in a&&(d[3]=a.fog_density1000/1E3);"fog_color"in a&&(d[0]=a.fog_color[0],d[1]=a.fog_color[1],d[2]=a.fog_color[2]);
l.set_fog_color_density(d)}function nb(){var a=l.get_shadow_params(),d="csm_first_cascade_border csm_last_cascade_border self_shadow_polygon_offset self_shadow_normal_offset first_cascade_blur_radius last_cascade_blur_radius res_ui-block-b num_ui-block-b blur_ui-block-b".split(" ");if(!a)return m(d,"disable"),document.getElementById("csm_resolution").innerHTML="",document.getElementById("csm_num").innerHTML="",document.getElementById("csm_borders").innerHTML="",document.getElementById("blur_radii").innerHTML=
"",null;m(d,"enable");Ya(a);h("self_shadow_polygon_offset",a.self_shadow_polygon_offset);h("self_shadow_normal_offset",a.self_shadow_normal_offset);h("first_cascade_blur_radius",a.first_cascade_blur_radius);a.b4w_enable_csm?(h("csm_first_cascade_border",a.csm_first_cascade_border),1<a.csm_num?(h("csm_last_cascade_border",a.csm_last_cascade_border),h("last_cascade_blur_radius",a.last_cascade_blur_radius)):m(["csm_last_cascade_border","last_cascade_blur_radius"],"disable")):m(["csm_first_cascade_border",
"csm_last_cascade_border","last_cascade_blur_radius"],"disable")}function Z(a){var d={};"csm_first_cascade_border"in a&&(d.csm_first_cascade_border=a.csm_first_cascade_border);"csm_last_cascade_border"in a&&(d.csm_last_cascade_border=a.csm_last_cascade_border);"self_shadow_polygon_offset"in a&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset);"self_shadow_normal_offset"in a&&(d.self_shadow_normal_offset=a.self_shadow_normal_offset);"first_cascade_blur_radius"in a&&(d.first_cascade_blur_radius=
a.first_cascade_blur_radius);"last_cascade_blur_radius"in a&&(d.last_cascade_blur_radius=a.last_cascade_blur_radius);l.set_shadow_params(d);Ya(l.get_shadow_params())}function Ya(a){document.getElementById("csm_resolution").innerHTML="&nbsp;&nbsp;"+a.csm_resolution;if(a.b4w_enable_csm){document.getElementById("csm_num").innerHTML=" "+a.csm_num;for(var d=["csm_borders","blur_radii"],b=0;b<d.length;b++){var c=d[b],e=a[c],c=document.getElementById(c);c.innerHTML="(";for(var f=0;f<e.length;f++)0<f&&(c.innerHTML+=
" __ "),c.innerHTML+=Math.round(10*e[f])/10;c.innerHTML+=")"}}else document.getElementById("cascades-info-block").style.display="none",document.getElementById("csm_first_cascade_border-info-block").style.display="none",document.getElementById("csm_last_cascade_border-info-block").style.display="none",document.getElementById("blur_radii-info-block").style.display="none",document.getElementById("first_cascade_blur_radius-label").innerHTML="Blur radius",document.getElementById("last_cascade_blur_radius-info-block").style.display=
"none"}function mb(){var a=l.get_environment_colors();h("environment_energy",a[0]);O("horizon_color",a[1]);O("zenith_color",a[2])}function Fa(a){"environment_energy"in a&&l.set_environment_colors(a.environment_energy,null,null);"horizon_color"in a&&l.set_environment_colors(null,a.horizon_color,null);"zenith_color"in a&&l.set_environment_colors(null,null,a.zenith_color)}function Ra(a){var d={};"string"==typeof a.wireframe_mode&&(d.wireframe_mode=w(document.getElementById("wireframe_mode")));"object"==
typeof a.wireframe_edge_color&&(d.wireframe_edge_color=a.wireframe_edge_color);B.set_debug_params(d)}function fb(){xb.shot()}function sb(){var a=l.get_sky_params(),d="sky_color rayleigh_brightness mie_brightness spot_brightness scatter_strength rayleigh_strength mie_strength rayleigh_collection_power mie_collection_power mie_distribution".split(" ");if(!a)return m(d,"disable"),null;m(d,"enable");O("sky_color",a.color);h("rayleigh_brightness",a.rayleigh_brightness);h("mie_brightness",a.mie_brightness);
h("spot_brightness",a.spot_brightness);h("scatter_strength",a.scatter_strength);h("rayleigh_strength",a.rayleigh_strength);h("mie_strength",a.mie_strength);h("rayleigh_collection_power",a.rayleigh_collection_power);h("mie_collection_power",a.mie_collection_power);h("mie_distribution",a.mie_distribution)}function J(a){var d={};"sky_color"in a&&(d.color=a.sky_color);"rayleigh_brightness"in a&&(d.rayleigh_brightness=a.rayleigh_brightness);"mie_brightness"in a&&(d.mie_brightness=a.mie_brightness);"spot_brightness"in
a&&(d.spot_brightness=a.spot_brightness);"scatter_strength"in a&&(d.scatter_strength=a.scatter_strength);"rayleigh_strength"in a&&(d.rayleigh_strength=a.rayleigh_strength);"mie_strength"in a&&(d.mie_strength=a.mie_strength);"rayleigh_collection_power"in a&&(d.rayleigh_collection_power=a.rayleigh_collection_power);"mie_collection_power"in a&&(d.mie_collection_power=a.mie_collection_power);"mie_distribution"in a&&(d.mie_distribution=a.mie_distribution);l.set_sky_params(d)}function Wa(a,d){var b=V.get_material_extended_params(a,
d),c="material_diffuse_color material_name material_reflectivity material_fresnel material_fresnel_factor material_parallax_scale material_parallax_steps".split(" ");if(!b)return m(c,"disable"),$("#material_warning")[0].style.display="block",null;var e=V.get_diffuse_color(a,d);e.pop();b.diffuse_color=e;m(c,"enable");O("material_diffuse_color",b.diffuse_color);h("material_reflectivity",b.reflect_factor);h("material_fresnel",b.fresnel);h("material_fresnel_factor",b.fresnel_factor);h("material_parallax_scale",
b.parallax_scale);h("material_parallax_steps",b.parallax_steps)}function U(a){var d=D;"material_name"in a&&Wa(d,a.material_name);if("material_diffuse_color"in a){var b=a.material_diffuse_color.slice();b.push(1);V.set_diffuse_color(d,$("#material_name").val(),b)}b={};"material_reflectivity"in a&&(b.material_reflectivity=a.material_reflectivity);"material_fresnel"in a&&(b.material_fresnel=a.material_fresnel);"material_fresnel_factor"in a&&(b.material_fresnel_factor=a.material_fresnel_factor);"material_parallax_scale"in
a&&(b.material_parallax_scale=a.material_parallax_scale);"material_parallax_steps"in a&&(b.material_parallax_steps=a.material_parallax_steps);V.set_material_extended_params(d,$("#material_name").val(),b);l.update_scene_materials_params()}function q(a){var b=D,c="waves_height waves_length sss_strength sss_width dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac".split(" ");if(!b)return null;
var e={},f=$("#water_dynamic").val(),g=$("#shore_smoothing").val();Boolean(Number(f))?m(c,"enable"):m(c,"disable");Boolean(Number(g))?m(["absorb_factor"],"enable"):m(["absorb_factor"],"disable");"shore_smoothing"in a&&(e.shore_smoothing=a.shore_smoothing);"absorb_factor"in a&&(e.absorb_factor=a.absorb_factor);"water_fog_color"in a&&(e.water_fog_color=a.water_fog_color);"water_fog_density"in a&&(e.water_fog_density=a.water_fog_density);"shallow_water_col"in a&&(e.shallow_water_col=a.shallow_water_col);
"shallow_water_col_fac"in a&&(e.shallow_water_col_fac=a.shallow_water_col_fac);"shore_water_col"in a&&(e.shore_water_col=a.shore_water_col);"shore_water_col_fac"in a&&(e.shore_water_col_fac=a.shore_water_col_fac);"foam_factor"in a&&(e.foam_factor=a.foam_factor);"norm_uv_velocity"in a&&(e.norm_uv_velocity=a.norm_uv_velocity);"sss_strength"in a&&(e.sss_strength=a.sss_strength);"sss_width"in a&&(e.sss_width=a.sss_width);"water_dynamic"in a&&(e.water_dynamic=a.water_dynamic);"waves_height"in a&&(e.waves_height=
a.waves_height);"waves_length"in a&&(e.waves_length=a.waves_length);"dst_noise_scale0"in a&&(e.dst_noise_scale0=a.dst_noise_scale0);"dst_noise_scale1"in a&&(e.dst_noise_scale1=a.dst_noise_scale1);"dst_noise_freq0"in a&&(e.dst_noise_freq0=a.dst_noise_freq0);"dst_noise_freq1"in a&&(e.dst_noise_freq1=a.dst_noise_freq1);"dir_min_shore_fac"in a&&(e.dir_min_shore_fac=a.dir_min_shore_fac);"dir_freq"in a&&(e.dir_freq=a.dir_freq);"dir_noise_scale"in a&&(e.dir_noise_scale=a.dir_noise_scale);"dir_noise_freq"in
a&&(e.dir_noise_freq=a.dir_noise_freq);"dir_min_noise_fac"in a&&(e.dir_min_noise_fac=a.dir_min_noise_fac);"dst_min_fac"in a&&(e.dst_min_fac=a.dst_min_fac);"waves_hor_fac"in a&&(e.waves_hor_fac=a.waves_hor_fac);if(!V.set_water_material_params(b,$("#material_name").val(),e))return null;l.update_scene_materials_params();l.set_water_params(e)}function Xa(a){if(a=F.get_light_params(a)){O("light_color",a.light_color);h("light_energy",a.light_energy);var b=a.light_type;$("#light_type").text(b);"SPOT"==a.light_type?
(m(["light_spot_blend","light_spot_size"],"enable"),"light_spot_blend"in a&&h("light_spot_blend",a.light_spot_blend),"light_spot_size"in a&&h("light_spot_size",Math.round(a.light_spot_size*yb))):m(["light_spot_blend","light_spot_size"],"disable");"SPOT"==a.light_type||"POINT"==a.light_type?(m(["light_distance"],"enable"),"light_distance"in a&&h("light_distance",a.light_distance)):m(["light_distance"],"disable")}}function Y(a){"light_name"in a&&Xa(l.get_object_by_name(a.light_name));var b={};"light_color"in
a&&(b.light_color=a.light_color);"light_energy"in a&&(b.light_energy=parseFloat(a.light_energy));"light_spot_size"in a&&(b.light_spot_size=parseFloat(a.light_spot_size*zb));"light_spot_blend"in a&&(b.light_spot_blend=parseFloat(a.light_spot_blend));"light_distance"in a&&(b.light_distance=parseFloat(a.light_distance));a=l.get_object_by_name($("#light_name").val());F.set_light_params(a,b)}function rb(){var a=F.get_sun_params(),b=["sun_horizontal_position","sun_vertical_position"];if(!a)return m(b,"disable"),
null;h("sun_horizontal_position",a.hor_position);h("sun_vertical_position",a.vert_position)}function Pa(a){var b={};"sun_horizontal_position"in a&&(b.hor_position=parseFloat(a.sun_horizontal_position),b.vert_position=parseFloat(document.getElementById("sun_vertical_position").value));"sun_vertical_position"in a&&(b.hor_position=parseFloat(document.getElementById("sun_horizontal_position").value),b.vert_position=parseFloat(a.sun_vertical_position));F.set_sun_params(b)}function cb(a){a=parseFloat(a.max_sun_angle);
F.set_max_sun_angle(a)}function Ga(a){"day_time"in a&&F.set_day_time(a.day_time);"date"in a&&F.set_date(new Date(a.date))}function db(){var a=0,b=parseFloat(document.getElementById("day_time").value),c=v.create_elapsed_sensor(),e=F.get_lamps("SUN")[0];v.create_sensor_manifold(e,"ELAPSED",v.CT_CONTINUOUS,[c],function(a){return a[0]},function(c,e,f){1==f&&(a=document.getElementById("sun_time_multiplier").value,c=v.get_sensor_value(c,e,0),b+=c*a/3600,24<b&&(b-=Math.floor(b)),h("day_time",b))})}function ub(){var a=
F.get_lamps("SUN")[0],b=["sn-ui-grid-b"];F.get_lamps().length?a||m("run_sun stop_sun date sun_time_multiplier day_time max_sun_angle".split(" "),"disable"):m(b,"disable")}function Ta(){m("material_diffuse_color material_name material_reflectivity material_fresnel material_fresnel_factor material_parallax_scale material_parallax_steps".split(" "),"disable");m("shallow_water_col shallow_water_col_fac shore_water_col shore_water_col_fac water_fog_color water_fog_density absorb_factor sss_strength sss_width foam_factor norm_uv_velocity waves_height waves_length dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac water_dynamic shore_smoothing".split(" "),
"disable")}function eb(){var a=F.get_lamps("SUN")[0];v.check_sensor_manifolds(a)&&v.remove_sensor_manifold(a,"ELAPSED")}function ob(){var a=l.get_dof_params(),b=["dof_distance","dof_front","dof_rear","dof_power","dof_on"];a?(h("dof_distance",a.dof_distance),h("dof_front",a.dof_front),h("dof_rear",a.dof_rear),h("dof_power",a.dof_power),m(b,"enable"),a=0<a.dof_distance?0:1,document.getElementById("dof_on").options[a].selected=!0,$("#dof_on").slider("refresh")):m(b,"disable")}function ia(a){var b={};
"dof_distance"in a&&Number($("#dof_on").val())&&(b.dof_distance=a.dof_distance);"dof_front"in a&&(b.dof_front=a.dof_front);"dof_rear"in a&&(b.dof_rear=a.dof_rear);"dof_power"in a&&(b.dof_power=a.dof_power);"dof_on"in a&&(b.dof_on=Boolean($("#dof_on").val()),b.dof_distance=Number(a.dof_on)?parseFloat($("#dof_distance").val()):0);l.set_dof_params(b)}function pb(){var a=l.get_god_rays_params(),b=["god_rays_intensity","god_rays_max_ray_length","god_rays_steps"];a?(m(b,"enable"),a&&(h("god_rays_intensity",
a.god_rays_intensity),h("god_rays_max_ray_length",a.god_rays_max_ray_length),h("god_rays_steps",a.god_rays_steps))):m(b,"disable")}function Ia(a){var b={};"god_rays_intensity"in a&&(b.god_rays_intensity=a.god_rays_intensity);"god_rays_max_ray_length"in a&&(b.god_rays_max_ray_length=a.god_rays_max_ray_length);"god_rays_steps"in a&&(b.god_rays_steps=a.god_rays_steps);l.set_god_rays_params(b)}function tb(){var a=l.get_bloom_params(),b=["bloom_key","bloom_blur","bloom_edge_lum"];a?(m(b,"enable"),a&&(h("bloom_key",
a.bloom_key),h("bloom_blur",a.bloom_blur),h("bloom_edge_lum",a.bloom_edge_lum))):m(b,"disable")}function Ja(a){var b={};"bloom_key"in a&&(b.bloom_key=a.bloom_key);"bloom_blur"in a&&(b.bloom_blur=a.bloom_blur);"bloom_edge_lum"in a&&(b.bloom_edge_lum=a.bloom_edge_lum);l.set_bloom_params(b)}function O(a,b){b=Ab(b);var c={r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*b[2])};$("#"+a).ColorPickerSetColor(c);$("#"+a+" div").css("backgroundColor","#"+function(a){var b=[a.r.toString(16),a.g.toString(16),
a.b.toString(16)];$.each(b,function(a,c){1==c.length&&(b[a]="0"+c)});return b.join("")}(c))}function Ab(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]}function qb(){var a=l.get_wind_params(),b=["wind_dir","wind_strength"];a?(h("wind_dir",a.wind_dir),h("wind_strength",a.wind_strength)):m(b,"disable")}function Qa(a){var b={};"wind_dir"in a&&(b.wind_dir=a.wind_dir);"wind_strength"in a&&(b.wind_strength=a.wind_strength);l.set_wind_params(b)}function h(a,b){$("#"+a).val(b);$("#"+
a).slider("refresh");$("#"+a).trigger("change")}function e(a,b,c){$("#"+b).bind("change",function(e){var f={};switch(c){case "string":f[b]=e.target.value;break;case "number":f[b]=parseFloat(e.target.value);break;case "bool":f[b]=Boolean(Number(e.target.value));break;default:return console.log("wrong value type"),null}a(f)})}function I(a,b){$("#"+b).ColorPicker({onChange:function(c,e,f){$("#"+b+" div").css("backgroundColor","#"+e);c={};e=[];e[0]=f.r/255;e[1]=f.g/255;e[2]=f.b/255;f=e;f=[Math.pow(f[0],
2.2),Math.pow(f[1],2.2),Math.pow(f[2],2.2)];c[b]=f;a(c)}})}function bb(){Bb.auto_rotate(.3)}function m(a,b){if(!a)return null;for(var c=0;c<a.length;c++){var e=$("#"+a[c]).parent().parent();"enable"==b?e.removeClass("ui-disabled"):"disable"==b&&e.addClass("ui-disabled")}}var p=k("animation"),u=k("app"),Na=k("assets"),Ua=k("camera"),Bb=k("camera_anim"),y=k("config"),vb=k("constraints"),v=k("controls"),La=k("data"),B=k("debug"),la=k("geometry"),hb=k("gyroscope"),F=k("lights"),H=k("main"),gb=k("mixer"),
V=k("material"),xb=k("screenshooter"),l=k("scenes"),wb=k("shaders"),r=k("storage"),jb=k("transform"),ja=k("util"),Oa=k("version"),lb=k("vec3"),Za="DEBUG"===Oa.type(),zb=Math.PI/180,yb=180/Math.PI,ib=new Float32Array(3),kb=new Float32Array(3),ka=!1,Ka,E=null,n=null,K=null,ma="",aa=null,ua=null,z=null,D=null,Sa=function(){},R=null,Va=null;f.init=function(){r.init("b4w_viewer");var a=r.get("quality");if(a){switch(a){case "ULTRA":var b=y.P_ULTRA;break;case "HIGH":b=y.P_HIGH;break;case "LOW":b=y.P_LOW;
break;case "CUSTOM":b=y.P_CUSTOM}y.set("quality",b)}y.set("anaglyph_use","true"===r.get("anaglyph_use"));y.set("gyro_use","true"===r.get("gyro_use"));""==r.get("outlining_overview_mode")?y.set("outlining_overview_mode",!0):y.set("outlining_overview_mode","true"===r.get("outlining_overview_mode"));u.init({canvas_container_id:"main_canvas_container",callback:$a,autoresize:!1,gl_debug:!0,show_hud_debug_info:"true"===r.get("show_hud_debug_info")?!0:!1,sfx_mix_mode:ga(),show_fps:!0,alpha:!0,assets_dds_available:!Za,
assets_min50_available:!Za,console_verbose:!0,physics_enabled:!0,wireframe_debug:!0})}});b4w.require("viewer_main").init();
