var hd={},od;for(od in window)hd[od]=!0;var b4w="object"===typeof b4w?b4w:function(a){var t={};a.module=t;var l={};a.register=function(a,b){t[a]||(t[a]=b)};a.require=function(a,b){if(!t[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";l[b]||(l[b]=function(a){return function(b){var c=t[b];if(!c)throw Error('Module "'+b+'" not found');c.yk||(c.yk={});c.yk[a]||(c.yk[a]={},c(c.yk[a],l[a]));return c.yk[a]}}(b));return l[b](a)};a.module_check=function(a){return t[a]?!0:!1};a.get_namespace=function(a){for(var b in l)if(l[b]==a)return b;
return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.app=function(a,t){function l(){var a=I.lo();document.addEventListener("visibilitychange",function(){document.hidden?(a=I.lo(),I.pause()):a||I.ke()},!1)}function c(a,e,b,k){var d=document.createElement("canvas"),f=document.getElementById(a);d.style.position="absolute";d.style.left=0;d.style.top=0;d.style.width=f.offsetWidth+"px";d.style.height=f.offsetHeight+"px";d.width=f.offsetWidth*window.devicePixelRatio;d.height=f.offsetHeight*window.devicePixelRatio;e?(e=document.createElement("canvas"),
e.style.position="absolute",d.style.left=0,d.style.top=0,e.style.pointerEvents="none"):e=null;f||(E.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(d);if(!I.Kc(d,e))return b&&J("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/troubleshooting",k),!1;e&&q.eo(e,"LAST");return!0}function b(a,e){a?(e&&(document.getElementById(e).style.display="block"),M=document.getElementById(a)):(M=document.createElement("div"),
M.innerHTML=0,M.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",q.eo(M,"JUST_AFTER_CANVAS"))}function y(a,e){var b=String(a);e&&(b+="/"+String(e));M.innerHTML=b}function h(a){a=document.getElementById(a);var e=a.cloneNode(!0);a.parentNode.replaceChild(e,a);return e}function r(){var a=q.Je();I.resize(a.clientWidth,a.clientHeight,!0)}function x(a,b,k){if(n.Ur(a))var d=G.de(a,P),f=n.qI(a,S),d=K.subtract(d,f,P),d=Math.max(K.len(d),
1);else d=10;f=G.eg(a,ka);b=e.za(f,b,P);b[1]=0;K.normalize(b,b);K.scale(b,d*k,b);d=G.de(a,S);K.add(d,b,d);n.Xr(a,d)}function v(a,b){if(n.Ur(a)){var k=n.pI(a,T);if(0>k[1]-k[0]){var d=n.ae(a,ea)[1],k=(k[0]-d)/(k[0]-k[1]),d=n.bI(a),k=Math.max(k,2/d[0]);n.ji(a,0,k*b)}}else k=G.de(a,P),d=K.scale(e.jb,-b,S),K.add(k,d,k),n.Xr(a,k)}function g(a,e,b,k){G.md(a,5*e,5*b,5*k)}function p(a,e,b){var k=G.de(a,P),d=n.Lr(a,S),k=K.dist(k,d),d=Math.abs(e);b=Math.pow(d*b,1-Math.pow(d*b,.15));G.md(a,0,0>e?.001<k?-k*b:
0:b/(1-b)*k,0)}function f(a,e,b,k){for(var d=b*e;0<a;--a)b+=d,k+=d,d=b*e;return k}function A(a,e,b,k,d){d?(d=n.Lr(a,P),a=n.ey(a),a=K.dist(d,a)+k,k=0<e?f(e,-b,a,k):f(-e,b/(1-b),a,k)):k-=2*e*b;return k}function F(a,b,d){function f(a,O,e,b){if(1==e){var k=M?.003*E[0]:.003*E[1];e=m.Ic(a,O,0);m.Ke(a,O,0)===m.Fm?(J+="X"==b?-e*k:0,t+="Y"==b?-e*k:0):m.Ke(a,O,0)===m.Dm&&(a=M?.003*E[1]:7.5E-4*E[0],bc+="X"==b?-e*a:0,ma+="Y"==b?-e*a:0)}}function c(a,O,e,b){if(1==e){e=m.Ic(a,O,1);n.wl(a,E);if(M)k=.003*E[0],d=
7.5E-4*E[1];else var k=.003*E[1],d=7.5E-4*E[0];if(1===m.Ke(a,O,0))Wb+="X"==b?-e*k:0,Aa+="Y"==b?-e*k:0;else if(2===m.Ke(a,O,0)||3===m.Ke(a,O,0))wb+="X"==b?-e*d:0,va+="Y"==b?-e*d:0}}function h(a){return a[0]&&(a[1]||a[2])}function q(a,O,b){if(1==b)switch(b=m.Ic(a,O,0),n.wl(a,E),O){case "FORWARD":r?ja[0]=1:M?(O=n.ae(a,ea)[1],O=Math.abs(O)>=Math.PI/4?e.Xg:e.dc,x(a,O,.5*E[0]*b)):w?p(a,-E[2],b):g(a,0,-E[0]*b,0);break;case "BACKWARD":r?ja[0]=-1:M?(O=n.ae(a,ea)[1],O=Math.abs(O)>=Math.PI/4?e.se:e.jb,x(a,O,
.5*E[0]*b)):w?p(a,E[2],b):g(a,0,E[0]*b,0);break;case "UP":M?v(a,30*-E[2]*b):r||g(a,0,0,-E[0]*b);break;case "DOWN":M?v(a,30*E[2]*b):r||g(a,0,0,E[0]*b);break;case "LEFT":r?ja[1]=1:M?x(a,e.Kp,.5*E[0]*b):g(a,-E[0]*b,0,0);break;case "RIGHT":r?ja[1]=-1:M?x(a,e.$e,.5*E[0]*b):g(a,E[0]*b,0,0);break;case "ROT_LEFT":w?n.Cf(a,2*-E[1]*b,0):n.rd(a,2*E[1]*b,0);break;case "ROT_RIGHT":w?n.Cf(a,2*E[1]*b,0):n.rd(a,2*-E[1]*b,0);break;case "ROT_UP":w?n.Cf(a,0,2*-E[1]*b):n.rd(a,0,2*E[1]*b);break;case "ROT_DOWN":w?n.Cf(a,
0,2*E[1]*b):n.rd(a,0,2*-E[1]*b)}else switch(O){case "FORWARD":case "BACKWARD":r&&(ja[0]=0);break;case "LEFT":case "RIGHT":r&&(ja[1]=0)}r&&(u.yt(r,ja[0],ja[1]),a=n.Qn(a,T),u.Vo(r,a[0],a[1]))}Q=!0;aa=a;U=b;ba=d;var l=z.cj(),w=!1,r=null,M=!1;switch(n.be(l)){case n.Da:w=!a;break;case n.Wb:r=z.hy();break;case n.Rd:return;case n.Ob:M=!0}var E=n.wl(l,ca);a=m.Pi();if(u.Vr(l)){var F=m.Nq(l,null,!0);m.U(l,"CAMERA_COLLISION",m.na,[F],null,function(a,O,e){if(1==e&&(e=m.Ke(a,O,0).coll_dist,0>e)){var b=m.Ke(a,
O,0).coll_norm;O=P;K.scale(b,-.25*e,O);e=G.de(a,S);K.add(e,O,e);G.Gt(a,e)}})}if(r){var F=G.de(l),C=G.eg(l),C=e.wq(C);F[1]-=.5;u.$o(r,F,C);B.ME(l,r);var ja=new Float32Array(2),y=!0;u.Uo(r,u.Uu);m.Qi(l,"TOGGLE_CHAR_MOVE_TYPE",m.ue,m.jD,function(){y=!y;u.Uo(r,y?u.Uu:u.QC)})}if(b)b=F=C=D=I=O=m.Oq(0);else{b=m.xb(m.ev);var F=m.xb(m.cv),C=m.xb(m.Yu),D=m.xb(m.Zu),I=m.xb(m.pD),O=m.xb(m.kD)}var pb=m.xb(m.dv),qa=m.xb(m.$u),Ga=m.xb(m.av),Ra=m.xb(m.bv);M||(m.U(l,"FORWARD",m.na,[a,b],null,q),m.U(l,"BACKWARD",m.na,
[a,F],null,q));w?(m.U(l,"ROT_UP",m.na,[a,pb,I],h,q),m.U(l,"ROT_DOWN",m.na,[a,qa,O],h,q),m.U(l,"ROT_LEFT",m.na,[a,Ga,C],h,q),m.U(l,"ROT_RIGHT",m.na,[a,Ra,D],h,q)):M?(m.U(l,"LEFT",m.na,[a,Ga,C],h,q),m.U(l,"RIGHT",m.na,[a,Ra,D],h,q),m.U(l,"FORWARD",m.na,[a,pb,b],h,q),m.U(l,"BACKWARD",m.na,[a,qa,F],h,q),m.U(l,"UP",m.na,[a,O],h,q),m.U(l,"DOWN",m.na,[a,I],h,q)):(m.U(l,"UP",m.na,[a,I],h,q),m.U(l,"DOWN",m.na,[a,O],h,q),m.U(l,"LEFT",m.na,[a,C],h,q),m.U(l,"RIGHT",m.na,[a,D],h,q),m.U(l,"ROT_UP",m.na,[a,pb],
h,q),m.U(l,"ROT_DOWN",m.na,[a,qa],h,q),m.U(l,"ROT_LEFT",m.na,[a,Ga],h,q),m.U(l,"ROT_RIGHT",m.na,[a,Ra],h,q));if(!d){var H=0;d=m.Qq();var Na=0;b=m.wn();m.U(l,"MOUSE_WHEEL",m.te,[d],null,function(a,O,e){1==e&&(O=m.Ic(a,O,0),n.wl(a,E),w||M?H=A(a,O,E[2],H,w):(E[0]*=1+O*E[2],n.DL(a,E)))});m.U(l,"TOUCH_ZOOM",m.te,[b],null,function(a,O,e){1==e&&(e=m.Ic(a,O,0),n.wl(a,E),m.Ke(a,O,0)===m.Em&&(Na=A(a,e,.03*E[2],Na,w)))});m.U(l,"ZOOM_INTERPOL",m.na,[a],null,function(a,O,b){if(1==b&&(w||M))if(1E-5<Math.abs(H)||
1E-5<Math.abs(Na)){O=m.Ic(a,O,0);b=e.sc(H,0,O,.1*k);H-=b;var d=e.sc(Na,0,O,.15*k);Na-=d;if(M)v(a,-(b+d));else{O=n.Lr(a,P);var f=n.ey(a,S);.001<K.dist(O,f)+b+d?G.md(a,0,b+d,0):(b=K.subtract(f,O,S),d=K.normalize(b,da),K.scale(d,.001,d),K.add(O,d,b),G.Gt(a,b),Na=H=0)}}else Na=H=0})}var Wb=0,Aa=0,wb=0,va=0;d=m.Ri("X");b=m.Ri("Y");F=m.un();m.U(l,"MOUSE_X",m.te,[F,d],null,c,"X");m.U(l,"MOUSE_Y",m.te,[F,b],null,c,"Y");var J=0,t=0,bc=0,ma=0;d=m.Rk("X");b=m.Rk("Y");m.U(l,"TOUCH_X",m.te,[d],null,f,"X");m.U(l,
"TOUCH_Y",m.te,[b],null,f,"Y");m.U(l,"ROT_TRANS_INTERPOL",m.na,[a],null,function(a,O,b){if(1==b&&(1E-5<Math.abs(Wb)||1E-5<Math.abs(Aa)||1E-5<Math.abs(J)||1E-5<Math.abs(t)||1E-5<Math.abs(wb)||1E-5<Math.abs(va)||1E-5<Math.abs(bc)||1E-5<Math.abs(ma))){var d=m.Ic(a,O,0),f=e.sc(Wb,0,d,.08*k);O=e.sc(Aa,0,d,.08*k);Wb-=f;Aa-=O;var g=e.sc(J,0,d,.12*k);b=e.sc(t,0,d,.12*k);J-=g;t-=b;var c=e.sc(wb,0,d,.08*k),h=e.sc(va,0,d,.08*k);wb-=c;va-=h;var q=e.sc(bc,0,d,.12*k),d=e.sc(ma,0,d,.12*k);bc-=q;ma-=d;w?(n.Cf(a,
f+g,O+b),n.cK(a,c+q,h+d)):M?(f+g&&x(a,e.$e,.2*(f+g)),O+b&&(f=n.ae(a,ea)[1],x(a,Math.abs(f)>Math.PI/4?e.se:e.jb,.2*(O+b))),n.ji(a,c+q,0)):(n.rd(a,.5*(f+g),.5*(O+b)),r&&(a=n.Qn(a,T),u.Vo(r,a[0],a[1])))}});m.Qi(l,"DEC_STEREO_DIST",m.ue,m.nD,function(a){n.lB(a,.9*n.Iy(a))});m.Qi(l,"INC_STEREO_DIST",m.ue,m.qD,function(a){n.lB(a,1.1*n.Iy(a))})}function H(){var a=z.cj();Q=!1;for(var e="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL".split(" "),
b=0;b<e.length;b++)m.Bf(a,e[b]);n.be(a)==n.Wb&&z.hy()&&B.remove(a)}function J(a,e,b,k){var d=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(k)for(var c=0;c<k.length;c++){var m=document.getElementById(k[c]);m&&m.parentNode.removeChild(m)}d.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=
a;g.innerHTML=e+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+b+'">'+b.replace("https://www.","")+"</a>";d.appendChild(f);d.appendChild(g);document.body.appendChild(d)}function D(a,e,b,k,d){function f(){var c=performance.now()-g;d(e+c*(b-e)/k);(c>=k||!a.parentNode)&&I.NK(f)}var g=performance.now();I.Um(f)}t("animation");var n=t("camera"),C=t("config"),B=t("constraints"),q=t("container"),m=t("controls"),w=t("data"),d=t("debug"),I=t("main"),u=t("physics"),E=t("print"),z=t("scenes"),G=
t("transform"),e=t("util"),K=t("vec3"),k=1,M=null,Q=!1,aa=!1,U=!1,ba=!1,T=new Float32Array(2),ea=new Float32Array(2),P=new Float32Array(3),S=new Float32Array(3),da=new Float32Array(3),ka=new Float32Array(4),ca=new Float32Array(3);a.Kc=function(a){function e(){var a=c(g,pb,A,u),O=q.Fr();if(a){var k=q.Je();r();I.zt(p);M&&(b(h,z),I.nL(y));K&&l();n&&I.Um(function(){k.style.height=k.clientWidth/n+"px"});f&&I.Um(function(){var a=k.clientWidth,e=k.clientHeight;a==O.clientWidth&&e==O.clientHeight||I.resize(a,
e,!0)});F&&I.Um(function(){q.vr()});d(O,!0)}else d(O,!1)}function k(a){a.keyCode==m.oD&&(I.lo()?I.ke():I.pause())}function d(){}a=a||{};var f=!1,g=null,u=null,h=null,n=0,z=null,p=!1,G=!0,K=!0,A=!0,E=!1,M=!1,x=!1,F=!1,O;for(O in a)switch(O){case "canvas_container_id":g=a.canvas_container_id;break;case "callback":d=a.callback;break;case "autoresize":f=a.autoresize;break;case "do_not_use_onload":break;case "gl_debug":p=a.gl_debug;break;case "show_hud_debug_info":x=a.show_hud_debug_info;break;case "sfx_mix_mode":E=
a.sfx_mix_mode;break;case "show_fps":M=a.show_fps;break;case "track_container_position":F=a.track_container_position;break;case "fps_wrapper_id":z=a.fps_wrapper_id;break;case "fps_elem_id":h=a.fps_elem_id;break;case "error_purge_elements":u=a.error_purge_elements;break;case "report_init_failure":A=a.report_init_failure;break;case "pause_invisible":K=a.pause_invisible;break;case "key_pause_enabled":G=a.key_pause_enabled;break;case "force_container_ratio":n=a.force_container_ratio;break;default:C.set(O,
a[O])}G&&document.addEventListener("keydown",k,!1);C.set("show_hud_debug_info",x);C.set("sfx_mix_mode",E);var pb=x||E||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){w.Y()},!1)};a.pT=r;a.YT=function(a,e){var b=h(a);b.addEventListener("mouseup",function(){e(b.value)},!1)};a.XT=function(a,e){var b=h(a);b.addEventListener("change",function(){var a=b.checked;e(void 0!=a?a:b.value)},!1)};a.ZT=function(a,e){var b=
h(a);b.addEventListener("keypress",function(a){e(a.keyCode,b.value)},!1)};a.lH=F;a.GQ=H;a.yT=function(a){var e=Q;e&&H();var b=z.cj();n.uL(b,a);e&&F(aa,U,ba)};a.OQ=function(a){function e(a){return a[0]&&(a[1]||a[2])}function b(a,e,d){if(1==d)switch(d=m.Ic(a,e,0),e){case "FORWARD":k?u.rk(a,1):G.md(a,0,0,1*d);break;case "BACKWARD":k?u.rk(a,-1):G.md(a,0,0,-1*d);break;case "LEFT":k?u.qk(a,-1):G.md(a,1*d,0,0);break;case "RIGHT":k?u.qk(a,1):G.md(a,-1*d,0,0)}else switch(e){case "FORWARD":case "BACKWARD":k&&
u.rk(a,0);break;case "LEFT":case "RIGHT":k&&u.qk(a,0)}}var k=u.Nc(a)||u.Oc(a),d=m.Pi(),f=m.xb(m.ev),g=m.xb(m.cv),c=m.xb(m.Yu),h=m.xb(m.Zu),q=m.xb(m.dv),l=m.xb(m.$u),n=m.xb(m.av),z=m.xb(m.bv);m.U(a,"FORWARD",m.na,[d,f,q],e,b);m.U(a,"BACKWARD",m.na,[d,g,l],e,b);m.U(a,"LEFT",m.na,[d,c,n],e,b);m.U(a,"RIGHT",m.na,[d,h,z],e,b)};a.IQ=function(a){for(var e=["FORWARD","BACKWARD","LEFT","RIGHT"],b=0;b<e.length;b++)m.Bf(a,e[b])};a.mH=function(){var a,e=q.Je();a=a||!1;m.ht(document,!1);m.it(e,!0,a);m.kt(e,!0);
m.jt(e,!0);m.gt()};a.HQ=function(){var a=q.Je();m.ou(document);m.pu(a);m.ru(a);m.qu(a);m.nu()};a.NQ=function(){m.Qi(null,"CAMERA_SHOT",m.ue,m.lD,function(){d.OJ()});m.Qi(null,"LIGHT_SHOT",m.ue,m.mD,function(){d.RJ()});m.Qi(null,"TELEMETRY",m.ue,m.rD,function(){d.Vs()})};a.VK=function(a,e){var b=document.body;function k(){document.fullscreenElement===b||document.webkitFullScreenElement===b||document.mozFullScreenElement===b||document.webkitIsFullScreen||document.msFullscreenElement===b?a():(document.removeEventListener("fullscreenchange",
k,!1),document.removeEventListener("webkitfullscreenchange",k,!1),document.removeEventListener("mozfullscreenchange",k,!1),document.removeEventListener("MSFullscreenChange",k,!1),e())}a=a||function(){};e=e||function(){};document.addEventListener("fullscreenchange",k,!1);document.addEventListener("webkitfullscreenchange",k,!1);document.addEventListener("mozfullscreenchange",k,!1);document.addEventListener("MSFullscreenChange",k,!1);b.requestFullScreen=b.requestFullScreen||b.webkitRequestFullScreen||
b.mozRequestFullScreen||b.msRequestFullscreen;b.requestFullScreen==b.webkitRequestFullScreen?b.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.requestFullScreen()};a.pH=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if("function"!=typeof a)throw"B4W App: exit fullscreen method is not supported";a.apply(document)};a.PF=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||
window.document.webkitFullscreenEnabled?!0:!1};a.mT=J;a.Un=function(a){a=!!a;var e=location.href.toString();if(-1==e.indexOf("?"))return null;for(var e=e.split("?")[1].split("&"),b={},k=0;k<e.length;k++){var d=e[k].split("="),f=d[0];1<d.length?(d=d[1],a?f in b?b[f].push(d):b[f]=[d]:b[f]=d):a?f in b||(b[f]=[]):b[f]=""}return b};a.hc=function(a,e,b,k,d,f,g,c){function m(d){a&&(h[e]=f+d+g,b>k&&d<=k||b<k&&d>=k)&&(h[e]=f+k+g,c())}if(a&&e&&isFinite(b)&&isFinite(k)&&isFinite(d)){f=f||"";g=g||"";c=c||function(){};
var h=a.style,u=e.charAt(0).toUpperCase()+e.slice(1);if(void 0==h[e])if(void 0!=h["webkit"+u])e="webkit"+u;else if(void 0!=h["ms"+u])e="ms"+u;else if(void 0!=h["moz"+u])e="moz"+u;else return;D(a,b,k,d,m)}};a.hF=function(a,e,b,k,d,f){function g(d){a&&(0<=d&&a.setAttribute(e,d),b>k&&d<=k||b<k&&d>=k)&&(a.setAttribute(e,k),f())}a&&e&&isFinite(b)&&isFinite(k)&&isFinite(d)&&(f=f||function(){},D(a,b,k,d,g))};a.HK=function(e){if(e.length){var b=e.shift(),k=b.elem,d=b.prop,f=b.from,g=b.to,c=b.duration,m=b.opt_prefix,
h=b.opt_suffix,u=function(){b.cb&&b.cb();a.HK(e)};"css"==b.type?a.hc(k,d,f,g,c,m,h,u):"attr"==b.type&&a.hF(k,d,f,g,c,u)}};a.zT=function(a){k=a};a.mR=function(){return k}};b4w.module.animation=function(a,t){var l=t("__animation"),c=t("__print"),b=t("__armature"),y=t("__obj_util");a.kb=l.kb;a.sv=l.sv;a.tv=l.tv;a.uv=l.uv;a.vv=l.vv;a.wv=l.wv;a.xv=l.xv;a.Qp=l.Qp;a.Gm=l.Gm;a.iv=l.iv;a.gv=l.gv;a.jv=l.jv;a.mv=l.mv;a.lv=l.lv;a.kv=l.kv;a.hv=l.hv;a.Gp=l.Gp;a.Hp=l.Hp;a.vm=l.vm;var h=new Float32Array(8);a.Ra=function(a){return l.Ra(a)};a.jR=function(){c.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],b=l.Ox(),h=0;h<b.length;h++)a.push(l.fM(b[h].name));
return a};a.pR=function(b,h){c.error("get_current_action() deprecated, use get_current_anim_name() instead");return a.gI(b,h)};a.Qx=function(a){return l.Yz(a)?l.Qx(a):[]};a.gI=function(a,b){if(!l.Ra(a))return null;b=b||l.kb;return l.XH(a,b)};a.apply=function(a,b,h){if(h>l.Qp)c.error("Can't apply animation to slot "+h+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{h=h||l.kb;if(l.Ra(a)){var g=l.Mr(a,b);if(-1!=g&&g!=h){c.error('Animation "'+b+'" is already applied to object "'+
a.name+'" (slot "'+g+'").');return}}l.qN(a,b)?l.apply(a,b,h):c.error('No fcurves in action "'+b+'"')}};a.remove=function(a){l.remove(a)};a.EA=function(a,b){l.Ra(a)&&(b=b||l.kb,l.EA(a,b))};a.Xm=function(a){l.Xm(a)};a.play=function(a,b,h){l.Ra(a)?(h=h||l.kb,l.play(a,b,h),l.vu(a,0,h,!0)):c.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){l.Ra(a)&&(b=b||l.kb,l.stop(a,b))};a.Lh=function(a,b){if(!l.Ra(a))return!1;b=b||l.kb;return l.Lh(a,b)};a.BT=function(b,h,l){c.error("set_current_frame_float() deprecated, use set_frame() instead");
a.li(b,h,l)};a.Gr=function(b,h){c.error("get_current_frame_float() deprecated, use get_frame() instead");return a.ky(b,h)};a.li=function(a,b,c){l.Ra(a)&&(c=c||l.kb,l.li(a,b,c))};a.At=function(a,b){l.Ra(a)&&l.At(a,b)};a.NT=function(a,b){if(l.Ra(a)){b=b||l.kb;var c=l.Dr(a,b),g=l.Cr(a,b);l.li(a,c+g-l.sD,b)}};a.ky=function(a,b){if(!l.Ra(a))return 0;b=b||l.kb;return l.Gr(a,b)};a.jB=function(a,b,c){l.Ra(a)&&(c=c||l.kb,l.jB(a,b||1,c))};a.Fy=function(a,b){if(!l.Ra(a))return 0;b=b||l.kb;return a.F[b]?l.Fy(a,
b):0};a.xR=function(a,b){c.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(l.Ra(a)){b=b||l.kb;var h=a.F[b];if(h)return[h.start,h.start+h.length]}return null};a.Dr=function(a,b){return l.Ra(a)&&(b=b||l.kb,a.F[b])?l.Dr(a,b):-1};a.Cr=function(a,b){return l.Ra(a)&&(b=b||l.kb,a.F[b])?l.Cr(a,b):-1};a.Hb=function(b,h,y){c.error("cyclic() deprecated, use set_behavior() instead");a.dm(b,h?l.Gp:l.Hp,y)};a.mj=function(a,b){c.error("is_cyclic() deprecated, use get_behavior() instead");
if(!l.Ra(a))return!1;b=b||l.kb;return l.mj(a,b)};a.dm=function(a,b,c){l.Ra(a)&&(c=c||l.kb,l.dm(a,b,c))};a.Tx=function(a,b){if(!l.Ra(a))return null;b=b||l.kb;return l.Tx(a,b)};a.Qv=function(a,b,c,g){g=g||l.kb;l.Ra(a)&&l.Qv(a,b,c,g)};a.vu=function(a,b,h,g){c.error("update_object_animation() deprecated, use set_frame() instead");l.Ra(a)&&(h=h||l.kb,l.vu(a,b||0,h,g||!1))};a.Fx=function(a){return l.Fx(a)};a.lR=function(a,l,v){c.error("get_bone_translation() deprecated, use armature.get_bone_tsr() instead");
if(!y.Jh(a))return null;if(!b.JF(a,l))return c.error('There is no bone: "',l,'" in "',a.name,'".'),null;v||(v=new Float32Array(3));b.Pn(a,l,!1,h);v[0]=h[0];v[1]=h[1];v[2]=h[2];return v};a.vR=function(){c.error("get_first_armature_object() deprecated");return null};a.Mr=function(a,b){return l.Ra(a)&&b?l.Mr(a,b):null};a.Rx=function(a,b){return l.Ra(a)?l.Rx(a,b):null};a.Rv=function(a,b){return l.Rv(a,b)};a.UR=function(a){return a.f.Rf};a.hB=function(a,b,h){y.Jh(a)?(b=Math.min(Math.max(b,0),1),a.f.Rf!=
b&&l.hB(a,b,h||0)):c.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,t){function l(a,b){var e=a.F[b];e&&e.sr&&e.gl&&(e.gl=!1,e.sr(a,b))}function c(a,b,e){e=a.F[e];e.type=30;var k=b.J,d=b.aa-k+1;e.start=k;e.length=d;e.ed=k;e.hh=b.name;for(d=k=0;d<a.cc.length;d++){var f=a.cc[d];if(f==b)break;else k+=f.aa-f.J+1}e.uC=k}function b(a,b,e){for(var k=a.ba,d=0;d<k.length;d++)for(var f=k[d].W,g=0;g<f.length;g++){var c=f[g].ua;if(c&&c.name==b){var m=a.F[e];m.type=50;m.hh=c.name;m.start=c.J;m.length=c.aa-m.start;c.Hb||(m.length+=c.ps)}}}function y(a){return a.replace(/_B4W_BAKED$/,
"")}function h(a,b){if(a.animation_data){var e=a.animation_data.action;e&&e.k.type==X&&b.push(e)}for(var e=a.nodes,k=0;k<e.length;k++){var d=e[k];d.node_group&&(d=d.node_group.node_tree)&&h(d,b)}}function r(a){return Q.Lc(a)&&a.f.cc?!0:!1}function x(a,b,e){var k=a.F;if(-1==e)for(e=0;8>e;e++){var d=k[e];d&&(d.ed=b,g(a,0,e,!0))}else if(d=k[e])d.ed=b,g(a,0,e,!0)}function v(a,b,e){if(-1==b)for(b=0;8>b;b++){var k=a[b];k&&e(k)}else(k=a[b])&&e(k)}function g(a,b,e,k){D(a,b,e,k);l(a,e);a.f.eh&&(B(a,b),C(a,
b))}function p(a,b,e){var k=b.frame_range;if(k[0]>k[1])return ba.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1;var d=b.k,g=a.F[e];g.hh=b.name;g.Vp=k;g.Gv=d.gA;g.Fv=d.ew;g.Ik.set(d.Ik);g.start=k[0];g.length=k[1]-k[0];g.ed=k[0];switch(d.type){case oa:if(Q.Jh(a)){g.type=10;var c=f(a,b);if(!c){for(var c=a.f.Dd,k=[],h=[],u=b.k.Ls,l=0;l<u;l++){for(var n in c){var z=c[n],p=z.tp,G=b.k.pq[n];G?ka.copy(G.subarray(8*l,8*l+8),p):ka.identity(p);z.up=!1}z=q(c);k.push(z.i);
h.push(z.pa)}c={i:k,pa:h};a.Ci.push(b,c)}g.i=c.i;g.pa=c.pa;g=c;n=a.f;c=n.ip;h=a.F[e];k=h.Kt;a:{u=n.yB;for(l=0;l<u.length;l+=2)if(b==u[l]){u=u[l+1];break a}u=null}if(u)h.Kt=u;else{for(h=0;h<c.length;h++){for(var u=c[h].Ki,l=[],z=[],p=g.i,G=g.pa,w=0;w<p.length;w++){var K=m(p[w],G[w],u);l.push(K.i);z.push(K.pa)}k.push({i:l,pa:z})}n.yB.push(b,k)}n.eh&&(b=n.xp,e>b[1]?(g=b[1],b[1]=e,b[0]=g):e>b[0]&&e<b[1]&&(b[0]=e),A(a))}break;case na:Q.pj(a)&&(g.volume=d.Ta.volume||null,g.pitch=d.Ta.pitch||null,g.type=
40);break;case X:if("MESH"==a.type){g.type=60;n=f(a,b);if(!n){n=[];k=[];h=[];u=[];l=b.k;z=a.f.qo;p=a.f.ro;for(c in l.Ta)G=b.name+"%join%"+c,H(c,G,l,k,n,z),H(c,G,l,u,h,p);n={pN:n,values:k,XK:h,YK:u};a.Ci.push(b,n)}g.Oz=n.pN;g.Qz=n.values;g.Nz=n.XK;g.Pz=n.YK}break;case N:if(n=d.Ta.tsr){g.type=20;c=f(a,b);if(!c){c=b.k.Ls;k=[];h=[];for(u=0;u<c;u++)k.push(n.subarray(8*u,8*u+4)),h.push(n.subarray(8*u+4,8*u+8));c={i:k,pa:h};a.Ci.push(b,c)}g.i=c.i;g.pa=c.pa;aa.Os(a)&&aa.WM(a,g.i[0],g.pa[0])}else return ba.warn('Incompatible action "'+
b.name+'" has been applied to object "'+a.name+'"'),!1}Q.Jh(a)&&d.type!=oa&&F(a,e);return!0}function f(a,b){for(var e=a.Ci,k=0;k<e.length;k+=2)if(b==e[k])return e[k+1];return null}function A(a){var b=a.f.xp;if(-1!=b[0]&&-1!=b[1]){var e=a.F;a=e[b[1]].ed;var k=Math.floor(a),d=a-k,b=e[b[0]];a=b.ed;k=Math.floor(a);b.ed=k+d}}function F(a,b){var e=a.f.xp,k=e[1];e[0]=-1;e[1]=-1;if(-1!=b)for(var d=a.F;0<=k;k--){var f=d[k];if(f&&10==f.type)if(k>e[1])e[1]=k;else{k>e[0]&&(e[1]=k);break}}}function H(a,b,e,k,
d,f){for(var g=0;g<f.length;g+=2)b==f[g]&&(d.push(f[g+1]),k.push(new Float32Array(e.Ta[a])))}function J(a){a=a.k;for(var b in a.Ta)if(-1!=b.indexOf("nodes"))return!0;return!1}function D(a,b,e,k){if((e=a.F[e])&&null!=e.type&&(e.play||k)){var d=a.f,f=e.ed,g=e.start,c=e.length,f=f+e.speed*b*S.Sb(),m=e.type,h=e.speed;if(0<=h&&f>=g+c||0>h&&f<g)switch(k||(e.gl=!0),e.behavior){case 10:f=0<=h?(f-g)%c+g:g+c-1E-6;break;case 20:f=0<=h?g:g+c-1E-6;e.play=!1;break;case 30:f=0<=h?g+c-1E-6:g,e.play=!1}e.ed=f;switch(m){case 10:if(!d.eh){k=
n(e,f,ga);b=k[0];f=k[1];k=k[2];d.Sc=e.pa[b];d.qd=e.pa[f];d.Wc=e.i[b];d.xd=e.i[f];d.Jd=k;k=d.ip;e=e.Kt;for(g=0;g<k.length;g++)c=k[g],m=e[g],c.Sc=m.pa[b],c.qd=m.pa[f],c.Wc=m.i[b],c.xd=m.i[f],c.Jd=d.Jd;da.q(a)}break;case 20:k=n(e,f,ga);var d=V,f=k[0],g=k[1],c=k[2],m=e.i,h=m[f][1],u=m[f][2],q=m[g][1],l=m[g][2];d[0]=(1-c)*m[f][0]+c*m[g][0];d[1]=(1-c)*h+c*q;d[2]=(1-c)*u+c*l;f=Z;u=k[0];g=k[1];c=k[2];m=e.pa;h=W;h[0]=m[u][0];h[1]=m[u][1];h[2]=m[u][2];h[3]=m[u][3];u=ja;u[0]=m[g][0];u[1]=m[g][1];u[2]=m[g][2];
u[3]=m[g][3];T.slerp(h,u,c,f);g=k[2];c=e.i;k=(1-g)*c[k[0]][3]+g*c[k[1]][3];e.iu&&(g=ha,da.de(a,g),ca.Tj(d,g,b,e.iu,d));e.ct&&(g=W,da.eg(a,g),ca.EB(f,g,b,e.ct,f));e=e.Ik;e[0]&&da.ap(a,d);e[1]&&da.Yo(a,f);e[2]&&da.Et(a,k);da.q(a);U.H(a);break;case 30:(a=ga)||(a=Array(3));f-=e.start;0>f&&(f=0);f>=e.length&&(f=e.length);b=Math.floor(f);k=b+1;f-=b;10!=e.behavior&&k==e.length&&(k=--b,f=1);e=e.uC;a[0]=b+e;a[1]=k+e;a[2]=f;k=ga;d.Cu=k[0];d.tC=k[2];break;case 40:k=n(e,f,ga);b=k[0];d=k[1];k=k[2];e.volume&&P.Ht(a,
(1-k)*e.volume[b]+k*e.volume[d]);e.pitch&&P.Tl(a,(1-k)*e.pitch[b]+k*e.pitch[d]);break;case 50:aa.CL(a,e.hh,f/S.Sb());break;case 60:k=n(e,f,ga);b=k[0];d=k[1];k=k[2];m=e.Qz;h=e.Oz;f=e.Pz;e=e.Nz;for(g=0;g<h.length;g++)u=m[g],c=h[g],a.f.yf[c]=(1-k)*u[b]+k*u[d];for(g=0;g<e.length;g++)m=f[g],c=e[g],m=ia.lerp(m.subarray(3*b,3*b+3),m.subarray(3*d,3*d+3),k,V),a.f.ld[c]=m[0],a.f.ld[c+1]=m[1],a.f.ld[c+2]=m[2];break;default:ca.fa("Unknown animation type:"+m)}}}function n(a,b,e){e||(e=Array(3));var k=a.Vp[0],
d=a.Vp[1]-k;b-=k;0>b&&(b=0);b>=d&&(b=d);b/=a.Gv;d=Math.floor(b);a=a.Fv[d]?b-d:0;b=Math.ceil(d+a);e[0]=d;e[1]=b;e[2]=a;return e}function C(a,b){var e=a.f,k=e.Rf,d=e.xp,f=d[0],d=d[1];if(-1!=d){if(-1!=f){var g=a.F[f];if(g.play||0==b){var c=n(g,g.ed,ga),m=c[0],h=c[1];e.Jd=c[2];var c=g.pa[m],u=g.pa[h],m=g.i[m],h=g.i[h]}else k=1}else k=1;d=a.F[d];if(d.play||0==b){var f=n(d,d.ed,ga),q=f[0],l=f[1];e.Jd=f[2]}else if(-1!=f&&g.play)k=0;else return;f=d.pa[q];g=d.pa[l];q=d.i[q];l=d.i[l];if(1==k)e.Sc.set(f),e.qd.set(g),
e.Wc.set(q),e.xd.set(l);else if(0==k)e.Sc.set(c),e.qd.set(u),e.Wc.set(m),e.xd.set(h);else{for(d=0;d<c.length;d+=4){for(var z=Z,p=W,G=0;4>G;G++)z[G]=c[d+G],p[G]=f[d+G];T.slerp(z,p,k,z);for(G=0;4>G;G++)e.Sc[d+G]=z[G];for(G=0;4>G;G++)z[G]=u[d+G],p[G]=g[d+G];T.slerp(z,p,k,z);for(G=0;4>G;G++)e.qd[d+G]=z[G]}ca.gw(m,q,k,e.Wc);ca.gw(h,l,k,e.xd)}da.q(a);fa.UM(a)}}function B(a,b){var e=a.f,k=e.Rf,d=e.$p;if(0!=d){var k=e.Zp-k,f=d*b;ca.sign(k)==ca.sign(d)&&Math.abs(f)<Math.abs(k)?e.Rf+=f:(e.Rf=e.Zp,e.$p=0)}}
function q(a){var b=[],e=[],k=new Float32Array(4),d=new Float32Array(4),f;for(f in a){var g=a[f],c=k,m=d,h=g.jn,u=h[h.length-1],q=u.mu;u.up||ka.identity(q);for(u=h.length-1;0<=u;u--){var l=h[u],n=l.mu;if(l.up)q=n;else{var z=l.Og,p=l.tp;ka.invert(z,L);ka.multiply(p,L,L);ka.multiply(z,L,L);ka.multiply(q,L,n);q=n;l.up=!0}}h=l.mu;c[0]=h[0];c[1]=h[1];c[2]=h[2];c[3]=h[3];m[0]=h[4];m[1]=h[5];m[2]=h[6];m[3]=h[7];T.normalize(m,m);g=g.Tf;for(c=0;4>c;c++)m=4*g+c,b[m]=k[c],e[m]=d[c]}return{i:b,pa:e}}function m(a,
b,e){var k=[],d=[];new Float32Array(4);new Float32Array(4);for(var f in e)for(var g=e[f],c=g.Tf,g=g.cr,m=0;4>m;m++){var h=4*g+m,u=4*c+m;k[h]=a[u];d[h]=b[u]}k=new Float32Array(k);d=new Float32Array(d);return{i:k,pa:d}}function w(a){var b=a.k;b.type=b.pq?oa:b.Ta?"volume"in b.Ta||"pitch"in b.Ta?na:J(a)?X:N:sa}function J(a){if(a=a.k.Ta)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function d(a,b){b[0]=b[1]=b[2]=0;for(var e in a)"location"==e?b[0]=1:"rotation_quaternion"==e?b[1]=1:"scale"==
e&&(b[2]=1)}function I(a,b,e,k,d,f,g){var c=a+(b-a)/2,m=u(c,k,d,f,g)-e;return.02>Math.abs(m)?c:0<m?I(a,c,e,k,d,f,g):I(c,b,e,k,d,f,g)}function u(a,b,e,k,d){var f=1-a;return b*f*f*f+3*e*f*f*a+3*k*f*a*a+d*a*a*a}function E(a,b){var e={type:null,hh:null,Vp:null,Gv:0,Fv:null,Ik:new Int8Array(3),pa:null,i:null,Kt:[],play:!1,behavior:20,ed:0,start:0,length:0,iu:0,ct:0,gl:!1,uC:null,speed:1,volume:null,pitch:null,Qz:[],Oz:[],Pz:[],Nz:[]};if(!a.F.length)for(var k=0;8>k;k++)a.F.push(null);a.F[b]=e;-1==ta.indexOf(a)&&
ta.push(a)}function z(a,b){da.q(a);U.H(a);g(a,0,b,!0)}function G(a,k,d){d=d||0;if(Q.Lc(a)){var f=e(a,k);if(f)return E(a,d),c(a,f,d),z(a,d),!0;if((f=K(a,k))&&"EMITTER"==f.Qs)return E(a,d),b(a,f.name,d),z(a,d),!0}if(f=ca.Ub("name",k,la)||ca.Ub("name",k+"_B4W_BAKED",la)){E(a,d);if(p(a,f,d))return z(a,d),!0;a.F[d]=null}ba.error('Unsupported object: "'+a.name+'" or animation name: "'+k+'"');return!1}function e(a,b){for(var e=0;e<a.cc.length;e++){var k=a.cc[e];if(k.name===b)return k}return null}function K(a,
b){for(var e=a.ba,k=0;k<e.length;k++)for(var d=e[k].W,f=0;f<d.length;f++){var g=d[f].ua;if(g&&g.name===b)return g}return null}function k(a){a=a.modifiers;for(var b=0;b<a.length;b++){var e=a[b];if("ARMATURE"==e.type)return e.object}return null}var M=t("__config"),Q=t("__obj_util"),aa=t("__particles"),U=t("__physics"),ba=t("__print"),T=t("__quat"),ea=t("__reformer"),P=t("__sfx"),S=t("__time"),da=t("__transform"),ka=t("__tsr"),ca=t("__util"),ia=t("__vec3"),fa=t("__armature"),R=M.gh,ra=M.r;a.sD=1E-6;
a.iv=0;a.gv=10;a.jv=20;a.mv=30;a.lv=40;a.kv=50;a.hv=60;a.kb=0;a.sv=1;a.tv=2;a.uv=3;a.vv=4;a.wv=5;a.xv=6;a.Qp=7;a.Gm=-1;a.Gp=10;a.Hp=20;a.vm=30;var sa=a.HN=0,oa=a.OC=1,na=a.IN=2,N=a.PC=3,X=a.Su=4,ga=Array(3),V=new Float32Array(3),ha=new Float32Array(3),Z=new Float32Array(4),W=new Float32Array(4),ja=new Float32Array(4),L=new Float32Array(8);new Float32Array(16);var ta=[],la=[];a.py=function(){return ca.trunc((ra.Hz-50)/4)};a.Fx=function(a){return a/S.Sb()};a.update=function(a){for(var b=0;b<ta.length;b++){for(var e=
ta[b],k=0;8>k;k++)D(e,a,k);e.f.eh&&(B(e,a),C(e,a))}for(b=0;b<ta.length;b++)for(e=ta[b],k=0;8>k&&e.F.length;k++)l(e,k)};a.Ox=function(){return la};a.Qx=function(a){var b=[];if(r(a))for(var e=0;e<a.cc.length;e++)b.push(a.cc[e].name);for(var k=[],e=0;e<la.length;e++){var d=la[e],f=d.k;f.type==N?k.push(d):f.type==oa&&"ARMATURE"==a.type?k.push(d):f.type==na&&"SPEAKER"==a.type&&k.push(d)}if("MESH"==a.type)for(e=0;e<a.Sd.length;e++)d=a.Sd[e],d.k.type==X&&k.push(d);for(e=0;e<k.length;e++)b.push(y(k[e].name));
if(aa.Os(a)&&aa.Ns(a))for(a=a.ba,e=0;e<a.length;e++)for(k=a[e].W,d=0;d<k.length;d++)(f=k[d].ua)&&b.push(f.name);return b};a.fM=y;a.Rx=function(a,b){var e=a.F[b];return e?e.type:0};a.Xm=function(a){for(var e=0,k=a.ba,d=0;d<k.length;d++)for(var f=k[d].W,g=0;g<f.length;g++){var m=f[g].ua;m&&"EMITTER"==m.Qs&&(E(a,e),b(a,m.name,e),z(a,e),a.F[e].behavior=a.Rm,m.Hb&&(a.F[e].behavior=10),e++)}k=a.Sd.slice();for(d=0;d<k.length;d++)f=k[d],E(a,e),p(a,f,e)?(z(a,e),a.F[e].behavior=a.Rm,e++):a.F[e]=null;r(a)&&
(E(a,e),c(a,a.cc[0],e),z(a,e),a.F[e].behavior=a.Rm)};a.xE=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ca.fa("Wrong animation behavior")}};a.aI=function(a){var b=[];a=a.data.materials;for(var e=0;e<a.length;e++){var k=a[e].node_tree;k&&h(k,b)}return b};a.play=function(a,b,e){v(a.F,e,function(a){a.play=!0;a.sr=b?b:null;a.gl=!1});a.f.eh&&A(a)};a.stop=function(a,b){v(a.F,b,function(a){a.play=!1;a.sr=null;a.gl=!1})};a.Lh=function(a,b){var e=
a.F;if(-1==b)for(var k=0;8>k;k++){if(e[k]&&e[k].play)return!0}else if(e=e[b])return e.play;return!1};a.li=x;a.At=function(a,b){b=b||0;v(a.F,b,function(e){x(a,e.start,b)})};a.Gr=function(a,b){var e=a.F[b];return e&&e.ed?e.ed:0};a.mj=function(a,b){var e=a.F[b];return e&&10==e.behavior};a.dm=function(a,b,e){v(a.F,e,function(a){a.behavior=b})};a.Tx=function(a,b){var e=a.F[b];return e&&e.behavior};a.Qv=function(a,b,e,k){v(a.F,k,function(a){a.iu=b||0;a.ct=e||0})};a.EA=function(a,b){if(-1==b)for(var e=0;8>
e;e++)a.F[e]=null;else a.F[b]=null;a.f.eh&&F(a,b)};a.vu=g;a.Yz=function(a){if("ARMATURE"==a.type||a.Ym)return!0;for(var b=0;b<a.Sd.length;b++){var e=a.Sd[b].k.type;if(e==N||e==oa||e==na&&"SPEAKER"==a.type||e==X&&"MESH"==a.type)return!0}return aa.Os(a)&&aa.Ns(a)||"MESH"==a.type&&a.cc.length?!0:!1};a.kw=function(a,b){if("ARMATURE"==b.type||k(a))return!0;for(var e=0;e<b.Sd.length;e++){var d=b.Sd[e].k.type;if(d==N||d==oa||d==na&&"SPEAKER"==b.type||d==X&&"MESH"==b.type)return!0}return aa.sF(a)&&aa.rF(a)||
"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.Ra=function(a){return Boolean(a.F.length)};a.wF=q;a.wH=m;a.zE=function(a){function b(a,e){for(var k=0;k<e;k++){var d=a.subarray(8*k+4,8*k+8);T.normalize(d,d)}}function e(a,b){if(-1<a.indexOf("location"))var k=0,d=b;else-1<a.indexOf("rotation_quaternion")?(k=4,d=0==b?3:b-1):-1<a.indexOf("scale")?(k=3,d=0):(k=0,d=b);return k+d}function k(a,b,e,d,c){if(-1<e.search(f)){a=b;e=e.split('"')[1];var m=g}else 8==c?(e="tsr",m=g):m=1<c?new Float32Array(c):
0;if(!a[e]){c=a;b=e;if("object"==typeof m&&m.length)for(var h=m.length,O=new Float32Array(d*h),u=0;u<d;u++)for(var l=0;l<h;l++)O[u*h+l]=m[l];else if("number"==typeof m)for(O=new Float32Array(d),u=0;u<d;u++)O[u]=m;else ca.fa("Wrong storage default value");c[b]=O}return a[e]}var f=new RegExp(/pose.bones\[\".+\"\]/g),g=ka.create(),c=a.k={type:sa,Ls:0,gA:0,Ta:null,pq:null,ew:null,Ik:new Int8Array(3)};c.gA=1/R.Ch;var m=a.fcurves,h={},u={},l=0,q;for(q in m){var n=m[q],z;for(z in n){var p=n[z],G=p.bd;ea.GF(p,
a);p=p.num_channels;l||(l=G.length);for(var p=k(h,u,q,l,p),K=p.length/l,A=e(q,z|0),E=0;E<l;E++)p[E*K+A]=G[E]}}if(ca.rl(h)){for(var M in h)"tsr"==M&&b(h[M],l);c.Ta=h}if(ca.rl(u)){for(var F in u)b(u[F],l);c.pq=u}c.Ls=l;c.ew=a.qE;"tsr"in h&&d(m,c.Ik);w(a);la.push(a)};a.ZH=function(a,b){return(b-a)*R.Ch+1};a.YE=function(a,b,e,k,d,f){var g,c,m=new Float32Array(2),h=new Float32Array(2),l=new Float32Array(2),q=new Float32Array(2),n=b[1],z=b[2],p=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var G=
0,w=0,K=null;d<=f;d++)if(d<n)for(var E=0;E<R.Ch;E++)e[G++]=z;else if(d>p)for(E=0;E<R.Ch;E++)e[G++]=a;else{var A=b[w],M=3;0===A&&(M+=2);0===K&&(M+=2);var F=2===A?0:1;if(b[w+1]==b[w+M+1])K=A,w+=M;else{E=0;d==b[w+1]&&(F&&(k[G]=1),e[G]=b[w+2],G++,E++);if(d==p)for(;E<R.Ch;E++)e[G++]=a;else for(m[0]=b[w+1],m[1]=b[w+2],0!==A?(h[0]=0,h[1]=0):0===K?(h[0]=b[w+5],h[1]=b[w+6]):(h[0]=b[w+3],h[1]=b[w+4]),0!==A?(l[0]=0,l[1]=0):(l[0]=b[w+M+3],l[1]=b[w+M+4]),q[0]=b[w+M+1],q[1]=b[w+M+2];E<R.Ch;E++){var r=d+E/R.Ch;
switch(A){case 0:g=m;c=h;var ra=l,ja=q,C=[],Q=[],B=void 0,x=void 0,y=void 0,B=void 0;C[0]=g[0]-c[0];C[1]=g[1]-c[1];Q[0]=ja[0]-ra[0];Q[1]=ja[1]-ra[1];y=ja[0]-g[0];B=Math.abs(C[0]);x=Math.abs(Q[0]);0!=B+x&&B+x>y&&(B=y/(B+x),c[0]=g[0]-B*C[0],c[1]=g[1]-B*C[1],ra[0]=ja[0]-B*Q[0],ra[1]=ja[1]-B*Q[1]);F&&(k[G]=1);e[G]=u(I(0,1,r,m[0],h[0],l[0],q[0]),m[1],h[1],l[1],q[1]);G++;break;case 1:c=m[0];ra=m[1];g=ja=(q[1]-ra)/(q[0]-c);c=ra-ja*c;F&&(k[G]=1);e[G]=g*r+c;G++;break;case 2:F&&(k[G]=1);e[G]=b[w+2];G++;break;
default:ca.fa("Unknown keyframe intepolation mode: "+A)}}d+1==b[w+M+1]&&(K=A,w+=M)}}};a.apply=G;a.SE=function(a,b,e){e=e||0;var k=ca.Ub("uuid",b,la);if(k){E(a,e);if(p(a,k,e)){z(a,e);return}a.F[e]=null}ba.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.qN=function(a,b){var k=ca.Ub("name",b,la)||ca.Ub("name",b+"_B4W_BAKED",la);if(k){if(k.k.type==sa)return!1}else if(!(K(a,b)||Q.Lc(a)&&e(a,b)))return!1;return!0};a.Mr=function(a,b){for(var e=a.F,k=0;k<e.length;k++){var d=e[k];if(d&&
y(d.hh)==y(b))return k}return-1};a.XH=function(a,b){var e=a.F[b];return e&&e.hh?y(e.hh):null};a.remove=function(a){a.F.length=0;a=ta.indexOf(a);-1!=a&&ta.splice(a,1)};a.LK=function(a){for(var b=la.length-1;0<=b;b--)la[b].rE==a&&la.splice(b,1)};a.Rv=function(a,b){if(!a.F.length)return G(a,b,0)?0:-1;for(var e=0;e<a.F.length;e++)if(!a.F[e])return G(a,b,e)?e:-1};a.hB=function(a,b,e){a.f.$p=(b-a.f.Rf)/e;a.f.Zp=b};a.jB=function(a,b,e){v(a.F,e,function(a){a.speed=b})};a.Fy=function(a,b){return a.F[b].speed};
a.Dr=function(a,b){return a.F[b].start};a.Cr=function(a,b){return a.F[b].length};a.Y=function(){ta.length=0;la.length=0};a.zH=function(a){var b=(a[0]||a[1]||a[2]).bd.length,e=Z,k=V,d=Boolean(a[0]);d||(a[0]={bd:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={bd:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={bd:new Float32Array(b),num_channels:8});a[3]={bd:new Float32Array(b),num_channels:8};for(var c=0;c<b;c++)k[0]=d?a[0].bd[c]:0,k[1]=f?a[1].bd[c]:0,k[2]=g?a[2].bd[c]:
0,ca.bg(k,e),a[0].bd[c]=e[3],a[1].bd[c]=e[0],a[2].bd[c]=e[1],a[3].bd[c]=e[2]};a.Vx=k};b4w.module.__config=function(a,t){function l(){return b4w.module_check(a.Ac.fn)}function c(){for(var c=a.Ac,l=null,x=document.getElementsByTagName("script"),y=0;y<x.length;y++){for(var g=x[y].src,p=0;p<c.tz.length;p++)if(0<=g.indexOf(c.tz[p])){l=g;break}if(null!==l)break}l||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),l=document.location.href);c=l.indexOf("?");0<=c&&(l=l.substring(0,c));return l.substring(0,l.lastIndexOf("/")+1)}var b=t("__print"),
y=t("__util");a.Zg=1;a.Yg=2;a.zi=3;a.qv=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.hG=y.ra(a.context);a.r={alpha_sort:!0,alpha_sort_threshold:.1,Yp:!1,Th:[5,6],fe:1E4,console_verbose:!1,do_not_load_resources:!1,Ap:!1,Ex:1.5,CH:10,background_color:[0,0,0,0],Ph:.01,render_resolution_factor:1,canvas_resolution_factor:1,op:3,allow_cors:!1,ur:!1,Sm:!0,show_hud_debug_info:!1,DQ:!0,Qj:!0,anaglyph_use:!1,Xl:!0,Dc:!0,Re:!0,Vi:!0,hj:!0,dn:!0,Uh:!0,Oi:!0,antialiasing:!0,smaa:!1,wireframe_debug:!1,
IC:!1,hl:!0,Ol:!0,Rb:!0,Io:!0,water_dynamic:!0,Cg:!0,ep:!0,kc:1024,tj:512,oC:!0,precision:"highp",quality:a.Yg,Xp:!0,eK:!1,sB:!1,nx:!1,yC:!1,kg:!1,gr:!1,Nw:!1,ez:!1,Cq:!1,qU:!1,cm:!1,allow_hidpi:!1,gyro_use:!1,Bx:!1,Ds:!1,enable_selectable:!0,enable_outlining:!0,sf:!0,Hz:128,Zr:!1,gz:!1,MJ:!1,vs:[0,0],cl:!1,rA:!0};a.YG=y.ra(a.r);a.gh={Mn:-1,Gx:!1,Ch:1};a.controls={bK:1/120};a.ye={dir:"ASSETS=../../assets/",XJ:15,Ys:!0,Bs:!1,ar:!1};a.aF=y.ra(a.ye);a.Ac={shaders_dir:"",LL:"include/",nU:"postprocessing/",
fn:"built_in_data",tz:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js webplayer.min.js".split(" "),IA:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.m={enabled:!0,fe:60,mm:"",uq:!1,ping:!1,qm:!0};a.qK=y.ra(a.m);a.Mj={Vn:1024,xn:384,cx:32,RG:128,QG:256,hA:.25,xK:.5,wK:1};a.fL=y.ra(a.Mj);a.A={Ku:!0,uo:!1,Zv:!1,Bw:!1,ox:!1};a.KL=y.ra(a.A);a.Db={outlining_overview_mode:!1,Af:[1,.4,.05],Fj:.2,Gj:3.8,Hj:1};a.br={enabled:!1,lM:"MAIN_OPAQUE",kM:0,OL:"DEPTH"};
a.TG=y.ra(a.br);a.WE=function(){var b=a.r,c=a.m,l=a.Mj;switch(b.quality){case a.zi:b.Qj=!0;b.Cg=!0;b.Re=!0;b.Vi=!0;b.hj=!0;b.dn=!0;b.Xl=!0;b.Dc=!0;b.hl=!0;b.Ol=!0;b.Rb=!0;b.Io=!0;b.render_resolution_factor=1.75;l.Vn=2048;b.op=3;b.Sm=!0;b.Ap=!1;b.precision="highp";b.water_dynamic=!0;b.ep=!0;b.antialiasing=!0;b.smaa=!0;b.Oi=!0;b.Uh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.sf=!0;c.fe=120;break;case a.Yg:b.Qj=!0;b.Cg=!0;b.Re=!0;b.Vi=!0;b.hj=!0;b.dn=!0;b.Xl=!0;b.Dc=!0;b.hl=!0;b.Ol=!0;b.Rb=!0;b.Io=!0;
b.render_resolution_factor=1;l.Vn=1024;b.op=3;b.Sm=!0;b.Ap=!1;b.precision="highp";b.water_dynamic=!0;b.ep=!0;b.antialiasing=!0;b.smaa=!1;b.Oi=!0;b.Uh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.sf=!0;c.fe=60;break;case a.Zg:b.Qj=!1,b.Cg=!1,b.Re=!1,b.Vi=!1,b.hj=!1,b.dn=!1,b.Xl=!1,b.Dc=!1,b.hl=!1,b.Ol=!1,b.Rb=!1,b.Io=!1,b.render_resolution_factor=1,l.Vn=512,b.op=2,b.Sm=!1,b.Ap=!0,b.precision="mediump",b.water_dynamic=!1,b.ep=!1,b.antialiasing=!1,b.smaa=!1,b.Oi=!1,b.Uh=!1,b.allow_hidpi=!1,b.enable_outlining=
!1,b.sf=!1,c.fe=60}};a.set=function(c,l){switch(c){case "allow_cors":a.r.allow_cors=l;break;case "allow_hidpi":a.r.allow_hidpi=l;break;case "alpha":a.context.alpha=l;break;case "alpha_sort":a.r.alpha_sort=l;break;case "alpha_sort_threshold":a.r.alpha_sort_threshold=l;break;case "anaglyph_use":a.r.anaglyph_use=l;break;case "animation_framerate":a.gh.Mn=l;break;case "antialiasing":a.r.antialiasing=l;break;case "assets_dds_available":a.ye.ar=l;break;case "assets_min50_available":a.ye.Bs=l;break;case "audio":a.A.Ku=
l;break;case "background_color":a.r.background_color=l;break;case "built_in_module_name":a.Ac.fn=l;break;case "canvas_resolution_factor":a.r.canvas_resolution_factor=l;break;case "console_verbose":a.r.console_verbose=l;break;case "do_not_load_resources":a.r.do_not_load_resources=l;break;case "gyro_use":a.r.gyro_use=l;break;case "physics_enabled":a.m.enabled=l;break;case "physics_uranium_path":a.m.mm=l;break;case "physics_calc_fps":a.m.uq=l;break;case "physics_use_workers":a.m.qm=l;break;case "precision":a.r.precision=
l;break;case "quality":a.r.quality=l;break;case "render_resolution_factor":a.r.render_resolution_factor=l;break;case "sfx_mix_mode":a.A.uo=l;break;case "shaders_dir":a.Ac.shaders_dir=l;break;case "show_hud_debug_info":a.r.show_hud_debug_info=l;break;case "smaa":a.r.smaa=l;break;case "smaa_search_texture_path":a.Ac.smaa_search_texture_path=l;break;case "smaa_area_texture_path":a.Ac.smaa_area_texture_path=l;break;case "wireframe_debug":a.r.wireframe_debug=l;break;case "enable_selectable":a.r.enable_selectable=
l;break;case "enable_outlining":a.r.enable_outlining=l;break;case "outlining_overview_mode":a.Db.outlining_overview_mode=l;break;case "glow_materials":a.r.sf=l;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.r.allow_cors;case "allow_hidpi":return a.r.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.r.alpha_sort;case "alpha_sort_threshold":return a.r.alpha_sort_threshold;case "anaglyph_use":return a.r.anaglyph_use;
case "animation_framerate":return a.gh.Mn;case "antialiasing":return a.r.antialiasing;case "assets_dds_available":return a.ye.ar;case "assets_min50_available":return a.ye.Bs;case "audio":return a.A.Ku;case "background_color":return a.r.background_color;case "built_in_module_name":return a.Ac.fn;case "canvas_resolution_factor":return a.r.canvas_resolution_factor;case "console_verbose":return a.r.console_verbose;case "do_not_load_resources":return a.r.do_not_load_resources;case "gyro_use":return a.r.gyro_use;
case "physics_enabled":return a.m.enabled;case "physics_uranium_path":return a.m.mm;case "physics_calc_fps":return a.m.uq;case "physics_use_workers":return a.m.qm;case "precision":return a.r.precision;case "quality":return a.r.quality;case "render_resolution_factor":return a.r.render_resolution_factor;case "sfx_mix_mode":return a.A.uo;case "shaders_dir":return a.Ac.shaders_dir;case "show_hud_debug_info":return a.r.show_hud_debug_info;case "smaa":return a.r.smaa;case "smaa_search_texture_path":return a.Ac.smaa_search_texture_path;
case "smaa_area_texture_path":return a.Ac.smaa_area_texture_path;case "wireframe_debug":return a.r.wireframe_debug;case "enable_selectable":return a.r.enable_selectable;case "enable_outlining":return a.r.enable_outlining;case "outlining_overview_mode":return a.Db.outlining_overview_mode;case "glow_materials":return a.r.sf;default:b.error("Unknown config property: "+c)}};a.reset=function(){a.context=y.ra(a.hG);a.r=y.ra(a.YG);a.ye=y.ra(a.aF);a.m=y.ra(a.qK);a.Mj=y.ra(a.fL);a.A=y.ra(a.KL);a.br=y.ra(a.TG)};
a.bJ=l;a.yL=function(){var b=a.Ac,r=a.m;l()||""!=b.shaders_dir||(b.shaders_dir=c()+"../shaders/");if(l())b.smaa_search_texture_path="smaa_search_texture.png",b.smaa_area_texture_path="smaa_area_texture.png";else if(""==b.smaa_search_texture_path||""==b.smaa_area_texture_path){var y=c()+b.IA;b.smaa_search_texture_path=b.smaa_search_texture_path||y+"smaa_search_texture.png";b.smaa_area_texture_path=b.smaa_area_texture_path||y+"smaa_area_texture.png"}r.enabled&&""==r.mm&&(y=c()+b.IA,r.mm=y+"uranium.js")};
a.Hy=function(){return a.ye.dir.replace("ASSETS=","")}};b4w.module.__print=function(a){function t(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var l=1;l<a.length;l++)c.push(a[l]);return c}var l=!1,c=0,b=0;a.EL=function(a){l=a};a.ws=function(){console.log.apply(console,arguments)};a.log=function(){if(l){var a=t(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){c++;var a=t(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){b++;var a=t(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=t(arguments,"B4W INFO");console.info.apply(console,a)};a.rH=function(){c++;var a=t(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.sH=function(){b++;var a=t(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){l&&console.time.apply(console,arguments)};a.timeEnd=function(){l&&console.timeEnd.apply(console,arguments)};a.group=function(){l&&console.group.apply(console,arguments)};a.groupCollapsed=function(){l&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){l&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.GI=function(){return b};a.jI=function(){return c};a.Ew=function(){c=b=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,t){function l(a){return 0<a?1:0>a?-1:0}function c(a){var b=a[0],e=a[1],k=a[2],d=a[3],f=Math.sqrt(b*b+e*e+k*k),f=1/f;a[0]=b*f;a[1]=e*f;a[2]=k*f;a[3]=d*f}function b(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}function y(a,b){var e=b;switch(typeof a){case "number":return h(a,e);case "string":return r(a,e);case "boolean":return h(a|0,e);case "function":case "undefined":return h(0,e);case "object":if(a){var k=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==
a.byteLength)for(k=0;k<a.length;k++)e=h(a[k],e);else if(k)for(k=0;k<a.length;k++)e=y(a[k],e);else for(var d in a)e=y(a[d],e)}else e=h(0,e)}return e}function h(a,b){var e=b;M[0]=a;e=(e<<5)-e+Q[0];e&=e;e=(e<<5)-e+Q[1];return e&e}function r(a,b){for(var e=b,k=0;k<a.length;k++)e=(e<<5)-e+a.charCodeAt(k),e&=e;return e}function x(a){return(34*a+1)*a%289}function v(a){return a-Math.floor(a)}function g(a){return p((34*a+5)*a)}function p(a){return a-289*Math.floor(a/289)}function f(a){return a-7*Math.floor(a/
7)}function A(a,b,e){a-=b;e-=b;return b+(a-Math.floor(a/e)*e)}function F(a){return A(a,0,2*Math.PI)}function H(a,b){if(a&&b){var e=a instanceof Array,k=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,d=b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength;if(e!=b instanceof Array||k!=d)return!1;if(e){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(!J(a[e],b[e]))return!1}else if(k){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(a[e]!=b[e])return!1}else{for(var f in a)if(!J(a[f],
b[f]))return!1;for(f in b)if(!(f in a))return!1}return!0}return!(a||b)}function J(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return H(a,b);default:return!0}}function D(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var e=[],k=0;k<a.length;k++){var d=a[k];""!=d&&"."!=d&&(".."!=d||!b&&!e.length||e.length&&".."==e[e.length-1]?e.push(d):e.length&&e.pop())}a=
e.join("/");for(k=0;k<b;k++)a="/"+a;return a||"."}var n=t("__mat3"),C=t("__mat4"),B=t("__print"),q=t("__quat"),m=t("__vec3"),w=t("__vec4"),d=0,I={},u=new Float32Array(3),E=new Float32Array(3),z=new Float32Array(4),G=new Float32Array(4),e=new Float32Array(9),K=new Float32Array(16),k=new Float32Array(16),M=new Float64Array(1),Q=new Uint32Array(M.buffer),aa=new Float32Array([0,0,0]),U=new Float32Array([0,0,0,1]),ba=new Float32Array([0,0,0,1,0,0,0,1]),T=new Float32Array([1,1,1]),ea=new Float32Array([1,
0,0]),P=new Float32Array([0,1,0]),S=new Float32Array([0,0,1]),da=new Float32Array([-1,0,0]),ka=new Float32Array([0,-1,0]),ca=new Float32Array([0,0,-1]),ia=Math.floor(44488.07041494893),fa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,
0,0,0,1])];a.yv=aa;a.rv=U;a.hP=ba;a.zv=T;a.$e=ea;a.jb=P;a.se=S;a.Kp=da;a.dc=ka;a.Xg=ca;a.TC=fa;a.uz=function(a,b,e){for(var k=[],d=e.length,f=0;f<d;f++){var c=e[f];c[a]==b&&k.push(c)}return k};a.BH=function(a,b){var e=a.length,k=new Float32Array(e+b.length);k.set(a);k.set(b,e);return k};a.wM=function(a,b){var e=a.length,k=new Uint32Array(e+b.length);k.set(a);k.set(b,e);return k};a.OF=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.ZE=function(a,b){var e=
[],k={},d=b.length,f,c;for(f=0;f<d;f++)k[b[f]]=!0;d=a.length;for(f=0;f<d;f++)c=a[f],c in k&&e.push(c);return e};a.sign=l;a.GS=function(a,b,e){for(var k=e.length,d=0;d<k;d++)if(e[d][a]==b)return!0;return!1};a.Ub=function(a,b,e){for(var k=0;k<e.length;k++){var d=e[k];if(d[a]===b)return d}return null};a.FS=function(a,b,e,k,d){for(var f=0;f<d.length;f++){var c=d[f];if(c[a]==b&&c[e]==k)return c}return null};a.rI=function(a,b){for(var e=0;e<a.length;e++)if(a[e].uuid==b)return e;return-1};a.RE=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]==b)return;a.push(b)};a.gQ=function(a){for(var b=0;b<a.length-1;b++)for(var e=a[b],k=b+1;k<a.length;k++)if(e==a[k])return!1;return!0};a.sM=function(a,b,e,k){k||(k=new Float32Array(16));C.identity(k);k[12]=a;k[13]=b;k[14]=e};var R=1;a.IK=function(){R=(69069*R+5)%Math.pow(2,32);return Math.round(R/65536)%32768/32767};a.cM=function(a){R=a};a.Pd=function(a){var b=a[0]%ia*48271-3399*Math.floor(a[0]/ia);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.bo=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.bg=function(a,b){b||(b=new Float32Array(4));var e=Math.cos(a[1]/2),k=Math.cos(a[2]/2),d=Math.cos(a[0]/2),f=Math.sin(a[1]/2),c=Math.sin(a[2]/2),g=Math.sin(a[0]/2);b[0]=f*c*d+e*k*g;b[1]=f*k*d+e*c*g;b[2]=e*c*d-f*k*g;b[3]=e*k*d-f*c*g;return b};a.oH=function(a){var b=n.create(),e=Math.cos(a[0]),k=Math.cos(a[1]),d=Math.cos(a[2]),f=Math.sin(a[0]),c=Math.sin(a[1]);a=Math.sin(a[2]);var g=e*d,m=e*a,l=f*d,u=f*a;b[0]=k*d;b[1]=k*a;b[2]=-c;b[3]=c*l-m;b[4]=c*u+g;b[5]=
k*f;b[6]=c*g+u;b[7]=c*m-l;b[8]=k*e;return b};a.uA=function(a,b){var e=a[0],k=a[1],d=a[2],f=a[3],c=d*d,g=e*k+d*f;.499999<g?(b[0]=0,b[1]=2*Math.atan2(e,f),b[2]=Math.PI/2):-.499999>g?(b[0]=0,b[1]=-2*Math.atan2(e,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*e*f-2*k*d,1-2*e*e-2*c),b[1]=Math.atan2(2*k*f-2*e*d,1-2*k*k-2*c),b[2]=Math.asin(2*e*k+2*d*f));return b};a.za=function(a,b,e){e||(e=new Float32Array(3));m.transformQuat(b,a,e);return e};a.FQ=function(a,b,e){e||(e=new Float32Array(4));a=m.normalize(a,u);var k=
m.dot(b,a);a=m.cross(b,a,E);k=Math.acos(k);e[0]=a[0]*Math.sin(k/2);e[1]=a[1]*Math.sin(k/2);e[2]=a[2]*Math.sin(k/2);e[3]=Math.cos(k/2);return e};a.tM=function(a,b,e,k){k||(k=new Float32Array(4));m.transformQuat(e,b,k);k[3]=-m.dot(a,k)};a.cH=function(a){var b=a.f.quat;switch(a.type){case "CAMERA":u[0]=0;u[1]=-1;u[2]=0;m.transformQuat(u,b,u);E[0]=0;E[1]=0;E[2]=-1;break;case "MESH":u[0]=0;u[1]=0;u[2]=1;m.transformQuat(u,b,u);E[0]=0;E[1]=0;E[2]=1;break;case "EMPTY":u[0]=0,u[1]=1,u[2]=0,m.transformQuat(u,
b,u),E[0]=0,E[1]=1,E[2]=0}u[1]=0;m.normalize(u,u);a=m.dot(u,E);return Math.acos(a)*(0<-u[0]*E[2]?-1:1)};a.gw=function(a,b,e,k){if(0!=e){k=k||[];for(var d=0;d<a.length;d++)k[d]=(1-e)*a[d]+e*b[d]}};a.HU=function(){d++;return d.toString(16)};a.ik=function(a){I[a]||(I[a]=0);var b=a+I[a];I[a]++;return b};a.Xd=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Gb=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};
return{name:a,R:0,sa:null,B:[],N:b,ga:[]}};a.oh=function(a){return JSON.parse(JSON.stringify(a))};a.ra=function(b){if(!(b instanceof Object))return b;var e;e=b.constructor;switch(e){case Float32Array:case Uint32Array:case Uint16Array:e=new e(b);break;case Array:e=new e(b.length);for(var k=0;k<b.length;k++)e[k]=a.ra(b[k]);break;default:for(k in e=new e,b)e[k]=a.ra(b[k])}return e};a.Kk=function(a){var b=a instanceof Array?[]:{},e;for(e in a)if(a[e]instanceof Object){var k=a[e].constructor;switch(k){case Float32Array:case Uint32Array:case Uint16Array:b[e]=
new k(a[e]);break;case Array:b[e]=a[e].slice(0);break;default:b[e]=a[e]}}else b[e]=a[e];return b};a.ng=function(a,b){b||(b=new Float32Array(4));n.fromMat4(a,e);var k=e[0],d=e[3],f=e[6],c=e[1],g=e[4],m=e[7],l=e[2],u=e[5],h=e[8],k=Math.sqrt(k*k+d*d+f*f)||1,c=Math.sqrt(c*c+g*g+m*m)||1,l=Math.sqrt(l*l+u*u+h*h)||1;e[0]/=k;e[3]/=k;e[6]/=k;e[1]/=c;e[4]/=c;e[7]/=c;e[2]/=l;e[5]/=l;e[8]/=l;q.fromMat3(e,b);return b};a.sj=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.zs=
function(a){z[0]=.577350269189626;z[1]=.577350269189626;z[2]=.577350269189626;z[3]=0;w.transformMat4(z,a,z);return w.length(z)};a.Hn=function(a,b){var e=b.left,k=b.right,d=b.top,f=b.bottom,g=b.rb,m=b.pb;e[0]=a[3]+a[0];e[1]=a[7]+a[4];e[2]=a[11]+a[8];e[3]=a[15]+a[12];k[0]=a[3]-a[0];k[1]=a[7]-a[4];k[2]=a[11]-a[8];k[3]=a[15]-a[12];d[0]=a[3]-a[1];d[1]=a[7]-a[5];d[2]=a[11]-a[9];d[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];g[0]=a[3]+a[2];g[1]=a[7]+a[6];g[2]=a[11]+a[10];
g[3]=a[15]+a[14];m[0]=a[3]-a[2];m[1]=a[7]-a[6];m[2]=a[11]-a[10];m[3]=a[15]-a[14];c(e);c(k);c(d);c(f);c(g);c(m)};a.YL=function(a,e,k){return k<-b(a,e.left)||k<-b(a,e.right)||k<-b(a,e.top)||k<-b(a,e.bottom)||k<-b(a,e.rb)||k<-b(a,e.pb)?!0:!1};a.kH=function(a,e,k,d,f){c=m.dot(k,e.pb);g=m.dot(d,e.pb);l=m.dot(f,e.pb);c=Math.sqrt(c*c+g*g+l*l);if(c<-b(a,e.rb)||c<-b(a,e.pb))return!0;var c=m.dot(k,e.left),g=m.dot(d,e.left),l=m.dot(f,e.left);if(Math.sqrt(c*c+g*g+l*l)<-b(a,e.left))return!0;c=m.dot(k,e.right);
g=m.dot(d,e.right);l=m.dot(f,e.right);if(Math.sqrt(c*c+g*g+l*l)<-b(a,e.right))return!0;c=m.dot(k,e.top);g=m.dot(d,e.top);l=m.dot(f,e.top);if(Math.sqrt(c*c+g*g+l*l)<-b(a,e.top))return!0;c=m.dot(k,e.bottom);g=m.dot(d,e.bottom);l=m.dot(f,e.bottom);return Math.sqrt(c*c+g*g+l*l)<-b(a,e.bottom)?!0:!1};a.wg=function(a,b,e,k){k||(k=0);for(var d=a.length,f=0;f<d;f+=3){var c=a[f],g=a[f+1],m=a[f+2];e[k+f]=b[0]*c+b[4]*g+b[8]*m+b[12];e[k+f+1]=b[1]*c+b[5]*g+b[9]*m+b[13];e[k+f+2]=b[2]*c+b[6]*g+b[10]*m+b[14]}};a.tN=
function(a,b,e){for(var k=0,k=0,d=a.length,f=0;f<d;f+=3){var c=a[f],g=a[f+1],m=a[f+2];e[k+f]=b[0]*c+b[4]*g+b[8]*m;e[k+f+1]=b[1]*c+b[5]*g+b[9]*m;e[k+f+2]=b[2]*c+b[6]*g+b[10]*m}};a.nM=function(a,b,e){for(var k=0,k=0,d=a.length,f=0;f<d;f+=4){var c=a[f],g=a[f+1],m=a[f+2];e[k+f]=b[0]*c+b[4]*g+b[8]*m;e[k+f+1]=b[1]*c+b[5]*g+b[9]*m;e[k+f+2]=b[2]*c+b[6]*g+b[10]*m;e[k+f+3]=a[f+3]}};a.rN=function(a,b,e){e||(e=new Float32Array(3));z[0]=a[0];z[1]=a[1];z[2]=a[2];z[3]=0;w.transformMat4(z,b,z);e[0]=z[0];e[1]=z[1];
e[2]=z[2]};a.ZQ=function(a,b){var e=a.length;if(!e)throw"flatten(): Wrong or empty array";var k=a[0].length;if(!k)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(e*k));for(var d=0;d<e;d++)for(var f=0;f<k;f++)b[d*k+f]=a[d][f];return b};a.sN=function(a){for(var b=[],e=0;e<a.length;e+=3){var k=new Float32Array([a[e],a[e+1],a[e+2]]);b[e/3]=k}return b};a.cn=function(b,e,k,d){if(d<k)return k;var f=k+Math.floor((d-k)/2);return b[f]>e?a.cn(b,e,k,f-1):b[f]<e?a.cn(b,e,f+1,d):f};a.Wf=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]!=b[e])return!1;return!0};a.pQ=function(a,b,e){for(var k=0;k<a.length;k++)if(Math.abs(a[k]-b[k])>e)return!1;return!0};a.dL=function(a,b,e){e||(e=new Float32Array(16));for(var k=0;12>k;k++)e[k]=a[k]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15]};a.ju=function(a,b,e,k){k||(k=new Float32Array(16));b=C.fromRotationTranslation(b,e,K);C.multiply(b,a,k)};a.Mg=function(a,b,e,d,f){f||(f=new Float32Array(3));e=C.fromRotationTranslation(e,d,K);1!==b&&(d=C.identity(k),
b=m.set(b,b,b,u),C.scale(d,b,d),C.multiply(e,d,e));m.transformMat4(a,e,f);return f};a.ku=function(a,b,e,k){k||(k=new Float32Array(4));b=C.fromRotationTranslation(b,e,K);w.transformMat4(a,b,k)};a.uS=function(a,b,e,k,d){d||(d=new Float32Array(3));b=C.fromRotationTranslation(e,k,K);C.invert(b,b);m.transformMat4(a,b,d);return d};a.DU=function(a,b,e){e||(e=new Float32Array(16));C.fromRotationTranslation(b,a,e);a=a[3];for(b=0;12>b;b++)e[b]*=a;return e};a.QS=function(b,e,k){a.sj(b,e);e[3]=a.zs(b);a.ng(b,
k)};a.EP=function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e]);return JSON.stringify(b)};a.ZK=function(a,b,e,k){k||(k=new Float32Array(3));m.subtract(b,a,u);m.transformQuat(u,e,u);m.subtract(b,u,k)};a.MH=function(){u[0]=0;u[1]=0;u[2]=0;var a=new Float32Array(16),b=new Float32Array(16),e=new Float32Array(16),k=new Float32Array(16),d=new Float32Array(16),f=new Float32Array(16);C.lookAt(u,[-1,0,0],[0,-1,0],a);C.scale(a,[-1,1,1],a);C.scale(a,[-1,1,-1],b);C.lookAt(u,[0,-1,0],[0,0,-1],e);C.scale(e,[1,
1,-1],e);C.scale(e,[1,-1,-1],k);C.lookAt(u,[0,0,-1],[0,-1,0],d);C.scale(d,[-1,1,1],d);C.scale(d,[-1,1,-1],f);return[a,b,e,k,d,f]};a.QH=function(){u[0]=0;u[1]=0;u[2]=0;var a=new Float32Array(16),b=new Float32Array(16),e=new Float32Array(16),k=new Float32Array(16),d=new Float32Array(16),f=new Float32Array(16);C.lookAt(u,[1,0,0],[0,-1,0],a);C.scale(a,[-1,1,-1],b);C.lookAt(u,[0,1,0],[0,0,1],e);C.scale(e,[1,-1,-1],k);C.lookAt(u,[0,0,1],[0,-1,0],d);C.scale(d,[-1,1,-1],f);return[a,b,e,k,d,f]};a.lw=function(a,
b){return y(a,b)};a.bz=y;a.pS=r;a.PS=function(a,b,e){var k=b[0],d=b[1];b=b[2];var f,c,g,m,l,u,q,h,n,z,O,p;if(!e||a===e)return a[12]=a[0]*k+a[4]*d+a[8]*b+a[12],a[13]=a[1]*k+a[5]*d+a[9]*b+a[13],a[14]=a[2]*k+a[6]*d+a[10]*b+a[14],a[15]=a[3]*k+a[7]*d+a[11]*b+a[15],a;f=a[0];c=a[1];g=a[2];m=a[3];l=a[4];u=a[5];q=a[6];h=a[7];n=a[8];z=a[9];O=a[10];p=a[11];e[0]=f;e[1]=c;e[2]=g;e[3]=m;e[4]=l;e[5]=u;e[6]=q;e[7]=h;e[8]=n;e[9]=z;e[10]=O;e[11]=p;e[12]=f*k+l*d+n*b+a[12];e[13]=c*k+u*d+z*b+a[13];e[14]=g*k+q*d+O*b+a[14];
e[15]=m*k+h*d+p*b+a[15];return e};a.SJ=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.tA=function(a,b){b||(b=a);var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<e?(b[3]=2*Math.acos(a[3]),e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Lo=function(a){return a*Math.PI/180};
a.ZG=function(a){return 180*a/Math.PI};a.Pt=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],e=Math.floor(a[0]+b),k=Math.floor(a[1]+b),d=.211324865405187*e+.211324865405187*k,b=a[0]-e+d;a=a[1]-k+d;var f=b>a?1:0,c=1-f,d=b+.211324865405187-f,g=a+.211324865405187-c,m=b+-.577350269189626,l=a+-.577350269189626,e=e%289,k=k%289,u=x(x(k)+e),c=x(x(k+c)+e+f),q=x(x(k+1)+e+1),e=Math.max(.5-(b*b+a*a),0),k=Math.max(.5-(d*d+g*g),0),f=Math.max(.5-(m*m+l*l),0),h=2*v(.024390243902439*u)-1,n=2*v(.024390243902439*
c)-1,z=2*v(.024390243902439*q)-1,u=Math.abs(h)-.5,c=Math.abs(n)-.5,q=Math.abs(z)-.5,h=h-Math.floor(h+.5),n=n-Math.floor(n+.5),z=z-Math.floor(z+.5),e=e*e*e*e*(1.79284291400159-.85373472095314*(h*h+u*u)),k=k*k*k*k*(1.79284291400159-.85373472095314*(n*n+c*c)),f=f*f*f*f*(1.79284291400159-.85373472095314*(z*z+q*q));return 130*(e*(h*b+u*a)+k*(n*d+c*g)+f*(z*m+q*l))};a.qw=function(a){var b=1/7,e=b/2,k=p(Math.floor(a[0])),d=p(Math.floor(a[1])),c=v(a[0]);a=v(a[1]);var m=c-.5,l=c-1.5,c=a-.5;a-=1.5;var u=g(k),
q=g(k+1),h=u,k=q,u=g(u+d),q=g(q+d),h=g(h+d+1),k=g(k+d+1),d=m+.7*(f(u)*b+e),n=l+.7*(f(q)*b+e),m=m+.7*(f(h)*b+e),l=l+.7*(f(k)*b+e),u=c+.7*(f(Math.floor(u*b))*b+e),c=c+.7*(f(Math.floor(q*b))*b+e),h=a+.7*(f(Math.floor(h*b))*b+e),b=a+.7*(f(Math.floor(k*b))*b+e);return Math.min(d*d+u*u,n*n+c*c,m*m+h*h,l*l+b*b)};a.bt=function(a,b,k,d,f){f||(f=new Float32Array(4));a=m.transformQuat(b,a,u);b=k[0];var c=k[1];k=k[2];e[0]=c*c+k*k;e[1]=-c*b;e[2]=-k*b;e[3]=-b*c;e[4]=b*b+k*k;e[5]=-k*c;e[6]=-b*k;e[7]=-c*k;e[8]=b*
b+c*c;m.transformMat3(a,e,a);m.normalize(a,a);q.rotationTo(d,a,f);return f};a.wq=function(a,b){b||(b=new Float32Array(4));var e=z,k=G,e=q.setAxisAngle([0,1,0],Math.PI,q.create()),k=q.setAxisAngle([1,0,0],Math.PI/2,q.create());q.multiply(e,k,e);q.multiply(a,e,b);return b};a.Y=function(){d=0;I={}};a.da=function(a,b,e){return Math.min(Math.max(a,b),e)};a.sc=function(a,b,e,k){e=Math.exp(-e/k);return(1-e)*a+e*b};a.Tj=function(a,b,e,k,d){d||(d=new Float32Array(a.length));e=Math.exp(-e/k);for(k=0;k<d.length;k++)d[k]=
(1-e)*a[k]+e*b[k];return d};a.EB=function(a,b,e,k,d){d||(d=new Float32Array(a.length));q.slerp(a,b,Math.exp(-e/k),d)};a.vS=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.ee=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.Lq=function(a,b){var k=n.fromQuat(a,e);E[0]=0;E[1]=1;E[2]=0;u[0]=k[3];u[1]=k[4];u[2]=k[5];var d=m.cross(E,u,u);m.normalize(d,d);var f=k[7];!b&&0<f&&(d[0]*=-1,d[1]*=
-1,d[2]*=-1);E[0]=k[0];E[1]=k[1];E[2]=k[2];m.normalize(E,E);q.rotationTo(E,d,G);q.multiply(G,a,a)};a.Sx=function(a,b,e,k){e=e*b-.5;var d=k*b-.5;k=e-Math.floor(e);var f=d-Math.floor(d);e=Math.floor(e);var d=Math.floor(d),c=b-1,g=a[d*b+e],m=a[d*b+Math.min(e+1,c)],l=a[Math.min(d+1,c)*b+e];a=a[Math.min(d+1,c)*b+Math.min(e+1,c)];return(g*(1-k)+m*k)*(1-f)+(l*(1-k)+a*k)*f};a.ii=function(a){for(var b=0,e=0;3>e;e++)0<(a&1<<e)&&b++;return b};a.JA=function(a){for(var b=[0,0,0],e=0;3>e;e++)0<(a&1<<e)&&(b[2-e]=
1);return b};a.am=function(a,b){var e=0;(1==b||2==b)&&0<(a&4)&&e++;2==b&&0<(a&2)&&e++;return e};a.Lx=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.rl=function(a){var b=0,e;for(e in a)a.hasOwnProperty(e)&&b++;return b};a.wA=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.MC=function(a,b,e){e||(e=new Float32Array(3));e[0]=a[0]-b[0];e[1]=0;e[2]=a[2]-b[2];
m.normalize(e,e)};a.uM=function(a,b,e){var k=a[0],d=a[1];a=a[2];var f=b[0],c=b[1],g=b[2];b=b[3];var m=c*a-g*d,l=g*k-f*a,u=f*d-c*k,h=c*u-g*l,g=g*m-f*u,f=f*l-c*m;e[0]=k+2*m*b+2*h;e[1]=d+2*l*b+2*g;e[2]=a+2*u*b+2*f};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.fa=function(a){a&&B.error.apply(B,arguments);throw"panic: see above for possible error messages";};a.cf=A;a.we=F;a.Ir=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.PB=function(a,b){for(var e in a){var k=!0,d=a[e],f=b[e];switch(typeof d){case "number":case "string":case "boolean":k=
d==f;break;case "object":k=H(d,f)}if(!k)return!1}return!0};a.at=function(a,b){var e=a[0],k=a[2],d=a[3];b[0]=a[1];b[1]=k;b[2]=d;b[3]=e};a.Jx=function(a){a+=1;132651<a&&B.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var e=Math.floor(a/51);return new Float32Array([b/51,e/51,a%51/51])};a.ts=function(a,b,e,k,d){z.set(a);z[3]=b;G.set(k);G[3]=0;a=w.dot(z,G);if(0==a)return null;G.set(e);G[3]=1;a=-w.dot(z,G)/a;d[0]=e[0]+a*k[0];d[1]=e[1]+a*k[1];d[2]=e[2]+a*k[2];return d};a.wI=function(a,
b,e,k){var d=b[0]-a[0],f=e[0]-a[0],c=b[1]-a[1],g=e[1]-a[1];b=b[2]-a[2];a=e[2]-a[2];k[0]=c*a-b*g;k[1]=f*b-d*a;k[2]=d*g-c*f;return k};a.sQ=function(a,b){for(var e=0;e<a.length;e++)b[e]=a[e];return b};a.aL=function(a,b,e){var k=m.dot(a,b);-.9999999>k?(m.cross(ea,a,u),1E-6>m.length(u)&&m.cross(P,a,u),m.normalize(u,u),q.setAxisAngle(u,Math.PI,e)):(m.cross(a,b,u),e.set(u),e[3]=1+k,q.normalize(e,e));return e};a.Uf=function(a,b,e){if(b==e)return e-a;a=F(a);b=F(b);e=F(e);var k=Math.abs(b-e);if(.001>k||.001>
Math.abs(k-2*Math.PI))return 0;b=2*Math.PI-b;e=F(e+b);a=F(a+b);return a>e?(e-=a,a=2*Math.PI-a,-e>a?a:e):0};a.Ot=function(a,b,e){isFinite(b)&&isFinite(e)&&(a=clamp(a,b,e));return a*a*(3-2*a)};a.lerp=function(a,b,e){return b+a*(e-b)};a.$E=function(a,b){for(var e=0;e<a.length;e++)for(var k=0;k<b.length;k++)if(b[k]==a[e])return!0;return!1};a.yQ=function(a){for(var b=Array(a),e=0;e<a;e++)b[e]=0;return b};a.xC=function(a,b){for(var e=Math.max(a.length,b.length),k=0;k<e;k++){var d=l((k>=a.length?0:a[k])-
(k>=b.length?0:b[k]));if(d)return d}return 0};a.Qg=function(a){return a.join(".")};a.NB=function(a){return a.split(".").map(function(a){return a|0})};a.vU=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.IS=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.Gl=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=D(b[1]),b.join("://")):D(a)}};b4w.module.__vec3=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new t(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new t(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,l){var h=new t(3);h[0]=a;h[1]=b;h[2]=l;return h};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,l,h){h[0]=a;h[1]=b;h[2]=l;return h};a.add=function(a,b,l){l[0]=a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];
return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],
b[2]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;return l};a.scaleAndAdd=function(a,b,l,h){h[0]=a[0]+b[0]*l;h[1]=a[1]+b[1]*l;h[2]=a[2]+b[2]*l;return h};a.distance=function(a,b){var l=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2];return Math.sqrt(l*l+h*h+r*r)};a.dist=a.distance;a.squaredDistance=function(a,b){var l=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2];return l*l+h*h+r*r};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1];a=a[2];return Math.sqrt(b*b+l*l+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],l=a[1];a=a[2];return b*b+l*l+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var l=a[0],h=a[1],r=a[2],l=l*l+h*h+r*r;0<l&&(l=1/Math.sqrt(l),b[0]=a[0]*l,b[1]=a[1]*l,b[2]=a[2]*l);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,l){var h=a[0],r=a[1];a=a[2];var x=b[0],v=b[1];b=b[2];
l[0]=r*b-a*v;l[1]=a*x-h*b;l[2]=h*v-r*x;return l};a.lerp=function(a,b,l,h){var r=a[0],x=a[1];a=a[2];h[0]=r+l*(b[0]-r);h[1]=x+l*(b[1]-x);h[2]=a+l*(b[2]-a);return h};a.random=function(a,b){a=a||1;var y=2*l()*Math.PI,h=2*l()-1,r=Math.sqrt(1-h*h)*a;b[0]=Math.cos(y)*r;b[1]=Math.sin(y)*r;b[2]=h*a;return b};a.transformMat4=function(a,b,l){var h=a[0],r=a[1];a=a[2];var x=b[3]*h+b[7]*r+b[11]*a+b[15],x=x||1;l[0]=(b[0]*h+b[4]*r+b[8]*a+b[12])/x;l[1]=(b[1]*h+b[5]*r+b[9]*a+b[13])/x;l[2]=(b[2]*h+b[6]*r+b[10]*a+b[14])/
x;return l};a.transformMat3=function(a,b,l){var h=a[0],r=a[1];a=a[2];l[0]=h*b[0]+r*b[3]+a*b[6];l[1]=h*b[1]+r*b[4]+a*b[7];l[2]=h*b[2]+r*b[5]+a*b[8];return l};a.transformQuat=function(a,b,l){var h=a[0],r=a[1],x=a[2];a=b[0];var v=b[1],g=b[2];b=b[3];var p=b*h+v*x-g*r,f=b*r+g*h-a*x,A=b*x+a*r-v*h,h=-a*h-v*r-g*x;l[0]=p*b+h*-a+f*-g-A*-v;l[1]=f*b+h*-v+A*-a-p*-g;l[2]=A*b+h*-g+p*-v-f*-a;return l};a.rotateX=function(a,b,l,h){var r=[],x=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];x[0]=r[0];x[1]=r[1]*Math.cos(l)-
r[2]*Math.sin(l);x[2]=r[1]*Math.sin(l)+r[2]*Math.cos(l);h[0]=x[0]+b[0];h[1]=x[1]+b[1];h[2]=x[2]+b[2];return h};a.rotateY=function(a,b,l,h){var r=[],x=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];x[0]=r[2]*Math.sin(l)+r[0]*Math.cos(l);x[1]=r[1];x[2]=r[2]*Math.cos(l)-r[0]*Math.sin(l);h[0]=x[0]+b[0];h[1]=x[1]+b[1];h[2]=x[2]+b[2];return h};a.rotateZ=function(a,b,l,h){var r=[],x=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];x[0]=r[0]*Math.cos(l)-r[1]*Math.sin(l);x[1]=r[0]*Math.sin(l)+r[1]*Math.cos(l);
x[2]=r[2];h[0]=x[0]+b[0];h[1]=x[1]+b[1];h[2]=x[2]+b[2];return h};a.forEach=function(){var l=a.create();return function(a,y,h,r,x,v){y||(y=3);h||(h=0);for(r=r?Math.min(r*y+h,a.length):a.length;h<r;h+=y)l[0]=a[h],l[1]=a[h+1],l[2]=a[h+2],x(l,v,l),a[h]=l[0],a[h+1]=l[1],a[h+2]=l[2];return a}}();a.nP=function(l,b){var y=a.fromValues(l[0],l[1],l[2]),h=a.fromValues(b[0],b[1],b[2]);a.normalize(y,y);a.normalize(h,h);y=a.dot(y,h);return 1<y?0:Math.acos(y)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+
a[2]+")"};"undefined"!==typeof a&&(a.vec3=a)};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new t(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new t(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,l,h){var r=new t(4);r[0]=a;r[1]=b;r[2]=l;r[3]=h;return r};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,l,h,r){r[0]=a;r[1]=b;r[2]=l;r[3]=h;return r};a.add=function(a,b,l){l[0]=
a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];l[3]=a[3]+b[3];return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];l[3]=a[3]-b[3];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];l[3]=a[3]*b[3];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];l[3]=a[3]/b[3];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);l[3]=
Math.min(a[3],b[3]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],b[2]);l[3]=Math.max(a[3],b[3]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;l[3]=a[3]*b;return l};a.scaleAndAdd=function(a,b,l,h){h[0]=a[0]+b[0]*l;h[1]=a[1]+b[1]*l;h[2]=a[2]+b[2]*l;h[3]=a[3]+b[3]*l;return h};a.distance=function(a,b){var l=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2],x=b[3]-a[3];return Math.sqrt(l*l+h*h+r*r+x*x)};a.dist=a.distance;a.squaredDistance=
function(a,b){var l=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2],x=b[3]-a[3];return l*l+h*h+r*r+x*x};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1],h=a[2];a=a[3];return Math.sqrt(b*b+l*l+h*h+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],l=a[1],h=a[2];a=a[3];return b*b+l*l+h*h+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var l=a[0],h=a[1],r=a[2],x=a[3],l=l*l+h*h+r*r+x*x;0<l&&(l=1/Math.sqrt(l),b[0]=a[0]*l,b[1]=a[1]*l,b[2]=a[2]*l,b[3]=a[3]*l);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,l,h){var r=a[0],x=a[1],v=a[2];a=a[3];h[0]=r+l*(b[0]-r);h[1]=x+l*(b[1]-x);h[2]=v+l*(b[2]-v);h[3]=a+l*(b[3]-a);return h};a.random=function(c,b){c=c||1;b[0]=l();b[1]=l();b[2]=l();b[3]=l();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,l){var h=a[0],
r=a[1],x=a[2];a=a[3];l[0]=b[0]*h+b[4]*r+b[8]*x+b[12]*a;l[1]=b[1]*h+b[5]*r+b[9]*x+b[13]*a;l[2]=b[2]*h+b[6]*r+b[10]*x+b[14]*a;l[3]=b[3]*h+b[7]*r+b[11]*x+b[15]*a;return l};a.transformQuat=function(a,b,l){var h=a[0],r=a[1],x=a[2],v=b[0],g=b[1],p=b[2];b=b[3];var f=b*h+g*x-p*r,A=b*r+p*h-v*x,F=b*x+v*r-g*h,h=-v*h-g*r-p*x;l[0]=f*b+h*-v+A*-p-F*-g;l[1]=A*b+h*-g+F*-v-f*-p;l[2]=F*b+h*-p+f*-g-A*-v;l[3]=a[3];return l};a.forEach=function(){var l=a.create();return function(a,y,h,r,x,v){y||(y=4);h||(h=0);for(r=r?Math.min(r*
y+h,a.length):a.length;h<r;h+=y)l[0]=a[h],l[1]=a[h+1],l[2]=a[h+2],l[3]=a[h+3],x(l,v,l),a[h]=l[0],a[h+1]=l[1],a[h+2]=l[2],a[h+3]=l[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,t){var l=t("__vec3"),c=t("__vec4"),b=t("__mat3"),y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=l.create(),c=l.fromValues(1,0,0),x=l.fromValues(0,1,0);return function(v,g,p){var f=l.dot(v,g);if(-.9999999>f)return l.cross(c,v,b),1E-6>l.length(b)&&l.cross(x,v,b),l.normalize(b,b),a.setAxisAngle(b,Math.PI,p),p;if(.9999999<f)return p[0]=0,p[1]=0,p[2]=0,p[3]=1,p;l.cross(v,
g,b);p[0]=b[0];p[1]=b[1];p[2]=b[2];p[3]=1+f;return a.normalize(p,p)}}();a.setAxes=function(){var l=b.create();return function(b,c,v,g){l[0]=c[0];l[3]=c[1];l[6]=c[2];l[1]=v[0];l[4]=v[1];l[7]=v[2];l[2]=-b[0];l[5]=-b[1];l[8]=-b[2];return a.normalize(a.fromMat3(l,g),g)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,l){b*=.5;var c=Math.sin(b);l[0]=c*a[0];l[1]=c*a[1];l[2]=c*a[2];l[3]=Math.cos(b);
return l};a.add=c.add;a.multiply=function(a,b,l){var c=a[0],g=a[1],p=a[2];a=a[3];var f=b[0],A=b[1],F=b[2];b=b[3];l[0]=c*b+a*f+g*F-p*A;l[1]=g*b+a*A+p*f-c*F;l[2]=p*b+a*F+c*A-g*f;l[3]=a*b-c*f-g*A-p*F;return l};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,l){b*=.5;var c=a[0],g=a[1],p=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=c*b+a*f;l[1]=g*b+p*f;l[2]=p*b-g*f;l[3]=a*b-c*f;return l};a.rotateY=function(a,b,l){b*=.5;var c=a[0],g=a[1],p=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=c*
b-p*f;l[1]=g*b+a*f;l[2]=p*b+c*f;l[3]=a*b-g*f;return l};a.rotateZ=function(a,b,l){b*=.5;var c=a[0],g=a[1],p=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=c*b+g*f;l[1]=g*b-c*f;l[2]=p*b+a*f;l[3]=a*b-p*f;return l};a.calculateW=function(a,b){var l=a[0],c=a[1],g=a[2];b[0]=l;b[1]=c;b[2]=g;b[3]=Math.sqrt(Math.abs(1-l*l-c*c-g*g));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,l,c){var g=a[0],p=a[1],f=a[2];a=a[3];var A=b[0],F=b[1],y=b[2];b=b[3];var J,D,n;D=g*A+p*F+f*y+a*b;0>D&&(D=-D,A=-A,F=-F,
y=-y,b=-b);1E-6<1-D?(J=Math.acos(D),n=Math.sin(J),D=Math.sin((1-l)*J)/n,l=Math.sin(l*J)/n):D=1-l;c[0]=D*g+l*A;c[1]=D*p+l*F;c[2]=D*f+l*y;c[3]=D*a+l*b;return c};a.invert=function(a,b){var l=a[0],c=a[1],g=a[2],p=a[3],f=l*l+c*c+g*g+p*p,f=f?1/f:0;b[0]=-l*f;b[1]=-c*f;b[2]=-g*f;b[3]=p*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,
b){var l=a[0]+a[4]+a[8];if(0<l)l=Math.sqrt(l+1),b[3]=.5*l,l=.5/l,b[0]=(a[5]-a[7])*l,b[1]=(a[6]-a[2])*l,b[2]=(a[1]-a[3])*l;else{var c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var g=(c+1)%3,p=(c+2)%3,l=Math.sqrt(a[3*c+c]-a[3*g+g]-a[3*p+p]+1);b[c]=.5*l;l=.5/l;b[3]=(a[3*g+p]-a[3*p+g])*l;b[g]=(a[3*g+c]+a[3*c+g])*l;b[p]=(a[3*p+c]+a[3*c+p])*l}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new t(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],y=a[2],h=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=y;c[7]=h}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=a[4],v=a[5],g=a[6],p=a[7],f=a[8],A=f*x-v*p,F=-f*r+v*g,H=
p*r-x*g,J=b*A+y*F+h*H;if(!J)return null;J=1/J;c[0]=A*J;c[1]=(-f*y+h*p)*J;c[2]=(v*y-h*x)*J;c[3]=F*J;c[4]=(f*b-h*g)*J;c[5]=(-v*b+h*r)*J;c[6]=H*J;c[7]=(-p*b+y*g)*J;c[8]=(x*b-y*r)*J;return c};a.adjoint=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=a[4],v=a[5],g=a[6],p=a[7],f=a[8];c[0]=x*f-v*p;c[1]=h*p-y*f;c[2]=y*v-h*x;c[3]=v*g-r*f;c[4]=b*f-h*g;c[5]=h*r-b*v;c[6]=r*p-x*g;c[7]=y*g-b*p;c[8]=b*x-y*r;return c};a.determinant=function(a){var c=a[3],b=a[4],y=a[5],h=a[6],r=a[7],x=a[8];return a[0]*(x*b-y*r)+a[1]*
(-x*c+y*h)+a[2]*(r*c-b*h)};a.multiply=function(a,c,b){var y=a[0],h=a[1],r=a[2],x=a[3],v=a[4],g=a[5],p=a[6],f=a[7];a=a[8];var A=c[0],F=c[1],H=c[2],J=c[3],D=c[4],n=c[5],C=c[6],B=c[7];c=c[8];b[0]=A*y+F*x+H*p;b[1]=A*h+F*v+H*f;b[2]=A*r+F*g+H*a;b[3]=J*y+D*x+n*p;b[4]=J*h+D*v+n*f;b[5]=J*r+D*g+n*a;b[6]=C*y+B*x+c*p;b[7]=C*h+B*v+c*f;b[8]=C*r+B*g+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var y=a[0],h=a[1],r=a[2],x=a[3],v=a[4],g=a[5],p=a[6],f=a[7];a=a[8];var A=c[0];c=c[1];b[0]=y;b[1]=h;b[2]=r;
b[3]=x;b[4]=v;b[5]=g;b[6]=A*y+c*x+p;b[7]=A*h+c*v+f;b[8]=A*r+c*g+a;return b};a.rotate=function(a,c,b){var y=a[0],h=a[1],r=a[2],x=a[3],v=a[4],g=a[5],p=a[6],f=a[7];a=a[8];var A=Math.sin(c);c=Math.cos(c);b[0]=c*y+A*x;b[1]=c*h+A*v;b[2]=c*r+A*g;b[3]=c*x-A*y;b[4]=c*v-A*h;b[5]=c*g-A*r;b[6]=p;b[7]=f;b[8]=a;return b};a.scale=function(a,c,b){var y=c[0];c=c[1];b[0]=y*a[0];b[1]=y*a[1];b[2]=y*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.HH=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.FH=function(a,c){var b=Math.sin(a),y=Math.cos(a);c[0]=y;c[1]=b;c[2]=0;c[3]=-b;c[4]=y;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.GH=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=b+b,v=y+y,g=h+h,b=b*x,p=y*x,y=y*v,f=h*x,A=
h*v,h=h*g,x=r*x,v=r*v,r=r*g;c[0]=1-y-h;c[3]=p-r;c[6]=f+v;c[1]=p+r;c[4]=1-b-h;c[7]=A-x;c[2]=f-v;c[5]=A+x;c[8]=1-b-y;return c};a.normalFromMat4=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=a[4],v=a[5],g=a[6],p=a[7],f=a[8],A=a[9],F=a[10],H=a[11],J=a[12],D=a[13],n=a[14],C=a[15],B=b*v-y*x,q=b*g-h*x,m=b*p-r*x,w=y*g-h*v,d=y*p-r*v,I=h*p-r*g,u=f*D-A*J,E=f*n-F*J,f=f*C-H*J,z=A*n-F*D,A=A*C-H*D,F=F*C-H*n,H=B*F-q*A+m*z+w*f-d*E+I*u;if(!H)return null;H=1/H;c[0]=(v*F-g*A+p*z)*H;c[1]=(g*f-x*F-p*E)*H;c[2]=(x*A-v*
f+p*u)*H;c[3]=(h*A-y*F-r*z)*H;c[4]=(b*F-h*f+r*E)*H;c[5]=(y*f-b*A-r*u)*H;c[6]=(D*I-n*d+C*w)*H;c[7]=(n*m-J*I-C*q)*H;c[8]=(J*d-D*m+C*B)*H;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.EH=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new t(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],y=a[2],h=a[3],r=a[6],x=a[7],v=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=y;c[9]=r;c[11]=a[14];c[12]=h;c[13]=
x;c[14]=v}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=a[4],v=a[5],g=a[6],p=a[7],f=a[8],A=a[9],F=a[10],H=a[11],J=a[12],D=a[13],n=a[14],C=a[15],B=b*v-y*x,q=b*g-h*x,m=b*p-r*x,w=y*g-h*v,d=y*p-r*v,I=h*p-r*g,u=f*D-A*J,E=f*n-F*J,z=f*C-H*J,G=A*n-F*D,e=A*C-H*D,K=F*C-H*n,k=B*K-q*e+m*G+w*z-d*E+I*u;if(!k)return null;
k=1/k;c[0]=(v*K-g*e+p*G)*k;c[1]=(h*e-y*K-r*G)*k;c[2]=(D*I-n*d+C*w)*k;c[3]=(F*d-A*I-H*w)*k;c[4]=(g*z-x*K-p*E)*k;c[5]=(b*K-h*z+r*E)*k;c[6]=(n*m-J*I-C*q)*k;c[7]=(f*I-F*m+H*q)*k;c[8]=(x*e-v*z+p*u)*k;c[9]=(y*z-b*e-r*u)*k;c[10]=(J*d-D*m+C*B)*k;c[11]=(A*m-f*d-H*B)*k;c[12]=(v*E-x*G-g*u)*k;c[13]=(b*G-y*E+h*u)*k;c[14]=(D*q-J*w-n*B)*k;c[15]=(f*w-A*q+F*B)*k;return c};a.adjoint=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=a[4],v=a[5],g=a[6],p=a[7],f=a[8],A=a[9],F=a[10],H=a[11],J=a[12],D=a[13],n=a[14],C=a[15];
c[0]=v*(F*C-H*n)-A*(g*C-p*n)+D*(g*H-p*F);c[1]=-(y*(F*C-H*n)-A*(h*C-r*n)+D*(h*H-r*F));c[2]=y*(g*C-p*n)-v*(h*C-r*n)+D*(h*p-r*g);c[3]=-(y*(g*H-p*F)-v*(h*H-r*F)+A*(h*p-r*g));c[4]=-(x*(F*C-H*n)-f*(g*C-p*n)+J*(g*H-p*F));c[5]=b*(F*C-H*n)-f*(h*C-r*n)+J*(h*H-r*F);c[6]=-(b*(g*C-p*n)-x*(h*C-r*n)+J*(h*p-r*g));c[7]=b*(g*H-p*F)-x*(h*H-r*F)+f*(h*p-r*g);c[8]=x*(A*C-H*D)-f*(v*C-p*D)+J*(v*H-p*A);c[9]=-(b*(A*C-H*D)-f*(y*C-r*D)+J*(y*H-r*A));c[10]=b*(v*C-p*D)-x*(y*C-r*D)+J*(y*p-r*v);c[11]=-(b*(v*H-p*A)-x*(y*H-r*A)+f*
(y*p-r*v));c[12]=-(x*(A*n-F*D)-f*(v*n-g*D)+J*(v*F-g*A));c[13]=b*(A*n-F*D)-f*(y*n-h*D)+J*(y*F-h*A);c[14]=-(b*(v*n-g*D)-x*(y*n-h*D)+J*(y*g-h*v));c[15]=b*(v*F-g*A)-x*(y*F-h*A)+f*(y*g-h*v);return c};a.determinant=function(a){var c=a[0],b=a[1],y=a[2],h=a[3],r=a[4],x=a[5],v=a[6],g=a[7],p=a[8],f=a[9],A=a[10],F=a[11],H=a[12],J=a[13],D=a[14];a=a[15];return(c*x-b*r)*(A*a-F*D)-(c*v-y*r)*(f*a-F*J)+(c*g-h*r)*(f*D-A*J)+(b*v-y*x)*(p*a-F*H)-(b*g-h*x)*(p*D-A*H)+(y*g-h*v)*(p*J-f*H)};a.multiply=function(a,c,b){var y=
a[0],h=a[1],r=a[2],x=a[3],v=a[4],g=a[5],p=a[6],f=a[7],A=a[8],F=a[9],H=a[10],J=a[11],D=a[12],n=a[13],C=a[14];a=a[15];var B=c[0],q=c[1],m=c[2],w=c[3];b[0]=B*y+q*v+m*A+w*D;b[1]=B*h+q*g+m*F+w*n;b[2]=B*r+q*p+m*H+w*C;b[3]=B*x+q*f+m*J+w*a;B=c[4];q=c[5];m=c[6];w=c[7];b[4]=B*y+q*v+m*A+w*D;b[5]=B*h+q*g+m*F+w*n;b[6]=B*r+q*p+m*H+w*C;b[7]=B*x+q*f+m*J+w*a;B=c[8];q=c[9];m=c[10];w=c[11];b[8]=B*y+q*v+m*A+w*D;b[9]=B*h+q*g+m*F+w*n;b[10]=B*r+q*p+m*H+w*C;b[11]=B*x+q*f+m*J+w*a;B=c[12];q=c[13];m=c[14];w=c[15];b[12]=B*y+
q*v+m*A+w*D;b[13]=B*h+q*g+m*F+w*n;b[14]=B*r+q*p+m*H+w*C;b[15]=B*x+q*f+m*J+w*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var y=c[0],h=c[1];c=c[2];var r,x,v,g,p,f,A,F,H,J,D,n;a===b?(b[12]=a[0]*y+a[4]*h+a[8]*c+a[12],b[13]=a[1]*y+a[5]*h+a[9]*c+a[13],b[14]=a[2]*y+a[6]*h+a[10]*c+a[14],b[15]=a[3]*y+a[7]*h+a[11]*c+a[15]):(r=a[0],x=a[1],v=a[2],g=a[3],p=a[4],f=a[5],A=a[6],F=a[7],H=a[8],J=a[9],D=a[10],n=a[11],b[0]=r,b[1]=x,b[2]=v,b[3]=g,b[4]=p,b[5]=f,b[6]=A,b[7]=F,b[8]=H,b[9]=J,b[10]=D,b[11]=n,
b[12]=r*y+p*h+H*c+a[12],b[13]=x*y+f*h+J*c+a[13],b[14]=v*y+A*h+D*c+a[14],b[15]=g*y+F*h+n*c+a[15]);return b};a.scale=function(a,c,b){var y=c[0],h=c[1];c=c[2];b[0]=a[0]*y;b[1]=a[1]*y;b[2]=a[2]*y;b[3]=a[3]*y;b[4]=a[4]*h;b[5]=a[5]*h;b[6]=a[6]*h;b[7]=a[7]*h;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,y){var h=b[0],r=b[1];b=b[2];var x=Math.sqrt(h*h+r*r+b*b),v,g,p,f,A,F,H,J,D,n,C,B,q,m,w,d,I,u,E,z;if(1E-7>Math.abs(x))return null;
x=1/x;h*=x;r*=x;b*=x;v=Math.sin(c);g=Math.cos(c);p=1-g;c=a[0];x=a[1];f=a[2];A=a[3];F=a[4];H=a[5];J=a[6];D=a[7];n=a[8];C=a[9];B=a[10];q=a[11];m=h*h*p+g;w=r*h*p+b*v;d=b*h*p-r*v;I=h*r*p-b*v;u=r*r*p+g;E=b*r*p+h*v;z=h*b*p+r*v;h=r*b*p-h*v;r=b*b*p+g;y[0]=c*m+F*w+n*d;y[1]=x*m+H*w+C*d;y[2]=f*m+J*w+B*d;y[3]=A*m+D*w+q*d;y[4]=c*I+F*u+n*E;y[5]=x*I+H*u+C*E;y[6]=f*I+J*u+B*E;y[7]=A*I+D*u+q*E;y[8]=c*z+F*h+n*r;y[9]=x*z+H*h+C*r;y[10]=f*z+J*h+B*r;y[11]=A*z+D*h+q*r;a!==y&&(y[12]=a[12],y[13]=a[13],y[14]=a[14],y[15]=a[15]);
return y};a.rotateX=function(a,c,b){var y=Math.sin(c);c=Math.cos(c);var h=a[4],r=a[5],x=a[6],v=a[7],g=a[8],p=a[9],f=a[10],A=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=h*c+g*y;b[5]=r*c+p*y;b[6]=x*c+f*y;b[7]=v*c+A*y;b[8]=g*c-h*y;b[9]=p*c-r*y;b[10]=f*c-x*y;b[11]=A*c-v*y;return b};a.rotateY=function(a,c,b){var y=Math.sin(c);c=Math.cos(c);var h=a[0],r=a[1],x=a[2],v=a[3],g=a[8],p=a[9],f=a[10],A=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=h*c-g*y;b[1]=r*c-p*y;b[2]=x*c-f*y;b[3]=v*c-A*y;b[8]=h*y+g*c;b[9]=r*y+p*c;b[10]=x*y+f*c;b[11]=v*y+A*c;return b};a.rotateZ=function(a,c,b){var y=Math.sin(c);c=Math.cos(c);var h=a[0],r=a[1],x=a[2],v=a[3],g=a[4],p=a[5],f=a[6],A=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=h*c+g*y;b[1]=r*c+p*y;b[2]=x*c+f*y;b[3]=v*c+A*y;b[4]=g*c-h*y;b[5]=p*c-r*y;b[6]=f*c-x*y;b[7]=A*c-v*y;return b};
a.HH=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.GH=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.FH=function(a,c,b){var y=c[0],h=c[1];c=c[2];var r=Math.sqrt(y*y+h*h+c*c),x;if(1E-7>Math.abs(r))return null;r=1/r;y*=r;h*=r;c*=r;r=Math.sin(a);a=Math.cos(a);x=1-a;b[0]=y*y*x+a;b[1]=h*y*x+c*
r;b[2]=c*y*x-h*r;b[3]=0;b[4]=y*h*x-c*r;b[5]=h*h*x+a;b[6]=c*h*x+y*r;b[7]=0;b[8]=y*c*x+h*r;b[9]=h*c*x-y*r;b[10]=c*c*x+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.aR=function(a,c){var b=Math.sin(a),y=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=y;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=y;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.bR=function(a,c){var b=Math.sin(a),y=Math.cos(a);c[0]=y;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=y;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.cR=function(a,c){var b=Math.sin(a),y=Math.cos(a);c[0]=y;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=y;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var y=a[0],h=a[1],r=a[2],x=a[3],v=y+y,g=h+h,p=r+r;a=y*v;var f=y*g,y=y*p,A=h*g,h=h*p,r=r*p,v=x*v,g=x*g,x=x*p;b[0]=1-(A+r);b[1]=f+x;b[2]=y-g;b[3]=0;b[4]=f-x;b[5]=1-(a+r);b[6]=h+v;b[7]=0;b[8]=y+g;b[9]=h-v;b[10]=1-(a+A);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.fromQuat=function(a,c){var b=a[0],y=a[1],h=a[2],r=a[3],x=b+b,v=y+y,g=h+h,b=b*x,p=y*x,y=y*v,f=h*x,A=h*v,h=h*g,x=r*x,v=r*v,r=r*g;c[0]=1-y-h;c[1]=p+r;c[2]=f-v;c[3]=0;c[4]=p-r;c[5]=1-b-h;c[6]=A+x;c[7]=0;c[8]=f+v;c[9]=A-x;c[10]=1-b-y;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,y,h,r,x){var v=1/(c-a),g=1/(y-b),p=1/(h-r);x[0]=2*h*v;x[1]=0;x[2]=0;x[3]=0;x[4]=0;x[5]=2*h*g;x[6]=0;x[7]=0;x[8]=(c+a)*v;x[9]=(y+b)*g;x[10]=(r+h)*p;x[11]=-1;x[12]=0;x[13]=0;x[14]=
r*h*2*p;x[15]=0;return x};a.perspective=function(a,c,b,y,h){a=1/Math.tan(a/2);var r=1/(b-y);h[0]=a/c;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=(y+b)*r;h[11]=-1;h[12]=0;h[13]=0;h[14]=2*y*b*r;h[15]=0;return h};a.dT=function(a,c,b,y){var h=Math.tan(a.IU*Math.PI/180),r=Math.tan(a.JQ*Math.PI/180),x=Math.tan(a.HS*Math.PI/180);a=Math.tan(a.qT*Math.PI/180);var v=2/(x+a),g=2/(h+r);y[0]=v;y[1]=0;y[2]=0;y[3]=0;y[4]=0;y[5]=g;y[6]=0;y[7]=0;y[8]=-((x-a)*v*.5);y[9]=(h-r)*g*.5;y[10]=b/
(c-b);y[11]=-1;y[12]=0;y[13]=0;y[14]=b*c/(c-b);y[15]=0;return y};a.ortho=function(a,c,b,y,h,r,x){var v=1/(a-c),g=1/(b-y),p=1/(h-r);x[0]=-2*v;x[1]=0;x[2]=0;x[3]=0;x[4]=0;x[5]=-2*g;x[6]=0;x[7]=0;x[8]=0;x[9]=0;x[10]=2*p;x[11]=0;x[12]=(a+c)*v;x[13]=(y+b)*g;x[14]=(r+h)*p;x[15]=1;return x};a.lookAt=function(l,c,b,y){var h,r,x,v,g,p,f,A,F=l[0],H=l[1];l=l[2];x=b[0];v=b[1];r=b[2];f=c[0];b=c[1];h=c[2];if(1E-7>Math.abs(F-f)&&1E-7>Math.abs(H-b)&&1E-7>Math.abs(l-h))return a.identity(y);c=F-f;b=H-b;f=l-h;A=1/Math.sqrt(c*
c+b*b+f*f);c*=A;b*=A;f*=A;h=v*f-r*b;r=r*c-x*f;x=x*b-v*c;(A=Math.sqrt(h*h+r*r+x*x))?(A=1/A,h*=A,r*=A,x*=A):x=r=h=0;v=b*x-f*r;g=f*h-c*x;p=c*r-b*h;(A=Math.sqrt(v*v+g*g+p*p))?(A=1/A,v*=A,g*=A,p*=A):p=g=v=0;y[0]=h;y[1]=v;y[2]=c;y[3]=0;y[4]=r;y[5]=g;y[6]=b;y[7]=0;y[8]=x;y[9]=p;y[10]=f;y[11]=0;y[12]=-(h*F+r*H+x*l);y[13]=-(v*F+g*H+p*l);y[14]=-(c*F+b*H+f*l);y[15]=1;return y};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.EH=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.mat4=b4w.module.__mat4;b4w.module.__obj_util=function(a,t){function l(a,b,f){f||(f=a);return{name:a,Zh:f,type:b,jJ:!1,xa:!1,Bl:!1,zp:!1,f:null,Na:null,A:null,jc:null,Ym:null,anchor:null,Yi:null,so:null,ba:[],cc:[],Wd:[],Jq:[],F:[],Yl:[],Od:[],Ci:[],le:null,yg:[],parent:null,tg:!1,Pl:"",mk:!1,Mc:!1,Md:!1,Kh:!1,m:null,l:null,Id:null,Xc:null,Zi:null,uw:null,Ts:[],ie:{Go:"NO_COLLISION",pm:!1,rC:!1,Me:0,wC:0,vC:0,Zq:0,st:0,FJ:!1,GJ:!1,HJ:!1,IJ:!1,JJ:!1,KJ:!1,Nk:0,Lk:0,Ok:0,yu:!1,ln:"BOX",om:!1},Zz:{pp:0,Ps:0,od:0,lt:0},Rm:0,
Sd:[],Gs:!1,La:null}}function c(a){if(!(a instanceof Object))return a;var b=null,f=null,h=null;a.T&&(b=a.T,a.T=null);a.ac&&(f=a.ac,a.ac=null);a.ga&&(h=a.ga,a.ga=null);var l;l=a.constructor;switch(l){case Float32Array:case Uint32Array:case Uint16Array:l=new l(a);break;case Array:l=new l(a.length);for(var r=0;r<a.length;r++)l[r]=c(a[r]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=a;
break;default:for(r in l=new l,a)l[r]=c(a[r])}b&&(l.T=b,a.T=b);f&&(l.ac=f,a.ac=f);h&&(l.ga=h,a.ga=h);return l}function b(a,b){for(var f=a.ba,c=0;c<f.length;c++){var h=f[c];if(h.Aa==b)return h}return null}function y(a){return a.tg?a.parent:a.parent?y(a.parent):null}var h=t("__mat4");t("__print");var r=t("__quat"),x=t("__tsr"),v=t("__vec4");new Float32Array(4);new Float32Array(4);new Float32Array(4);new Float32Array(8);new Float32Array(8);a.Si=function(a){a={type:a,Hc:0,JI:[0,0],i:new Float32Array(3),
quat:new Float32Array(4),Ca:new Float32Array(8),ea:new Float32Array(16),fz:new Float32Array(16),mc:new Float32Array(3),zc:new Float32Array(3),kj:0,lj:0,es:!1,mn:null,bi:0,du:!1,pC:!1,Ha:0,Fu:1,Eu:1,Gu:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,nf:null,eC:!1,mf:0,vh:0,ub:!1,yc:null,Fc:null,Tb:null,kr:!0,S:null,Ej:{Fj:1,Gj:1,Hj:0},Fd:null,pd:null,Bc:new Float32Array(4),ll:0,el:0,Fl:0,Ph:0,Cn:!1,td:!1,Vc:!1,Uc:!1,Cc:!1,nc:!1,Tc:!1,Ne:"",gf:!1,zd:!1,Bn:!1,Ge:!1,Rb:!1,Ui:!1,jj:!1,oo:!1,Ef:!1,
zo:!1,Db:!1,yo:!1,$z:!1,jo:!1,mo:!1,wr:!1,tm:0,Ye:0,Mf:0,lf:0,kf:0,ef:0,wf:"",ic:null,bn:!1,Ud:!1,lq:!1,Ek:"",Dk:!1,Jd:0,time:0,Cu:0,tC:0,zf:0,kl:!1,cc:!1,Xe:!1,Bg:[],oj:!1,eh:!1,Rf:1,$p:0,Zp:1,xp:new Int8Array([-1,-1]),ip:[],Iz:[],yB:[],Sc:null,qd:null,Wc:null,xd:null,Dd:null,Ki:null,Ws:null,dq:null,cq:null,yf:null,Sh:null,qo:null,ld:null,Rh:null,ro:null,Ii:null,Yb:null,iq:null,gq:null,hq:null,wb:null,Ed:null,Zb:null,Sf:null,jh:null,scale:1,mg:1E4};r.identity(a.quat);x.identity(a.Ca);h.identity(a.ea);
h.identity(a.fz);return a};a.Rq=l;a.Vw=function(a){a=l(a,"MESH");a.jJ=!0;return a};a.Kq=function(a){return a instanceof Array?a.slice():a};a.Xf=c;a.xa=function(a){return a.xa};a.fs=function(a){return"MESH"==a.type&&a.xa};a.Wm=function(a,b){a.ba.push({Aa:b,fo:!1,W:[],ug:null,Yf:null,vB:[],El:0,Xz:!1})};a.Tm=function(a,c,f){b(a,c).W.push(f)};a.kT=function(a,b){for(var f=a.ba,c=0;c<f.length;c++)if(f[c].Aa==b){f.splice(c,1);break}};a.Qa=b;a.mC=function(a,b){for(var f=0;f<a.length;f++)v.copy(b,a[f].f.Bc)};
a.tt=function(a,b,f){for(var c=0;c<a.ba.length;c++){var h=a.ba[c];f&&h.Aa!=f||(h.fo=b)}};a.Jr=function(a){for(var b=0;b<a.length;b++){var f=a[b];if(f.jc.Nx)return f}return null};a.Kx=function(a,b){return a+"*"+b};a.ty=function(a){return a.tg?null:a.parent};a.qf=y;a.Hr=function(a,b){for(var f=[],c=0;c<b.length;c++){var h=b[c];y(h)==a&&f.push(h)}return f};a.Lc=function(a){return"MESH"===a.type};a.Jh=function(a){return"ARMATURE"===a.type};a.pj=function(a){return"SPEAKER"===a.type};a.jd=function(a){return"CAMERA"===
a.type};a.gJ=function(a){return"LAMP"===a.type};a.ho=function(a){return"EMPTY"===a.type}};b4w.module.__tsr=function(a,t){function l(a,b,f,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=b;c[4]=f[0];c[5]=f[1];c[6]=f[2];c[7]=f[3];return c}function c(a,b,f){var c=b[0],h=b[1],l=b[2],r=b[3],x=b[4],n=b[5],C=b[6];b=b[7];var B=a[0]*r,q=a[1]*r,m=a[2]*r;a=b*B+n*m-C*q;var r=b*q+C*B-x*m,w=b*m+x*q-n*B,B=-x*B-n*q-C*m;f[0]=a*b+B*-x+r*-C-w*-n;f[1]=r*b+B*-n+w*-x-a*-C;f[2]=w*b+B*-C+a*-n-r*-x;f[0]+=c;f[1]+=h;f[2]+=l;return f}var b=t("__mat4"),y=t("__quat"),h=t("__util"),r=t("__vec3"),x=new Float32Array(3),v=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.Hx=function(a,b,f,c,h,l,r,x){var n=new Float32Array(8);n[0]=a;n[1]=b;n[2]=f;n[3]=c;n[4]=h;n[5]=l;n[6]=r;n[7]=x;return n};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.Fe=function(a,b,f,c){c||(c=new Float32Array(8));l(a,b,f,c);return c};a.Ag=l;a.Oj=function(a,
b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Oe=function(a,b){b[3]=a;return b};a.Ft=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.Nj=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.gj=function(a){return a.subarray(0,3)};a.fg=function(a){return a[3]};a.fj=function(a){return a.subarray(4)};a.invert=function(a,b){var f=1/a[3];if(!f)return null;var c=a[0],h=a[1],l=a[2];v[0]=a[4];v[1]=a[5];v[2]=a[6];v[3]=a[7];y.invert(v,v);var r=v[0],x=v[1],n=v[2],C=v[3],c=c*f,h=h*
f,B=l*f,l=C*c+x*B-n*h,q=C*h+n*c-r*B,m=C*B+r*h-x*c,c=-r*c-x*h-n*B;b[0]=-(l*C+c*-r+q*-n-m*-x);b[1]=-(q*C+c*-x+m*-r-l*-n);b[2]=-(m*C+c*-n+l*-x-q*-r);b[3]=f;b[4]=r;b[5]=x;b[6]=n;b[7]=C;return b};a.$B=function(a,c){var f=a[3];b.fromRotationTranslation(a.subarray(4),a.subarray(0,3),c);for(var h=0;12>h;h++)c[h]*=f;return c};a.Nn=function(a,b){var f=h.sj(a,x),c=h.zs(a),F=h.ng(a,v);l(f,c,F,b);return b};a.multiply=function(a,b,f){c(b,a,f);f[3]=a[3]*b[3];var h=a[4],l=a[5],r=a[6];a=a[7];var x=b[4],D=b[5],n=b[6];
b=b[7];f[4]=h*b+a*x+l*n-r*D;f[5]=l*b+a*D+r*x-h*n;f[6]=r*b+a*n+h*D-l*x;f[7]=a*b-h*x-l*D-r*n;return f};a.Mg=c;a.bC=function(a,b,f){var c=b[3],h=a[0]-b[0],l=a[1]-b[1],r=a[2]-b[2];a=b[4];var x=b[5],n=b[6];b=b[7];var C=a*a+x*x+n*n+b*b,C=C?1/C:0;a=-a*C;x=-x*C;n=-n*C;b*=C;var C=b*h+x*r-n*l,B=b*l+n*h-a*r,q=b*r+a*l-x*h,h=-a*h-x*l-n*r;f[0]=C*b+h*-a+B*-n-q*-x;f[1]=B*b+h*-x+q*-a-C*-n;f[2]=q*b+h*-n+C*-x-B*-a;f[0]/=c;f[1]/=c;f[2]/=c;return f};a.hk=function(a,b,f,c){c||(c=0);var h=a.length,l=b[0],r=b[1],x=b[2],
n=b[3],C=b[4],B=b[5],q=b[6];b=b[7];for(var m=0;m<h;m+=3){var w=a[m]*n,d=a[m+1]*n,v=a[m+2]*n,u=b*w+B*v-q*d,E=b*d+q*w-C*v,z=b*v+C*d-B*w,w=-C*w-B*d-q*v;f[c+m]=u*b+w*-C+E*-q-z*-B;f[c+m+1]=E*b+w*-B+z*-C-u*-q;f[c+m+2]=z*b+w*-q+u*-B-E*-C;f[c+m]+=l;f[c+m+1]+=r;f[c+m+2]+=x}return f};a.rp=function(a,b,f,c){c||(c=0);var h=a.length,l=b[3],r=b[4],x=b[5],n=b[6];b=b[7];for(var C=0;C<h;C+=3){var B=a[C]*l,q=a[C+1]*l,m=a[C+2]*l,w=b*B+x*m-n*q,d=b*q+n*B-r*m,v=b*m+r*q-x*B,B=-r*B-x*q-n*m;f[c+C]=w*b+B*-r+d*-n-v*-x;f[c+
C+1]=d*b+B*-x+v*-r-w*-n;f[c+C+2]=v*b+B*-n+w*-x-d*-r}return f};a.oi=function(a,b,f){var c=b[3],h=b[4],l=b[5],r=b[6];b=b[7];var x=a[0]*c,n=a[1]*c,C=a[2]*c;a=b*x+l*C-r*n;var c=b*n+r*x-h*C,B=b*C+h*n-l*x,x=-h*x-l*n-r*C;f[0]=a*b+x*-h+c*-r-B*-l;f[1]=c*b+x*-l+B*-h-a*-r;f[2]=B*b+x*-r+a*-l-c*-h;return f};a.sp=function(a,b,f,c){c||(c=0);var h=a.length,l=b[3],r=b[4],x=b[5],n=b[6];b=b[7];for(var C=0;C<h;C+=4){var B=a[C]*l,q=a[C+1]*l,m=a[C+2]*l,w=b*B+x*m-n*q,d=b*q+n*B-r*m,v=b*m+r*q-x*B,B=-r*B-x*q-n*m;f[c+C]=w*
b+B*-r+d*-n-v*-x;f[c+C+1]=d*b+B*-x+v*-r-w*-n;f[c+C+2]=v*b+B*-n+w*-x-d*-r;f[c+C+3]=a[C+3]}return f};a.translate=function(a,b,f){var c=a[3],h=a[4],l=a[5],r=a[6],x=a[7],n=b[0]*c,C=b[1]*c,B=b[2]*c;b=x*n+l*B-r*C;var c=x*C+r*n-h*B,q=x*B+h*C-l*n,n=-h*n-l*C-r*B;f[0]=a[0]+b*x+n*-h+c*-r-q*-l;f[1]=a[1]+c*x+n*-l+q*-h-b*-r;f[2]=a[2]+q*x+n*-r+b*-l-c*-h;f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];return f};a.ds=function(a,b,f,c){c||(c=new Float32Array(8));r.lerp(a.subarray(0,3),b.subarray(0,3),f,c.subarray(0,
3));var h=a[3];c[3]=h+f*(b[3]-h);y.slerp(a.subarray(4),b.subarray(4),f,c.subarray(4));return c};a.SQ=function(a,b,f,c){c||(c=new Float32Array(8));var h=a.subarray(0,3),l=b.subarray(0,3),r=c.subarray(0,3);r[0]=l[0]*(f+1)-h[0]*f;r[1]=l[1]*(f+1)-h[1]*f;r[2]=l[2]*(f+1)-h[2]*f;c[3]=b[3]*(f+1)-a[3]*f;a=a.subarray(4);b=b.subarray(4);h=c.subarray(4);h[0]=b[0]*(f+1)-a[0]*f;h[1]=b[1]*(f+1)-a[1]*f;h[2]=b[2]*(f+1)-a[2]*f;h[3]=b[3]*(f+1)-a[3]*f;y.normalize(h,h);return c};a.YI=function(a,b,f,c,h){h[0]=a[0]+b*f[0];
h[1]=a[1]+b*f[1];h[2]=a[2]+b*f[2];h[3]=a[3];f=c[0];var l=c[1];c=c[2];var r=a[4],x=a[5],n=a[6],C=a[7];h[4]=.5*(f*C+l*n-c*x);h[5]=.5*(l*C+c*r-f*n);h[6]=.5*(c*C+f*x-l*r);h[7]=.5*(-f*r-l*x-c*n);h[4]=a[4]+h[4]*b;h[5]=a[5]+h[5]*b;h[6]=a[6]+h[6]*b;h[7]=a[7]+h[7]*b;a=h[4];b=h[5];f=h[6];l=h[7];a=a*a+b*b+f*f+l*l;0<a&&(a=1/Math.sqrt(a),h[4]*=a,h[5]*=a,h[6]*=a,h[7]*=a)}};b4w.module.__particles=function(a,t){function l(){throw"_rand() undefined";}function c(a,b,c,h,l,x,n){var C=a.An,B=a.$d,q=a.time;a=a.lA;for(var m=b?4:1,w=0;w<C.length;w+=m){var d=C[w];if(q>a&&q>=d&&d>a||q<a&&(d>a||q>=d))for(d=0;8>d;d++)B[8*w+d]=l[d];for(d=0;8>d;d++)g[d]=B[8*w+d];d=p;d[0]=c[3*w];d[1]=c[3*w+1];d[2]=c[3*w+2];r.Mg(d,g,d);x[3*w]=d[0];x[3*w+1]=d[1];x[3*w+2]=d[2];var v=p;v[0]=h[3*w];v[1]=h[3*w+1];v[2]=h[3*w+2];r.oi(v,g,v);n[3*w]=v[0];n[3*w+1]=v[1];n[3*w+2]=v[2];if(b)for(d=1;4>d;d++)x[3*
(w+d)]=x[3*w],x[3*(w+d)+1]=x[3*w+1],x[3*(w+d)+2]=x[3*w+2],n[3*(w+d)]=v[0],n[3*(w+d)+1]=v[1],n[3*(w+d)+2]=v[2]}}function b(a){a?(x.cM(a),l=function(){return x.IK()}):l=function(){return Math.random()}}t("__config");var y=t("__geometry");t("__scenes");var h=t("__time"),r=t("__tsr"),x=t("__util"),v=t("__vec3"),g=new Float32Array(8),p=new Float32Array(3);a.Os=function(a){a=a.ba;for(var b=0;b<a.length;b++)for(var c=a[b].W,h=0;h<c.length;h++)if(c[h].ua)return!0;return!1};a.Ns=function(a){a=a.ba;for(var b=
0;b<a.length;b++)for(var c=a[b].W,h=0;h<c.length;h++){var g=c[h].ua;if(g&&"EMITTER"==g.Qs)return!0}return!1};a.sF=function(a){return 0<a.particle_systems.length};a.rF=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.MI=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.WI=function(a,b,c){var g=a.ua={name:b.name,Qs:b.settings.type,
time:0,lA:-1,Bu:!1,J:0,aa:0,YB:0,ps:0,zz:0,Hb:!1,Me:0,Hs:0,Sy:0,yh:0,gd:0,JC:0,size:0,Jv:0,Iv:0,xB:0,Jw:0,wB:new Float32Array(8),Iw:new Float32Array(16),Jj:null,jA:null,Sz:null,Tz:null,An:null,dr:null,$d:null};g.J=b.settings.frame_start;g.aa=b.settings.frame_end;g.YB=(g.aa-g.J)/h.Sb();g.ps=b.settings.lifetime;g.zz=g.ps/h.Sb();g.Hb=b.settings.b4w_cyclic?1:0;g.Me=b.settings.mass;g.Hs=b.settings.normal_factor;g.Sy=9.81*b.settings.effector_weights.gravity;g.yh=b.settings.b4w_fade_in/h.Sb();g.gd=b.settings.b4w_fade_out/
h.Sb();g.JC=b.settings.effector_weights.wind;g.Bu="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var l,p;a.Fh?(a=c.halo.size,l=c.halo.hardness,30>l?(l=.5,p=.9):40>l?(l=.1,p=1):50>l?(l=0,p=.8):(l=0,p=.5)):(a=b.settings.particle_size,p=l=1);g.size=a;g.Jv=l;g.Iv=p;a=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(a[0]&&a[0].use_map_size&&a[0].texture&&"BLEND"==a[0].texture.type&&a[0].texture.use_color_ramp){a=a[0].texture.color_ramp.elements;l=Math.min(2*a.length,b.length);for(p=0;p<l;p+=2){var n=
a[p/2];b[p]=n.position;b[p+1]=(n.color[0]+n.color[1]+n.color[2])/3}g.xB=a.length}g.wB.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){a=b[0].texture.color_ramp.elements;l=Math.min(4*a.length,c.length);for(p=0;p<l;p+=4)n=a[p/4],c[p]=n.position,c[p+1]=n.color[0],c[p+2]=n.color[1],c[p+3]=n.color[2];g.Jw=a.length}g.Iw.set(c)};a.NH=function(a,g,p,r){var t=a.ua,D=p.settings.count,
n=p.settings.frame_start/h.Sb(),C=p.settings.frame_end/h.Sb(),B=p.settings.lifetime/h.Sb(),q=p.settings.lifetime_random,m=p.settings.emit_from,w=p.settings.factor_random,d=p.settings.angular_velocity_mode,I=p.settings.angular_velocity_factor,u=p.settings.b4w_randomize_emission,E=p.settings.b4w_cyclic,z=!a.Fh;b(p.seed);g=y.xx(g,["a_position","a_normal"],null);switch(m){case "VERT":p=g.B[0].a_position;g=g.B[0].a_normal;for(var G=p.length/3,m=[],e=0;e<D;e++){var K=Math.round((G-1)*l());m.push(K);z&&
(m.push(K),m.push(K),m.push(K))}G=[];for(e=0;e<m.length;e++)G.push(p[3*m[e]]),G.push(p[3*m[e]+1]),G.push(p[3*m[e]+2]);p=new Float32Array(G);G=[];for(e=0;e<m.length;e++)G.push(g[3*m[e]]),G.push(g[3*m[e]+1]),G.push(g[3*m[e]+2]);m=new Float32Array(G);break;case "FACE":p=[];m=[];e=[];x.bo(0,e);G=y.Ar(g,D,!1,e);x.bo(0,e);g=y.Ar(g,D,!0,e);for(e=0;e<G.length;e++)p.push(G[e][0],G[e][1],G[e][2]),z&&(p.push(G[e][0],G[e][1],G[e][2]),p.push(G[e][0],G[e][1],G[e][2]),p.push(G[e][0],G[e][1],G[e][2])),m.push(g[e][0],
g[e][1],g[e][2]),z&&(m.push(g[e][0],g[e][1],g[e][2]),m.push(g[e][0],g[e][1],g[e][2]),m.push(g[e][0],g[e][1],g[e][2]));p=new Float32Array(p);m=new Float32Array(m);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}m=[p,m];g=m[0];m=m[1];t.Jj=new Float32Array(g);t.Sz=new Float32Array(m);t.jA=new Float32Array(g.length);t.Tz=new Float32Array(m.length);p=[];C=(C-n)/D;for(G=0;G<D;G++)e=u?C*G+10*C*(.5-l()):C*G,E||(e+=n),p.push(e),z&&(p.push(e),
p.push(e),p.push(e));n=new Float32Array(p);t.An=new Float32Array(n);t.dr=new Float32Array(n);t.$d=new Float32Array(8*n.length);for(u=0;u<8*n.length;u++)for(E=0;8>E;E++)t.$d[8*u+E]=r[E];t.Bu&&c(t,z,g,m,r,g,m);r=x.Gb("EMITTER_PARTICLES");t=x.Xd();t.a_position=g;t.a_normal=m;r.B[0]=t;if(z){a.$f=y.Am;a=[];for(t=0;t<D;t++)a.push(4*t,4*t+2,4*t+1,4*t,4*t+3,4*t+2);a=new Uint16Array(a);r.sa=a;a=r.N;t=[];for(u=0;u<D;u++)t.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);t=new Float32Array(t);a.a_p_bb_vertex=t}else a.$f=y.Vu,
r.sa=new Uint16Array(0);r.R=g.length/3;r.N.a_p_delay=n;a=r.N;t=[];q*=B;for(n=0;n<D;n++)u=q*l(),t.push(B-u),z&&(t.push(B-u),t.push(B-u),t.push(B-u));B=new Float32Array(t);a.a_p_lifetime=B;B=r.N;q=[];for(a=0;a<D;a++){t=[l()-.5,l()-.5,l()-.5];v.normalize(t,t);q.push(w*t[0]);q.push(w*t[1]);q.push(w*t[2]);switch(d){case "NONE":q.push(0);break;case "SPIN":case "VELOCITY":q.push(I);break;case "RAND":q.push(2*I*(l()-.5));break;default:throw"Undefined velocity factor";}if(z)for(t=q.slice(-4),n=0;12>n;n++)q.push(t[n%
4])}D=new Float32Array(q);B.a_p_vels=D;return r};a.KM=function(a,b){for(var g=0;g<b.length;g++){var h=b[g],l=b[g].ua;if(l){var p=h.ca;if(!l.Bu)break;var n=l.jA,C=l.Tz;c(l,!h.Fh,l.Jj,l.Sz,a.f.Ca,n,C);y.QJ(p);y.su(p,"a_position",3,n);y.su(p,"a_normal",3,C)}}};a.CL=function(a,b,c){a=a.ba;for(var g=0;g<a.length;g++)for(var h=a[g].W,l=0;l<h.length;l++){var n=h[l].ua;n&&n.name==b&&(n.lA=n.time,n.time=c)}};a.BK=function(a){for(var b=a.R,c=a.B[0].a_position,g=a.N.a_texcoord,h=[],l=[],n=0;n<b;n++)l.push(c[3*
n]),l.push(c[3*n+1]),h.push(c[3*n+2]);h=new Float32Array(h);l=new Float32Array(l);a.N.a_lf_dist=h;a.N.a_lf_bb_vertex=l;a.N.a_texcoord=g;return a};a.iU=function(a,b,c){a=a.ba;for(var g=0;g<a.length;g++)for(var h=a[g].W,l=0;l<h.length;l++){var n=h[l].ua;n&&n.name==b&&(n.size=c)}};a.WT=function(a,b,c){a=a.ba;for(var g=0;g<a.length;g++)for(var h=a[g].W,l=0;l<h.length;l++){var n=h[l].ua;n&&n.name==b&&(n.Hs=c)}};a.HT=function(a,b,c){a=a.ba;for(var g=0;g<a.length;g++)for(var h=a[g].W,l=0;l<h.length;l++){var n=
h[l],p=n.ua;if(p&&p.name==b){var B=p.An;if(1==c)p=B;else if(0==c)for(var q=!n.Fh,m=q?4:1,p=p.dr,w=0;w<p.length;w+=m)p[w]=1E4,q&&(p[w+1]=p[w],p[w+2]=p[w],p[w+3]=p[w]);else for(var d=1/c,p=p.dr,m=(q=!n.Fh)?4:1,r=0,w=0;w<p.length;w+=m)w>=r?(p[w]=B[w],r+=d):p[w]=1E4,q&&(p[w+1]=p[w],p[w+2]=p[w],p[w+3]=p[w]);y.su(n.ca,"a_p_delay",1,p)}}};a.WM=function(a,b,c){a=a.ba;for(var g=0;g<a.length;g++)for(var h=a[g].W,l=0;l<h.length;l++){var n=h[l].ua;if(n)for(var p=0;p<8*n.An.length;p++)n.$d[8*p]=b[0],n.$d[8*p+
1]=b[1],n.$d[8*p+2]=b[2],n.$d[8*p+3]=b[3],n.$d[8*p+4]=c[0],n.$d[8*p+5]=c[1],n.$d[8*p+6]=c[2],n.$d[8*p+7]=c[3]}}};b4w.module.__geometry=function(a,t){function l(a){return 65536<a.R?q.cy()?!1:!0:!1}function c(a){return 0<a.sa.length?!0:!1}function b(a,b,k){if(!c(a))return a;k||m.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.R*(b||1)+", will use drawArrays","color: #aa0");b=a.sa;k=a.R;var d=a.N,f=a.B,g;for(g in d){var u=d[g],h=F(u,k);d[g]=y(b,u,h)}for(d=0;d<f.length;d++){var q=f[d];for(g in q)u=q[g],h=F(u,k),q[g]=y(b,u,h)}for(d=0;d<a.ga.length;d++){g=a.ga[d].xc;for(var n in g)u=g[n],
h=F(u,k),g[n]=y(b,u,h)}a.R=b.length;a.sa=new Uint16Array(0);return a}function y(a,b,k){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*k),f=0;f<a.length;f++)for(var c=a[f],m=0;m<k;m++)d[k*f+m]=b[k*c+m];return d}function h(a,b){var k=a.pe,d=a.vg[b];if(d)return k.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function r(b,d){var k,f;switch(d){case a.wk:case a.Bm:k=G.TRIANGLES;f=G.STATIC_DRAW;break;case a.Wu:k=G.POINTS;f=G.STATIC_DRAW;
break;case a.Am:k=G.TRIANGLES;f=G.DYNAMIC_DRAW;break;case a.Vu:k=G.POINTS;f=G.DYNAMIC_DRAW;break;case a.RC:k=G.LINES;f=G.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=k;b.nm=f}function x(a){a.Gh?(a.tf||(a.tf=G.createBuffer()),G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,a.tf),G.bufferData(G.ELEMENT_ARRAY_BUFFER,a.Gh,a.nm),a.zn=a.Gh.byteLength):a.zn=0;a.Pg||(a.Pg=G.createBuffer());G.bindBuffer(G.ARRAY_BUFFER,a.Pg);G.bufferData(G.ARRAY_BUFFER,a.pe,a.nm);a.hx=a.pe.byteLength}function v(a){for(var b=
d.Gb("JOIN_"+a.length+"_SUBMESHES"),k=0,f=0;f<a.length;f++)k+=a[f].sa.length;b.sa=new Uint32Array(k);var c=k=0,m=0;if(0<a[0].ga.length)for(var g=0;g<a[0].ga.length;g++){for(f=0;f<a.length;f++)k+=a[f].ga[g].xc.a_position.length,c+=a[f].ga[g].xc.a_normal.length,m+=a[f].ga[g].xc.a_tangent.length;f={a_position:new Float32Array(k),a_normal:new Float32Array(c),a_tangent:new Float32Array(m)};b.ga.push({co:a[0].ga[g].co,xc:f})}for(f=k=0;f<a.length;f++)k+=a[f].R;b.R=k;var c=a[0],u;for(u in c.N){for(f=k=0;f<
a.length;f++)k+=a[f].N[u].length;b.N[u]=new Float32Array(k)}for(u in c.B[0]){for(f=k=0;f<a.length;f++)k+=a[f].B[0][u].length;for(f=0;f<c.B.length;f++)b.B[f]=b.B[f]||{},b.B[f][u]=new Float32Array(k)}for(u=c=k=0;u<a.length;u++){for(var m=a[u],h=m.sa,g=m.R,q=m.N,f=0;f<h.length;f++)b.sa[k+f]=h[f]+c;var k=k+h.length,n;for(n in q){var h=q[n],z=c*F(h,g);b.N[n].set(h,z)}for(f=0;f<m.B.length;f++){var q=m.B[f],l=b.B[f];for(n in q)h=q[n],z=c*F(h,g),l[n].set(h,z)}c+=g}if(0<b.ga.length)for(u=0;u<b.ga.length;u++)for(n=
b.ga[u].xc,f=m=c=k=0;f<a.length;f++)g=a[f].ga[u].xc,n.a_position.set(g.a_position,k),n.a_normal.set(g.a_normal,c),n.a_tangent.set(g.a_tangent,m),k+=g.a_position.length,c+=g.a_normal.length,m+=g.a_tangent.length;return b}function g(a,c,k,g,u,h){var q=d.Gb("SUBMESH_"+a.name+"_"+c),z=a.submeshes[c],l=z.base_length,G=a.materials[c];q.R=l;var w=!1;if(f(k,"a_texcoord")){var E=null,B=a.materials[c];c=a.submeshes[c];if(B.texture_slots.length)switch(B=B.texture_slots[0],B.texture_coords){case "UV":B=a.uv_textures.indexOf(B.uv_layer);
0==B?E=new Float32Array(c.texcoord):1==B&&(E=new Float32Array(c.texcoord2));break;case "ORCO":for(var C=a.b4w_bounding_box_source,E=new Float32Array(2*c.base_length),B=(C.max_x+C.min_x)/2,r=(C.max_z+C.min_z)/2,x=C.max_x-C.min_x,C=C.max_z-C.min_z,F=0,v=0;v<c.position.length;v+=3)E[F++]=(c.position[v]-B)/x+.5,E[F++]=(r-c.position[v+2])/C+.5}null===E&&(E=new Float32Array(2*c.base_length));c=E}else c=new Float32Array(0);if(f(k,"a_orco_tex_coord")){E=a.b4w_bounding_box_source;B=new Float32Array(3*z.base_length);
r=E.max_x-E.min_x;x=E.max_y-E.min_y;C=E.max_z-E.min_z;for(v=F=0;v<z.position.length;v+=3)0==r?B[F++]=.5:B[F++]=d.da(parseFloat(((z.position[v]-E.min_x)/r).toFixed(5)),0,1),0==C?B[F++]=.5:B[F++]=d.da(parseFloat(((E.max_z-z.position[v+2])/C).toFixed(5)),0,1),0==x?B[F++]=.5:B[F++]=d.da(parseFloat(((z.position[v+1]-E.min_y)/x).toFixed(5)),0,1);E=B}else E=new Float32Array(0);var I,B=z.group;if(f(k,"a_influence")&&g){r=new Float32Array(4*l);x=B.length/l;C=new Float32Array(x);for(F=0;F<x;F++)for(I in C[F]=
-1,g)if(v=g[I],v.zC===F){C[F]=v.cr;break}var y=3<x?x:4;g=new Float32Array(y);I=new Uint32Array(y);for(var F=new Float32Array(4),v=new Float32Array(y),y=new Uint32Array(y),t=new Float32Array(4),D=0;D<l;D++)g.set(v),I.set(y),F.set(t),r.set(A(B,x,D,l,C,g,I,F),4*D)}else r=new Float32Array(0);I=r;g=u?d.ra(u):{};g.a_color={Eh:!0};g.a_color.src=f(k,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Nd:7}]:[];u={a_texcoord:c,a_influence:I,a_orco_tex_coord:E};I=z.vertex_colors;c=z.color;E=a.name;B=[];
for(r=0;r<I.length;r++)B.push(I[r].name);for(var H in g)if(r=g[H].src,r.length){for(C=x=0;C<r.length;C++)x+=d.ii(r[C].Nd);u[H]=new Float32Array(x*l);for(C=F=0;C<r.length;C++){var J=r[C].name,v=r[C].Nd,y=d.JA(v),ga=B.indexOf(J);-1==ga&&d.fa('vertex color "'+J+'" for mesh "'+E+'" not found.');t=I[ga].mask;D=d.ii(t);(v&t)!==v&&m.error("Wrong color extraction from "+J+" to "+H+".");for(var V=J=0;V<ga;V++)J+=d.ii(I[V].mask);ga=J*l;for(J=0;J<l;J++)for(V=0;3>V;V++)y[V]&&(u[H][J*x+(F+d.am(v,V))]=c[ga+J*D+
d.am(t,V)]);F+=D}}else u[H]=new Float32Array(0);H=a.uv_textures;g=z.texcoord;I=z.texcoord2;if(h)for(var ha in h){c=H.indexOf(ha);if(0==c)var Z=new Float32Array(g);else 1==c&&(Z=new Float32Array(I));u[h[ha]]=Z}q.N=u;q.sa=new Uint32Array(z.indices);h=z.position.length/l/3;Z=(ha=f(k,"a_normal")&&z.normal.length?!0:!1)&&f(k,"a_tangent")&&z.tangent.length?!0:!1;H=G.texture_slots[0];H=ha&&G.texture_slots.length&&f(k,"a_tangent")&&"ORCO"==H.texture_coords&&H.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&
(w=!0);for(u=0;u<h;u++){G=p(z,k,l,ha,Z,H,u,a.name);if(w)if(g={},g.name=a.b4w_shape_keys[u].name,q.ga.push(g),0!=u){g.xc=G;g.co=a.b4w_shape_keys[u].value;continue}else g.xc=p(z,k,l,ha,Z,H,u,a.name),g.co=1;q.B.push(G)}if(1<h&&!w){a=q.B[0];var G={},W;for(W in a)G[W]=new Float32Array(a[W]);q.B.push(G)}f(k,"a_polyindex")&&(b(q,1,!0),q.N.a_polyindex=n(q));return q}function p(a,b,k,c,g,h,q,n){var z={},l=new Float32Array(3*k),G=new Float32Array(c?3*k:0),w=new Float32Array(g||h?4*k:0),p=q*k*3;l.set(a.position.subarray(p,
p+3*k),0);c&&(p=q*k*3,G.set(a.normal.subarray(p,p+3*k),0));if(g)p=q*k*4,w.set(a.tangent.subarray(p,p+4*k),0);else if(h)for(a=w,m.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+n+'". Please add a UV-map.'),n=0;n<k;n++)b=u,c=E,b[0]=G[3*n],b[1]=G[3*n+1],b[2]=G[3*n+2],I.cross(b,d.se,c),0==I.length(c)&&I.cross(b,d.$e,c),I.normalize(c,c),a[4*n]=c[0],a[4*n+1]=c[1],a[4*n+2]=c[2],a[4*n+3]=1;else if(c&&f(b,"a_tangent"))for(w=new Float32Array(4*k),k=0;k<
w.length;k++)w[k]=1;z.a_position=l;z.a_normal=G;z.a_tangent=w;return z}function f(a,b){return-1<a.indexOf(b)?!0:!1}function A(b,d,k,f,c,m,g,u){for(var h=!0,q=0;q<d;q++){var n=b[q*f+k];if(-1!==n){var z=c[q];-1!==z&&(m[q]=n,g[q]=z,h=!1)}}if(h)return u;H(m,g,a.Rp,!1);for(q=b=0;4>q;q++)b+=m[q];if(.01>b)return u;for(q=0;4>q;q++)m[q]/=b;if(.01>Math.abs(m[0]-1))u[0]=g[0]+1;else for(q=0;4>q;q++)u[q]=g[q]+m[q];return u}function F(a,b){if(0==b)return 0;var k=a.length,d=k/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+
k+", base length="+b;return d}function H(b,d,k,f){for(var c=b.length,m=c,g=!1,u=f?-1:1;1<m||g;){1<m&&(m=Math.floor(m/1.247330950103979));for(var g=!1,h=0;m+h<c;h++)if(k==a.Rp?0>u*(b[h]-b[h+m]):b[h]<b[h+m]&&f)g=b[h],b[h]=b[h+m],b[h+m]=g,g=d[h],d[h]=d[h+m],d[h+m]=g,g=!0}}function J(a,b,k){var d=[],f=[];I.subtract(b,a,d);I.subtract(k,a,f);I.normalize(d,d);I.normalize(f,f);return Math.acos(I.dot(d,f))}function D(a,b,k){b||(b=[]);k=k?a.B[0].a_normal:a.B[0].a_position;if(c(a)){a=a.sa;for(var d=a.length/
3,f=0;f<d;f++){var m=new Float32Array(9),g=a[3*f];m[0]=k[3*g];m[1]=k[3*g+1];m[2]=k[3*g+2];g=a[3*f+1];m[3]=k[3*g];m[4]=k[3*g+1];m[5]=k[3*g+2];g=a[3*f+2];m[6]=k[3*g];m[7]=k[3*g+1];m[8]=k[3*g+2];b[f]=m}}else for(f=0;f<k.length;f++)m=new Float32Array(9),m[0]=k[9*f],m[1]=k[9*f+1],m[2]=k[9*f+2],m[3]=k[9*f+3],m[4]=k[9*f+4],m[5]=k[9*f+5],m[6]=k[9*f+6],m[7]=k[9*f+7],m[8]=k[9*f+8],b[f]=m;return b}function n(a){for(var b=new Float32Array(a.R),k=0;k<a.R;k++)b[k]=k%3;return b}function C(a,b,k){var d=I.dist(a,
b);a=I.dist(a,k);b=I.dist(b,k);k=(d+a+b)/2;return k*(k-d)*(k-a)*(k-b)}function B(a,b,k,d,f){k-=b;for(var c=0;c<k;c+=d)c%d==f&&vec3.normalize(a.subarray(c+b-f,c+b+1),a.subarray(c+b-f,c+b+1))}var q=t("__extensions"),m=t("__print"),w=t("__tsr"),d=t("__util"),I=t("__vec3"),u=new Float32Array(3),E=new Float32Array(3),z=new Float32Array(3);a.bf=10;a.Av=20;a.jP=30;a.Bm=10;a.Wu=20;a.Am=30;a.Vu=40;a.RC=50;a.Rp=0;a.lE=1;a.wk=a.Bm;var G=null;a.oe=function(a){G=a};a.CQ=function(a){var b=_buffers[a];G.deleteBuffer(b.tf);
G.deleteBuffer(b.Pg);delete _buffers[a]};a.jM=function(e,d,k,f){l(e)&&b(e);var m=e.sa,g=e.R,u=e.B,h={},q;for(q in e.N)q in f&&!f[q].Eh||(h[q]=e.N[q]);f={Gh:null,pe:null,Yr:0,count:0,vg:{},mode:0,nm:0,zn:0,hx:0,Pg:null,tf:null,ao:null,ga:null};if(0<e.ga.length){q=u[0];for(var n=1;n<e.ga.length;n++){for(var z=e.ga[n].xc,w=z.a_position,E=z.a_normal,p=q.a_position,B=q.a_normal,C=w.length,A=e.ga[n].co,v=0;v<C;v++)p[v]+=A*w[v],B[v]+=A*E[v];z=z.a_tangent;w=q.a_tangent;E=z.length;for(v=0;v<E;v++)w[v]+=A*
z[v]}}if(m.length)if(q=m.length,65536>=g)var n=new Uint16Array(m),I=G.UNSIGNED_SHORT;else n=new Uint32Array(m),I=G.UNSIGNED_INT;else q=g,n=null;var A=0,v=u.length,y;for(y in u[0])z=u[0][y],A+=z.length*v;for(y in h)z=h[y],A+=z.length;y=new Float32Array(A);var A=0,v={},t;for(t in h)if(w=h[t],z=w.length)y.set(w,A),v[t]={OP:t,Xh:F(w,g),offset:A,frames:1,length:z},A+=z;h=u.length;for(t in u[0])if(w=u[0][t],z=w.length,w=F(w,g),z)for(v[t]={Xh:w,offset:A,frames:h,length:z},1<h&&(v[t+"_next"]={Xh:w,offset:A+
z,frames:h,length:z}),E=0;E<h;E++)w=u[E][t],y.set(w,A),A+=z;f.count=q;f.Gh=n;f.pe=y;f.Yr=I;f.vg=v;r(f,k);x(f);d!=a.bf&&c(e)&&(f.ao={$J:new Float32Array(m.length),aK:new Float32Array(m.length),dH:new Float32Array(m.length/3),type:d});f.ga=e.ga;return f};a.hJ=l;a.fJ=c;a.np=b;a.LU=function(a,b,k){r(a,b);a.count=k.length;a.Gh=k;a.Yr=k instanceof Uint16Array?G.UNSIGNED_SHORT:G.UNSIGNED_INT;return a};a.su=function(a,b,k,f){var c=a.pe,m=a.vg,g=m[b];g?(k&&g.Xh!=k&&d.fa('invalid num_comp for "'+b+'"'),c.set(f,
g.offset)):(c=c.length,g=new Float32Array(c+f.length),g.set(a.pe),g.set(f,c),a.pe=g,m[b]={Xh:k,offset:c});x(a)};a.QQ=h;a.OS=function(a){a.nm=G.STATIC_DRAW};a.QJ=function(a){a.nm=G.DYNAMIC_DRAW};a.MM=x;a.Cw=function(a){a.tf&&G.deleteBuffer(a.tf);a.Pg&&G.deleteBuffer(a.Pg)};a.az=function(a,b){return a.submeshes[b].base_length?!1:!0};a.QB=function(a,b){for(var k=0;k<a.B.length;k++){var d=a.B[k].a_position;w.hk(d,b,d,0);d=a.B[k].a_normal;0<d.length&&w.rp(d,b,d,0);d=a.B[k].a_tangent;0<d.length&&w.sp(d,
b,d,0)}(k=a.N.au_center_pos)&&k.length&&w.hk(k,b,k,0);return a};a.hM=function(a,b){var k=a.N.au_center_pos;if(k&&k.length){var d=new Float32Array(k);w.hk(d,b,d,0);for(var f=0;f<a.B.length;f++)for(var c=0;c<d.length;c++)a.B[f].a_position[c]+=d[c]-k[c];k.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.gM=function(a,b){var k=a.R,d;for(d in b){var f=b[d].length;a.N[d]=new Float32Array(f*k);for(var c=0;c<k;c++)for(var m=0;m<f;m++)a.N[d][c*f+m]=b[d][m]}};a.iM=v;a.PJ=function(a,
f,k){if(!a.R)return d.Gb("EMPTY");var c=k.length;65536<a.R*c&&!q.cy()&&b(a,c);var m=a.sa,g=a.R,u=a.N;a=a.B;for(var h in f){var n=f[h].length,z=n*g;u[h]=new Float32Array(z);for(var l=0;l<g;l++)for(z=0;z<n;z++)u[h][l*n+z]=f[h][z]}f=d.Gb("CLONE_"+c+"_SUBMESHES");f.R=g*c;f.sa=new Uint32Array(m.length*c);for(l=0;l<c;l++)for(n=m.length*l,h=g*l,z=0;z<m.length;z++)f.sa[n+z]=m[z]+h;for(var G in u)for(m=u[G],z=m.length*c,n=F(m,g),f.N[G]=new Float32Array(z),l=0;l<c;l++)h=g*n*l,f.N[G].set(m,h);for(G in a[0])for(l=
0;l<a.length;l++)for(m=a[l][G],z=m.length*c,n=F(m,g),f.B[l]=f.B[l]||{},f.B[l][G]=new Float32Array(z),z=0;z<c;z++)switch(u=k[z],h=g*n*z,G){case "a_position":w.hk(m,u,f.B[l][G],h);break;case "a_normal":w.rp(m,u,f.B[l][G],h);break;case "a_tangent":w.sp(m,u,f.B[l][G],h);break;default:throw"Wrong attribute name: "+G;}return f};a.wx=g;a.vH=function(a){var b=a.R,k=a.B[0].a_position,f=new Float32Array(12*b),c=new Float32Array(8*b);a=new Uint16Array(4*a.sa.length);for(var m=0;m<b;m++)f[12*m]=k[3*m],f[12*m+
1]=k[3*m+1],f[12*m+2]=k[3*m+2],f[12*m+3]=k[3*m],f[12*m+4]=k[3*m+1],f[12*m+5]=k[3*m+2],f[12*m+6]=k[3*m],f[12*m+7]=k[3*m+1],f[12*m+8]=k[3*m+2],f[12*m+9]=k[3*m],f[12*m+10]=k[3*m+1],f[12*m+11]=k[3*m+2],c[8*m]=-.5,c[8*m+1]=-.5,c[8*m+2]=-.5,c[8*m+3]=.5,c[8*m+4]=.5,c[8*m+5]=.5,c[8*m+6]=.5,c[8*m+7]=-.5,a[6*m]=4*m+2,a[6*m+1]=4*m+1,a[6*m+2]=4*m,a[6*m+3]=4*m+2,a[6*m+4]=4*m,a[6*m+5]=4*m+3;k=d.Gb("HALO");k.B=[];k.B[0]={};k.R=4*b;k.B[0].a_position=f;k.N.a_halo_bb_vertex=c;k.sa=a;return k};a.KI=f;a.xx=function(a,
b,k){for(var f=[],c=0;c<a.submeshes.length;c++){var m=g(a,c,b,null,k,null);m.R&&f.push(m)}return 0==f.length?d.Gb("EMPTY"):1==f.length?f[0]:v(f)};a.GM=function(a,b,k){for(var f=a.Gh,c=h(a,"a_position"),m=a.ao,g=m.$J,u=m.aK,m=m.dH,q=f,n=q.length/3,z=0;z<n;z++){var l=q[3*z],w=q[3*z+1],E=q[3*z+2],p=c[3*l+1],B=c[3*l+2],C=c[3*w+1],r=c[3*w+2],x=c[3*E+1],A=c[3*E+2];g[3*z]=(c[3*l]+c[3*w]+c[3*E])/3;g[3*z+1]=(p+C+x)/3;g[3*z+2]=(B+r+A)/3}d.wg(g,b,u);b=u.length/3;for(c=0;c<b;c++)g=u[3*c]-k[0],q=u[3*c+1]-k[1],
n=u[3*c+2]-k[2],m[c]=g*g+q*q+n*n;k=f;f=m.length;if(!(2>f))for(u=f,c=!1;1<u||c;)for(1<u&&(u=Math.floor(u/1.247330950103979)),c=!1,b=0;u+b<f;b++)0>m[b]-m[b+u]&&(c=m[b],m[b]=m[b+u],m[b+u]=c,c=k,g=b,q=b+u,n=c[3*g],z=c[3*g+1],l=c[3*g+2],c[3*g]=c[3*q],c[3*g+1]=c[3*q+1],c[3*g+2]=c[3*q+2],c[3*q]=n,c[3*q+1]=z,c[3*q+2]=l,c=!0);f=k;G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,a.tf);G.bufferData(G.ELEMENT_ARRAY_BUFFER,f,G.DYNAMIC_DRAW)};a.FB=H;a.vF=function(a,b,k){for(var d=b.length/3,f=a.length/3,c=[],m=Array(3),g=Array(3),
u=Array(3),h=0;h<f;h++){for(var q=a[3*h],n=a[3*h+1],z=a[3*h+2],l=0;3>l;l++)m[l]=b[3*q+l],g[l]=b[3*n+l],u[l]=b[3*z+l];if(k)var l=J(m,g,u),G=J(g,u,m),w=Math.PI-l-G;else w=G=l=1;var E=c,p;p=m;var B=u,C=[],r=[],x=[];I.subtract(g,p,C);I.subtract(B,p,r);I.cross(C,r,x);I.normalize(x,x);p=x;for(B=0;3>B;B++)C=3*n+B,r=3*z+B,E[3*q+B]=l*p[B],E[C]=G*p[B],E[r]=w*p[B]}if(k)for(var A in k)for(h=k[A],a=0;3>a;a++){b=3*h[0]+a;for(f=1;f<h.length;f++)m=3*h[f]+a,c[b]+=c[m];for(f=1;f<h.length;f++)m=3*h[f]+a,c[m]=c[b]}for(h=
0;h<d;h++){k=h;A=c;a=new Float32Array(3);for(b=0;3>b;b++)f=3*k+b,a[b]=A[f];I.normalize(a,a);for(b=0;3>b;b++)f=3*k+b,A[f]=a[b]}return c};a.xF=function(a,b,k){for(var d={},f=b.length/3,c=0;c<f;c++){var m=String(b[3*c])+String(b[3*c+1])+String(b[3*c+2]);d[m]=[]}f=a.length;for(c=0;c<f;c++)b=a[c],m=String(k[3*b])+String(k[3*b+1])+String(k[3*b+2]),m in d&&d[m].push(b);return d};a.Ar=function(a,b,k,f){var c=D(a,null,!1);if(k)var m=D(a,null,!0);var g=c.length,h=new Float32Array(g),q=u,n=E;for(a=0;a<g;a++){var l=
c[a];q.set(l.subarray(0,3));n.set(l.subarray(3,6));z.set(l.subarray(6));h[a]=Math.sqrt(C(q,n,z))}q=new Float32Array(g);q[0]=h[0];for(a=1;a<g;a++)q[a]=q[a-1]+h[a];g=q[h.length-1];h=[];for(a=0;a<b;a++){var n=g*d.Pd(f),n=d.cn(q,n,0,q.length-1),l=k?m[n]:c[n],n=a,G=l,w=f,l=void 0,l=new Float32Array(3),p=G[0],B=G[1],r=G[2],x=G[3],A=G[4],F=G[5],v=G[6],I=G[7],y=G[8],G=d.Pd(w),w=d.Pd(w);1<G+w&&(G=1-G,w=1-w);var t=1-G-w,B=t*B+G*A+w*I,r=t*r+G*F+w*y;l[0]=t*p+G*x+w*v;l[1]=B;l[2]=r;h[n]=l}return h};a.RQ=D;a.rr=
n;a.GU=C;a.LA=function(a,b,k){a=a.B[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-k[0])*b[0]+k[0],a[d+1]=(a[d+1]-k[1])*b[1]+k[1],a[d+2]=(a[d+2]-k[2])*b[2]+k[2]};a.XE=function(a,b,k){var d=a.ba[0].W;a=a.f.Bg;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=k);for(f=0;f<d.length;f++)if(!d[f].Bh&&d[f].Xe&&!d[f].th){k=d[f].ca.vg;b=d[f].ca.pe;G.bindBuffer(G.ARRAY_BUFFER,d[f].ca.Pg);var c=k.a_position,m=d[f],g=b,u=a;if(c){for(var h=c.offset,c=c.length+h,q=m.ca.ga[0].xc.a_position,n=h;n<c;n++)g[n]=
q[n-h];for(n=1;n<m.ca.ga.length;n++){var q=m.ca.ga[n].xc.a_position,z=u[n].value;if(z)for(var l=h;l<c;l++)g[l]+=z*q[l-h]}G.bufferSubData(G.ARRAY_BUFFER,4*h,g.subarray(h))}c=k.a_normal;m=d[f];g=b;u=a;if(c){h=c.offset;c=c.length+h;q=m.ca.ga[0].xc.a_normal;for(n=h;n<c;n++)g[n]=q[n-h];for(n=1;n<m.ca.ga.length;n++)if(q=m.ca.ga[n].xc.a_normal,z=u[n].value)for(l=h;l<c;l++)g[l]+=z*q[l-h];B(g,h,c,3,2);G.bufferSubData(G.ARRAY_BUFFER,4*h,g.subarray(h))}u=k.a_tangent;k=d[f];m=a;if(u){g=u.offset;u=u.length+g;
c=k.ca.ga[0].xc.a_tangent;for(h=g;h<u;h++)b[h]=c[h-g];for(h=1;h<k.ca.ga.length;h++)if(c=k.ca.ga[h].xc.a_tangent,n=m[h].value)for(q=g;q<u;q++)b[q]+=n*c[q-g];B(b,g,u,4,3);G.bufferSubData(G.ARRAY_BUFFER,4*g,b.subarray(g))}}};a.UF=function(a){return a.f.Xe};a.TR=function(a){var b=[];if(a.f)for(var k=1;k<a.f.Bg.length;k++)b.push(a.f.Bg[k].name);return b};a.SR=function(a,b){if(a.f)for(var k=1;k<a.f.Bg.length;k++)if(b==a.f.Bg[k].name)return a.f.Bg[k].value;return 0};a.OI=function(a,b){var k=a.f.Bg;if(k)for(var d=
1;d<k.length;d++)if(k[d].name==b)return!0;return!1};a.jS=function(a){return a&&a.f&&a.f.Ge?!0:!1}};b4w.module.__extensions=function(a,t){function l(a){if(a in y)return y[a];var l=b.getExtension(a)||null;y[a]=l;c.log("%cGET EXTENSION","color: #"+(l?"0a0":"a00"),a);return l}var c=t("__print"),b=null,y={};a.oe=function(a){b=a};a.zy=function(){return l("WEBGL_compressed_texture_s3tc")||l("WEBKIT_WEBGL_compressed_texture_s3tc")||l("MOZ_WEBGL_compressed_texture_s3tc")};a.hI=function(){return l("WEBGL_depth_texture")||l("WEBKIT_WEBGL_depth_texture")||l("MOZ_WEBGL_depth_texture")};a.YH=function(){return l("EXT_texture_filter_anisotropic")||
l("WEBKIT_EXT_texture_filter_anisotropic")||l("MOZ_EXT_texture_filter_anisotropic")};a.$x=function(){return l("WEBGL_debug_shaders")};a.xy=function(){return l("WEBGL_debug_renderer_info")};a.cy=function(){return l("OES_element_index_uint")};a.AI=function(){return l("OES_standard_derivatives")};a.Y=function(){y={}}};b4w.module.__scenes=function(a,t){function l(a){for(var b=0;b<a.length;b++){var e=a[b];if(!e.ve||!e.ve.length)return e}return null}function c(){if(!Gb)throw"No active scene available";return Gb}function b(a,e,k){for(var d=0;d<a.length;d++){var f=a[d];"ALL"!=e&&e!=f.type||k.push(f);(f=f.dupli_group)&&b(f.objects,e,k)}}function y(a,b,e){if(!xa.Wk||!h(a,b,e))return null;a=a.b4w_shadow_settings;e={};a.csm_resolution>xa.kc?(e.csm_resolution=xa.kc,va.error("Shadow map texture has unsupported size. Changed to "+
xa.kc+".")):e.csm_resolution=a.csm_resolution;e.self_shadow_polygon_offset=a.self_shadow_polygon_offset;e.self_shadow_normal_offset=a.self_shadow_normal_offset;e.enable_csm=a.b4w_enable_csm;if(b=Na.Jr(b)||b[0])e.Mh=b.jc.type,e.Hg=b.jc.Hg,e.distance=b.jc.distance,"SPOT"!=e.Mh&&"POINT"!=e.Mh||!e.enable_csm||(va.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),e.enable_csm=!1);e.enable_csm?(e.csm_num=a.csm_num,e.csm_first_cascade_border=a.csm_first_cascade_border,e.first_cascade_blur_radius=
a.first_cascade_blur_radius,e.csm_last_cascade_border=a.csm_last_cascade_border,e.last_cascade_blur_radius=a.last_cascade_blur_radius,e.fade_last_cascade=a.fade_last_cascade,e.blend_between_cascades=a.blend_between_cascades):(e.csm_num=1,e.csm_first_cascade_border=a.csm_first_cascade_border,e.first_cascade_blur_radius=a.first_cascade_blur_radius,e.csm_last_cascade_border=a.csm_last_cascade_border,e.last_cascade_blur_radius=a.last_cascade_blur_radius,e.fade_last_cascade=!1,e.blend_between_cascades=
!1);return e}function h(a,b,e){if(xa.Qj)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var k=!1,d=!1;a=xa.Re&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<e.length;b++){var f=e[b].La;f.b4w_shadow_cast&&(k=!0);f.b4w_shadow_receive&&(d=!0);if((a||k)&&d)return!0}return!1}function r(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].jc.type)return!0;return!1}function x(a){if(!xa.Cg)return!1;a=ca(a);for(var b=0;b<a.length;b++){var e=a[b];if(e.b4w_water&&e.b4w_water_shore_smoothing)return!0}return!1}
function v(a){for(var b=0;b<a.length;b++)for(var e=a[b].La.particle_systems,k=0;k<e.length;k++){var d=e[k].settings;if(d.b4w_enable_soft_particles&&0<d.b4w_particles_softness)return!0}return!1}function g(a){for(var b=ca(a),e=[],k=0;k<b.length;k++){var d=b[k];if(d.b4w_water){for(var f={},c=0;c<a.length;c++)for(var m=a[c].La,g=m.data.materials,u=0;u<g.length;u++)g[u]==d&&(f.Tg=m.location[1]);f.wc=d.b4w_water_fog_color.slice(0);f.wc.push(d.b4w_water_fog_density);d.b4w_water_dynamic?(f.bl=!0,f.waves_height=
d.b4w_waves_height,f.waves_length=d.b4w_waves_length,f.dst_noise_scale0=d.b4w_water_dst_noise_scale0,f.dst_noise_scale1=d.b4w_water_dst_noise_scale1,f.dst_noise_freq0=d.b4w_water_dst_noise_freq0,f.dst_noise_freq1=d.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=d.b4w_water_dir_min_shore_fac,f.dir_freq=d.b4w_water_dir_freq,f.dir_noise_scale=d.b4w_water_dir_noise_scale,f.dir_noise_freq=d.b4w_water_dir_noise_freq,f.dir_min_noise_fac=d.b4w_water_dir_min_noise_fac,f.dst_min_fac=d.b4w_water_dst_min_fac,
f.waves_hor_fac=d.b4w_water_waves_hor_fac):(f.bl=!1,f.waves_height=0,f.waves_length=0);f.gf=d.b4w_water_enable_caust;f.DF=d.b4w_water_caust_scale;f.CF=d.b4w_water_caust_brightness;f.EF=new Float32Array([.3,.7]);f.hp=null;d=d.texture_slots;for(c=0;c<d.length;c++)m=d[c].texture,!0===m.b4w_shore_dist_map&&(f.hp=m.image,f.Rj=m.image.size[0],f.ML=m.b4w_shore_boundings,f.vj=m.b4w_max_shore_dist);e.push(f)}}if(0<e.length){f=e[0];if(!f.bl)for(k=0;k<e.length;k++)e[k].bl&&(f=e[k]);return f}return null}function p(a){function b(a){if(a){a=
a.nodes;for(var k=0;k<a.length;k++){var d=a[k];"GROUP"==d.type&&d.node_group&&b(d.node_group.node_tree);"GROUP"==d.type&&"B4W_REFRACTION"==d.node_tree_name&&(e.Dc=!0)}}}var e={Dc:!1};a=ca(a);for(var k=0;k<a.length;k++){var d=a[k];d.b4w_refractive&&(e.Dc=!0);d.node_tree&&b(d.node_tree)}return e}function f(a,b){if(xa.Xl)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;for(var e=[],k=0,d=0;d<b.length;d++){var f=b[d];f.f.Tc&&"CUBE"==f.f.Ne&&k++;if(f.Yl.length){for(var c=null,m=0;m<e.length;m++)if(e[m]==
f){c=m;break}null==c&&e.push(f)}}return{BA:e,Vz:k,Yf:[],ug:[]}}function A(a,b){var e=a.b4w_sky_settings,k={};k.QK=e.render_sky;k.procedural_skydome=e.procedural_skydome&&b;k.use_as_environment_lighting=e.use_as_environment_lighting;k.Sj=e.color;k.rayleigh_brightness=e.rayleigh_brightness;k.mie_brightness=e.mie_brightness;k.spot_brightness=e.spot_brightness;k.scatter_strength=e.scatter_strength;k.rayleigh_strength=e.rayleigh_strength;k.mie_strength=e.mie_strength;k.rayleigh_collection_power=e.rayleigh_collection_power;
k.mie_collection_power=e.mie_collection_power;k.mie_distribution=e.mie_distribution;k.Cc=e.reflexible;k.nc=e.reflexible_only;!b&&e.procedural_skydome&&va.warn("There is no sun on the scene. Procedural sky won't be rendered");return k}function F(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.QI=a.hemisphere;b.pF=a.blur_depth;b.iw=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.cL=a.samples;return b}function H(a){if(!(xa.dn&&a.b4w_enable_bloom&&a.k.ni))return null;
var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.hH=a.edge_lum;b.key=a.key;return b}function J(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function D(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function n(a){var b={};a=a.b4w_god_rays_settings;b.cs=a.intensity;b.uj=a.max_ray_length;b.bk=a.steps_per_pass;return b}
function C(a){var b={};b.Af=a.b4w_outline_color;b.Ll=a.b4w_outline_factor;return b}function B(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function q(a,b){var e=a.light_settings,k={};k.ag=e.environment_energy;k.zu=e.use_environment_light;k.mr=e.environment_color;k.ig=a.horizon_color.slice(0);k.Wg=a.zenith_color.slice(0);
k.mN=a.use_sky_paper;k.lN=a.use_sky_blend;k.nN=a.use_sky_real;k.CB=null;k.Nt=null;k.nr=null;if(k.zu&&"SKY_TEXTURE"==k.mr&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,d=0;d<a.texture_slots.length;d++)if(a.texture_slots[d].texture.b4w_use_as_environment_lighting){e=a.texture_slots[d];break}e?k.nr=e:(va.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),k.zu=!1)}for(d=0;d<a.texture_slots.length;d++)if(a.texture_slots[d].texture.b4w_use_as_skydome){e=
a.texture_slots[d];k.CB=e;k.Nt={mF:e.blend_factor,RI:e.horizon_factor,GN:e.zenith_up_factor,FN:e.zenith_down_factor,color:e.color,Pa:e.default_value,invert:e.invert,kN:e.use_rgb_to_intensity,nF:e.blend_type,gN:e.use_map_blend,hN:e.use_map_horizon,jN:e.use_map_zenith_up,iN:e.use_map_zenith_down};break}return k}function m(a){var b=a.fog_settings,e={};e.cN=b.use_fog;e.cs=b.intensity;e.depth=b.depth;e.start=b.start;e.height=b.height;e.yH=b.falloff;e.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);
a=e.color;e.wc=new Float32Array([a[0],a[1],a[2],1/e.depth]);e.Ln=new Float32Array([e.cs,e.depth,e.start,e.height]);return e}function w(a){if(!xa.Rb)return!1;for(var b=!1,e=!1,k=0;k<a.length;k++){for(var d=a[k].La,f=d.data.materials,c=0;c<f.length;c++)f[c].b4w_terrain&&(b=!0);d=d.particle_systems;for(c=0;c<d.length;c++)f=d[c].settings,"HAIR"==f.type&&f.b4w_dynamic_grass&&(e=!0);if(b&&e)return!0}return!1}function d(a,b){if(tc.outlining_overview_mode)return!0;if(xa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var e=0;e<b.length;e++)if(b[e].f.Ef)return!0;return!1}else return!1}function I(a,b){if(tc.outlining_overview_mode)return!0;if(xa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var e=0;e<b.length;e++)if(b[e].f.Db)return!0;return!1}else return!1}function u(a,b){if(xa.sf)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var e=0;e<b.length;e++)for(var k=b[e].La.data.materials,
d=0;d<k.length;d++)if(kb.yw(k[d]))return!0;return!1}else return!1}function E(a,b){if(xa.Dc)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.Dc}else return!1}function z(a){for(var b=0;b<a.length;b++)for(var e=a[b].La.data.materials,k=0;k<e.length;k++){var d=e[k],f=d.game_settings.alpha_blend;if(d.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function G(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0}for(var e=
0;e<b.length;e++){var k=b[e];if(k.anchor&&k.anchor.Ti)return!0}return!1}function e(a,b,e){var k=qa.Vh(a,b);qa.Kf(a,k,function(a,b,k){if(k.mb){switch(k.from){case "COLOR":case "CUBEMAP":a=b.j.Cb;break;case "DEPTH":a=b.j.Gd;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(k.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!a)throw"Connection of SCREEN is forbidden";
if(a.Sg)throw"Batch texture can't use renderbuffer";ma.Aw(e.Ec,k.to)&&W.Hi(e,a,k.to)}}});for(a=0;a<b.va.length;a++){var k=b.va[a],d=b.Ue[a];switch(k.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(d.Sg)throw"Batch texture can't use renderbuffer";ma.Aw(e.Ec,k.to)&&W.Hi(e,d,k.to)}}}function K(a,b){return{yb:!0,ir:[!0,!0,!0,!0,!0,!0],he:a,C:b}}function k(a,b,k,d,f,c){function m(a,b){return a==b?0:a>b?1:-1}for(var g=b.f,u=Na.Qa(b,f).W,h=0;h<u.length;h++){var q=
u[h];q.Uc||q.nc||"MAIN"!=q.type&&"NODES_GLOW"!=q.type&&"PARTICLES"!=q.type||!("OPAQUE"==q.$a&&"OPAQUE"==d||"BLEND"==q.$a&&"BLEND"==d||"XRAY"==q.$a&&"XRAY"==d||"NODES_GLOW"==q.type&&"GLOW"==d)||(c||(M(q,a,b,k,d,f),W.Vb(q),Q(q)),a.p.push(K(g,q)),e(k,a,q),aa(q))}a.p.sort(function(a,b){return a.C&&b.C?-m(a.C.Ma,b.C.Ma)||-m(a.C.dh,b.C.dh)||m(a.C.Yh,b.C.Yh):0})}function M(a,b,e,k,d,f){var c=e.f,m=Na.Qa(e,f),g="NO_SHADOWS";if((e=pa.Ya(k,"SHADOW_CAST"))&&a.Vc){switch(d){case "OPAQUE":g="SHADOW_MAPPING_OPAQUE";
break;case "BLEND":case "XRAY":g="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":g="NO_SHADOWS";break;case "DEPTH":g="SHADOW_MASK_GENERATION";break;default:throw"Wrong subscene type";}W.Vv(a,f.k.rc,e)}e=a.ib;ma.I(e,"SHADOW_USAGE",g);a.Rb&&(g=pa.Ya(k,"GRASS_MAP"))&&U(a,g,c);if("DEPTH"!=a.type&&"COLOR_ID"!=d||a.ij)if(d=b.Hl,ma.I(e,"NUM_LIGHTS",d),ma.I(e,"NUM_LFACTORS",0==d%2?d/2:Math.floor(d/2)+1),"special_skydome.glslf"==ma.iy(e)&&ma.I(e,"REFLECTION_PASS",0),ma.I(e,"SSAO_ONLY",
0),b.Bb&&b.re?ma.I(e,"WATER_EFFECTS",1):ma.I(e,"WATER_EFFECTS",0),b.Bb&&b.gf&&c.gf?(ma.I(e,"CAUSTICS",1),ma.I(e,"CAUST_SCALE",ma.M(b.ow)),ma.I(e,"CAUST_SPEED",ma.M(b.pw,2)),ma.I(e,"CAUST_BRIGHT",ma.M(b.nw))):ma.I(e,"CAUSTICS",0),b.Bb&&(ma.I(e,"WAVES_HEIGHT",ma.M(b.Ug)),ma.I(e,"WAVES_LENGTH",ma.M(b.yi)),ma.I(e,"WATER_LEVEL",ma.M(b.Tg))),c=m.Yf,m=m.ug,-1!==a.ac.indexOf("u_mirrormap")?ma.I(e,"REFLECTION_TYPE","REFL_MIRRORMAP"):a.Tc&&c?(c=c.j.Cb,W.Hi(a,c,"u_cube_reflection"),ma.I(e,"REFLECTION_TYPE",
"REFL_CUBE")):a.Tc&&m?(c=m.j.Cb,W.Hi(a,c,"u_plane_reflection"),ma.I(e,"REFLECTION_TYPE","REFL_PLANE")):ma.I(e,"REFLECTION_TYPE","REFL_NONE"),(m=pa.Ya(k,"SKY"))?a.nA?(c=m.j.Cb,W.Hi(a,c,"u_sky")):xa.Io?(a.dd=m.dd,ma.I(e,"PROCEDURAL_FOG",1)):ma.I(e,"PROCEDURAL_FOG",0):ma.I(e,"PROCEDURAL_FOG",0),c=f.k.Nu,c.zu&&(ma.I(e,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==c.mr?(c=c.nr?W.$H(c.nr,!1):m.j.Cb,ma.I(e,"SKY_TEXTURE",1),W.Hi(a,c,"u_sky_texture")):"SKY_COLOR"==c.mr&&ma.I(e,"SKY_COLOR",1)),c=f.k.LC,c.cN&&(ma.I(e,
"USE_FOG",1),ma.I(e,"FOG_TYPE",c.yH)),a.ft?(xa.Wk&&ma.I(e,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ij||"NODES_GLOW"==a.type?(ma.I(e,"REFRACTIVE",1),f.k.Dc?ma.I(e,"USE_REFRACTION",1):ma.I(e,"USE_REFRACTION",0)):f.k.Dc?ma.I(e,"REFRACTIVE",1):ma.I(e,"REFRACTIVE",0)):(ma.I(e,"REFRACTIVE",0),ma.I(e,"USE_REFRACTION",0),ma.I(e,"USE_REFRACTION_CORRECTION",0)),a.vi&&(xa.Cg&&a.Ju&&pa.Ya(k,"DEPTH")?ma.I(e,"SHORE_SMOOTHING",1):ma.I(e,"SHORE_SMOOTHING",0),a.water_dynamic&&b.Bb&&b.Ug?ma.I(e,"DYNAMIC",1):
ma.I(e,"DYNAMIC",0)),"PARTICLES"==a.type&&(ma.I(e,"SIZE_RAMP_LENGTH",a.ua.xB),ma.I(e,"COLOR_RAMP_LENGTH",a.ua.Jw)),!a.Bh)for(a=a.T,b=0;b<a.length;b++)if(c=a[b],"SCENE"==c.source)for(k=0;k<Va.length;k++)for(e=Va[k],m=Va[k].ve,d=0;d<m.length;d++)m[d].k==c&&qa.n(Xb,e,f,null)}function Q(a){var b=a.Ec.attributes,e=a.ca.vg,k;for(k in b)e[k]||Fa.fa('missing data for "'+k+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(b=ma.DI(a.Ec.Iu),10<b&&("MAIN"==a.type&&va.warn("Varying limit exceeded for main shader - "+
b+', materials: "'+a.xf.join(", ")+'"'),"MAIN"==a.type&&a.ij||"NODES_GLOW"==a.type))k=e=0,a.si&&(e=Fa.rl(a.si)),a.Nb&&(k=Fa.rl(a.Nb)),va.warn("Varying limit exceeded for node shader - "+b+", uv: "+e+", vc: "+k+', materials: "'+a.xf.join(", ")+'"')}function aa(a){8<a.T.length&&va.warn(a.type,"too many textures used - "+a.T.length+' (max 8), materials "'+a.xf.join(", ")+'"')}function U(a,b,e){a.Jc=b.Jc;var k=b.Jc[0],d=b.Jc[1],f=b.Jc[2];e=e.Yb;e=Math.max(e.max_x-e.min_x,e.max_z-e.min_z);f=0==f?e:Math.max(f,
e);b.Jc[2]=f;b=b.j;L.Xo(b,f/2,-d,-k,f/2);L.zg(b);k=a.Pr||0;k=0==k?e:Math.max(k,e);a.Pr=k}function ba(a){var b=R(a,"MAIN_OPAQUE"),e=!0,k=a.k.rc;qa.V(a.k.zb,function(a,d){"SHADOW_CAST"===d.type&&(ea(d,b.j,d.p,k,e),e=!1)})}function T(a){qa.V(a.k.zb,function(a,b){"OUTLINE"===b.type&&(b.jr=1)})}function ea(a,b,e,k,d){if(0!=e.length){var f=a.j;gb.copy(b.cg,f.cg);Ra.copy(b.Ba,f.uB);if("SUN"===k.Mh||"HEMI"===k.Mh){var c=Pb;ja.Qd(c);for(var m=0;m<e.length;m++){var g=e[m].he;0==m?ja.qn(g.wb,c):ja.tx(c,g.wb)}e=
ja.tH(c,Kc);Fa.wg(e,f.Ba,e);if(k.enable_csm){k=gb.copy(b.Sk[a.Tq],wc);c=Ra.invert(b.Ba,nc);Fa.wg(k,c,k);Fa.wg(k,f.Ba,k);a=b.Uq[a.Tq];if(d)for(xc=0,gc=-Infinity,d=2;d<e.length;d+=3)xc=Math.min(xc,e[d]),gc=Math.max(gc,e[d]);d=Pb;d.max_x=k[0]+a;d.max_y=k[1]+a;d.max_z=gc;d.min_x=k[0]-a;d.min_y=k[1]-a;d.min_z=xc}else{a=d=Pb;b=Lc;b.set(e);e=Uc/9;k=Ra.identity(nc);Ra.rotate(k,e,Fa.Xg,k);m=c=-1;for(g=0;10>g;g++){var u=ja.kF(b,Qb),h=(u.max_x-u.min_x)*(u.max_y-u.min_y);if(-1==c||h<c)c=h,m=g,ja.qn(u,a);Fa.wg(b,
k,b)}e*=m;0<e&&(a=Ra.identity(nc),Ra.rotate(a,e,Fa.Xg,a),Ra.multiply(a,f.Ba,f.Ba));e=d.max_x-d.min_x;a=d.max_y-d.min_y;e&&a&&(b=Math.abs(e-a)/2,2<e/a?(d.max_y+=b,d.min_y-=b):2<a/e&&(d.max_x+=b,d.min_x-=b));d.max_x+=.005;d.max_y+=.005;d.max_z+=.005;d.min_x-=.005;d.min_y-=.005;d.min_z-=.005}L.pL(f,d.min_x,d.max_x,d.min_y,d.max_y,-d.max_z,-d.min_z);L.zg(f);Fa.Hn(f.qe,f.ml)}else"SPOT"!==k.Mh&&"POINT"!==k.Mh||L.zg(f,f.Ia)}}function P(a,b,e,k,d){for(var f=b.f,c=Na.Qa(b,k).W,m=0;m<c.length;m++){var g=c[m];
"COLOR_ID"==g.type&&(d||(M(g,a,b,e,"COLOR_ID",k),W.Vb(g),Q(g)),"COLOR_PICKING"==a.type&&"COLOR_ID"==g.$a||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==g.$a)&&(d||(W.ne(g,"USE_OUTLINE",0),W.Vb(g),Q(g)),a.p.push(K(f,g)))}}function S(a,b,k,d,f){d||(f.Rb&&(d=pa.Ya(k,"GRASS_MAP"))&&U(f,d,b),W.Vb(f),Q(f));a.p.push(K(b,f));e(k,a,f);aa(f)}function da(a,b){for(var e=fa(b,lc),k=a.jc,d=a.f,f=Na.Qa(a,b),c=f.El,m=0;m<e.length;m++){var g=e[m];g.po.set(d.i,3*c);g.rs.set(k.direction,3*c);g.qs.set(k.nn,3*c);switch(k.type){case "SUN":g.TB.set(d.quat);
g.SB=k.nn;"SKY"===g.type?(g.vo=k.Lz,gb.copy(k.direction,g.Zt),ka(b,g)):gb.copy(k.direction,g.Zt);break;case "HEMI":case "POINT":case "SPOT":break;default:va.error("Unknown light type: "+k.type+'".')}var u=Hb;u[0]=k.lk?1:0;u[1]=k.ri?1:0;g.ss.set(u,2*c);g.ya=!0;for(u=0;u<g.p.length;u++){var h=g.p[u].C;h.qj&&W.rL(h,a)}}e=R(b,"MAIN_OPAQUE").j;f=f.vB;k=b.k.rc;for(m=0;m<f.length;m++)g=f[m],L.oB(g.j,d.i,d.quat),ea(g,e,g.p,k,!0)}function ka(a,b){Vb.al(b);if(b.vo)for(var e=fa(a,["MAIN_OPAQUE","MAIN_BLEND",
"MAIN_XRAY","MAIN_GLOW"]),k=0;k<e.length;k++)for(var d=e[k].p,f=0;f<d.length;f++){var c=d[f];c.yb&&(c=c.C,W.IF(c)&&Vb.DM(c))}}function ca(a){for(var b=[],e=0;e<a.length;e++)for(var k=a[e].La.data,d=0;d<k.materials.length;d++){var f=k.materials[d];-1==b.indexOf(f)&&b.push(f)}return b}function ia(a,b,e){for(var k=a.k,d=a.ah.f.S,f=0;f<d.length;f++){var c=d[f];L.zg(c,b/e);k.rc&&L.tu(c,k.rc)}k.rc&&(k.wo=!0,R(a,"DEPTH").ya=!0,R(a,"MAIN_BLEND").ya=!0);var m=k.zb;pa.vM(m,function(k,d,f){if(k.jk){var c=k.Gg*
b,g=k.Gg*e;if(d)for(d=0;d<f.va.length;d++)f.va[d]==k&&jb.resize(k.Ga,c,g);else switch(jb.Cl(k.Ga)&&jb.resize(k.Ga,c,g),k=f.j,k.width=c,k.height=g,f.type){case "DOF":ra(a,{dof_power:f.j.dof_power,dof_on:f.j.dof_on});break;case "GLOW_COMBINE":oa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":sa(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=pa.Xa(m,f,"POSTPROCESSING");c=pa.Xa(m,f,"POSTPROCESSING");g=pa.Xa(m,c,"POSTPROCESSING");
k=pa.Xa(m,g,"POSTPROCESSING");pa.sd(f,1/b,1/e);pa.sd(c,1/b,1/e);pa.sd(g,1/b,1/e);pa.sd(k,1/b,1/e);break;default:pa.sd(f,1/b,1/e)}}})}function fa(a,b){for(var e=[],k=0;k<b.length;k++){var d=b[k];qa.V(a.k.zb,function(a,b){b.type==d&&e.push(b)})}return e}function R(a,b){return pa.Ya(a.k.zb,b)}function ra(a,b){var e=R(a,"DOF");if(!e)return va.error("DOF is not enabled on the scene. Check camera settings"),0;var k=a.k.zb;"boolean"==typeof b.dof_on&&(e.j.dof_on=parseFloat(b.dof_on));"number"==typeof b.dof_distance&&
(e.j.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(e.j.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(e.j.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){e.j.dof_power=b.dof_power;var d=pa.Xa(k,e,"POSTPROCESSING"),k=pa.Xa(k,d,"POSTPROCESSING");pa.qc(d,e.j.dof_power);pa.sd(d,1/e.j.width,1/e.j.height);pa.qc(k,e.j.dof_power);pa.sd(k,1/e.j.width,1/e.j.height)}e.ya=!0}function sa(a,b){var e=R(a,"LUMINANCE_TRUNCED"),k=R(a,"BLOOM");if(!e||!k)return va.error("Bloom is not enabled on the scene"),
0;"number"==typeof b.bloom_key&&(e.bloom_key=b.bloom_key,e.ya=!0);"number"==typeof b.bloom_edge_lum&&(e.bloom_edge_lum=b.bloom_edge_lum,e.ya=!0);if("number"==typeof b.bloom_blur){var d=a.k.zb,e=pa.Xa(d,k,"BLOOM_BLUR"),d=pa.Xa(d,e,"BLOOM_BLUR");k.bloom_blur=b.bloom_blur;pa.qc(e,b.bloom_blur);pa.sd(e,1/k.j.width,1/k.j.height);pa.qc(d,b.bloom_blur);pa.sd(d,1/k.j.width,1/k.j.height)}}function oa(a,b){var e=R(a,"GLOW_COMBINE");if(!e)return va.error("Glow is not enabled on the scene"),null;for(var k=a.k.zb,
d=pa.sI(k,e),f=0;f<d.length;++f){var c=d[f];if("POSTPROCESSING"===c.type&&"GLOW_MASK_LARGE"===c.$a)var m=c;if("POSTPROCESSING"===c.type&&"GLOW_MASK_SMALL"===c.$a)var g=c}d=pa.Xa(k,m,"POSTPROCESSING");k=pa.Xa(k,g,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(e.small_glow_mask_coeff=b.small_glow_mask_coeff,e.ya=!0);"number"==typeof b.large_glow_mask_coeff&&(e.large_glow_mask_coeff=b.large_glow_mask_coeff,e.ya=!0);"number"==typeof b.small_glow_mask_width&&(e.small_glow_mask_width=b.small_glow_mask_width,
pa.qc(g,b.small_glow_mask_width),pa.sd(g,1/e.j.width,1/e.j.height),g.ya=!0,pa.qc(k,b.small_glow_mask_width),pa.sd(k,1/e.j.width,1/e.j.height),k.ya=!0);"number"==typeof b.large_glow_mask_width&&(e.large_glow_mask_width=b.large_glow_mask_width,pa.qc(m,b.large_glow_mask_width),pa.sd(m,1/e.j.width,1/e.j.height),m.ya=!0,pa.qc(d,b.large_glow_mask_width),pa.sd(d,1/e.j.width,1/e.j.height),d.ya=!0)}function na(a,b){var e=R(Gb,"MAIN_OPAQUE");if(!e||!e.Bb)return va.error("get_water_surface_level() - no water parameters on the scene"),
0;var k=e.Ug,d=e.yi,f=e.Tg,c=e.Bb;if(!k||!c.bl)return c.Tg;var m=gb.length(e.Lf),g=e.time;m&&(g*=m);var u=Hb;u[0]=20/d*(a-.25*g);u[1]=20/d*(b-.25*g);m=Fa.qw(u);u[0]=17/d*(b+.1*g);u[1]=17/d*(a+.1*g);var u=Fa.qw(u),m=m+u-1,h=c.dst_noise_scale0,u=c.dst_noise_scale1,q=c.dst_noise_freq0,n=c.dst_noise_freq1,z=Hb;z[0]=h*(a+q*g);z[1]=h*(b+q*g);h=Fa.Pt(z);z[0]=u*(b-n*g);z[1]=u*(a-n*g);u=Fa.Pt(z);u*=k*h;if(e.Bp)if(n=(a-e.Dg[0])/e.Eg[0],z=(e.Dg[1]+b)/e.Eg[1],n+=.5,z+=.5,1<n||0>n||1<z||0>z)k=u;else var n=Fa.Sx(Gb.k.It,
e.Rj,n,z),h=c.dir_freq,l=c.dir_noise_scale,O=c.dir_noise_freq,q=c.dir_min_noise_fac,z=c.dst_min_fac,e=d/e.vj/Math.PI,l=[l/d*(a+O*g),l/d*(b+O*g)],d=Math.sqrt(n),k=k*Math.max(n,c.dir_min_shore_fac)*Math.sin(d/e+h*g)*Math.max(Fa.Pt(l),q),c=Math.max(d,z),k=k*(1-c)+u*c,m=m*n;else k=u;return f+(k+.05*m)}function N(a,b){a.Al&&"POSTPROCESSING"==a.type&&b.yb!=a.yb&&(a.yb=b.yb);b.yb||"OUTLINE"!=a.type||(a.jr=0)}function X(a,b,e,k){var d=qa.Za(a,b);L.To(d.j,e,k);d.eq=!0;qa.Ng(a,b,function(b,d,f){f.mb&&f.from==
e&&pa.VF(f)&&ga(a,b,f.to,k)});qa.Kf(a,b,function(b,d,f){f.mb&&f.from==e&&f.from==f.to&&X(a,b,e,k)})}function ga(a,b,e,k){a=qa.Za(a,b).p;for(b=0;b<a.length;b++)W.UK(a[b].C,k,e)}function V(a){var b=R(a,"GRASS_MAP");if(b){var e=b.j,k=a.ah.f,d=k.i;a=wc;a[0]=0;a[1]=-b.Jc[2]/2;a[2]=0;gb.transformQuat(a,k.quat,a);a[0]+=d[0];a[1]=0;a[2]+=d[2];b=Mc;b[0]=0;b[1]=0;b[2]=0;b[3]=1;L.oB(e,a,b)}}function ha(a,b){qa.V(a,function(e,k){if("MOTION_BLUR"==k.type){if(!k.va[0]||!k.Ue[0])throw"Wrong MOTION_BLUR subscene";
var d=k.va[0],f=k.Ue[0];k.Ue[0]=k.j.Cb;qa.Ng(a,e,function(b,e,k){k.mb&&ga(a,b,k.to,f)});X(a,e,d.from,f);ga(a,e,d.to,k.Ue[0]);k.Jz=Math.exp(-b/k.mb_factor)}})}function Z(a){return a.k.Lf}var W=t("__batch"),ja=t("__boundings"),L=t("__camera"),ta=t("__config"),la=t("__container");t("__constraints");var O=t("__debug"),pb=t("__geometry"),qa=t("__graph"),Ga=t("__hud"),Ra=t("__mat4"),kb=t("__nodemat"),Na=t("__obj_util"),Wb=t("__physics"),Aa=t("__prerender"),wb=t("__primitives"),va=t("__print"),Vb=t("__renderer"),
pa=t("__scenegraph"),bc=t("__sfx"),ma=t("__shaders"),jb=t("__textures"),Fa=t("__util"),gb=t("__vec3"),xa=ta.r,tc=ta.Db,Ma=ta.Mj,qb="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");a.fP=qb;var lc="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED DEPTH SHADOW_CAST COLOR_PICKING COLOR_PICKING_XRAY OUTLINE_MASK".split(" "),
Xc="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),uc="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),mc="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Fc=null,Gb=null,Va=[],Xb=null,Uc=Math.PI/2,Hb=new Float32Array(2),wc=new Float32Array(3),Mc=new Float32Array(4),nc=new Float32Array(16),
Kc=new Float32Array(24),Lc=new Float32Array(24),Pb=ja.Qd(),Qb=ja.Qd(),xc=0,gc=-Infinity;a.xQ=function(){return{}};a.So=function(a){Gb=a;bc.jL(a)};a.DK=function(a,b){var e=a.k,k=pa.CG(e.zb);if(a==b){ia(a,la.FI(),la.EI());for(var d=0;d<k.length;d++)a.k.fi.push(k[d])}else for(d=a.ve[0],ia(a,d.k.mi,d.k.mi),d=0;d<k.length;d++)b.k.fi.push(k[d]);k=fa(a,uc);for(d=0;d<k.length;d++)k[d].Lf.set(e.Lf);for(d=0;d<e.fi.length;d++)"SHADOW_CAST"==e.fi[d].type&&Vb.al(e.fi[d])};a.ej=function(){Fc||(Fc=l(Va));return Fc};
a.Jn=l;a.o=c;a.oa=function(){return Gb?!0:!1};a.ql=function(a){return a.ah};a.dj=function(){return Va};a.wy=function(){if(1==Va.length)return Va;for(var a=0;a<Va.length;a++){var b=Va[a].k.zb;qa.V(b,function(b,e){for(var k=0;k<e.p.length;k++){for(var d=e.p[k].C.T,f=null,c=0;c<d.length;c++)if("SCENE"==d[c].source&&d[c].Qt==Va[a].name&&"COPY"!=e.type){va.error('Texture-scene loop detected. A scene is rendered to texture "'+d[c].name+'" yet this texture belongs to the same scene.');qa.Vh(Xb,Va[a]);f=
e.p[k].C;break}f&&(f.T=[],f.ac=[],W.CM(f,null),W.Vb(f))}})}for(var e=[],a=0;a<Va.length;a++)if(b=Va[a],!b.ve.length){b=qa.Vh(Xb,b);qa.nH(Xb,b);b=qa.Xt(Xb,b,qa.Lp);b=qa.hu(b);qa.V(b,function(a,b){e.push(b)});break}return e};a.FE=function(a,b,e,k,c){a.ve=a.ve||[];a.X=null;var h=a.k,l=a.ah.f;h.uk=[];var O=a.world;h.pJ=e.length;h.ni=r(e);h.jp=A(O,h.ni);h.Nu=q(O,h.jp);h.LC=m(O);h.wE=G(a,c);l.S[0].type!=L.ec&&xa.anaglyph_use?(va.warn("Anaglyph stereo is disabled for the non-perspective camera"),c=!1):c=
xa.anaglyph_use;h.anaglyph_use=c;h.Kj=f(a,b);h.oF=H(a);h.ZJ=J(a);h.FF=D(a);h.II=n(a);h.mK=C(a);h.hg=B(a);h.Vi=xa.Vi&&(0<l.dof_distance||l.nf);h.Uh=xa.Uh&&a.b4w_enable_motion_blur;h.Oi=xa.Oi&&a.b4w_enable_color_correction;h.antialiasing=xa.antialiasing&&a.b4w_enable_antialiasing;h.Re=xa.Re&&a.b4w_enable_ssao;h.hj=xa.hj&&a.b4w_enable_god_rays&&h.ni;h.aH=xa.Wk;h.Or=a.world.b4w_render_glow_over_blend;h.dM=F(a);c=p(k);h.VJ=c;h.Dc=E(a,c);h.rc=y(a,e,k);h.Bb=g(k);h.Nf=z(k);h.PL=v(k);h.Cg=x(k);h.Rb=w(k);h.dG=
d(a,k);h.outline=I(a,k);h.sf=u(a,k);switch(a.b4w_reflection_quality){case "LOW":h.sh=Ma.cx;h.Sl=Ma.hA;break;case "MEDIUM":h.sh=Ma.RG;h.Sl=Ma.xK;break;case "HIGH":h.sh=Ma.QG;h.Sl=Ma.wK;break;default:h.sh=Ma.cx,h.Sl=Ma.hA}e=a.ve.sort(function(a,b){return b.k.mi-a.k.mi});h.zb=pa.BG(h,l,e);h.fi=[];h.wo=!1;h.Es=!1;h.Fs=!1;h.Lf=new Float32Array(3);Va.push(a);Xb||(Xb=qa.create());qa.u(Xb,a);for(h=0;h<b.length;h++)Na.tt(b[h],!0,a)};a.GE=function(a,b,e){for(var k=0;k<b.length;k++)b[k].k&&b[k].k.nj&&(b[k].k.Yc=
e,a.k.uk.push(b[k]))};a.eG=function(a){var e="ALL",k=[];b(a.objects,e,k);return k};a.oy=function(a){return a.k.zb};a.JH=function(a){qa.V(a,function(b,k){var d=null;switch(k.type){case "POSTPROCESSING":d=W.Xw(k.Ho);break;case "SSAO":d=W.IG(k);break;case "SSAO_BLUR":d=W.JG(k);break;case "DEPTH_PACK":d=W.qG();break;case "REFRACT":case "COPY":d=W.Xw("NONE");break;case "GOD_RAYS":pa.Xa(a,k,"WIREFRAME")||pa.Xa(a,k,"MAIN_BLEND")||pa.Xa(a,k,"GOD_RAYS");d=W.uG(k.bA,k.vi,k.bk);break;case "GOD_RAYS_COMBINE":pa.Xa(a,
k,"WIREFRAME")||pa.Xa(a,k,"MAIN_BLEND");pa.Xa(a,k,"GOD_RAYS");d=W.vG();break;case "MOTION_BLUR":d=W.yG();break;case "DOF":var d=W.rG(),f=pa.Xa(a,k,"POSTPROCESSING"),c=pa.Xa(a,f,"POSTPROCESSING");pa.qc(f,k.j.dof_power);pa.qc(c,k.j.dof_power);break;case "OUTLINE":var d=W.zG(),f=pa.Xa(a,k,"POSTPROCESSING"),c=pa.Xa(a,f,"POSTPROCESSING"),m=pa.Xa(a,c,"POSTPROCESSING"),g=pa.Xa(a,m,"POSTPROCESSING");pa.qc(c,k.nq);pa.qc(f,k.nq);pa.qc(g,k.qr*k.Ll);pa.qc(m,k.qr*k.Ll);break;case "GLOW_COMBINE":d=W.tG();break;
case "COMPOSITING":d=W.oG();break;case "ANTIALIASING":d=W.kG();break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=W.GG(k.type);break;case "ANAGLYPH":d=W.iG();break;case "SKY":d=W.AG();break;case "LUMINANCE":d=W.wG();break;case "AVERAGE_LUMINANCE":d=W.lG();break;case "LUMINANCE_TRUNCED":d=W.xG();break;case "BLOOM_BLUR":d=W.mG();break;case "BLOOM":d=pa.Xa(a,k,"BLOOM_BLUR");f=pa.Xa(a,d,"BLOOM_BLUR");pa.qc(d,k.bloom_blur);pa.qc(f,
k.bloom_blur);d=W.nG();break;case "VELOCITY":d=W.MG();break;case "ANCHOR_VISIBILITY":d=W.jG()}d&&(f=K(Na.Si("NONE"),d),Q(d),k.p.push(f),e(a,k,d),aa(d))})};a.Gi=function(a,b,d){switch(b.type){case "MESH":var f=a.k.zb,c=b.f;!pa.Ya(f,"SHADOW_CAST")&&c.Vc&&(c.Vc=!1);c=fa(a,qb);d&&Wb.L(b)&&Wb.Gi(b,a);for(var m=0;m<c.length;m++){var g=c[m],h=b,u=f,q=a,n=d;switch(g.type){case "MAIN_OPAQUE":k(g,h,u,"OPAQUE",q,n);break;case "MAIN_BLEND":k(g,h,u,"BLEND",q,n);break;case "MAIN_XRAY":k(g,h,u,"XRAY",q,n);break;
case "MAIN_GLOW":k(g,h,u,"GLOW",q,n);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var z=h.f,l=Na.Qa(h,q).W,O=0;O<l.length;O++){var G=l[O];if(("MAIN"==G.type||"PARTICLES"==G.type)&&"REFLECT"==G.$a){if("MAIN_PLANE_REFLECT"==g.type){var w;a:{w=q.k.Kj.ug;for(var E=0;E<w.length;E++)if(w[E]==g){w=E;break a}w=null}if(w==z.pd)continue}else{a:{if(q.k.Kj)for(w=q.k.Kj.Yf,E=0;E<w.length;E++)if(w[E]==g){w=E;break a}w=null}if(w==z.Fd)continue}n||(M(G,g,h,u,"REFLECT",q),w=G.ib,ma.I(w,"DISABLE_FOG",
0),ma.I(w,"WATER_EFFECTS",0),"special_skydome.glslf"==ma.iy(w)&&ma.I(w,"REFLECTION_PASS",1),ma.I(w,"TEXTURE_NORM",0),W.Vb(G),Q(G));g.p.push(K(z,G))}}break;case "DEPTH":z=Na.Qa(h,q).W;for(l=0;l<z.length;l++)O=z[l],"DEPTH"!=O.type||O.Uc||"DEPTH"!=O.$a&&"NODES"!=O.$a||(n||(M(O,g,h,u,"DEPTH",q),W.Vb(O),Q(O)),g.p.push(K(h.f,O)),e(u,g,O),aa(O));break;case "SHADOW_CAST":z=!1;l=h.f;h=Na.Qa(h,q).W;O=pa.Ya(u,"GRASS_MAP");for(G=0;G<h.length;G++)w=h[G],"DEPTH"==w.type&&"SHADOW_CAST"==w.$a&&(z=!0,n||(E=g.Hl,W.ne(w,
"NUM_LIGHTS",E),W.ne(w,"NUM_LFACTORS",0==E%2?E/2:Math.floor(E/2)+1),ma.I(w.ib,"SHADOW_USAGE","SHADOW_CASTING"),w.Rb&&O&&U(w,O,l),W.ne(w,"SHADOW_TEX_RES",ma.M(q.k.rc.csm_resolution)),W.Vb(w),Q(w)),g.p.push(K(l,w)));z&&(h=q.k.rc,q=pa.Ya(u,"MAIN_OPAQUE"),ea(g,q.j,g.p,h,!0));break;case "COLOR_PICKING":P(g,h,u,q,n);break;case "COLOR_PICKING_XRAY":P(g,h,u,q,n);break;case "OUTLINE_MASK":u=h.f;h=Na.Qa(h,q).W;for(q=0;q<h.length;q++)z=h[q],"COLOR_ID"==z.type&&"OUTLINE"==z.$a&&(n||(W.ne(z,"USE_OUTLINE",1),W.Vb(z),
Q(z)),g.p.push(K(u,z)));break;case "GRASS_MAP":u=h.f;h=Na.Qa(h,q).W;for(q=0;q<h.length;q++)z=h[q],"GRASS_MAP"==z.type&&(n||(W.Vb(z),Q(z)),g.p.push(K(u,z)),z=g.j,w=u.wb,l=g.Jc[0],O=g.Jc[1],G=g.Jc[2],0==l&&0==O?(l=w.min_y,O=w.max_y):(l=Math.min(l,w.min_y),O=Math.max(O,w.max_y)),w=1E-4*(O-l),g.Jc[0]=l-w,g.Jc[1]=O+w,L.Xo(z,G/2,-O,-l,G/2),L.zg(z));break;case "WIREFRAME":for(z=h.f,h=Na.Qa(h,q).W,q=0;q<h.length;q++)l=h[q],"WIREFRAME"==l.type&&S(g,z,u,n,l)}}break;case "LAMP":da(b,a)}Na.tt(b,!0,a)};a.ut=function(a){a.k.wo=
!0};a.fI=function(a,b){for(var e=a.k.rc,k=new Float32Array(e.csm_num),d=0;d<e.csm_num;d++)k[d]=L.PG(e,b,d);return k};a.xP=S;a.Zn=function(a){a.f.jj=!0};a.Jt=function(a){a.f.jj=!1};a.gs=function(a){return a.f.jj};a.OK=function(a,b,e){b=b.f;a=fa(a,qb);for(var k=0;k<a.length;k++)for(var d=a[k].p,f=d.length-1;0<=f;f--){var c=d[f];c.he==b&&(c.C&&e&&pb.Cw(c.C.ca),d.splice(f,1))}};a.kC=da;a.Y=function(){for(var a=0;a<Va.length;a++){var b=Va[a];qa.V(b.k.zb,function(a,b){if("SINK"!=b.type){var e=b.j;Vb.RK(e.pf,
e.Cb,e.Gd,e.width,e.height);for(var e=b.p,k=0;k<e.length;k++){var d=e[k].C;d&&W.cG(d)}}});b.k.zb=[];b.k.fi=[]}Gb=Fc=null;Va.length=0;Xb=null};a.Ez=function(a,b,e){a=L.uH(a,a.rb,a.pb,null,!0);var k=wb.OH(a);a=Na.Si("DYNAMIC");a.wb=a.Yb={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Zb=a.Ed=ja.lF();var d=a.Zb.Va;a.jh=a.Sf=ja.sn([d,0,0],[0,d,0],[0,0,d],a.Zb.G);e=W.FG(k,e);b.p.push(K(a,e))};a.PR=function(a){return[a.frame_start,a.frame_end]};a.rB=function(a,b,e){la.JL(a,b,e);
Gb&&ia(Gb,a,b)};a.RB=fa;a.ia=R;a.dy=function(a){a=fa(a,lc)[0];var b=a.ig,e=a.Wg,k=[],d=[];k[0]=b[0];k[1]=b[1];k[2]=b[2];d[0]=e[0];d[1]=e[1];d[2]=e[2];return[a.ag,k,d]};a.$A=function(a,b,e,k){a=fa(a,lc);for(var d=0;d<a.length;d++){var f=a[d];isNaN(b)||(f.ag=b);e&&f.ig.set(e);k&&f.Wg.set(k);f.ya=!0}};a.Ey=function(a){if(a=R(a,"SKY")){var b={};b.color=Array(3);gb.copy(a.Sj,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=
a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.iB=function(a,b){var e=R(a,"SKY");e&&("number"==typeof b.procedural_skydome&&(e.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&
(e.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&e.Sj.set(b.color),"number"==typeof b.rayleigh_brightness&&(e.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(e.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(e.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(e.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(e.rayleigh_strength=b.rayleigh_strength),"number"==
typeof b.mie_strength&&(e.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(e.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(e.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(e.mie_distribution=b.mie_distribution),e.ya=!0,e.vo=!0,ka(a,e))};a.jy=function(a,b){var e=b||[],k=fa(a,Xc)[0].wc;e[0]=k[0];e[1]=k[1];e[2]=k[2];e[3]=k[3];return e};a.bB=function(a,b){for(var e=fa(a,Xc),k=0;k<e.length;k++){var d=
e[k];d.wc.set(b);d.ya=!0}};a.Gy=function(a){var b=R(a,"SSAO");a=R(a,"SSAO_BLUR");if(!b)return null;var e=b.p[0].C,k={};k.ssao_quality=W.Er(e,"SSAO_QUALITY")[1];k.ssao_hemisphere=b.ssao_hemisphere;k.ssao_blur_depth=a.ssao_blur_depth;k.iw=a.ssao_blur_discard_value;k.radius_increase=b.Yj;k.influence=b.Xj;k.dist_factor=b.Wj;k.ssao_only=b.ssao_only;k.ssao_white=W.Er(e,"SSAO_WHITE")[1];return k};a.kB=function(a,b){var e=R(a,"SSAO"),k=R(a,"SSAO_BLUR");if(!e)return va.error("SSAO is not enabled on the scene"),
0;if("string"==typeof b.ssao_quality){var d=e.p[0].C;W.ne(d,"SSAO_QUALITY",b.ssao_quality);W.Vb(d,!0)}"number"==typeof b.ssao_hemisphere&&(d=e.p[0].C,W.ne(d,"SSAO_HEMISPHERE",b.ssao_hemisphere),W.Vb(d,!0));"number"==typeof b.ssao_blur_depth&&(d=k.p[0].C,W.ne(d,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),W.Vb(d,!0));"number"==typeof b.ssao_blur_discard_value&&(k.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.Yj&&(e.Yj=b.Yj);"number"==typeof b.Xj&&(e.Xj=b.Xj);"number"==typeof b.Wj&&
(e.Wj=b.Wj);if("number"==typeof b.ssao_only){e=R(a,"MAIN_OPAQUE");e.ssao_only=b.ssao_only;for(var f=0;f<e.p.length;f++)d=e.p[f].C,W.ne(d,"SSAO_ONLY",b.ssao_only),W.Vb(d,!0)}"number"==typeof b.ssao_white&&(d=e.p[0].C,W.ne(d,"SSAO_WHITE",b.ssao_white),W.Vb(d,!0));e.ya=!0;k.ya=!0};a.ay=function(a){a=R(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.j.dof_distance;b.dof_front=a.j.dof_front;b.dof_rear=a.j.dof_rear;b.dof_power=a.j.dof_power;b.nf=a.j.nf;return b};a.ZA=ra;a.ny=function(a){var b=fa(a,
["GOD_RAYS"]);a=R(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var e={};e.god_rays_max_ray_length=b[0].uj;e.god_rays_intensity=a.god_rays_intensity;e.god_rays_steps=W.Er(b[0].p[0].C,"STEPS_PER_PASS")[1];return e};a.eB=function(a,b){var e=fa(a,["GOD_RAYS"]),k=R(a,"GOD_RAYS_COMBINE");if(!e||!k)return va.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(k.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var d=b.god_rays_max_ray_length,
f=0;f<e.length;f++)e[f].uj=d,e[f].Mo=d/e[f].bk/(f+1),e[f].ya=!0;if("number"==typeof b.god_rays_steps)for(var c=ma.M(b.god_rays_steps,1),d=e[0].uj,f=0;f<e.length;f++){e[f].bk=c;e[f].Mo=d/c/(f+1);e[f].ya=!0;var m=e[f].p[0].C;W.ne(m,"STEPS_PER_PASS",c);W.Vb(m,!0)}k.ya=!0};a.Ux=function(a){var b=R(a,"LUMINANCE_TRUNCED");a=R(a,"BLOOM");if(!b||!a)return null;var e={};e.bloom_key=b.bloom_key;e.bloom_edge_lum=b.bloom_edge_lum;e.bloom_blur=a.bloom_blur;return e};a.QA=sa;a.my=function(a){a=R(a,"GLOW_COMBINE");
if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.dB=oa;a.Qy=function(a){a=Z(a);var b=gb.length(a);if(0==b)return null;var e={};e.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;e.wind_strength=b;return e};a.gL=function(a){a.k.Es=!0};a.Oy=na;a.Ny=function(a,b){var e=R(a,"MAIN_OPAQUE");if(e&&(b.waves_height=e.Ug,b.waves_length=
e.yi,e.re)){b.water_fog_density=e.re[3];var k=b.water_fog_color=[];k[0]=e.re[0];k[1]=e.re[1];k[2]=e.re[2]}};a.pB=function(a,b){var e=R(a,"MAIN_OPAQUE");if(!e||!e.Bb)return va.error("set_water_params() - no water parameters on the scene"),null;e=e.Bb;"number"==typeof b.dst_noise_scale0&&(e.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(e.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(e.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&
(e.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(e.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(e.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(e.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(e.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(e.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(e.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(e.waves_hor_fac=
b.waves_hor_fac);"number"==typeof b.water_dynamic&&(e.bl=b.water_dynamic);for(var k=fa(a,mc),d=0;d<k.length;d++){var f=k[d];"number"==typeof b.water_fog_density&&e.wc&&(f.re[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&e.wc&&f.re.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.Ug=b.waves_height);"number"==typeof b.waves_length&&(f.yi=b.waves_length);f.ya=!0}};a.Cy=function(a,b){var e=R(Gb,"MAIN_OPAQUE");if(!e.Bp)return 100;var k=e.vj,d=e.Tg,f=(a[0]-e.Dg[0])/e.Eg[0],c=(e.Dg[1]+
a[2])/e.Eg[1],f=f+.5,c=c+.5;if(1<f||0>f||1<c||0>c)d=1;else return e=k*Fa.Sx(Gb.k.It,e.Rj,f,c),d=(d-a[1])*b,d=Math.sqrt(e*e+d*d)};a.update=function(a,b){for(var e=c().ah.f,k=0;k<Va.length;k++){var d=Va[k],f=d.k.zb,m=d.k;if(m.Bb)var g=e.i[1]-na(e.i[0],e.i[2]);for(var h=0;h<m.uk.length;h++){var u=m.uk[h].k,q=u.O,n=u.pc;if(!(d.b4w_use_nla&&u.Au||!q&&!n)&&jb.CC(u)){var z=jb.uN(u),l=jb.wN(u);q&&xa.kg&&(l-=5);var O=jb.vN(u);!u.kk&&z>=O?jb.Eo(u.name,u.Yc):(n&&z>=O&&(z=u.ki=0),z<l&&jb.HA(u.name,u.Yc),jb.DC(u)&&
(q?jb.xu(u):(q=jb.PA(u,a),q!=u.Ro&&(jb.nC(u),u.ki++),u.Ro=q)))}}qa.V(f,function(b,e){-1<uc.indexOf(e.type)&&(e.time=a);m.Bb&&(e.xq=g)})}for(k=0;k<Va.length;k++)if(d=Va[k],m=d.k,f=m.zb,e=m.fi,e.length)for(m.wo&&(ba(d),m.wo=!1),m.Es&&(V(d),m.Es=!1),m.Fs&&(T(d),m.Fs=!1),m.Uh&&ha(f,b),d=pa.Ya(f,"OUTLINE_MASK"),h=0;h<e.length;h++)f=e[h],Aa.Xs(f),d&&N(f,d),Vb.al(f);xa.show_hud_debug_info&&Ga.NL(Va,b)};a.WK=function(a){a.k.Fs=!0};a.Br=function(a){var b=[];qa.V(a.k.zb,function(a,e){b.push(e)});return b};
a.Wx=function(){var a=R(Gb,"MAIN_BLEND"),b=Gb;return a||b.k.Bb?a.xq:null};a.sy=function(a){return a.f.Hc};a.wu=function(a){qa.V(a.k.zb,function(a,b){b.ya=!0})};a.HL=function(a,b){a.yb=b!=O.Mm;for(var e=0;e<a.p.length;e++)a.p[e].C.wireframe_mode=b;a.Ma=b==O.Nm;a.ya=!0};a.GL=function(a,b){for(var e=0;e<a.p.length;e++)a.p[e].C.wireframe_edge_color=b,a.ya=!0};a.LM=function(a,b){var e=b.Yi,k=a.k.Lf;if(e&&"WIND"==e.type&&k){Fa.za(b.f.quat,Fa.jb,k);gb.normalize(k,k);gb.scale(k,e.OB,k);for(var e=fa(a,uc),
d=0;d<e.length;d++)e[d].Lf.set(k)}};a.rK=function(a,b,e){var k=R(a,"COLOR_PICKING");if(k)return b=la.zq(b,e,Hb,k.j),Aa.Xs(k),Vb.al(k),(a=R(a,"COLOR_PICKING_XRAY"))?(Aa.Xs(a),Vb.al(a),k=a.j):k=k.j,b[1]=k.height-b[1],Vb.AA(k.pf,b[0],b[1]);va.error("Object Selection is not available on the scene");return null};a.Bt=function(a){var b=c();if(b=R(b,"OUTLINE"))b.Af.set(a),b.ya=!0};a.gS=Z;a.tl=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);
return b};a.iC=function(a,b){var e=wc;gb.negate(b,e);for(var k=0;6>k;k++){var d=a.Tk[k],f=a.Vq[k],c=a.j;Ra.translate(Fa.TC[k],e,d);Ra.multiply(c.Fa,d,c.qe);Fa.Hn(c.qe,f)}};a.lC=function(a,b,e){Fa.tM(b,e,Fa.jb,a.j.Bc)};a.eF=function(a,b,e){var k=a.k.rc,d=a.k.Kj;e=Na.Jr(e)||e[0];for(var f=0;f<b.length;f++){var c=b[f],m=Na.Qa(c,a);if(d)if(null!=c.f.pd){var g=d.ug;if(g.length){var h=c.f.pd;m.ug=g[h]}}else null!=c.f.Fd&&(g=d.Yf,g.length&&(h=c.f.Fd,m.Yf=g[h]));k&&c==e&&(m.vB=fa(a,["SHADOW_CAST"]))}};a.Gz=
function(a,b){return a.timeline_markers[b]}};b4w.module.__batch=function(a,t){function l(a){a={type:a,$a:"",id:0,PK:0,Dj:"",T:[],ac:[],xf:[],Pk:[],si:null,Nb:{},Ec:null,ib:{tk:null,$i:null,Zf:[],pg:[]},Yv:[],cT:null,ca:null,Xe:!1,th:!1,gx:!1,wireframe_mode:0,Ms:0,Il:0,rz:0,sz:0,Ry:0,Pr:0,Jc:new Float32Array(3),dd:new Float32Array(16),dh:!1,Ma:!1,Hw:!1,ha:!1,Nf:!1,bb:!1,yd:!1,Ge:!1,td:!1,Uc:!1,Vc:!1,Cc:!1,nc:!1,Tc:!1,Rb:!1,nA:!1,$f:da.wk,Of:da.bf,yq:!1,Bh:!1,GK:"",oU:"",Ty:!1,Xy:0,Uy:0,Yy:0,Zy:0,Wy:new Float32Array(3),Vy:new Float32Array(3),
Fh:!1,Di:0,Wi:0,Yk:1,Oo:0,kp:0,Rt:1,Ao:0,Xk:0,Bk:1,Rz:0,Cs:0,Yh:0,CA:0,fd:Array(2),Uj:new Float32Array(3),Kg:new Float32Array(3),fm:new Float32Array(3),Yd:new Float32Array(4),Dh:new Float32Array(4),qj:null,ms:null,ks:null,js:null,ls:null,ij:!1,vi:!1,water_dynamic:!1,Ju:!1,FC:!1,GC:0,HC:0,EC:0,Fp:.1,cp:0,gp:0,Kn:0,Dx:new Float32Array(2),Cx:new Float32Array(2),tr:new Float32Array(2),bp:new Float32Array(3),fp:new Float32Array(3),Wh:null,ft:!1,ua:null};a.Yd[3]=1;a.Hw=!0;a.ha=!0;return a}function c(a){switch(a.type){case "MAIN":case "PARTICLES":a.$a=
a.Ma?a.Nf?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.$a=a.ij?"NODES":"DEPTH";break;case "COLOR_ID":a.$a=a.Nf?"COLOR_ID_XRAY":"COLOR_ID"}}function b(a){var b=a.ca;a.ca=null;var e=ia.Xf(a);a.ca=b;e.ca=b;return e}function y(a,b){for(var e=[],k=0;k<a.length;k++){var d=a[k],f=d.La,c=d.f,m=ba.Qd();ba.qn(c.Ii,m);var g=f.data.b4w_bounding_cylinder_radius,h=f.data.b4w_bounding_sphere_radius,u=f.data.b4w_bounding_sphere_center,q=f.data.b4w_bounding_ellipsoid_axes,f=f.data.b4w_bounding_ellipsoid_center;if(c.Ud){var g=
Math.max(Math.abs(m.max_x),Math.abs(m.min_x)),h=Math.max(Math.abs(m.max_y),Math.abs(m.min_y)),n=Math.max(Math.abs(m.max_z),Math.abs(m.min_z)),n=Math.sqrt(g*g+h*h+n*n),g=Math.sqrt(g*g+h*h);m.max_x=m.max_y=m.max_z=n;m.min_x=m.min_y=m.min_z=-n;h=n;u[0]=u[1]=u[2]=0;q[0]=q[1]=q[2]=n;f[0]=f[1]=f[2]=0}c.Yb=m;n=ba.qq(m,c.ea);c.wb=n;x(c,g,g,m);m=ba.tn(h,u);c.Ed=m;m=ba.sq(m,c.ea);c.Zb=m;q=ba.sn([q[0],0,0],[0,q[1],0],[0,0,q[2]],f);c.Sf=q;q=ba.rq(q,c.Ca);c.jh=q;e=e.concat(r(d,c,b))}return e}function h(a,b,e){for(var k=
[],d=[],f={},c=0;c<a.length;c++){var m=a[c],g=m.La,h=m.f,u=ba.Qd();ba.qn(h.Ii,u);var q=ba.qq(u,h.ea),n=ba.tn(g.data.b4w_bounding_sphere_radius,g.data.b4w_bounding_sphere_center),l=ba.sq(n,h.ea),w=g.data.b4w_bounding_ellipsoid_axes,g=ba.sn([w[0],0,0],[0,w[1],0],[0,0,w[2]],g.data.b4w_bounding_ellipsoid_center),w=ba.rq(g,h.Ca);h.Yb=u;h.wb=q;h.Ed=n;h.Zb=l;h.Sf=g;h.jh=w;u={};u.td=h.td;u.Uc=h.Uc;u.Vc=h.Vc;u.Ef=h.Ef;u.zo=h.zo;u.Db=h.Db;u.yo=h.yo;u.Ej=h.Ej;u.Cc=h.Cc;u.nc=h.nc;u.Tc=h.Tc;u.Fd=h.Fd;u.pd=h.pd;
u.Ne=h.Ne;u.gf=h.gf;u.zd=h.zd;u.wf=h.wf;u.ic=h.ic;u.Ud=h.Ud;u.Ek=h.Ek;u.Dk=h.Dk;u.Rb=h.Rb;u.Ui=h.Ui;u.Bn=h.Bn;u.yf=h.yf;u.Sh=h.Sh;u.qo=h.qo;u.ld=h.ld;u.Rh=h.Rh;u.ro=h.ro;u.Ge=h.Ge;q=h.Zb.G;u.JI=0==e?[0,0]:[Math.floor(q[0]/e),Math.floor(q[2]/e)];u.mg=h.mg;u.Fl=h.Fl;u.Ph=h.Ph;u.Cn=h.Cn;h=JSON.stringify(u);f[h]=f[h]||[];f[h].push(m)}for(var E in f){u=JSON.parse(E);e=f[E];var m=ia.Si("STATIC"),p;for(p in u)m[p]=u[p];m.Hc=a[0].f.Hc;m.Ye=0;m.Mf=0;m.lf=0;m.kf=0;m.ef=0;m.jj=!1;for(c=0;c<e.length;c++)h=e[c],
0==c?(m.wb=V.ra(h.f.wb),m.Zb=V.ra(h.f.Zb),m.Sf=V.ra(h.f.Sf),m.jh=V.ra(h.f.jh)):(ba.tx(m.wb,h.f.wb),ba.qH(m.Zb,h.f.Zb));m.Yb=V.ra(m.wb);m.Ed=V.ra(m.Zb);d.push({f:m,lc:e})}for(a=0;a<d.length;a++)for(f=d[a].f,c=d[a].lc,E=0;E<c.length;E++){p=c[E];e=p.La;m=r(p,f,b);p.f.Ud&&!p.f.lq?(h=ga.create(),ga.Oj(p.f.i,h)):(h=p.f,h=ga.Fe(h.i,h.scale,h.quat));u={};if(f.zd||f.Ud)u.au_center_pos=[h[0],h[1],h[2]];f.zd&&(u.au_wind_bending_amp=[p.f.Ye],u.au_wind_bending_freq=[e.b4w_wind_bending_freq],u.au_detail_bending_amp=
[e.b4w_detail_bending_amp],u.au_detail_bending_freq=[e.b4w_detail_bending_freq],u.au_branch_bending_amp=[e.b4w_branch_bending_amp]);for(q=0;q<m.length;q++)g=m[q].f,n=m[q].vd,l=m[q].C,g.jo?g.Ud?da.hM(n,h):da.QB(n,h):("COLOR_ID"==l.type&&(g=m[q].f=p.f,l.Dj=e.uuid,B(l,g),g=G(g),z(l,g)),n=da.QB(n,h),da.gM(n,u));k=k.concat(m)}return k}function r(a,b,e){var k=a.La,f=[],c=v(e,b),m=G(b),h=k.data,q=h.materials,n=Array(q.length),w=na.Ya(e,"MAIN_OPAQUE"),p=!1;w&&(p=w.po.length?!0:!1);for(var C=0;C<c.length;C++)for(var ja=
c[C],r=0;r<q.length;r++){var K=q[r];if(("LENS_FLARES"!=K.name||p)&&!da.az(h,r)){var x=l(ja);"COLOR_ID"==ja&&(x.yq=!(k.b4w_do_not_render||K.b4w_do_not_render));"MAIN"==ja&&(n[r]=x);if(E(x,K)){"DEPTH"==ja&&n[r]&&(x.yd=n[r].yd);x.$f=b.Xe||b.Ge?da.Am:da.wk;B(x,b);for(var A=x,M=k.particle_systems,F=0;F<M.length;F++){var L=M[F].settings.b4w_vcol_from_name,Q=M[F].settings.b4w_vcol_to_name;""!==L&&""!==Q&&(A.Nb[L]={Eh:!1,src:[{name:L,Nd:7}]})}"DYNAMIC"==b.type&&(x.Dj=k.uuid);z(x,m);var I=da.wx(h,r,x.Pk,b.Ki,
x.Nb,x.si);"LENS_FLARES"==K.name&&(I=fa.BK(I));f.push({C:x,vd:I,Pc:[K.name],f:b,je:[a]})}}}var y=k.particle_systems;if(0<y.length&&f.length){for(var ta=!1,t=!1,C=0;C<y.length;C++){var D=y[C],R=D.settings;R.use_render_emitter&&(ta=!0);"HAIR"!=R.type||"OBJECT"!=R.render_type&&"GROUP"!=R.render_type&&D.transforms.length||(t=!0);if(ta&&t)break}var H=f[0].C.Nb,aa;if(t){var J;if(1<q.length){for(var la={},U=0;U<y.length;U++){var oa=y[U].settings;if("HAIR"==oa.type&&("OBJECT"==oa.render_type||"GROUP"==oa.render_type)){var Z=
oa.b4w_vcol_from_name,ra=oa.b4w_vcol_to_name;""!==Z&&""!==ra&&(la[Z]=V.ra(H[Z]))}}"a_bending_col_main"in H&&(la.a_bending_col_main=V.ra(H.a_bending_col_main));"a_bending_col_detail"in H&&(la.a_bending_col_detail=V.ra(H.a_bending_col_detail));J=da.xx(h,[],la)}else J=f[0].vd;aa=J}else aa=null;for(var T,ba=aa,X=a.La,ca=[],S=X.particle_systems,ka=X.data,ga=0;ga<S.length;ga++){var ea=S[ga],ia=ea.settings;if(ia.count)if("EMITTER"==ia.type){if("DYNAMIC"==b.type){var hb=l("PARTICLES"),$a,Ha=ka.materials,
cc=ea.settings.material-1;cc>=Ha.length&&(P.warn('Wrong material used for rendering particle system "'+ea.name+'"'),cc=0);$a=Ha[cc];"HALO"===ea.settings.render_type&&(hb.Fh=!0);g(hb,$a);var xb=hb,ya=ea.settings;switch(ya.b4w_billboard_align){case "VIEW":d(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":d(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":d(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":d(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";
}d(xb,"BILLBOARD",0);d(xb,"SOFT_PARTICLES",ya.b4w_enable_soft_particles&&0<ya.b4w_particles_softness&&W.Wk?1:0);d(xb,"SOFT_STRENGTH",N.M(ya.b4w_particles_softness));N.I(xb.ib,"WORLD_SPACE","WORLD"==ya.b4w_coordinate_system?1:0);hb.Ge=!0;hb.Dj=a.name+"_"+ia.uuid;hb.GK=ea.name;z(hb,m);fa.WI(hb,ea,$a);var rb=fa.NH(hb,ka,ea,a.f.Ca);ca.push({C:hb,vd:rb,Pc:[$a.name],f:b,je:[a]})}}else if("HAIR"==ia.type){var Y=V.bo(ea.seed);ia.b4w_dynamic_grass&&(b.Ui=!0);var cb=sa.zw(W.vs)&&!ia.b4w_initial_rand_rotation&&
!ia.b4w_hair_billboard,za=4;cb&&(za=8);if(ea.transforms.length)var ua=ea.transforms;else for(var Da=da.Ar(ba,ia.count,!1,Y),ua=new Float32Array(Da.length*za),Ea=0;Ea<Da.length;Ea++){var Cc=.75+.5*V.Pd(Y);ua[Ea*za]=Da[Ea][0];ua[Ea*za+1]=Da[Ea][1];ua[Ea*za+2]=Da[Ea][2];ua[Ea*za+3]=Cc;cb&&(ua[Ea*za+4]=1,ua[Ea*za+5]=0,ua[Ea*za+6]=0,ua[Ea*za+7]=0)}var Ya=na.Ya(e,"GRASS_MAP")?!0:!1;if("OBJECT"==ia.render_type)var lb=[v(e,ia.dupli_object.ad.f,!0)],Kb=u(a,b,H,ba,[ia.dupli_object.ad],lb,[ua],ia,ea,Ya,Y,!1),
ca=ca.concat(Kb);else if("GROUP"==ia.render_type){for(var Db=[],oc=ia.dupli_group.objects,Ea=0;Ea<oc.length;Ea++)Db.push(oc[Ea].ad);for(var Rb=!1,lb=[],Ea=0;Ea<Db.length;Ea++){var Yb=v(e,ia.dupli_group.objects[Ea].ad.f,!0);lb.push(Yb)}if(ia.use_whole_group){for(var ab,yb=ua,dc=Db,yc=cb,Lb=za,sb={},tb=new Float32Array([0,0,0,1]),Oa=0;Oa<yb.length;Oa+=Lb)for(var Wa=0;Wa<dc.length;Wa++){var Eb=ha.create();ha.scale(dc[Wa].f.i,dc[Wa].f.scale,Eb);var ec=ha.clone([yb[Oa],yb[Oa+1],yb[Oa+2]]);sb[Wa]||(sb[Wa]=
new Float32Array(yb.length));yc&&(sb[Wa][Oa+4]=tb[0]=yb[Oa+4],sb[Wa][Oa+5]=tb[1]=yb[Oa+5],sb[Wa][Oa+6]=tb[2]=yb[Oa+6],sb[Wa][Oa+7]=tb[3]=yb[Oa+7],V.at(tb,tb),V.uM(Eb,tb,Eb));ha.add(ec,Eb,ec);sb[Wa][Oa]=ec[0];sb[Wa][Oa+1]=ec[1];sb[Wa][Oa+2]=ec[2];sb[Wa][Oa+3]=yb[Oa+3]}ab=sb;Rb=!0}else{var pc;if(ia.use_group_count){for(var db=ua,qc=Db,Mb=ia.dupli_weights,eb=Y,Ia=cb,zb=za,fb={},Ja=[],Ba=0;Ba<qc.length;Ba++)for(var mb=qc[Ba],wa=mb.Zh||mb.name,bb=0;bb<Mb.length;bb++){var Sa=Mb[bb];wa==Sa.name&&Ja.push(Sa)}Mb.length!=
Ja.length&&P.error("dupli weights match failed");for(Ba=0;Ba<db.length;Ba+=zb){for(var ib,Ka=Ja,ub=[0],Ta=0;Ta<Ka.length;Ta++)ub[Ta+1]=ub[Ta]+Ka[Ta].count;for(var hc=ub[ub.length-1]*V.Pd(eb),Ab=0,Ta=0;Ta<ub.length;Ta++)if(hc>=ub[Ta]&&hc<ub[Ta+1]){Ab=Ta;break}ib=Ab;fb[ib]=fb[ib]||[];fb[ib].push(db[Ba],db[Ba+1],db[Ba+2],db[Ba+3]);Ia&&fb[ib].push(db[Ba+4],db[Ba+5],db[Ba+6],db[Ba+7])}for(ib in fb)fb[ib]=new Float32Array(fb[ib]);pc=fb}else{for(var nb=ua,Fb=Y,ob=cb,Bb=za,zc=Db.length,Xa={},Ca=0;Ca<nb.length;Ca+=
Bb){var Ua=Math.floor(zc*V.Pd(Fb));Xa[Ua]=Xa[Ua]||[];Xa[Ua].push(nb[Ca],nb[Ca+1],nb[Ca+2],nb[Ca+3]);ob&&Xa[Ua].push(nb[Ca+4],nb[Ca+5],nb[Ca+6],nb[Ca+7])}for(Ua in Xa)Xa[Ua]=new Float32Array(Xa[Ua]);pc=Xa}ab=pc}Kb=u(a,b,H,ba,Db,lb,ab,ia,ea,Ya,Y,Rb);ca=ca.concat(Kb)}"INSTANCE"==ia.b4w_wind_bend_inheritance&&a.f.zd&&P.warn('Emitter object "'+a.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";
}T=ca;f=ta?f.concat(T):T}return f}function x(a,b,e,k){a.iq=ba.Qw(b,k);a.gq=ba.Ow(e,k);a.hq=ba.Pw(b,k)}function v(a,b,e){var k;b.Cn&&!e?(k=[],b.Ef&&na.Ya(a,"COLOR_PICKING")&&k.push("COLOR_ID")):(k=["MAIN","NODES_GLOW"],(b.Ef&&na.Ya(a,"COLOR_PICKING")||b.Db&&na.Ya(a,"OUTLINE_MASK"))&&!e&&k.push("COLOR_ID"),na.Ya(a,"WIREFRAME")&&k.push("WIREFRAME"),(na.Ya(a,"DEPTH")||na.Ya(a,"SHADOW_CAST"))&&k.push("DEPTH"),na.Ya(a,"GRASS_MAP")&&k.push("GRASS_MAP"));k.push("PHYSICS");if(b.Uc||b.nc)for(a=null,b.Uc&&(a=
["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","WIREFRAME"]),b.nc&&(b=["COLOR_ID","PHYSICS","DEPTH","WIREFRAME"],a=null!==a?V.ZE(a,b):b),b=a,a=0;a<b.length;a++)e=k.indexOf(b[a]),-1!==e&&k.splice(e,1);return k}function g(a,b){var e;switch(a.type){case "MAIN":if(b.b4w_do_not_render)e=!1;else{if(b.use_nodes)n(a,b,"MAIN");else{f(a,b);var c=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Yh=b.offset_z;a.Kg.set([1,1,1]);var m=b.texture_slots;Z.set(b.diffuse_color[0],b.diffuse_color[1],
b.diffuse_color[2],b.alpha,a.Yd);switch(b.name){case "LENS_FLARES":K(a,"special_lens_flares.glslv","special_lens_flares.glslf");w(a,"a_position");w(a,"a_texcoord");var g=A(m[0],null);k(a,g);break;default:K(a,"main_stack.glslv","main_stack.glslf");b.use_shadeless||(e=ca.Pq(b.uuid,b.name,{yd:b.use_shadeless,Zk:b.diffuse_shader,Vj:b.specular_shader}),a.ib.pg=ca.on(e));var h=F("use_map_color_diffuse",m),u=F("use_map_color_spec",m),q=F("use_map_normal",m),z=F("use_map_mirror",m),g=F("use_stencil",m);e=
h[0];u=u[0];q=q[0];z=z[0];h=h[1];m=g[0]&&F("use_rgb_to_intensity",m)[0];if(e){switch(e.blend_type){case "MIX":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}g=A(e,null);k(a,g,"u_colormap0");W.Yp&&"CLIP"==c&&X.em(g,X.Zc,X.Zc);a.Xk=e.diffuse_color_factor;a.Bk=e.use_map_alpha?e.alpha_factor:0;a.Kg.set(e.scale)}c=e&&e==u;u&&(c||(g=A(u,null),k(a,g,"u_specmap0")),a.kp=u.specular_color_factor);if(q&&(w(a,"a_normal"),w(a,"a_tangent"),
g=A(q,null),k(a,g,"u_normalmap0"),a.Rz=q.normal_factor,g=q.texture,g.b4w_use_map_parallax&&W.Ol)){var l=N.M(g.b4w_parallax_steps),G=N.M(g.b4w_parallax_lod_dist);d(a,"PARALLAX",1);d(a,"PARALLAX_STEPS",l);d(a,"PARALLAX_LOD_DIST",G);a.Ao=g.b4w_parallax_scale}z&&(g=A(z,null),k(a,g,"u_mirrormap"),a.Cs=z.mirror_factor);if(z=e&&h&&m?1:0)g=A(h,null),k(a,g,"u_colormap1"),g=A(m,null),k(a,g,"u_stencil0");(g=e||u||q)&&a.Kg.set(g.scale);d(a,"TEXTURE_SPEC",void 0==u?0:1);d(a,"ALPHA_AS_SPEC",c?1:0);d(a,"TEXTURE_STENCIL_ALPHA_MASK",
z);w(a,"a_position");w(a,"a_normal");(e||u||q)&&w(a,"a_texcoord");if(b.b4w_water){a.vi=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Ma?(P.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.Ju=!1):a.Ju=b.b4w_water_shore_smoothing;K(a,"special_water.glslv","special_water.glslf");c=ca.Pq(b.uuid,b.name,{yd:!1,Zk:b.diffuse_shader,Vj:b.specular_shader});a.ib.pg=ca.on(c);w(a,"a_position");W.IC?(w(a,"a_polyindex"),a.ha=!0,a.wireframe_edge_color=[0,0,0],d(a,
"DEBUG_WIREFRAME",1)):d(a,"DEBUG_WIREFRAME",0);z=b.texture_slots;c=F("use_map_normal",z);g=F("use_map_mirror",z)[0];c.length&&(l=A(c[0]),k(a,l,"u_normalmap0"),a.Fp=b.b4w_water_norm_uv_velocity);d(a,"NUM_NORMALMAPS",c.length);a.Wh=Array(c.length);for(l=0;l<c.length;l++)a.Wh[l]=new Float32Array(2),a.Wh[l].set([c[l].scale[0],c[l].scale[1]]);g&&(l=A(g),k(a,l,"u_mirrormap"),a.Cs=g.mirror_factor);g=null;if(W.hl)for(l=0;l<z.length;l++){var E=z[l];if(!0===E.texture.b4w_water_foam){g=E;break}}g?(d(a,"FOAM",
1),l=A(g),k(a,l,"u_foam"),a.Kn=b.b4w_foam_factor,a.Dx.set(g.texture.b4w_foam_uv_freq),a.Cx.set(g.texture.b4w_foam_uv_magnitude),a.tr[0]=g.scale[0],a.tr[1]=g.scale[1]):d(a,"FOAM",0);for(l=0;l<z.length;l++)if(E=z[l],!0===E.texture.b4w_shore_dist_map){var B=E;break}B&&W.Xp?(B=A(B),k(a,B,"u_shore_dist_map"),d(a,"SHORE_PARAMS",1),B=E.texture.b4w_shore_boundings,d(a,"MAX_SHORE_DIST",N.M(E.texture.b4w_max_shore_dist)),d(a,"SHORE_MAP_SIZE_X",N.M(B[0]-B[1])),d(a,"SHORE_MAP_SIZE_Y",N.M(B[2]-B[3])),d(a,"SHORE_MAP_CENTER_X",
N.M((B[0]+B[1])/2)),d(a,"SHORE_MAP_CENTER_Y",N.M((B[2]+B[3])/2))):d(a,"SHORE_PARAMS",0);if(b.b4w_generated_mesh&&W.Wk)d(a,"GENERATED_MESH",1),a.FC=!0,a.GC=b.b4w_water_num_cascads,a.HC=b.b4w_water_subdivs,a.EC=b.b4w_water_detailed_dist;else{w(a,"a_normal");if(g||c.length)w(a,"a_texcoord"),w(a,"a_tangent");d(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var E=N.M(b.b4w_water_dst_noise_scale0),B=N.M(b.b4w_water_dst_noise_scale1),c=N.M(b.b4w_water_dst_noise_freq0),z=N.M(b.b4w_water_dst_noise_freq1),g=
N.M(b.b4w_water_dir_min_shore_fac),l=N.M(b.b4w_water_dir_freq),G=N.M(b.b4w_water_dir_noise_scale),C=N.M(b.b4w_water_dir_noise_freq),ja=N.M(b.b4w_water_dir_min_noise_fac),r=N.M(b.b4w_water_dst_min_fac),x=N.M(b.b4w_water_waves_hor_fac);d(a,"DST_NOISE_SCALE_0",E);d(a,"DST_NOISE_SCALE_1",B);d(a,"DST_NOISE_FREQ_0",c);d(a,"DST_NOISE_FREQ_1",z);d(a,"DIR_MIN_SHR_FAC",g);d(a,"DIR_FREQ",l);d(a,"DIR_NOISE_SCALE",G);d(a,"DIR_NOISE_FREQ",C);d(a,"DIR_MIN_NOISE_FAC",ja);d(a,"DST_MIN_FAC",r);d(a,"WAVES_HOR_FAC",
x)}J(a,b);D(a,b);a.bp.set(b.b4w_shallow_water_col);a.fp.set(b.b4w_shore_water_col);a.cp=b.b4w_shallow_water_col_fac;a.gp=b.b4w_shore_water_col_fac;d(a,"ABSORB",N.M(b.b4w_water_absorb_factor));d(a,"SSS_STRENGTH",N.M(b.b4w_water_sss_strength));d(a,"SSS_WIDTH",N.M(b.b4w_water_sss_width))}"HALO"===b.type&&(E=b.halo,K(a,"halo.glslv","halo.glslf"),d(a,"NUM_RINGS",E.ring_count),d(a,"NUM_LINES",E.line_count),d(a,"NUM_STARS",E.star_tip_count),d(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.Pk=["a_position"],a.Xy=
E.size,a.Uy=E.hardness/20,a.Wy.set(E.b4w_halo_rings_color),a.Vy.set(E.b4w_halo_lines_color),a.Yy=1/b.b4w_halo_stars_blend_height,a.Zy=b.b4w_halo_stars_min_height,a.Ty=!0);d(a,"TEXCOORD",0);d(a,"NORMAL_TEXCOORD",0);e&&p(a,e,"TEXTURE_COLOR0_CO");h&&p(a,h,"TEXTURE_COLOR1_CO");m&&p(a,m,"TEXTURE_STENCIL_ALPHA_MASK_CO");u&&p(a,u,"TEXTURE_SPEC_CO");q&&p(a,q,"TEXTURE_NORM_CO");d(a,"SHADELESS",b.use_shadeless?1:0);a.yd=b.use_shadeless}c=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===c?0:1);d(a,"ALPHA_CLIP",
"CLIP"===c?1:0);d(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(d(a,"VERTEX_COLOR",1),w(a,"a_color")):d(a,"VERTEX_COLOR",0);a.Di=b.ambient;a.Yk=b.diffuse_intensity;a.Wi=b.emit;a.fm.set(b.specular_color);a.Rt=b.specular_alpha;J(a,b);D(a,b);b.b4w_wettable?d(a,"WETTABLE",1):d(a,"WETTABLE",0);H(a,b);a.ft=b.b4w_refractive;a.CA=b.b4w_refr_bump}e=!0}break;case "NODES_GLOW":e=n(a,b,"GLOW");break;case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||
"HALO"===b.type)e=!1;else if(f(a,b),a.Ma)e=!1;else{u=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==u?n(a,b,"DEPTH"):(K(a,"depth.glslv","depth.glslf"),Z.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Yd));w(a,"a_position");w(a,"a_normal");d(a,"ALPHA","OPAQUE"===u?0:1);a.Kg.set([1,1,1]);if((e=F("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===u){a.Kg.set(e.scale);d(a,"TEXTURE_COLOR",1);w(a,"a_texcoord");if("IMAGE"==e.texture.k.source||"ENVIRONMENT_MAP"==e.texture.k.source)u=
A(e),k(a,u,"u_colormap0");"NONE"==e.texture.k.source&&(u=A(e),k(a,u,"u_colormap0"))}else d(a,"TEXTURE_COLOR",0);e=!0}break;case "PHYSICS":b.b4w_collision?(a.pm=b.b4w_use_ghost,a.ob=b.b4w_collision_id,a.Nk=b.b4w_collision_margin,a.Lk=b.b4w_collision_group,a.Ok=b.b4w_collision_mask,a.ll=b.physics.friction,a.el=b.physics.elasticity,e=!0):b.b4w_water?(a.vi=!0,a.BN=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,
a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,e=!0):e=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||"HALO"===b.type)e=!1;else{f(a,b);a.Of=da.bf;a.ha=!0;a.Ma=!1;u=b.game_settings.alpha_blend;a.Nf=
b.b4w_render_above_all&&"OPAQUE"!=u&&"CLIP"!=u;b.use_nodes&&"CLIP"==u?n(a,b,"COLOR_ID"):(K(a,"color_id.glslv","color_id.glslf"),Z.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Yd));w(a,"a_position");d(a,"ALPHA","OPAQUE"===u?0:1);a.Kg.set([1,1,1]);if((e=F("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===u){a.Kg.set(e.scale);d(a,"TEXTURE_COLOR",1);w(a,"a_texcoord");if("IMAGE"==e.texture.k.source||"ENVIRONMENT_MAP"==e.texture.k.source)u=A(e),k(a,u,"u_colormap0");"NONE"==
e.texture.k.source&&(u=A(e),k(a,u,"u_colormap0"))}else d(a,"TEXTURE_COLOR",0);e=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?e=!1:(f(a,b),a.Ma=!1,a.Of=da.bf,a.ha=!0,K(a,"grass_map.glslv","grass_map.glslf"),w(a,"a_position"),e=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,u=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Nb.a_grass_size={Eh:!0,src:[]},e?(a.Nb.a_grass_size.src.push({name:e,Nd:4}),d(a,"DYNAMIC_GRASS_SIZE",1)):d(a,"DYNAMIC_GRASS_SIZE",0),a.Nb.a_grass_color=
{Eh:!0,src:[]},u?(a.Nb.a_grass_color.src.push({name:u,Nd:7}),d(a,"DYNAMIC_GRASS_COLOR",1)):d(a,"DYNAMIC_GRASS_COLOR",0),e=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?e=!1:(K(a,"wireframe.glslv","wireframe.glslf"),w(a,"a_position"),w(a,"a_normal"),w(a,"a_polyindex"),a.ha=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],e=!0);break;case "PARTICLES":if(b.b4w_do_not_render)e=!1;else{e=b.texture_slots;if(a.Fh)K(a,"particles_color.glslv","particles_color.glslf");
else if(K(a,"particles_texture.glslv","particles_texture.glslf"),u=ca.Pq(b.uuid,b.name,{yd:!1,Zk:b.diffuse_shader,Vj:b.specular_shader}),a.ib.pg=ca.on(u),e=F("use_map_color_diffuse",e)[0]){d(a,"TEXTURE_COLOR",1);switch(e.blend_type){case "MIX":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Xk=e.diffuse_color_factor;a.Bk=e.use_map_alpha?e.alpha_factor:0;e=A(e);k(a,e)}Z.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.Yd);a.Di=b.ambient;a.Yk=b.diffuse_intensity;a.Wi=b.emit;a.fm.set(b.specular_color);a.Rt=b.specular_alpha;w(a,"a_position");w(a,"a_normal");e=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===e?0:1);d(a,"ALPHA_CLIP","CLIP"===e?1:0);d(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);J(a,b);D(a,b);f(a,b);e=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;a.Yh=b.offset_z;e=!0}break;default:throw"Wrong batch type: "+a.type;}return e}function p(a,b,e){switch(b.texture_coords){case "UV":case "ORCO":d(a,
e,"TEXTURE_COORDS_UV_ORCO");d(a,"TEXCOORD",1);break;case "NORMAL":d(a,e,"TEXTURE_COORDS_NORMAL");d(a,"NORMAL_TEXCOORD",1);break;default:d(a,e,0)}}function f(a,b){var e=b.game_settings,k=e.alpha_blend;switch(k){case "ALPHA_SORT":a.Ma=!0;a.Of=da.Av;a.ha=!0;a.dh=!1;break;case "ALPHA":a.Ma=!0;a.Of=da.bf;a.ha=!0;a.dh=!1;break;case "CLIP":a.Ma=!1;a.Of=da.bf;a.ha=!0;a.dh=!0;break;case "ADD":a.Ma=!0;a.Of=da.bf;a.ha=!1;a.dh=!1;break;case "OPAQUE":a.Ma=!1;a.Of=da.bf;a.ha=!0;a.dh=!1;break;default:throw Error("Unknown alpha blend mode: "+
k);}a.bb=e.use_backface_culling}function A(a,b){var e=a.texture,k=e.k,e=e.image;k&&b&&e&&X.lm(k,b,e.$c,e.filepath);return k}function F(a,b){for(var e=[],k=b.length,d=0;d<k;d++){var f=b[d];1==f[a]&&f.texture&&f.texture.k&&e.push(f)}return e}function H(a,b){var e=b.raytrace_transparency;a.Dh[0]=e.fresnel;a.Dh[1]=1-e.fresnel_factor/5;e=b.raytrace_mirror;a.Oo=e.reflect_factor;a.Dh[2]=e.fresnel;a.Dh[3]=1-e.fresnel_factor/5}function J(a,b){var e,k=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":e=
b.specular_hardness;break;case "WARDISO":e=b.specular_slope;break;case "TOON":e=b.specular_toon_size;k=b.specular_toon_smooth;break;case "BLINN":e=b.specular_ior;k=b.specular_hardness;break;default:P.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),e=b.specular_hardness}a.Uj[0]=b.specular_intensity;a.Uj[1]=e;a.Uj[2]=k}function D(a,b){switch(b.diffuse_shader){case "LAMBERT":a.fd[0]=0;a.fd[1]=0;break;case "OREN_NAYAR":a.fd[0]=b.roughness;a.fd[1]=0;break;case "FRESNEL":a.fd[0]=
b.diffuse_fresnel;a.fd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.fd[0]=b.darkness;a.fd[1]=0;break;case "TOON":a.fd[0]=b.diffuse_toon_size;a.fd[1]=b.diffuse_toon_smooth;break;default:P.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.fd[0]=0,a.fd[1]=0}}function n(a,b,e){if(!b.use_nodes||b.b4w_do_not_render)return!1;var c;switch(e){case "MAIN":K(a,"main.glslv","main.glslf");c=!1;break;case "GLOW":K(a,"main.glslv","main.glslf");c=!0;break;case "DEPTH":K(a,
"depth.glslv","depth.glslf");c=!1;break;case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf"),c=!1}e=ca.fG(b.node_tree,b.uuid,!1,b.name,e);if(!e)return P.error('Failed to create node graph for material "'+b.name+'", disable nodes'),C(a,b),!0;a.ij=!0;d(a,"NODES",1);d(a,"NODES_GLOW",c?1:0);var m=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===m?0:1);d(a,"ALPHA_CLIP","CLIP"===m?1:0);d(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);w(a,"a_position");b.use_orco_tex_coord&&w(a,"a_orco_tex_coord");
f(a,b);a.Yh=b.offset_z;m=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=m&&"CLIP"!=m;Z.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Yd);a.Wi=b.emit;a.Di=b.ambient;H(a,b);b.b4w_wettable?d(a,"WETTABLE",1):d(a,"WETTABLE",0);a.ib.pg=ca.on(e);var g=!1;ka.V(e,function(b,e){switch(e.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var f=e.data.name,c=e.data.value;a.si||(a.si={});a.si[c]=f;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":f=
e.data.name;a.Nb[f]={Eh:!0,src:[{name:e.data.value}]};c=0;if("GEOMETRY_VC"==e.type)c=7;else for(var h=0;h<e.ta.length;h++){var u="RGB".indexOf(e.ta[h].identifier);-1<u&&(c|=1<<2-u)}a.Nb[f].src[0].Nd=c;break;case "TEX_COORD_NO":case "GEOMETRY_NO":w(a,"a_normal");break;case "MATERIAL_BEGIN":w(a,"a_normal");g=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":f=e.data.name;c=e.data.value;!1!==c.k.Qm&&(c.k.Qm="TEXTURE_ENVIRONMENT"!=e.type?!0:!1);k(a,c.k,f);W.Yp&&"CLIP"==m&&X.em(e.data.value.k,X.Zc,
X.Zc);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":d(a,"CALC_TBN_SPACE",1);w(a,"a_normal");w(a,"a_tangent");f=e.data.name;c=e.data.value;c.k.Qm=!1;k(a,c.k,f);break;case "LAMP":e.data&&(a.qj=e.data);break;case "B4W_REFRACTION":a.ft=!0}});g||(a.yd=!0);return!0}function C(a,b){switch(a.type){case "DEPTH":K(a,"depth.glslv","depth.glslf");break;case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf");break;default:K(a,"main_stack.glslv","main_stack.glslf")}d(a,"SHADELESS",1);w(a,"a_position");w(a,"a_normal");
Z.set(1,0,1,1,a.Yd);if(b){var e=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===e?0:1);d(a,"ALPHA_CLIP","CLIP"===e?1:0);d(a,"VERTEX_COLOR",0);a.Yh=b.offset_z;f(a,b)}return!0}function B(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.jo?d(a,"AU_QUALIFIER","attribute"):d(a,"AU_QUALIFIER","uniform"),d(a,"STATIC_BATCH",0)):(d(a,"AU_QUALIFIER","attribute"),d(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(S.AI()?d(a,"WIREFRAME_QUALITY",1):d(a,"WIREFRAME_QUALITY",0),a.th?(d(a,"DEBUG_SPHERE",1),a.gx?d(a,
"DEBUG_SPHERE_DYNAMIC",1):d(a,"DEBUG_SPHERE_DYNAMIC",0)):d(a,"DEBUG_SPHERE",0),d(a,"ALPHA",1));b.Xe&&(a.Xe=b.Xe);b.zd?(""!==b.wf?(a.Nb.a_bending_col_main={Eh:!0,src:[{name:b.wf,Nd:4}]},w(a,"a_bending_col_main"),""!==b.ic.xz&&""!==b.ic.wz&&""!==b.ic.aA?(a.Nb.a_bending_col_detail={Eh:!0,src:[{name:b.ic.xz,Nd:4},{name:b.ic.wz,Nd:2},{name:b.ic.aA,Nd:1}]},w(a,"a_bending_col_detail"),w(a,"a_normal"),d(a,"DETAIL_BEND",1)):d(a,"DETAIL_BEND",0),d(a,"MAIN_BEND_COL",1)):d(a,"MAIN_BEND_COL",0),d(a,"WIND_BEND",
1)):d(a,"WIND_BEND",0);b.bn?d(a,"BEND_CENTER_ONLY",1):d(a,"BEND_CENTER_ONLY",0);d(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.lq|0);b.Ud?d(a,"BILLBOARD",1):d(a,"BILLBOARD",0);b.Ud&&b.jo?d(a,"HAIR_BILLBOARD",1):d(a,"HAIR_BILLBOARD",0);b.Dk?d(a,"BILLBOARD_SPHERICAL",1):d(a,"BILLBOARD_SPHERICAL",0);switch(b.Ek){case "RANDOM":d(a,"BILLBOARD_RANDOM",1);d(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":d(a,"BILLBOARD_RANDOM",0);d(a,"BILLBOARD_JITTERED",1);break;default:d(a,"BILLBOARD_RANDOM",0),d(a,"BILLBOARD_JITTERED",
0)}b.Rb&&W.Xp?d(a,"DYNAMIC_GRASS",1):d(a,"DYNAMIC_GRASS",0);a.Rb=b.Rb;a.Ge=b.Ge;a.td=b.td;a.Uc=b.Uc;a.Vc=b.Vc&&!a.yd&&!(a.Ma&&W.nx);a.Cc=b.Cc;a.nc=b.nc;a.Tc=b.Tc;b.oj?(w(a,"a_influence"),d(a,"SKINNED",1),b.kl?d(a,"FRAMES_BLENDING",1):d(a,"FRAMES_BLENDING",0),d(a,"MAX_BONES",b.zf)):(d(a,"SKINNED",0),d(a,"FRAMES_BLENDING",0));b.cc?(d(a,"VERTEX_ANIM",1),W.yC?d(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):d(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):d(a,"VERTEX_ANIM",0);if(b.oj&&b.cc)throw"Skinning and vertex animation are mutually exlusive";
b.Bn?d(a,"DISABLE_FOG",1):d(a,"DISABLE_FOG",0);if(a.ij){for(var e=a.ib.pg,k=b.Sh,f=b.Rh,c=0;c<e.length;c++){var m=e[c];switch(m.id){case "VALUE":var g=m.Bo[0];if(g)for(var h=0;h<k.length;h+=2)if(k[h]==g){m.Hd.push(["VALUE_IND",k[h+1]]);break}break;case "RGB":if(g=m.Bo[0])for(h=0;h<f.length;h+=2)if(f[h]==g){m.Hd.push(["RGB_IND",f[h+1]]);break}}}d(a,"NUM_VALUES",b.yf.length);d(a,"NUM_RGBS",b.ld.length)}}}function q(a,b,e){if(b.length){for(var k=ia.Jr(b)||b[0],d=a.ib,f=0,c=0;c<a.ib.pg.length;c++){var g=
a.ib.pg[c];if("LIGHTING_LAMP"==g.id){var h=b[f++%b.length],u=h.jc;"AREA"==u.type&&(h=b[f++%b.length],u=h.jc);var q=ia.Qa(h,e);if("SPOT"==u.type||"POINT"==u.type)var n=Math.cos(u.Hg/2);if("SPOT"==u.type)var z=u.lp*(1-n);q=q.El;h=h==k?0:-1;g.Hd=[["LAMP_TYPE",u.type],["LAMP_IND",q],["LAMP_LIGHT_FACT_IND",Math.floor(q/2)],["LAMP_FAC_CHANNELS",0==q%2?"rg":"ba"],["LAMP_SPOT_SIZE",N.M(n||.01)],["LAMP_SPOT_BLEND",N.M(z||.01)],["LAMP_LIGHT_DIST",N.M(u.distance)],["LAMP_SHADOW_MAP_IND",h]]}}if(a.qj){e=0;for(var l in a.qj)e++;
a.ms=new Float32Array(3*e);a.ks=new Float32Array(3*e);a.js=new Float32Array(3*e);a.ls=new Float32Array(4*e);N.I(d,"NUM_LAMP_LIGHTS",e);for(c=0;c<b.length;c++)m(a,b[c])}}}function m(a,b){var e=b.La.uuid;if(e in a.qj){e=a.qj[e];a.ms.set(b.f.i,3*e);a.ks.set(b.jc.direction,3*e);a.js.set(b.jc.nn,3*e);var k=ta,d=b.jc;k[0]=-1;k[1]=-1;k[2]=-1;k[3]=d.ri?1:0;switch(d.type){case "POINT":k[2]=d.distance;break;case "SPOT":k[2]=d.distance;var f=k[0]=Math.cos(d.Hg/2);k[1]=d.lp*(1-f)}a.ls.set(k,4*e)}}function w(a,
b){var e=a.Pk;-1==e.indexOf(b)&&e.push(b)}function d(a,b,e){N.I(a.ib,b,e)}function I(a,b){if("PHYSICS"==a.type)a.vd=b;else{var e=a.Of,k=a.$f;a.Ty&&(b=da.vH(b));a.FC&&(b=R.SH(a.GC,a.HC,a.EC));e=da.jM(b,e,k,a.Nb);a.ca=e;a.Ge||e.ao||a.Xe||(e.Gh=null,e.pe=null);e=b.B.length;a.Ms=b.R*e;a:switch(a.$f){case da.wk:case da.Bm:case da.Am:k=!0;break a;default:k=!1}k?da.fJ(b)?a.Il=b.sa.length/3*e:a.Il=b.R/3*e:a.Il=0}}function u(a,b,e,k,d,f,c,m,g,h,u,q){var n=[],w=m.b4w_dynamic_grass;if(!h&&w)return n;for(var p=
"INSTANCE"==m.b4w_wind_bend_inheritance,C="INSTANCE"==m.b4w_shadow_inheritance,ja="INSTANCE"==m.b4w_reflection_inheritance,r=[],x=[],K=0;K<d.length;K++){var A=d[K],M=V.Kk(b);M.Ud=m.b4w_hair_billboard;M.Ek=m.b4w_hair_billboard_type;M.Dk="SPHERICAL"==m.b4w_hair_billboard_geometry;M.Rb=w;M.jo=!0;M.yf=A.f.yf;M.Sh=A.f.Sh;M.ld=A.f.ld;M.Rh=A.f.Rh;p?(M.zd=A.f.zd,M.tm=A.f.tm,M.Mf=A.f.Mf,M.lf=A.f.lf,M.wf=A.f.wf,M.kf=A.f.kf,M.ef=A.f.ef,M.Ye=A.f.Ye,M.ic=A.f.ic,M.bn=!1):(M.zd=a.f.zd,M.tm=a.f.tm,M.Mf=a.f.Mf,M.lf=
a.f.lf,M.wf=a.f.wf,M.kf=a.f.kf,M.ef=a.f.ef,M.Ye=a.f.Ye,M.ic=a.f.ic,M.bn=!0);C?(M.td=A.f.td,M.Uc=A.f.Uc,M.Vc=A.f.Vc):(M.td=a.f.td,M.Uc=a.f.Uc,M.Vc=a.f.Vc);ja?(M.Cc=A.f.Cc,M.nc=A.f.nc,M.Tc=A.f.Tc,M.Fd=A.f.Fd,M.pd=A.f.pd,M.Ne=A.f.Ne):(M.Cc=a.f.Cc,M.nc=a.f.nc,M.Tc=a.f.Tc,M.Fd=a.f.Fd,M.pd=a.f.pd,M.Ne=a.f.Ne);r.push(M);var F=c[K];F||(F=new Float32Array);q&&V.bo(g.seed,u);var v=new Float32Array(3),Q=new Float32Array([0,0,0,1]),I=[],y=sa.zw(W.vs)&&!m.b4w_initial_rand_rotation&&!m.b4w_hair_billboard,ta=4;
y&&(ta=8);for(var t=0;t<F.length;t+=ta){v[0]=F[t];v[1]=F[t+1];v[2]=F[t+2];var D=F[t+3]*A.f.scale;if(m.b4w_initial_rand_rotation){switch(m.b4w_rotation_type){case "XYZ":var R=new Float32Array([V.Pd(u),V.Pd(u),V.Pd(u)]);ha.normalize(R,R);break;case "Z":R=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+m.b4w_rotation_type;}ra.setAxisAngle(R,m.b4w_rand_rotation_strength*(2*Math.PI*V.Pd(u)-Math.PI),Q)}else y&&(Q.set(F.subarray(t+4,t+8)),V.at(Q,Q),m.use_whole_group||(m.use_rotation_dupli?
ra.multiply(Q,A.f.quat,Q):ra.multiply(Q,L,Q)));var H=ga.Fe(v,D,Q);I.push(H)}x.push(I)}for(var aa={},K=0;K<d.length;K++){var A=d[K],J=A.La,la=f[K],M=r[K],U={};M.zd&&(U.au_wind_bending_amp=[M.Ye],U.au_wind_bending_freq=[M.Mf],U.au_detail_bending_freq=[M.lf],U.au_detail_bending_amp=[M.kf],U.au_branch_bending_amp=[M.ef],M.Ye=0,M.Mf=0,M.lf=0,M.kf=0,M.ef=0);var N=G(M),I=x[K];if(I.length)for(var oa=J.data,T=oa.materials,ba=Array(T.length),t=0;t<T.length;t++)if(!da.az(oa,t))for(var X=0;X<la.length;X++){var na=
la[X],ca=l(na),S=T[t];"COLOR_ID"==na&&(ca.yq=!(J.b4w_do_not_render||S.b4w_do_not_render));"MAIN"==na&&(ba[t]=ca);if(E(ca,S)){"DEPTH"==na&&ba[t]&&(ca.yd=ba[t].yd);ca.$f=da.wk;B(ca,M);ca.Dj=m.uuid;"JITTERED"==m.b4w_hair_billboard_type&&(ca.rz=m.b4w_hair_billboard_jitter_amp,ca.sz=m.b4w_hair_billboard_jitter_freq);w&&(ca.Ry=m.b4w_dynamic_grass_scale_threshold);p||(delete ca.Nb.a_bending_col_main,delete ca.Nb.a_bending_col_detail);z(ca,N);var ka=da.wx(oa,t,ca.Pk,b.Ki,ca.Nb,ca.si),ea=da.PJ(ka,U,I),fa=
ea,ia=I;fa.N.au_center_pos=new Float32Array(3*fa.R);for(var cc=ia.length,xb=fa.R/cc,ya=0;ya<cc;ya++)for(var rb=ia[ya],Y=3*xb*ya,cb=0;cb<xb;cb++)fa.N.au_center_pos[Y+3*cb]=rb[0],fa.N.au_center_pos[Y+3*cb+1]=rb[1],fa.N.au_center_pos[Y+3*cb+2]=rb[2];ea=fa;if(M.zd&&M.bn){var za=ea,ua=a.f.ea;za.N.a_emitter_center=new Float32Array(3*za.R);var Da=Z.fromValues(0,0,0,1);Z.transformMat4(Da,ua,Da);for(var Ea=0;Ea<za.R;Ea++)za.N.a_emitter_center[3*Ea]=Da[0],za.N.a_emitter_center[3*Ea+1]=Da[1],za.N.a_emitter_center[3*
Ea+2]=Da[2];ea=za}var Cc=m.b4w_vcol_from_name,Ya=m.b4w_vcol_to_name,lb=ca,Kb=e,Db=!p,oc=oa,Rb=[];if(""!==Cc&&""!==Ya){var Yb,ab=Ya,yb=lb.Nb,dc=[],yc=void 0;for(yc in yb)for(var Lb=yb[yc].src,sb=0,tb=0;tb<Lb.length;tb++){var Oa=Lb[tb].Nd;ab==Lb[tb].name&&dc.push(yc,Oa,sb);sb+=V.ii(Oa)}Yb=dc;if(0<Yb.length)for(var Wa=0;Wa<Yb.length;Wa+=3)Rb.push({fl:Cc,Gn:7,Co:Yb[Wa],Do:Yb[Wa+1],Dn:Yb[Wa+2]});else da.KI(lb.Pk,"a_color")&&Ya==oc.active_vcol_name&&Rb.push({fl:Cc,Gn:7,Co:"a_color",Do:7,Dn:0})}Db&&("a_bending_col_main"in
Kb&&Rb.push({fl:"a_bending_col_main",Gn:4,Co:"a_bending_col_main",Do:4,Dn:0}),"a_bending_col_detail"in Kb&&Rb.push({fl:"a_bending_col_detail",Gn:7,Co:"a_bending_col_detail",Do:7,Dn:0}));for(var Eb=ea,ec=I,pc=k,db=Rb,qc=ca.Nb,Mb=!1,eb=0;eb<db.length;eb++){var Ia=db[eb].fl,zb=pc.N[Ia];if(zb&&0<zb.length){Mb=!0;break}}if(Mb){var fb,Ja=a.f.Yb,Ba=pc.B[0].a_position,mb=ec,wa=aa,bb=new Float32Array(3),Sa=new Float32Array(3),ib=new Uint32Array(mb.length);if(!("verts_indices"in wa)){wa.hf=new Float32Array(3);
wa.df=new Float32Array(3);wa.Hu=new Uint32Array(Ba.length/3);wa.Kl=new Uint32Array(Ba.length/3);wa.hf[0]=(Ja.max_x-Ja.min_x)/20;wa.hf[1]=(Ja.max_y-Ja.min_y)/20;wa.hf[2]=(Ja.max_z-Ja.min_z)/20;wa.df[0]=Ja.min_x;wa.df[1]=Ja.min_y;wa.df[2]=Ja.min_z;for(var Ka=0;Ka<Ba.length/3;Ka++){var ub=V.trunc((Ba[3*Ka]-wa.df[0])/wa.hf[0]),Ta=V.trunc((Ba[3*Ka+1]-wa.df[1])/wa.hf[1]),hc=V.trunc((Ba[3*Ka+2]-wa.df[2])/wa.hf[2]),ub=V.da(ub,0,19),Ta=V.da(Ta,0,19),hc=V.da(hc,0,19);wa.Hu[Ka]=Ka;wa.Kl[Ka]=hc*Math.pow(20,2)+
20*Ta+ub}da.FB(wa.Kl,wa.Hu,da.Rp,!0);wa.ti=new Uint32Array(Math.pow(20,3));for(Ka=0;Ka<wa.Kl.length;Ka++)wa.ti[wa.Kl[Ka]]++;delete wa.Kl;for(Ka=1;Ka<wa.ti.length;Ka++)wa.ti[Ka]+=wa.ti[Ka-1]}for(var Ab=0;Ab<mb.length;Ab++){bb[0]=mb[Ab][0];bb[1]=mb[Ab][1];bb[2]=mb[Ab][2];for(var nb=1E10,Fb=-1,ob=V.trunc((bb[0]-wa.df[0])/wa.hf[0]),Bb=V.trunc((bb[1]-wa.df[1])/wa.hf[1]),zc=V.trunc((bb[2]-wa.df[2])/wa.hf[2]),ob=V.da(ob,0,19),Bb=V.da(Bb,0,19),zc=V.da(zc,0,19),Xa=zc*Math.pow(20,2)+20*Bb+ob,Ca=wa.ti[Xa],Ua=
0==Xa?0:wa.ti[Xa-1];Ua<Ca;Ua++){var Ac=wa.Hu[Ua];Sa[0]=Ba[3*Ac];Sa[1]=Ba[3*Ac+1];Sa[2]=Ba[3*Ac+2];ha.sub(Sa,bb,Sa);var Ib=ha.sqrLen(Sa);Ib<=nb&&(nb=Ib,Fb=Ac)}if(-1==Fb)for(Ua=0;Ua<Ba.length/3;Ua++)Sa[0]=Ba[3*Ua],Sa[1]=Ba[3*Ua+1],Sa[2]=Ba[3*Ua+2],ha.sub(Sa,bb,Sa),Ib=ha.sqrLen(Sa),Ib<=nb&&(nb=Ib,Fb=Ua);ib[Ab]=Fb}fb=ib;for(var rc=Eb.R/ec.length,eb=0;eb<db.length;eb++){var Pa=db[eb].Co,Jb=db[eb].Do,Ia=db[eb].fl,fc=db[eb].Gn,zb=pc.N[Ia];switch(Pa){case "a_bending_col_main":var Za=1;break;case "a_bending_col_detail":Za=
3;break;case "a_color":Za=3;break;default:for(var Cb=Za=0;Cb<qc[Pa].src.length;Cb++)Za+=V.ii(qc[Pa].src[Cb].Nd)}if(zb&&0<zb.length){var Nc=V.ii(fc),ic=V.ii(Jb),Sb=fc&Jb,Tb=V.JA(Sb);Sb!=Jb&&P.error("Wrong color extraction from "+Ia+" to "+Pa+".");if("a_bending_col_main"==Pa||"a_bending_col_detail"==Pa)Eb.N[Pa]=new Float32Array(Eb.R*ic);for(Cb=0;Cb<ec.length;Cb++){var jc=fb[Cb],Oc=jc*Nc,Vc=Cb*rc*Za;if(-1!=jc)for(var Zb=0;Zb<rc;Zb++)for(var kc=Zb*Za,vb=0;vb<Tb.length;vb++)Tb[vb]&&(Eb.N[Pa][Vc+kc+(db[eb].Dn+
V.am(Jb,vb))]=zb[Oc+V.am(fc,vb)])}}else Eb.N[Pa]=new Float32Array(0)}}ea=Eb;n.push({C:ca,vd:ea,Pc:[S.name],f:M,je:[a]})}}}return n}function E(a,b){var e=!0;"NODES_GLOW"==a.type&&(e=ca.yw(b));return e=e&&g(a,b)}function z(a,b){for(var e=null,k=null,d=0;d<a.T.length;d++){var f=a.T[d].ff;f&&(e||(e={}),e[d]=f,a.T[d].ff=null);if(f=a.T[d].O)k||(k={}),k[d]=f,a.T[d].O=null}a.id=0;a.PK=b;a.id=V.lw(a,b);if(e)for(var c in e)a.T[c].ff=e[c];if(k)for(c in k)a.T[c].O=k[c]}function G(a){var b=a.Dd;a.Dd=null;var e=
V.lw(a,0);a.Dd=b;return e}function e(a,b,e,k,d){var f=l("WIREFRAME");K(f,"wireframe.glslv","wireframe.glslf");f.wireframe_mode=0;f.th=!0;f.ha=!0;f.Dj=e;d&&(f.gx=!0);B(f,b);b=G(b);z(f,b);k?(k=R.zr(1,a.G),da.LA(k,[a.ze[0],a.Ae[1],a.Be[2]],a.G)):k=R.zr(a.Va,a.G);da.np(k,1,!0);k.N.a_polyindex=da.rr(k);I(f,k);return f}function K(a,b,e){a.ib.tk=b;a.ib.$i=e;N.mL(a.ib)}function k(a,b,e){1==a.T.length&&0==a.ac.length&&a.ac.push("default0");e=e||"default"+String(a.T.length);-1==a.ac.indexOf(e)&&(a.T.push(b),
a.ac.push(e));a.Ec&&oa.Wv(a)}function M(a){if(!a.ib)throw"No shaders info for batch "+a.name;a.Ec=N.dI(a.ib);oa.fF(a.Ec);oa.bF(a);oa.Wv(a)}function Q(a,b,e){a=a.ba[0].W;for(var k=0;k<a.length;k++)if(a[k].type==e&&!a[k].Bh&&-1!=a[k].xf.indexOf(b))return a[k];return null}function aa(a,b,e){a=a.ba[0].W;for(var k=0;k<a.length;k++)if(a[k].type==e&&a[k].Bh&&-1!=a[k].xf.indexOf(b))return a[k];return null}function U(a,b){a.Yd.set(b.Yd);a.Yk=b.Yk;a.fm.set(b.fm);a.kp=b.kp;a.Uj.set(b.Uj);a.Wi=b.Wi;a.Di=b.Di;
a.Xk=b.Xk;a.Bk=b.Bk;a.Oo=b.Oo;a.Dh.set(b.Dh);a.Ao=b.Ao;a.bp.set(b.bp);a.cp=b.cp;a.fp.set(b.fp);a.gp=b.gp;a.Kn=b.Kn;a.Fp=b.Fp}var ba=t("__boundings"),T=t("__camera"),ea=t("__config"),P=t("__print"),S=t("__extensions"),da=t("__geometry"),ka=t("__graph"),ca=t("__nodemat"),ia=t("__obj_util"),fa=t("__particles"),R=t("__primitives"),ra=t("__quat"),sa=t("__reformer"),oa=t("__renderer"),na=t("__scenegraph"),N=t("__shaders"),X=t("__textures"),ga=t("__tsr"),V=t("__util"),ha=t("__vec3"),Z=t("__vec4"),W=ea.r,
ja=["MAIN"],L=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]),ta=new Float32Array(4);a.JN=la;var la="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" ");a.sS=l;a.RH=function(a,b,k,d){for(var f=a.k.zb,m=[],g=[],u=0;u<b.length;u++){var n=b[u];n.Bl||(ia.xa(n)?m.push(n):g.push(n))}for(var u=[],u=u.concat(y(m,f)),g=u=u.concat(h(g,f,a.b4w_batch_grid_size)),f=[],u=[],z={},n=0;n<g.length;n++){var l=g[n].C,w=g[n].f,G=null;if(l.id in z){for(var E=z[l.id],p=u[E].C,B=u[E].f,
C=null,r=null,m=0;m<l.T.length;m++){var A=l.T[m].ff;A&&(C||(C={}),C[m]=A,l.T[m].ff=null);if(A=l.T[m].O)r||(r={}),r[m]=A,l.T[m].O=null}V.PB(l,p)&&V.PB(w,B)&&(G=u[E]);if(C)for(m in C)l.T[m].ff=C[m];if(r)for(m in r)l.T[m].O=r[m];if(!G){do l.id++;while(z[l.id])}}G||(G={C:l,f:g[n].f,je:[],Yt:[],Pc:[]},z[l.id]=u.length,u.push(G));G.je=G.je.concat(g[n].je);g[n].vd&&g[n].vd.R&&G.Yt.push(g[n].vd);if(G.Pc.length)for(m=0;m<g[n].Pc.length;m++)l=g[n].Pc[m],-1==G.Pc.indexOf(l)&&G.Pc.push(l);else G.Pc=g[n].Pc;da.FB(G.Pc,
G.Yt,da.lE,!1)}for(n=0;n<u.length;n++){g=u[n].Yt;if(0==g.length)m=V.Gb(V.ik("%empty"));else if(1==g.length)m=g[0];else{z=[];for(m=0;m<g.length;m++)da.hJ(g[m])||z.push(m);if(z.length<g.length)for(m=0;m<z.length;m++)da.np(g[z[m]]);m=da.iM(g)}f.push({C:u[n].C,f:u[n].f,vd:m,Pc:u[n].Pc,je:u[n].je})}for(u=0;u<f.length;u++)if(g=f[u].C,g.xf=f[u].Pc,I(g,f[u].vd),q(g,k,a),"STATIC"==f[u].f.type&&"COLOR_ID"!=g.type)n=V.ik("%meta%"+g.type+"%"+g.xf.join("%")+"%"),n=ia.Vw(n),n.f=f[u].f,ia.Wm(n,a),ia.Tm(n,a,g),d.push(n);
else for(z=[],m=0;m<f[u].je.length;m++)n=f[u].je[m],-1==z.indexOf(n.name)&&(ia.Tm(n,a,g),z.push(n.name));if(W.wireframe_debug){for(u=0;u<f.length;u++)if(k=f[u].f,"DYNAMIC"==k.type&&(n=f[u].je[0],-1<ja.indexOf(f[u].C.type))){m=ia.Qa(n,a);g=m.W;z=!1;for(m=0;m<g.length;m++)g[m].th&&(z=!0);z||(k=e(k.Sf,k,n.name,!0,!0),ia.Tm(n,a,k))}for(u=0;u<d.length;u++)n=d[u],k=n.f,m=ia.Qa(n,a),g=m.W,-1<ja.indexOf(g[0].type)&&(k=e(k.Ed,k,n.name,!1),ia.Tm(n,a,k))}for(u=0;u<b.length;u++)for(m=ia.Qa(b[u],a),g=m.W,m=0;m<
g.length;m++)c(g[m]);for(u=0;u<d.length;u++)for(m=ia.Qa(d[u],a),g=m.W,m=0;m<g.length;m++)c(g[m])};a.TH=function(a,b){var e=a.k.Nu,f=l("MAIN");K(f,"special_skydome.glslv","special_skydome.glslf");if(b.procedural_skydome)d(f,"PROCEDURAL_SKYDOME",1),f.nA=!0;else{var m=e.Nt;if(m){d(f,"WO_SKYTEX",1);var g=A(e.CB,null);k(f,g,"u_sky");m.invert&&d(f,"MTEX_NEGATIVE",1);m.kN&&d(f,"MTEX_RGBTOINT",1);d(f,"BLENDTYPE",m.nF);m.gN&&d(f,"WOMAP_BLEND",1);m.hN&&d(f,"WOMAP_HORIZ",1);m.jN&&d(f,"WOMAP_ZENUP",1);m.iN&&
d(f,"WOMAP_ZENDOWN",1)}e.lN&&d(f,"WO_SKYBLEND",1);e.mN&&d(f,"WO_SKYPAPER",1);e.nN&&d(f,"WO_SKYREAL",1)}b.Cc&&(f.Cc=!0,b.nc&&(f.nc=!0));f.Yh=99999;w(f,"a_position");e=R.PH();I(f,e);c(f);e=V.ik("%meta_sky%");e=ia.Vw(e);ia.Wm(e,a);m=ia.Qa(e,a);e.f=ia.Si("STATIC");e.f.Ui=!0;e.f.Yb=ba.Qd();e.f.Ed=ba.um();e.f.wb=ba.Qd();e.f.Zb=ba.um();m.W.push(f);return e};a.Sw=function(a,e,k){k=ia.Qa(a,k).W;var d=[],f=na.Ya(e,"SHADOW_CAST"),c=na.Ya(e,"MAIN_PLANE_REFLECT"),m=na.Ya(e,"MAIN_CUBE_REFLECT"),g=na.Ya(e,"OUTLINE_MASK");
e=na.Ya(e,"COLOR_PICKING");for(var u=0;u<k.length;u++){var h=k[u],q=null;"DEPTH"==h.type&&f&&h.td&&(q=b(h),q.$a="SHADOW_CAST");"MAIN"!=h.type&&"PARTICLES"!=h.type||!c&&!m||h.Ma||!h.Cc||(q=b(h),q.$a="REFLECT");"COLOR_ID"==h.type&&h.yq&&g&&a.f.Db&&(e&&a.f.Ef?(q=b(h),q.$a="OUTLINE"):h.$a="OUTLINE");q&&(q.Bh=!0,z(q,a.f.id),d.push(q))}k.push.apply(k,d)};a.sL=x;a.DN=function(a,b,e){if(b)b=e*(b.max_y-b.min_y);else throw"No bounding box for mesh";return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*
Math.PI)+1)+2)/2-1)/b};a.jF=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.$H=A;a.CM=C;a.BM=q;a.rL=m;a.Vv=function(a,b,e){e&&e.j.type==T.ec&&d(a,"PERSPECTIVE_SHADOW_CAST",1);d(a,"CSM_SECTION0",0);d(a,"CSM_SECTION1",0);d(a,"CSM_SECTION2",0);d(a,"CSM_SECTION3",0);if(b){for(e=0;e<b.csm_num;e++)d(a,"CSM_SECTION"+String(e),1);d(a,"SHADOW_TEX_RES",N.M(b.csm_resolution));d(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);d(a,"CSM_BLEND_BETWEEN_CASCADES",
b.blend_between_cascades?1:0)}else d(a,"SHADOW_TEX_RES",0),d(a,"CSM_FADE_LAST_CASCADE",0),d(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.ne=d;a.Er=function(a,b){return N.iI(a.ib,b)};a.zM=I;a.AM=z;a.yF=G;a.uQ=e;a.Hi=k;a.UK=function(a,b,e){e=a.ac.indexOf(e);-1<e&&(a.T[e]=b)};a.FG=function(a,b){var e=l("MAIN");e.Ma=!0;Z.set(b[0],b[1],b[2],.5,e.Yd);e.$f=da.Bm;I(e,a);K(e,"main_stack.glslv","main_stack.glslf");d(e,"SHADELESS",1);M(e);return e};a.Vb=M;a.IF=function(a){return a.Ec.Ql.length?a.Ec.Ss.u_cube_fog?!0:
!1:!1};a.qG=function(){var a=l("DEPTH_PACK");a.bb=!0;a.ha=!1;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");M(a);return a};a.Xw=function(a){var b=l("POSTPROCESSING");K(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":d(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":d(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":d(b,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":d(b,
"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":d(b,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":d(b,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":d(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":d(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;default:throw"Wrong postprocessing effect: "+a;}b.bb=!0;b.ha=!1;a=R.Ib();I(b,a);M(b);return b};a.IG=function(a){var b=l("SSAO");b.ha=!1;b.bb=!0;var e=R.Ib();I(b,e);K(b,"postprocessing/postprocessing.glslv",
"postprocessing/ssao.glslf");d(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.KB);d(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:X.UH(a)};e={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=A(a,e);k(b,a,"u_ssao_special_tex");M(b);return b};a.JG=function(a){var b=l("SSAO_BLUR");b.ha=!1;b.bb=!0;var e=R.Ib();I(b,
e);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");d(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);M(b);return b};a.rG=function(){var a=l("DOF");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");d(a,"DEPTH_RGBA",1);M(a);return a};a.zG=function(){var a=l("OUTLINE");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");M(a);return a};a.tG=function(){var a=l("GLOW_COMBINE");
a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");M(a);return a};a.uG=function(a,b,e){var k=l("GOD_RAYS");k.ha=!1;k.bb=!0;var f=R.KH();I(k,f);K(k,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");d(k,"DEPTH_RGBA",a?1:0);d(k,"WATER_EFFECTS",b?1:0);d(k,"STEPS_PER_PASS",N.M(e,1));M(k);return k};a.vG=function(){var a=l("GOD_RAYS_COM");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");
M(a);return a};a.AG=function(){var a=l("SKY");a.ha=!1;a.bb=!0;var b=R.LH();I(a,b);K(a,"procedural_skydome.glslv","procedural_skydome.glslf");d(a,"WATER_EFFECTS",1);M(a);return a};a.kG=function(){var a=l("ANTIALIASING");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");W.rA?d(a,"AA_METHOD","AA_METHOD_FXAA_QUALITY"):d(a,"AA_METHOD","AA_METHOD_FXAA_LIGHT");M(a);return a};a.GG=function(a){var b=l("SMAA"),e=R.Ib();I(b,e);K(b,"postprocessing/smaa.glslv",
"postprocessing/smaa.glslf");d(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");d(b,"SMAA_PASS",a);d(b,"SMAA_PREDICATION",0);d(b,"SMAA_REPROJECTION",0);M(b);b.ha=!1;b.bb=!0;return b};a.oG=function(){var a=l("COMPOSITING");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");M(a);return a};a.yG=function(){var a=l("MOTION_BLUR");a.bb=!0;a.ha=!1;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");M(a);return a};
a.iG=function(){var a=l("ANAGLYPH");a.bb=!0;a.ha=!1;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/anaglyph.glslf");M(a);return a};a.wG=function(){var a=l("LUMINANCE");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");M(a);return a};a.lG=function(){var a=l("LUMINANCE");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");M(a);return a};a.xG=function(){var a=
l("LUMINANCE_X_BLUR");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");M(a);return a};a.mG=function(){var a=l("POSTPROCESSING");a.bb=!0;a.ha=!1;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");M(a);return a};a.nG=function(){var a=l("BLOOM");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");M(a);return a};a.MG=function(){var a=
l("VELOCITY");a.ha=!1;a.bb=!0;var b=R.Ib();I(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");M(a);return a};a.jG=function(){var a=l("ANCHOR_VISIBILITY");a.ha=!0;a.bb=!0;a.$f=da.Wu;K(a,"anchors.glslv","anchors.glslf");var b=R.Mx(1);I(a,b);d(a,"ANCHOR_NUM",1);M(a);a.Jj=new Float32Array([0,0,0]);return a};a.yM=function(a,b){var e=b.length/3;if(e!=a.Jj.length/3){var k=R.Mx(e);I(a,k);d(a,"ANCHOR_NUM",e);M(a)}a.Jj=b};a.WQ=Q;a.XQ=aa;a.UT=U;a.XP=function(a,b){for(var e=a.ba[0].W,
k=0;k<e.length;k++)if(e[k].type==b)return!0;return!1};a.cG=function(a){for(var b=a.T,e=0;e<b.length;e++)X.$G(b[e].vb);da.Cw(a.ca)};a.TI=function(a,b,e,k){for(var d=["MAIN","DEPTH","COLOR_ID"],f=!1,c=0;c<d.length;c++){var m=d[c],g=Q(a,b,m),u=Q(e,k,m);if(g&&u){var f=!0,h=aa(e,k,m);"MAIN"==m&&(U(u,g),h&&U(h,g));for(m=0;m<u.ac.length;m++){var q=u.ac[m];if(-1!==la.indexOf(q)){var n=g.ac.indexOf(q);-1!==n&&(u.T[m]=g.T[n],h&&(q=h.ac.indexOf(q),-1!==q&&(h.T[q]=g.T[n])))}}}}f||P.error("Wrong objects for inheriting material!")}};b4w.module.__boundings=function(a,t){function l(a,b){for(var c=a[0],g=a[1],h=a[2],l=a[0],n=a[1],p=a[2],B=3;B<a.length;B+=3)var q=a[B],m=a[B+1],w=a[B+2],c=Math.max(c,q),g=Math.max(g,m),h=Math.max(h,w),l=Math.min(l,q),n=Math.min(n,m),p=Math.min(p,w);b.max_x=c;b.max_y=g;b.max_z=h;b.min_x=l;b.min_y=n;b.min_z=p;return b}function c(a,b){b||(b=new Float32Array(24));var c=a.max_x,g=a.max_y,h=a.max_z,l=a.min_x,n=a.min_y,p=a.min_z;b[0]=l;b[1]=n;b[2]=p;b[3]=c;b[4]=n;b[5]=p;b[6]=c;b[7]=g;b[8]=p;b[9]=l;b[10]=
g;b[11]=p;b[12]=l;b[13]=n;b[14]=h;b[15]=c;b[16]=n;b[17]=h;b[18]=c;b[19]=g;b[20]=h;b[21]=l;b[22]=g;b[23]=h;return b}function b(a,b,c){r.add(b,c,a.G);r.scale(a.G,.5,a.G);a.Va=r.distance(a.G,b);return a}var y=t("__tsr"),h=t("__util"),r=t("__vec3"),x=new Float32Array(24),v=new Float32Array(3),g=new Float32Array(3),p=new Float32Array(3);a.qn=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.RP=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12}};a.Qd=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.tx=function(a,b){var c=a.max_y,g=a.max_z,h=a.min_x,l=a.min_y,n=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,g);a.min_x=Math.min(b.min_x,h);a.min_y=Math.min(b.min_y,l);a.min_z=Math.min(b.min_z,n)};a.kF=l;a.qq=function(b,g,p){p||(p=a.Qd());b=c(b,x);h.wg(b,g,b);return l(b,p)};a.tH=c;a.pU=function(b,c,g){g||(g=a.Qd());
var h=c.min_x,l=c.max_x,p=c.min_y,n=c.max_y,C=c.min_z;c=c.max_z;if(h>=b.max_x||l<=b.min_x||p>=b.max_y||n<=b.min_y||C>=b.max_z||c<=b.min_z)return g.min_x=-.1,g.max_x=.1,g.min_y=-.1,g.max_y=.1,g.min_z=-.2,g.max_z=-.1,g;g.min_x=Math.max(b.min_x,h);g.max_x=Math.min(b.max_x,l);g.min_y=Math.max(b.min_y,p);g.max_y=Math.min(b.max_y,n);g.min_z=Math.max(b.min_z,C);g.max_z=Math.min(b.max_z,c);return g};a.AU=function(b,c,g){g||(g=a.Qd());var h=b.max_x-b.min_x,l=b.max_y-b.min_y,p=b.max_z-b.min_z;g.min_x=b.min_x-
.5*(c-1)*h;g.max_x=b.max_x+.5*(c-1)*h;g.min_y=b.min_y-.5*(c-1)*l;g.max_y=b.max_y+.5*(c-1)*l;g.min_z=b.min_z-.5*(c-1)*p;g.max_z=b.max_z+.5*(c-1)*p;return g};a.sq=function(b,c,g){g||(g=a.um());r.transformMat4(b.G,c,g.G);g.Va=b.Va*h.zs(c);return g};a.rq=function(a,b,c){c||(c={ze:new Float32Array(3),Ae:new Float32Array(3),Be:new Float32Array(3),G:new Float32Array([0,0,0])});y.Mg(a.G,b,c.G);r.copy(a.ze,c.ze);r.copy(a.Ae,c.Ae);r.copy(a.Be,c.Be);y.oi(c.ze,b,c.ze);y.oi(c.Ae,b,c.Ae);y.oi(c.Be,b,c.Be);return c};
a.tn=function(a,b){return{Va:a,G:new Float32Array(b)}};a.um=function(){return{G:new Float32Array([0,0,0]),Va:0}};a.sn=function(a,b,c,g){return{ze:new Float32Array(a),Ae:new Float32Array(b),Be:new Float32Array(c),G:new Float32Array([g[0],g[1],g[2]])}};a.lF=function(){return{G:new Float32Array([0,0,0]),Va:1E12}};a.qH=function(a,b){var c=r.subtract(b.G,a.G,r.create());0==r.length(c)&&r.set(1,0,0,c);var g=r.normalize(c,r.create()),c=r.scale(g,a.Va,r.create());r.add(c,a.G,c);var h=r.scale(g,-a.Va,r.create());
r.add(h,a.G,h);var l=r.scale(g,b.Va,r.create());r.add(l,b.G,l);var n=r.scale(g,-b.Va,r.create());r.add(n,b.G,n);c=[c,h,l,n];g=r.normalize(g,r.create());h=c[0];l=c[0];for(n=1;n<c.length;n++){var p=r.dot(c[n],g);p<r.dot(h,g)&&(h=c[n]);p>r.dot(l,g)&&(l=c[n])}g=[h,l];c=g[0];g=g[1];a.G=r.scale(r.add(c,g,r.create()),.5,r.create());a.Va=r.length(r.subtract(g,c,r.create()))/2};a.Ow=function(a,b){var c=b.max_y,g=b.min_y,h=Math.max(0,c-g-2*a);return{Va:a,height:h,G:new Float32Array([0,(c+g)/2,0])}};a.Qw=function(a,
b){var c=b.max_y,g=b.min_y,h=Math.max(0,c-g);return{Va:a,height:h,G:new Float32Array([0,(c+g)/2,0])}};a.Pw=function(a,b){var c=b.max_y,g=b.min_y,h=Math.max(0,c-g);return{Va:a,height:h,G:new Float32Array([0,(c+g)/2,0])}};a.YP=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.JK=function(a){for(var b=0,c=0,g=0,h=0,l=0,n=0,p=0,B=0,q=0;q<a.submeshes.length;q++){var m=a.submeshes[q];if(m.position.length){b=h=m.position[0];
c=l=m.position[1];g=n=m.position[2];break}}for(q=0;q<a.submeshes.length;q++)for(var m=a.submeshes[q],m=m.position,w=0;w<m.length/3;w++)var d=m[3*w],r=m[3*w+1],u=m[3*w+2],b=Math.max(d,b),c=Math.max(r,c),g=Math.max(u,g),h=Math.min(d,h),l=Math.min(r,l),n=Math.min(u,n),p=Math.max(Math.sqrt(d*d+r*r+u*u),p),B=Math.max(Math.sqrt(d*d+u*u),B);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=h;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=l;a.b4w_bounding_box.max_z=g;a.b4w_bounding_box.min_z=n;a.b4w_bounding_box_source.max_x=
b;a.b4w_bounding_box_source.min_x=h;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=l;a.b4w_bounding_box_source.max_z=g;a.b4w_bounding_box_source.min_z=n;a.b4w_bounding_sphere_radius=p;a.b4w_bounding_cylinder_radius=B};a.nI=function(c){var l=c.subarray(0,3),x=c.subarray(6,9),y=c.subarray(12,15),t=c.subarray(18,21);c=r.subtract(x,l,v);r.normalize(c,c);var D=h.wI(l,x,y,g),D=r.cross(D,c,D);r.normalize(D,D);var n=r.create(),C=r.create();r.subtract(x,l,p);C[0]=r.dot(p,c);C[1]=r.dot(p,
D);x=r.create();r.subtract(y,l,p);x[0]=r.dot(p,c);x[1]=r.dot(p,D);y=r.create();r.subtract(t,l,p);y[0]=r.dot(p,c);y[1]=r.dot(p,D);t=a.um();y=[n,C,x,y];n=b(t,y[0],y[1]);for(t=2;t<y.length;t++)if(r.distance(n.G,y[t])>n.Va){for(var B=n,n=y,C=y[t],x=t-1,B=b(B,C,n[0]),q=1;q<=x;q++)if(r.distance(B.G,n[q])>B.Va){for(var m=B,B=n,w=C,d=n[q],I=q-1,m=b(m,w,d),u=0;u<=I;u++)if(r.distance(m.G,B[u])>m.Va){var E=w,z=d,G=B[u],e=r.subtract(z,G,p),e=r.squaredLength(e),K=r.subtract(E,G,p),k=r.squaredLength(K),K=r.subtract(E,
z,p),M=r.squaredLength(K),K=e*(k+M-e),Q=k*(M+e-k),e=M*(e+k-M),k=K+Q+e;r.copy(E,m.G);r.scale(m.G,K/k,m.G);r.scaleAndAdd(m.G,z,Q/k,m.G);r.scaleAndAdd(m.G,G,e/k,m.G);m.Va=r.distance(m.G,E)}B=m}n=B}t=n;c=r.scale(c,t.G[0],p);r.scaleAndAdd(c,D,t.G[1],c);r.add(c,l,t.G);return t}};b4w.module.__camera=function(a,t){function l(b){b=b.f;switch(b.Ha){case a.Da:b.kj=S.dist(b.i,b.mc);b.lj=b.S[0].top;break;case a.Ob:b.ub&&(b.kj=S.dist(b.i,b.zc),b.lj=b.S[0].top)}}function c(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),rb:new Float32Array([0,0,0,0]),pb:new Float32Array([0,0,0,0])}}function b(b){switch(b){case "STATIC":return a.Rd;case "TARGET":return a.Da;case "EYE":return a.Wb;case "HOVER":return a.Ob;
default:throw"Unknown move style";}}function y(b){var e={type:b,name:"",Gg:1,width:0,height:0,pf:null,Cb:null,Gd:null,Ia:0,hd:0,rb:0,pb:0,left:0,right:0,top:0,bottom:0,cg:new Float32Array(3),yx:new Float32Array(3),quat:new Float32Array(4),Ba:new Float32Array(16),SP:new Float32Array(16),Fa:new Float32Array(16),vk:new Float32Array(16),FK:new Float32Array(16),Qe:new Float32Array(16),uB:new Float32Array(16),qe:new Float32Array(16),dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,nf:null,dof_on:0,ml:c(),
jm:0,Te:0,Bc:null,Sk:null,Uq:null,bx:new Float32Array(4),Fo:new Float32Array(4)};if(b==a.Pb)return e;switch(b){case a.ec:v(e,40,.1,1E3);break;case a.Bd:v(e,2.5,.1,1E3);break;case a.af:break;case a.Qf:break;case a.$g:break;case a.Qb:case a.Xb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return e}function h(b,e,k){if(b.type!=a.Qb&&b.type!=a.Xb)throw"set_stereo_params(): wrong camera type";b.jm=e;b.Te=k;m(b,b.Ia);if(T.oa()&&(e=T.o(),b=e.k.rc))for(e=
T.ql(e).f.S,k=0;k<e.length;k++)E(e[k],b)}function r(a,b){return x(a.f.quat,b)}function x(a,b){var e=P.za(a,P.jb,fa),k=P.za(a,P.se,R),d=-Math.asin(e[1]/S.length(e)),e=Math.abs(d)>Math.PI/4?S.scale(k,-P.sign(d),ra):S.scale(e,-P.sign(k[1]),ra),c=Math.atan(Math.abs(e[0]/e[2]));0<k[1]&&(d=P.sign(d)*Math.PI-d);k=c;0>e[2]&&(k=Math.PI-k);0>e[0]&&(k=2*Math.PI-k);b[0]=k;b[1]=d;return b}function v(b,e,k,d,c){switch(b.type){case a.ec:case a.Qb:case a.Xb:b.hd=e;b.Ia=1;break;case a.Bd:b.top=e;b.Ia=1;break;case a.af:delete b.hd;
b.hd=e;b.Ia=c/e;break;case a.Qf:b.top=e;b.Ia=c/e;break;default:U.error("set_frustum(): Unsupported camera type: "+b.type)}b.rb=k;b.pb=d}function g(b,e){var k=e.f.i,c=e.f.quat,f=ga;Q.rotateX(e.f.ea,-Math.PI/2,f);Q.invert(f,b.Ba);if(b.Bc){var f=b.Bc[0],g=b.Bc[1],h=b.Bc[2],u=b.Bc[3],q=ga;q[0]=1-2*f*f;q[1]=-2*f*g;q[2]=-2*f*h;q[3]=0;q[4]=-2*f*g;q[5]=1-2*g*g;q[6]=-2*g*h;q[7]=0;q[8]=-2*f*h;q[9]=-2*g*h;q[10]=1-2*h*h;q[11]=0;q[12]=-2*f*u;q[13]=-2*g*u;q[14]=-2*h*u;q[15]=1;Q.multiply(b.Ba,q,b.Ba);m(b,b.Ia,!0);
f=na;g=ga;Q.invert(b.Ba,g);Q.transpose(g,g);da.transformMat4(b.Bc,g,f);g=N;g[0]=(P.sign(f[0])+b.Fa[8])/b.Fa[0];g[1]=(P.sign(f[1])+b.Fa[9])/b.Fa[5];g[2]=-1;g[3]=(1+b.Fa[10])/b.Fa[14];da.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.Fa[2]=f[0];b.Fa[6]=f[1];b.Fa[10]=f[2]+1;b.Fa[14]=f[3]}b.type==a.Qb?b.Ba[12]+=b.Te/2:b.type==a.Xb&&(b.Ba[12]-=b.Te/2);Q.multiply(b.Fa,b.Ba,b.qe);d(b);w(b);S.copy(b.cg,b.yx);S.copy(k,b.cg);ba.copy(c,b.quat)}function p(b,e,k,c){Q.lookAt(e,k,c,b.Ba);b.type==a.Qb?
b.Ba[12]+=b.Te/2:b.type==a.Xb&&(b.Ba[12]-=b.Te/2);Q.multiply(b.Fa,b.Ba,b.qe);d(b);w(b);S.copy(e,b.cg)}function f(a){var b=a.f.S;if(!b)throw"Wrong object";for(var e=a.f,k=0;k<b.length;k++){var d=b[k];g(d,a);P.Hn(d.qe,d.ml);if(d.nf)if(d.dof_on){var c=e.i,f=ea.de(d.nf,fa),c=S.dist(c,f);d.dof_distance=c}else d.dof_distance=0}}function A(b){b=b.f;if(b.Ha==a.Da){var e=P.za(b.quat,P.se,fa);b.du=0<e[1]}}function F(b,e){var k=b.f,d=k.yc;!d||k.Ha!=a.Wb&&k.Ha!=a.Da||(e&&(k=r(b,ca),d.left+=k[0],d.right+=k[0]),
d.left=P.we(d.left),d.right=P.we(d.right))}function H(b,e){var k=b.f,d=k.Fc;!d||k.Ha!=a.Wb&&k.Ha!=a.Da||(e&&(k=r(b,ca),d.tb+=k[1],d.fb+=k[1]),d.tb=P.cf(d.tb,-Math.PI,Math.PI),d.fb=P.cf(d.fb,-Math.PI,Math.PI))}function J(b){var e=b.f;if(aa.jd(b)){var k=e.S;if(k[0].type===a.Bd){if(e.Ha===a.Da)var d=S.dist(e.i,e.mc),e=d/e.kj*e.lj;else e.ub&&e.Ha===a.Ob?(d=S.distance(e.i,e.zc),e=d/e.kj*e.lj):e=k[0].top;for(d=0;d<k.length;d++){var c=k[d];c.top=e;m(c,c.Ia)}f(b)}}}function D(a,b,e,k,d){var c=a.f,f=b,m=e;
if(k||d)a=r(a,ia),k&&(f=b-a[0]),d&&(m=e-a[1]);if(f||m)b=ba.identity(sa),f&&(f=ba.setAxisAngle(P.jb,f,oa),ba.multiply(b,f,b)),m&&(f=P.za(c.quat,P.$e,fa),m=ba.setAxisAngle(f,m,oa),ba.normalize(m,m),ba.multiply(b,m,b)),ba.multiply(b,c.quat,c.quat)}function n(a,b,e,k,d){var c=a.f,f=b,m=e;if(k||d){var g=r(a,ia);k&&(f=b-g[0]);d&&(m=e-g[1])}B(a,a.f.mc,f,m);a=r(a,ia);a=P.cf(a[1],-Math.PI,Math.PI);c.du=Math.abs(a)>Math.PI/2}function C(a,b,e,k,d){var c=a.f,f=b,m=e;if(k||d){var g=r(a,ia);k&&(f=b-g[0]);d&&(m=
e-g[1])}c.kr||(f=0);B(a,c.zc,f,m);m&&q(a)}function B(a,b,e,k){var d=a.f;if(e||k){var c=ba.identity(sa);e&&(e=ba.setAxisAngle(P.jb,e,oa),ba.multiply(c,e,c));a=u(a);k&&(!a||a&&d.ub)&&(a=P.za(d.quat,P.$e,fa),k=ba.setAxisAngle(a,k,oa),ba.normalize(k,k),ba.multiply(c,k,c));P.ZK(d.i,b,c,d.i);ba.multiply(c,d.quat,d.quat)}}function q(a){var b=a.f;if(b.ub){var e=r(a,ca)[1];a=a.f;a.Tb.fb-a.Tb.tb?(e=(a.Tb.fb-e)/(a.Tb.fb-a.Tb.tb),e=Math.max(e,0)):e=0;e=e*(a.vh-a.mf)+a.mf;a=P.za(b.quat,P.dc,fa);S.normalize(a,
a);S.scale(a,e,a);S.subtract(b.zc,a,b.i)}}function m(b,e,k){switch(b.type){case a.ec:if(!e)throw"No aspect ratio";b.Ia=e;case a.af:Q.perspective(P.Lo(b.hd),b.Ia,b.rb,b.pb,b.Fa);break;case a.Bd:if(!e)throw"No aspect ratio";b.Ia=e;case a.Qf:e=b.top*b.Ia;Q.ortho(-e,e,-b.top,b.top,b.rb,b.pb,b.Fa);break;case a.$g:Q.ortho(b.left,b.right,b.bottom,b.top,b.rb,b.pb,b.Fa);break;case a.Qb:case a.Xb:if(!e)throw"No aspect ratio";b.Ia=e;var c=Math.tan(b.hd*Math.PI/360);e=b.rb*c;var f=b.Ia*b.jm*c;b.type==a.Qb?(c=
f-b.Te/2,f+=b.Te/2):(c=f+b.Te/2,f-=b.Te/2);c=-(b.rb/b.jm*c);f*=b.rb/b.jm;Q.frustum(c,f,-e,e,b.rb,b.pb,b.Fa);b.left=c;b.right=f;break;case a.Pb:return;default:throw"Wrong camera type: "+b.type;}k||(Q.multiply(b.Fa,b.Ba,b.qe),d(b),w(b))}function w(a){Q.copy(a.Ba,a.Qe);a.Qe[12]=0;a.Qe[13]=0;a.Qe[14]=0;a.Qe[15]=1;Q.multiply(a.Fa,a.Qe,a.Qe);Q.invert(a.Qe,a.Qe)}function d(a){Q.copy(a.Ba,a.vk);Q.multiply(a.Fa,a.vk,a.vk);Q.invert(a.vk,a.vk)}function I(b,e,k,d,c){d||(d=new Float32Array(24));e||(e=b.rb);k||
(k=b.pb);var f,m,g,h,u,q,n,l;switch(b.type){case a.Pb:throw"Extraction from NONE camera is not possible";case a.ec:case a.af:f=e*Math.tan(b.hd*Math.PI/360);h=-f;m=f*b.Ia;g=-m;u=k/e*f;l=-u;q=u*b.Ia;n=-q;break;case a.Bd:case a.Qf:g=b.top*b.Ia;f=u=b.top;m=q=g;h=l=-b.top;g=n=-g;break;case a.$g:f=u=b.top;m=q=b.right;h=l=b.bottom;g=n=b.left;break;case a.Qb:case a.Xb:u=e/b.rb;f=e*Math.tan(b.hd*Math.PI/360);h=-f;m=b.right*u;g=b.left*u;n=k/e;u=f*n;l=-u;q=m*n;n*=g;break;default:throw"Wrong camera type: "+b.type;
}d[0]=g;d[1]=h;d[2]=-e;d[3]=m;d[4]=h;d[5]=-e;d[6]=m;d[7]=f;d[8]=-e;d[9]=g;d[10]=f;d[11]=-e;d[12]=n;d[13]=l;d[14]=-k;d[15]=n;d[16]=u;d[17]=-k;d[18]=q;d[19]=u;d[20]=-k;d[21]=q;d[22]=l;d[23]=-k;c&&(e=ga,Q.invert(b.Ba,e),P.wg(d,e,d,0));return d}function u(b){return aa.jd(b)&&b.f&&b.f.Ha==a.Ob?!0:!1}function E(a,b){if(b.enable_csm){var k=b.csm_num;if(!a.Sk){var d=b.csm_num;a.Sk=Array(d);for(var c=0;c<d;c++)a.Sk[c]=new Float32Array(3);a.Uq=new Float32Array(d)}for(d=0;d<k;d++){var c=0==d?a.rb:z(b,a,d-1),
f=z(b,a,d),c=I(a,c,f,V),c=e.nI(c);a.Sk[d].set(c.G);a.Uq[d]=c.Va;a.bx[d]=S.length(c.G);a.Fo[d]=G(b.first_cascade_blur_radius,b.last_cascade_blur_radius,k,d)}}else a.Fo[0]=b.first_cascade_blur_radius}function z(a,b,e){var k=a.csm_num,d=P.da(a.csm_first_cascade_border,b.rb,b.pb);a=P.da(a.csm_last_cascade_border,b.rb,b.pb);return P.da(G(d,a,k,e),b.rb,b.pb)}function G(a,b,e,k){switch(k){case 0:break;case e-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,k/(e-1))}return a}var e=t("__boundings");t("__config");
var K=t("__constraints"),k=t("__container"),M=t("__mat3"),Q=t("__mat4"),aa=t("__obj_util"),U=t("__print"),ba=t("__quat"),T=t("__scenes"),ea=t("__transform"),P=t("__util"),S=t("__vec3"),da=t("__vec4");a.Pb=10;a.ec=20;a.Bd=30;a.af=40;a.Qf=50;a.$g=60;a.Qb=70;a.Xb=80;a.Rd=0;a.Da=2;a.Wb=3;a.Ob=4;var ka=Math.PI/180/2,ca=new Float32Array(2),ia=new Float32Array(2),fa=new Float32Array(3),R=new Float32Array(3),ra=new Float32Array(3),sa=new Float32Array(4),oa=new Float32Array(4),na=new Float32Array(4),N=new Float32Array(4),
X=new Float32Array(16),ga=new Float32Array(16),V=new Float32Array(24);a.AF=function(e,k){var d=k.f,c=e.data;switch(c.type){case "PERSP":var f=y(a.ec);if(c.angle_y)var m=c.angle_y/Math.PI*180;v(f,m,c.clip_start,c.clip_end);break;case "ORTHO":f=y(a.Bd),v(f,c.ortho_scale/2,c.clip_start,c.clip_end)}f.name=k.name;d.eC=!1;d.Ha=b(c.b4w_move_style);d.dof_distance=c.dof_distance;m=c.dof_object;d.nf=m?m.ad:null;d.dof_front=c.b4w_dof_front;d.dof_rear=c.b4w_dof_rear;d.dof_power=c.b4w_dof_power;d.kr=c.b4w_enable_hover_hor_rotation;
d.S=[f];d.Fu=c.b4w_trans_velocity;d.Eu=c.b4w_rot_velocity;d.Gu=c.b4w_zoom_velocity;d.Ha==a.Da&&(d.mc.set(c.b4w_target),A(k));var g=k.La,c=k.f,m=c.Ha;if(m===a.Da||m===a.Wb||m===a.Ob){var g=g.data,h=null,u=null,n=null;m===a.Da||m===a.Wb?(g.b4w_use_panning&&(c.pC=g.b4w_use_panning),g.b4w_use_horizontal_clamping&&(h={left:g.b4w_rotation_left_limit,right:g.b4w_rotation_right_limit}),g.b4w_use_vertical_clamping&&(u={fb:g.b4w_rotation_down_limit,tb:g.b4w_rotation_up_limit}),m===a.Da&&(c.ub=g.b4w_use_distance_limits&&
g.b4w_distance_min<=g.b4w_distance_max,c.ub&&(c.mf=g.b4w_distance_min,c.vh=g.b4w_distance_max))):m===a.Ob&&(g.b4w_use_horizontal_clamping&&g.b4w_horizontal_translation_min<=g.b4w_horizontal_translation_max&&(h={left:g.b4w_horizontal_translation_min,right:g.b4w_horizontal_translation_max}),g.b4w_use_vertical_clamping&&g.b4w_vertical_translation_min<=g.b4w_vertical_translation_max&&(u={fb:g.b4w_vertical_translation_min,tb:g.b4w_vertical_translation_max}),c.ub=g.b4w_use_distance_limits&&g.b4w_hover_angle_min<=
g.b4w_hover_angle_max&&g.b4w_distance_min<=g.b4w_distance_max,c.ub&&(n={fb:g.b4w_hover_angle_min,tb:g.b4w_hover_angle_max},c.mf=g.b4w_distance_min,c.vh=g.b4w_distance_max));var z=h;z&&m==a.Wb&&(z.left*=-1,z.right*=-1);if(z=u)switch(m){case a.Da:z.fb*=-1;z.tb*=-1;break;case a.Ob:var G=-z.fb;z.fb=-z.tb;z.tb=G}(z=n)&&m==a.Ob&&(z.fb*=-1,z.tb*=-1);c.yc=h;c.Fc=u;c.Tb=n;F(k,"LOCAL"==g.b4w_horizontal_clamping_type);H(k,"LOCAL"==g.b4w_vertical_clamping_type)}if(d.Ha===a.Ob)if(d=k.f,d.ub){m=k.La;c=k.f;g=P.za(c.quat,
P.dc,fa);h=na;h.set(P.jb);h[3]=0;m=P.ts(h,-m.data.b4w_hover_zero_level,c.i,g,c.zc);g=r(k,ca)[1];if(!m||Math.abs(g)<ka)U.warn("Active hover camera view vector and the supporting plane are parallel to each other. Set hover pivot based on the camera position."),c.zc[0]=c.i[0],c.zc[1]=0,c.zc[2]=c.i[2];c=r(k,ca);d=P.Uf(c[1],d.Tb.tb,d.Tb.fb);0<c[1]&&U.warn("Active hover camera has wrong orientation");d?C(k,0,d):q(k)}else d.kr=!1;f.type==a.Bd&&l(k)};a.VI=l;a.sG=c;a.Fb=y;a.WP=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.Cb);
case "DEPTH":return Boolean(a.Gd);case "SCREEN":return!Boolean(a.Cb)&&!Boolean(a.Gd);default:throw"Wrong attachment type: "+b;}};a.To=function(a,b,e){switch(b){case "COLOR":case "CUBEMAP":a.Cb=e;break;case "DEPTH":a.Gd=e;break;case "SCREEN":a.Cb=null;a.Gd=null;break;default:throw"Wrong attachment type: "+b;}};a.kR=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.Cb;case "DEPTH":return a.Gd;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.Fz=function(b,e){if(b.type!=
a.ec||e!=a.Qb&&e!=a.Xb)throw"make_stereo(): wrong camera type";b.type=e;h(b,6,.065)};a.BL=h;a.ae=r;a.Xx=x;a.Qn=function(a,b){r(a,b);b[0]=P.we(b[0]+Math.PI);b[1]*=-1;return b};a.Px=function(a,b){var e=a.f,k=P.za(e.quat,P.dc,fa),d=Math.asin(k[1]/S.length(k));0==k[0]&&0==k[2]?e=0:(Math.abs(d)>Math.PI/4&&(k=0>=d?P.za(e.quat,P.Xg,R):P.za(e.quat,P.se,R)),e=Math.atan(Math.abs(k[0]/k[2])),0<k[2]&&(e=Math.PI-e),0<k[0]&&(e=2*Math.PI-e));b[0]=e;b[1]=d;return b};a.Xo=v;a.pL=function(b,e,k,d,c,f,m){switch(b.type){case a.$g:b.left=
e;b.right=k;b.bottom=d;b.top=c;b.rb=f;b.pb=m;break;default:U.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.be=function(a){return a.f.Ha};a.FL=g;a.mU=p;a.oB=function(a,b,e){var k=fa;k[0]=0;k[1]=-1;k[2]=0;S.transformQuat(k,e,k);k[0]+=b[0];k[1]+=b[1];k[2]+=b[2];var d=R;d[0]=0;d[1]=0;d[2]=-1;S.transformQuat(d,e,d);p(a,b,k,d)};a.xH=function(a,b,e,k,d){k[0]=a[0];k[1]=a[1];k[2]=a[2];Q.lookAt(a,b,e,ga);Q.invert(ga,ga);Q.rotateX(ga,Math.PI/2,ga);M.fromMat4(ga,X);ba.fromMat3(X,d)};
a.IM=f;a.HM=function(b){var e=b.f,k=b.f;if(k.Ha===a.Da||k.Ha===a.Wb){if(k.yc){var d=k.yc.left,c=k.yc.right,f=r(b,ca);(f=k.Ha==a.Da?P.Uf(f[0],d,c):P.Uf(f[0],c,d))&&(k.Ha==a.Da?n(b,f,0):D(b,f,0))}k.Fc&&(d=k.Fc.fb,c=k.Fc.tb,f=r(b,ca),(f=k.Ha==a.Da?P.Uf(f[1],c,d):P.Uf(f[1],d,c))&&(k.Ha==a.Da?n(b,0,f):D(b,0,f)));k.Ha===a.Da&&k.ub&&(f=b.f,d=S.subtract(f.i,f.mc,fa),c=S.length(d),c>f.vh?(S.scale(d,f.vh/c,d),S.add(f.mc,d,f.i)):c<f.mf&&(c=P.za(f.quat,P.dc,R),S.scale(c,100*f.mf,c),S.add(d,c,d),S.scale(d,-f.mf/
S.length(d),d),S.add(f.mc,d,f.i)))}k.Ha===a.Ob&&(k=b.f,f=k.ub?k.zc:k.i,k.yc&&(d=P.da(f[0],k.yc.left,k.yc.right)-f[0],f[0]+=d,k.ub&&(k.i[0]+=d)),k.Fc&&(d=P.da(f[2],k.Fc.fb,k.Fc.tb)-f[2],f[2]+=d,k.ub&&(k.i[2]+=d)),k=b.f,k.ub&&k.Tb&&(f=r(b,ca)[1],f=P.Uf(f,k.Tb.tb,k.Tb.fb),P.za(k.quat,P.dc,fa),f&&C(b,0,f)));J(b);switch(e.Ha){case a.Da:K.$K(e.i,e.quat,e.mc);K.rn(b,P.jb);break;case a.Wb:b.Na||K.rn(b,P.jb)}A(b)};a.uu=A;a.AK=F;a.EK=H;a.RM=J;a.rd=D;a.Cf=n;a.ji=C;a.SI=q;a.zS=function(b){switch(b.type){case a.ec:case a.Bd:case a.Qb:case a.Xb:return!0;
default:return!1}};a.WH=function(b){b=b.f.S[0];switch(b.type){case a.ec:case a.af:case a.Qb:case a.Xb:return Math.PI*b.hd/180;default:return U.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.zg=m;a.vq=w;a.mw=d;a.uH=I;a.cF=function(a){a=a.f;var b=e.Qd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.Yb=b;var k=e.tn(1,[0,0,0]);a.Ed=k;a.gq=e.Ow(1,b);a.iq=e.Qw(1,b);a.hq=e.Pw(1,b)};a.Kb=function(b){return aa.jd(b)&&b.f&&b.f.Ha==a.Da?!0:!1};a.kd=function(b){return aa.jd(b)&&
b.f&&b.f.Ha==a.Wb?!0:!1};a.qb=u;a.tu=E;a.PG=z;a.Zs=function(b,e,d){b=b.f.S[0];switch(b.type){case a.ec:case a.af:case a.Bd:case a.Qf:case a.Qb:case a.Xb:var c=na;c.set(e);c[3]=1;da.transformMat4(c,b.qe,c);e=-c[1]/c[3];d[0]=(c[0]/c[3]+1)/2*b.width;d[1]=(e+1)/2*b.height;k.xN(d[0],d[1],d,b);2<d.length&&(d[2]=(c[2]/Math.abs(c[3])+1)/2);return d;default:return U.error("Non-compatible camera"),d}};a.kI=function(a){return a.f.S[0]};a.Sn=function(b,e){switch(b.type){case a.ec:case a.af:case a.Qb:case a.Xb:var k=
Math.tan(P.Lo(b.hd)/2);switch(e){case "LEFT":return-k*b.Ia;case "RIGHT":return k*b.Ia;case "TOP":return k;case "BOTTOM":return-k}break;case a.Bd:case a.Qf:switch(e){case "LEFT":return-b.top*b.Ia;case "RIGHT":return b.top*b.Ia;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.$g:switch(e){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:P.fa("Unknown camera type")}};a.kJ=function(b){switch(b.type){case a.Bd:case a.Qf:case a.$g:return!0;
default:return!1}};a.lI=function(b,e){switch(b.type){case a.ec:case a.af:case a.Qb:case a.Xb:var k=P.Lo(b.hd);return e?k*b.Ia:k;default:return 0}}};b4w.module.__constraints=function(a,t){function l(a){var b={};b.type=a;return b}function c(a,d){a.Na&&a.Na.P&&b(a.Na.P,a);if(d.P){var c=d.P;if(-1==c.Wd.indexOf(a))c.Wd.push(a);else throw"Descendant object override is forbidden";}a.Na=d}function b(a,b){var d=a.Wd.indexOf(b);if(-1!=d)a.Wd.splice(d,1);else throw"No descendant object";}function y(a,b,c){switch(b.type){case 1:var e=a.f.quat,h=b.P.f.ea;c=b.P.f.quat;b.oc?(p.copy(b.oc,e),p.multiply(c,e,e)):p.copy(c,e);F.transformMat4(b.offset,h,a.f.i);a.f.scale=
b.bm*b.P.f.scale;break;case 9:var k=a.f.i,e=a.f.quat,h=b.P.f.ea;c=b.P.f.quat;p.multiply(p.invert(b.di,b.di),e,e);p.multiply(c,e,e);F.transformMat4(b.offset,h,k);p.copy(c,b.di);break;case 10:k=a.f.i;e=a.f.quat;h=b.P.f.ea;c=b.P.f.quat;p.multiply(p.invert(b.di,b.di),e,e);p.multiply(c,e,e);F.transformMat4(b.offset,h,k);p.copy(c,b.di);k=a.f.quat;e=p.multiply(b.P.f.quat,b.oc,m);e=v.Xx(e,J);k=v.Xx(k,D);v.rd(a,A.Uf(k[0],e[0]+b.aG,e[0]+b.$F),A.Uf(k[1],e[1]+b.ZF,e[1]+b.bG));break;case 13:var k=a.f.i,e=a.f.quat,
h=b.P.f.ea,q=b.P.f.i,l=b.QL,B=n,C=m;F.transformMat4(b.offset,h,B);A.Tj(B,k,c,l,k);h=n;F.sub(q,k,h);F.normalize(h,h);var y=e,k=w,q=k.subarray(0,3),B=k.subarray(3,6),t=k.subarray(6,9);F.copy(h,B);F.negate(B,B);F.normalize(B,B);Boolean(.999999<Math.abs(F.dot(h,A.jb)))?(h=g.fromQuat(p.normalize(y,C),d),F.copy(h.subarray(0,3),q)):F.cross(A.jb,B,q);F.normalize(q,q);F.cross(q,B,t);F.normalize(t,t);p.fromMat3(k,C);p.normalize(C,C);A.EB(C,e,c,.16*l,e);break;case 2:e=a.f.quat;c=I;H.Pn(b.P,b.mh,!0,c);f.multiply(b.P.f.Ca,
c,c);e[0]=c[4];e[1]=c[5];e[2]=c[6];e[3]=c[7];b.oc&&(p.copy(b.oc,e),p.multiply(e,b.oc,e));a.f.scale=b.bm*c[3];f.Mg(b.offset,c,a.f.i);break;case 3:k=a.f.i;e=a.f.quat;c=b.P.f.i;r(k,e,c);break;case 4:k=a.f.i;e=a.f.quat;c=b.target;r(k,e,c);break;case 5:k=a.f.i;e=a.f.quat;c=b.P.f.i;r(k,e,c);e=F.dist(k,c);if(e=e>b.dist_max?e-b.dist_max:e<b.$k?e-b.$k:0)F.sub(c,k,n),F.normalize(n,n),F.scale(n,e,n),F.add(k,n,k);break;case 6:k=a.f.i;e=a.f.quat;c=b.target;r(k,e,c);e=F.dist(k,c);if(e=e>b.dist_max?e-b.dist_max:
e<b.$k?e-b.$k:0)F.sub(c,k,n),F.normalize(n,n),F.scale(n,e,n),F.add(k,n,k);break;case 7:h=b.P.f.ea;F.transformMat4(b.offset,h,a.f.i);break;case 8:q=b.P.f.i;k=a.f.i;F.add(q,b.offset,k);break;case 14:e=a.f.quat;h=b.P.f.ea;c=b.P.f.quat;b.oc?(p.copy(b.oc,e),p.multiply(c,e,e)):p.copy(c,e);F.transformMat4(b.offset,h,a.f.i);break;case 11:k=b.P.f;c=f.Fe(k.i,k.scale,k.quat,I);k=b.wp;f.multiply(c,k,c);k=a.f.i;k[0]=c[0];k[1]=c[1];k[2]=c[2];a.f.scale=c[3];e=a.f.quat;e[0]=c[4];e[1]=c[5];e[2]=c[6];e[3]=c[7];break;
case 12:k=b.wp;c=I;H.Pn(b.P,b.mh,!0,c);f.multiply(b.P.f.Ca,c,c);f.multiply(c,k,c);k=a.f.i;k[0]=c[0];k[1]=c[1];k[2]=c[2];a.f.scale=c[3];e=a.f.quat;e[0]=c[4];e[1]=c[5];e[2]=c[6];e[3]=c[7];break;case 15:c=b.P,e=v.kI(c),k=a.f.i,l=v.Sn(e,"TOP"),C=v.Sn(e,"BOTTOM"),h=l-C,b.yz?(q=v.Sn(e,"LEFT"),k[0]=q+h*b.os):(q=v.Sn(e,"RIGHT"),k[0]=q-h*b.os),k[2]=b.aC?-(l-h*b.gu):-(C+h*b.gu),v.kJ(e)?k[1]=-b.distance:(k[1]=-1,F.normalize(k,k),F.scale(k,b.distance/Math.abs(k[1]),k)),f.oi(k,c.f.Ca,k),F.add(c.f.i,k,k),e=a.f.quat,
b.oc?(p.copy(b.oc,e),p.multiply(c.f.quat,e,e)):p.copy(c.f.quat,e)}"CAMERA"==a.f.type&&(k=A.jb,10==b.type&&(c=b.P.f.quat,k=F.transformQuat(k,c,u)),v.uu(a),x(a,k))}function h(a,b){switch(b.type){case 1:var d=b.target.f.Ca,e=I;f.invert(a.f.Ca,e);f.multiply(e,d,e);H.kL(a,b.mh,e)}a.Gs=!0}function r(a,b,d){var e=n;A.za(b,A.dc,e);F.normalize(e,e);var c=C;F.subtract(d,a,c);F.normalize(c,c);a=A.aL(e,c,q);p.multiply(a,b,b);p.normalize(b,b)}function x(a,b){var d=a.f,e=d.quat,c=A.za(d.quat,A.jb,n);F.normalize(c,
c);if(.999999<Math.abs(F.dot(b,c)))c=p.identity(m);else{var k=F.cross(b,c,C);F.normalize(k,k);if(d.Ha==v.Da)d.du&&F.negate(k,k);else{var f=A.za(d.quat,A.se,B);0<F.dot(f,b)&&F.negate(k,k)}d=A.za(d.quat,A.$e,B);F.normalize(d,d);var f=A.da(F.dot(d,k),-1,1),g=Math.acos(f),c=-.999999>=f?p.setAxisAngle(c,g,m):p.rotationTo(d,k,m);p.normalize(c,c)}p.multiply(c,e,e);v.uu(a)}var v=t("__camera"),g=t("__mat3"),p=t("__quat"),f=t("__tsr"),A=t("__util"),F=t("__vec3"),H=t("__armature");a.WN=1;a.VN=2;a.$N=3;a.aO=
4;a.QN=5;a.RN=6;a.XN=7;a.PN=8;a.UN=9;a.TN=10;a.NN=11;a.ON=12;a.SN=13;a.YN=14;a.ZN=15;a.KN=1;var J=new Float32Array(2),D=new Float32Array(2),n=new Float32Array(3),C=new Float32Array(3),B=new Float32Array(3),q=new Float32Array(4),m=new Float32Array(4),w=new Float32Array(9),d=new Float32Array(9),I=new Float32Array(8),u=new Float32Array(3);a.Lv=function(a,b,d,e,f){var k=l(1);k.P=b;k.offset=new Float32Array(d);k.oc=e?new Float32Array(e):null;k.bm=f;c(a,k);y(a,k,0)};a.KE=function(a,b,d,e,f,k){var m=l(2);
m.P=b;m.mh=d;m.offset=new Float32Array(e);m.oc=f?new Float32Array(f):null;m.bm=k;c(a,m);y(a,m,0)};a.JE=function(a,b,d,e){var f=l(9),k=a.f.quat,m=b.f.quat;f.P=b;f.offset=new Float32Array(d);f.di=new Float32Array(m);e&&(p.copy(e,k),p.multiply(m,k,k));c(a,f);y(a,f,0)};a.IE=function(a,b,d,e,f,k,m,g){var h=l(10),u=a.f.quat,q=b.f.quat;h.P=b;h.offset=new Float32Array(d);h.di=new Float32Array(q);h.$F=A.we(f);h.aG=A.we(k);h.bG=A.cf(m,-Math.PI,Math.PI);h.ZF=A.cf(g,-Math.PI,Math.PI);e?(h.oc=new Float32Array(e),
p.copy(e,u),p.multiply(q,u,u)):h.oc=p.create();c(a,h);y(a,h,0)};a.HE=function(a,b,d,e){var f=l(13);f.P=b;f.offset=new Float32Array(d);f.QL=e;c(a,f);y(a,f,0)};a.OE=function(a,b,d,e){var f=l(14);f.P=b;f.offset=new Float32Array(d);f.bm=1;f.oc=e?new Float32Array(e):null;c(a,f);y(a,f,0)};a.jT=b;a.PE=function(a,b){var d=l(3);d.P=b;c(a,d);y(a,d,0)};a.QE=function(a,b){var d=l(4);d.target=new Float32Array(b);c(a,d);y(a,d,0)};a.DE=function(a,b,d,e){var f=l(5);f.P=b;f.$k=d;f.dist_max=e;c(a,f);y(a,f,0)};a.EE=
function(a,b,d,e){var f=l(6);f.target=new Float32Array(b);f.$k=d;f.dist_max=e;c(a,f);y(a,f,0)};a.NE=function(a,b){var d=l(7);d.P=b;d.offset=new Float32Array([0,.5,0]);c(a,d);y(a,d,0)};a.CE=function(a,b,d){var e=l(8);e.P=b;e.offset=new Float32Array(d);c(a,e);y(a,e,0)};a.AE=function(a,b,d){var e=l(11);e.P=b;e.wp=new Float32Array(d);c(a,e);y(a,e,0)};a.BE=function(a,b,d,e){var f=l(12);f.P=b;f.mh=d;f.wp=new Float32Array(e);c(a,f);y(a,f,0)};a.Mv=function(a,b,d){var e=l(15);e.P=b;if("left"in d)e.yz=!0,e.os=
d.left;else if("right"in d)e.yz=!1,e.os=d.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}if("top"in d)e.aC=!0,e.gu=d.top;else if("bottom"in d)e.aC=!1,e.gu=d.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}"distance"in d?(e.distance=d.distance,e.oc="rotation"in d?new Float32Array(d.rotation):null,c(a,e),y(a,e,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};a.JM=function(a,b){a.Na&&y(a,a.Na,b)};a.LE=function(a,
b,d,e,c){var k=l(1);k.mh=d;k.target=b;k.offset=new Float32Array(e);k.oc=c?new Float32Array(c):null;k.bm=1;b=k.target;d=k.mh;e=a.f.Dd[d];c=b.Jq;for(var f=0;f<c;f++){var m=c[f];if(m[0]==a&&m[1]==d){c.splice(f,1);break}}b.Jq.push([a,d]);e.Na=k;h(a,k)};a.EM=function(a,b){var d=a.f.Dd[b];d.Na&&h(a,d.Na)};a.$K=r;a.rn=x;a.NF=function(a){return a.Na?!0:!1};a.remove=function(a){a.Na.P&&b(a.Na.P,a);a.Na=null};a.XR=function(a){return a.Na?a.Na.type:null};a.Ld=function(a){a=a.Na;return!a||11!=a.type&&12!=a.type?
!1:!0};a.Rn=function(a){if((a=a.Na)&&11==a.type)return a.P.f.Ca;if(a&&12==a.type){var b=I;H.Pn(a.P,a.mh,!0,b);f.multiply(a.P.f.Ca,b,b);return b}return null};a.Kd=function(a){a=a.Na;return!a||11!=a.type&&12!=a.type?null:a.wp}};b4w.module.__armature=function(a,t){function l(a){a=a.f;for(var b=a.ip,c=a.Iz,f=0;f<b.length;f++){for(var g=b[f],h=c[f],l=0;l<h.length;l+=2)for(var q=h[l],m=h[l+1],w=0;4>w;w++)g.Sc[q+w]=a.Sc[m+w],g.qd[q+w]=a.qd[m+w],g.Wc[q+w]=a.Wc[m+w],g.xd[q+w]=a.xd[m+w];g.Jd=a.Jd}}function c(a,b,f,h){var n=a.dC,l=a.Og,p=a.vp,q=a.eA;q?(q=q.vp,b?y.multiply(q,n,p):(b=g,y.invert(q,b),y.multiply(b,p,n))):b?y.copy(n,p):y.copy(p,n);n=v;y.invert(l,n);y.multiply(p,n,n);l=a.Tf;f[4*l]=n[0];f[4*l+1]=n[1];f[4*l+2]=n[2];f[4*
l+3]=n[3];h[4*l]=n[4];h[4*l+1]=n[5];h[4*l+2]=n[6];h[4*l+3]=n[7];a=a.lx;for(l=0;l<a.length;l++)p=a[l],p.Na||c(p,!0,f,h)}var b=t("__util"),y=t("__tsr"),h=t("__quat"),r=t("__mat4"),x=t("__vec3"),v=new Float32Array(8),g=new Float32Array(8),p=new Float32Array(4),f=new Float32Array(4),A=new Float32Array(4);a.pi=function(a,c){for(var f=a.data.bones,g=a.pose.bones,h={},l=0;l<g.length;l++){var p=g[l],q=p.bone,m=q.name,w=h[m]={Tf:0,zC:-1,eA:null,lx:[],jn:[],Na:null,lu:y.create(),dC:y.create(),Og:y.create(),
vp:y.create(),tp:y.create(),mu:y.create(),up:!1,XB:new Float32Array(3)},m=new Float32Array(q.matrix_local),d=new Float32Array(16);r.invert(m,d);var p=new Float32Array(p.matrix_basis),A=w.XB;x.subtract(q.tail_local,q.head_local,A);b.rN(A,d,A);y.Nn(m,w.Og);y.Nn(p,w.tp);y.copy(w.Og,w.vp)}for(l=0;l<f.length;l++){m=f[l].name;p=b.Ub("name",m,g);w=h[m];q=p.parent_recursive;w.jn.push(w);for(d=0;d<q.length;d++)p=q[d],p=p.name,p=h[p],w.jn.push(p);q.length?(p=q[0],p=p.name,p=h[p],w.eA=p,y.invert(p.Og,v),y.multiply(v,
w.Og,w.lu),p.lx.push(w)):y.copy(w.Og,w.lu);w.Tf=l;w.name=m;y.multiply(w.lu,w.tp,w.dC)}c.f.Dd=h};a.Pn=function(a,b,c,l){var n=a.f,r=n.Jd;b=n.Dd[b];var B=b.Tf;a=b.Og;var q=n.Wc,m=n.xd,w=n.Sc,n=n.qd,d=q[4*B+1],x=q[4*B+2],u=q[4*B+3],E=m[4*B+1],z=m[4*B+2],G=m[4*B+3];p[0]=(1-r)*q[4*B]+r*m[4*B];p[1]=(1-r)*d+r*E;p[2]=(1-r)*x+r*z;p[3]=(1-r)*u+r*G;f[0]=w[4*B];f[1]=w[4*B+1];f[2]=w[4*B+2];f[3]=w[4*B+3];A[0]=n[4*B];A[1]=n[4*B+1];A[2]=n[4*B+2];A[3]=n[4*B+3];h.slerp(f,A,r,f);r=v;y.Ft(p,r);y.Nj(f,r);c?(c=g,y.translate(a,
b.XB,c),y.multiply(r,c,r)):y.multiply(r,a,r);y.copy(r,l)};a.kL=function(a,b,f){var g=a.f;b=g.Dd[b];var h=g.Wc,p=g.Sc;y.copy(f,b.vp);c(b,!1,h,p);g.Jd=0;l(a)};a.UM=l;a.FM=c;a.JF=function(a,b){return b in a.f.Dd}};b4w.module.__container=function(a,t){var l,c,b,y,h;function r(a,b){l=a;c=b}function x(){var a=p.getBoundingClientRect();r(a.left,a.top)}var v=t("__print"),g=t("__util"),p=null,f=null,A=!1;y=b=0;h=1;l=c=0;a.Fr=function(){return p};a.Je=function(){return f};a.Kc=function(a){a&&a.parentNode?(p=a,f=a.parentNode):g.fa("canvas container is not available")};a.eo=function(a,b){b=b||"LAST";switch(b){case "FIRST":f.insertBefore(a,f.firstElementChild);break;case "JUST_BEFORE_CANVAS":f.insertBefore(a,p);break;
case "JUST_AFTER_CANVAS":p.nextElementSibling?f.insertBefore(a,p.nextElementSibling):f.appendChild(a,p);break;case "LAST":f.appendChild(a,p);break;default:v.error(b+" invalid stack order")}};a.FI=function(){return b};a.EI=function(){return y};a.RA=r;a.gC=x;a.JL=function(a,c,f){b=a;y=c;h=f;x()};a.vr=function(){A=!0};a.kn=function(a,b,f){f||(f=new Float32Array(2));var g=f;A&&(x(),A=!1);g[0]=a-l;a=f;A&&(x(),A=!1);a[1]=b-c;return f};a.zq=function(a,c,f,g){f||(f=new Float32Array(2));f[0]=a*h;f[1]=c*h;
g&&(a=g.width/b,f[0]*=a,f[1]*=a);return f};a.xN=function(a,c,f,g){f||(f=new Float32Array(2));f[0]=a/h;f[1]=c/h;g&&(a=g.width/b,f[0]/=a,f[1]/=a)};a.iz=function(b){return b&&b.parentNode?b.parentNode==f?!0:a.iz(b.parentNode):!1};a.Ax=function(a){var b=document.getElementsByTagName("script");a=g.Gl(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null}};b4w.module.__transform=function(a,t){function l(a,b){p.Ld(a)?n.Oj(b,p.Kd(a)):m.copy(b,a.f.i)}function c(a,b){var d=a.f;if(p.Ld(a)){n.Nj(b,d.Ca);var k=p.Rn(a),k=n.invert(k,u);n.multiply(k,d.Ca,p.Kd(a))}else H.copy(b,d.quat)}function b(a,b){p.Ld(a)?n.Nj(b,p.Kd(a)):H.copy(b,a.f.quat)}function y(a,b){p.Ld(a)?n.copy(b,p.Kd(a)):h(a,b)}function h(a,b){var d=a.f;d.i[0]=b[0];d.i[1]=b[1];d.i[2]=b[2];d.scale=b[3];d.quat[0]=b[4];d.quat[1]=b[5];d.quat[2]=b[6];d.quat[3]=b[7]}function r(a,b){if(p.Ld(a))n.copy(p.Kd(a),
b);else{var d=a.f;n.Ag(d.i,d.scale,d.quat,b)}return b}function x(a){var b=a.f,d=a.ba,k=a.type;"CAMERA"==k&&g.uu(a);p.JM(a,z);"CAMERA"==k&&g.HM(a);var c=b.i,m=b.scale,h=b.quat;n.Ag(c,m,h,b.Ca);var l=b.ea;A.fromQuat(h,l);"CAMERA"!=k&&q.dL(l,m,l);l[12]=c[0];l[13]=c[1];l[14]=c[2];A.invert(l,b.fz);b.Yb&&b.wb&&(v.qq(b.Yb,l,b.wb),v.sq(b.Ed,l,b.Zb),v.rq(b.Sf,b.Ca,b.jh));switch(k){case "SPEAKER":D.XL(a,z);break;case "MESH":if(l=a.Ym)n.invert(l.f.Ca,u),n.multiply(u,b.Ca,u),w.set(u[0],u[1],u[2],u[3],b.dq),H.set(u[4],
u[5],u[6],u[7],b.cq);break;case "CAMERA":g.IM(a);J.oa()&&(m=J.o(),J.ql(m)==a&&D.DJ(m,c,h,z));break;case "LAMP":f.NM(a)}for(m=0;m<d.length;m++){var E=d[m];if(E.fo){var l=E.Aa,r=l.k,y=E.W;switch(k){case "LAMP":J.kC(a,l);break;case "CAMERA":J.gL(l);r.rc&&r.rc.enable_csm&&J.ut(l);break;case "MESH":b.Yb&&b.wb&&(b.td&&J.ut(l),r=E.Yf,null!=b.Fd&&r&&J.iC(r,c));a.F.length&&F.Ns(a)&&F.KM(a,y);break;case "EMPTY":C.jC(a)}E=E.ug;y=a.Yl;y.length&&E&&(r=E.j,J.lC(E,c,h),B.mC(y,r.Bc),g.FL(r,J.ql(l)),q.Hn(r.qe,r.ml))}}d=
a.Wd;for(m=0;m<d.length;m++)x(d[m]);a=a.Jq;for(m=0;m<a.length;m++)d=a[m],l=d[0],p.EM(l,d[1]);b.wr=!0}var v=t("__boundings"),g=t("__camera"),p=t("__constraints"),f=t("__lights");t("__mat3");var A=t("__mat4"),F=t("__particles"),H=t("__quat"),J=t("__scenes"),D=t("__sfx"),n=t("__tsr"),C=t("__objects"),B=t("__obj_util"),q=t("__util"),m=t("__vec3"),w=t("__vec4"),d=new Float32Array(3),I=new Float32Array(4);new Float32Array(9);var u=n.create(),E=n.create(),z=0;a.Im=0;a.Hm=1;a.gP=2;a.update=function(a){z=
a};a.Pe=function(a,b){var d=a.f;if(p.Ld(a)){n.Oj(b,d.Ca);var k=p.Rn(a),k=n.invert(k,u);n.multiply(k,d.Ca,p.Kd(a))}else m.copy(b,d.i)};a.ap=l;a.de=function(a,b){m.copy(a.f.i,b);return b};a.Jy=function(a,b){p.Ld(a)?m.copy(n.gj(p.Kd(a)),b):m.copy(a.f.i,b);return b};a.Ff=c;a.Yo=b;a.eg=function(a,b){H.copy(a.f.quat,b);return b};a.yy=function(a,b){p.Ld(a)?H.copy(n.fj(p.Kd(a)),b):H.copy(a.f.quat,b);return b};a.Ct=function(a,b){var d=q.bg(b,I);c(a,d)};a.Dt=function(a,e){var d=q.bg(e,I);b(a,d)};a.Oe=function(a,
b){var d=a.f;if(p.Ld(a)){var d=p.Kd(a),k=n.fg(p.Rn(a));n.Oe(b/k,d)}else d.scale=b};a.Et=function(a,b){p.Ld(a)?n.Oe(b,p.Kd(a)):a.f.scale=b};a.fg=function(a){return a.f.scale};a.Ay=function(a){return p.Ld(a)?n.fg(p.Kd(a)):a.f.scale};a.Pj=function(a,b){var d=a.f;if(p.Ld(a)){n.Oj(trans,d.Ca);var k=p.Rn(a),k=n.invert(k,u);n.multiply(k,d.Ca,p.Kd(a))}else h(a,b)};a.nB=y;a.vl=function(a,b){var d=a.f;n.Ag(d.i,d.scale,d.quat,b);return b};a.Ky=r;a.Kr=function(a){var b=a.f,d=b.Ii;a=b.scale*(d.max_x-d.min_x);
var k=b.scale*(d.max_y-d.min_y),b=b.scale*(d.max_z-d.min_z);return.5*Math.sqrt(a*a+k*k+b*b)};a.Tn=function(a,b,d){d||(d=new Float32Array(3));b?(a=a.f,m.copy(a.Zb.G,d)):(a=a.f,b=a.Ii,d[0]=(b.max_x+b.min_x)/2,d[1]=(b.max_y+b.min_y)/2,d[2]=(b.max_z+b.min_z)/2,m.transformMat4(d,a.ea,d));return d};a.md=function(a,b,c,k){var f=r(a,u);d[0]=b;d[1]=c;d[2]=k;n.Mg(d,f,d);l(a,d)};a.rt=function(a,b){var d=r(a,u),k=n.Nj(b,n.identity(E));n.multiply(d,k,k);y(a,k)};a.q=x;a.distance=function(a,b){return m.dist(a.f.i,
b.f.i)};a.iK=function(a,b){return m.dist(a.f.i,b)};a.ry=function(a){return{max_x:a.f.wb.max_x,min_x:a.f.wb.min_x,max_y:a.f.wb.max_y,min_y:a.f.wb.min_y,max_z:a.f.wb.max_z,min_z:a.f.wb.min_z}}};b4w.module.__lights=function(a,t){function l(a){b.scale(a.color,a.lr,a.nn)}t("__print");var c=t("__util"),b=t("__vec3"),y=new Float32Array(3);a.oJ=function(a,r){var x=a.data,v=r.jc={name:"",type:x.type,kA:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),nn:new Float32Array(3),XG:0,Hg:0,lp:0,Nx:!1,Lz:!1,gH:!1,lk:!0,ri:!0,lr:1,distance:25,UQ:"INVERSE_SQUARE"};v.name=r.name;v.lk=x.use_diffuse;v.ri=x.use_specular;var g=c.za(r.f.quat,c.jb,y);b.normalize(g,g);v.direction.set(g);
v.color[0]=x.color[0];v.color[1]=x.color[1];v.color[2]=x.color[2];v.lr=v.XG=x.energy;l(v);v.distance=x.distance;if("POINT"===v.type||"SPOT"===v.type)v.distance=x.distance;"SPOT"===v.type?(v.lp=x.spot_blend,v.Hg=x.spot_size):"POINT"===v.type&&(v.Hg=Math.PI/2);v.Nx=x.b4w_generate_shadows;v.gH=x.b4w_dynamic_intensity};a.OT=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];l(a)};a.RT=function(a,b){a.lp=b};a.PT=function(a,b){a.distance=b};a.ST=function(a,b){a.Hg=b};a.QT=function(a,b){a.lr=
b;l(a)};a.NM=function(a){if("LAMP"!=a.type)throw"Wrong light object";var l=a.jc;if(l){c.za(a.f.quat,c.jb,l.direction);b.normalize(l.direction,l.direction);if("SUN"==l.type){a=Math.acos(b.dot(l.kA,c.zv));var x=Math.acos(b.dot(l.direction,c.zv));l.Lz=Math.floor(a/.025)!=Math.floor(x/.025)?!0:!1}b.copy(l.direction,l.kA)}}};b4w.module.__sfx=function(a,t){function l(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;J.warn("deprecated WebAudio implementation");return null}J.warn("WebAudio is not supported");return null}function c(a,e,d){var c=a.A;if("NONE"!=c.behavior){d||(d=0);var f=c.loop,m=c.pitch;if(c.src&&(f||0<=d)){c.fq=Math.floor(5E4*Math.random());var g=E.currentTime+e;c.ud=g;c.state=20;b(a);"POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior?(e=E.createBufferSource(),
e.buffer=c.src,e.playbackRate.value=m,f?(c.Mb&&c.Mb.disconnect(),e.loop=!0,e.start(g),c.duration=0):(f=e.buffer?e.buffer.duration:0,d>f?(f=g+d+c.gd,e.loop=!0,e.start(g),e.stop(f),c.duration=d):(e.loop=!1,e.start(g),c.duration=f)),e.connect(c.Rc),c.Mb=e,h(c),r(c)):"BACKGROUND_MUSIC"==c.behavior&&(D.Ni(c.jq),D.Ni(c.kq),d=function(){var b=a.A,e=b.src;e&&(e.volume=1,e.loop=b.loop,b.Mb=b.Mb||E.createMediaElementSource(e),b.Mb.connect(b.Rc),20==b.state&&(e.currentTime&&(e.currentTime=0),e.play()))},0==
e?d():c.jq=D.Zo(d,1E3*e),c.duration=f?0:F(a));x(c,g)}}}function b(a){var b=a.A;if(!b.Rc){var e=a.f.i;a=a.f.quat;if(q.uo){var d=E.createBiquadFilter();d.type="peaking"}else d=null;var c=E.createGain();switch(b.behavior){case "POSITIONAL":var f=E.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(e[0],e[1],e[2]);C.copy(e,b.ns);e=m;n.za(a,n.dc,e);f.setOrientation(e[0],e[1],
e[2]);C.copy(e,b.direction);f.refDistance=b.dist_ref;f.maxDistance=b.dist_max;f.rolloffFactor=b.attenuation;f.coneInnerAngle=b.Kw;f.coneOuterAngle=b.Lw;f.coneOuterGain=b.Mw;var g=E.createGain();g.gain.value=A(b);d?(f.connect(d),d.connect(g)):f.connect(g);g.connect(c);b.Rc=f;if(b.ui){var h=E.createGain();c.connect(h);h.connect(E?z.ja.Rc:null)}else h=null,c.connect(E?z.ja.Rc:null);break;case "BACKGROUND_SOUND":f=null;g=E.createGain();g.gain.value=A(b);d?(b.Rc=d,d.connect(g)):b.Rc=g;g.connect(c);b.ui?
(h=E.createGain(),c.connect(h),h.connect(E?z.ja.Rc:null)):(h=null,c.connect(E?z.ja.Rc:null));break;case "BACKGROUND_MUSIC":h=f=null,g=E.createGain(),g.gain.value=A(b),d?(b.Rc=d,d.connect(g)):b.Rc=g,g.connect(c),c.connect(E?z.ja.Rc:null)}b.Nl=f;b.He=d;b.bj=g;b.xh=c;b.vA=h}}function y(a){var b=a.A,e=b.duration,b=b.jx+b.kx*Math.random();c(a,b,e)}function h(a){a.ui&&a.vA.gain.cancelScheduledValues(a.ud);a.Ij&&a.Mb.playbackRate.cancelScheduledValues(a.ud);a.sm=a.ud}function r(a){if(a.ui||a.Ij){var b=a.vA,
d=a.Mb,c=d.buffer?d.buffer.duration:0;if(c){var f=a.ud;e[0]=a.fq;for(var m=0;5>m;){var g=a.pitch+a.Ij*n.Pd(e);if(f>=a.sm){if(a.ui){var h=1-n.da(a.ui,0,1)*Math.random();b.gain.setValueAtTime(h,f)}a.Ij&&d.playbackRate.setValueAtTime(g,f);m++}f+=c/g}a.sm=f-.001}}}function x(a,b){if(a.yh||a.gd){var e=a.xh;e.gain.cancelScheduledValues(b);a.yh?(e.gain.setValueAtTime(0,b),e.gain.linearRampToValueAtTime(1,b+a.yh)):e.gain.setValueAtTime(1,b);a.gd&&!a.loop&&(e.gain.setValueAtTime(1,b+a.duration),e.gain.linearRampToValueAtTime(0,
b+a.duration+a.gd))}}function v(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.A;if(20==b.state||40==b.state){var e=b.xh,d=E.currentTime;b.gd&&(e.gain.setValueAtTime(e.gain.value,d),e.gain.linearRampToValueAtTime(0,d+b.gd));"BACKGROUND_MUSIC"==b.behavior?b.src&&(D.Ni(b.jq),D.Ni(b.kq),b.kq=D.Zo(function(){var b=a.A.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.gd)):(e=b.Mb,b.duration<e.buffer.duration?b.gd&&20==b.state?e.stop(d+b.gd):20==b.state&&(e.stop(0),e.disconnect()):e.disconnect(),
b.ud=0,b.Rs=0,b.tq=0);b.state=30}}function g(a){a=a.A;if(20==a.state){var b=E.currentTime;a.Rs=b;if("BACKGROUND_MUSIC"==a.behavior){var d=a.src;d&&d.pause()}else{if(b>a.ud){e[0]=a.fq;for(var c=a.Mb.buffer.duration,f=a.ud;f<b;)d=a.pitch+a.Ij*n.Pd(e),f+=c/d;d*=c/d-(f-b)}else d=0;a.tq=d;a.Mb.stop(0);a.Mb.disconnect();h(a)}a.state=40}}function p(a){var b=a.A;if(40==b.state){var e=E.currentTime;b.ud+=e-b.Rs;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.A;var d=E.createBufferSource();d.loop=a.Mb.loop;
d.buffer=a.Mb.buffer;d.playbackRate.value=a.Mb.playbackRate.value;a.Nl?d.connect(a.Nl):d.connect(a.bj);a.Mb=d;b.sm=e;b.Mb.start(b.ud,b.tq);r(b)}x(b,b.ud);b.state=20}}function f(a){return!a.A||20!=a.A.state&&40!=a.A.state&&30!=a.A.state?!1:!0}function A(a){return a.muted?0:a.volume}function F(a){a=a.A;return(a=a.src)?a.duration:0}var H=t("__config"),J=t("__print"),D=t("__time"),n=t("__util"),C=t("__vec3"),B=H.r,q=H.A;a.Pu=10;a.Ip=20;a.Ou=30;var m=new Float32Array(3),w=new Float32Array(3),d=new Float32Array(3),
I=[],u=[],E=null,z=null,G=[],e=[1],K=null;a.EG=function(){return{behavior:"NONE",uh:!1,muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,Kw:360,Lw:360,Mw:1,Hb:!1,loop:!1,jx:0,kx:0,ui:0,Ij:0,yh:0,gd:0,ud:0,Rs:0,tq:0,duration:0,sm:0,fq:1,src:null,state:10,ns:new Float32Array(3),direction:new Float32Array(3),St:new Float32Array(3),jq:-1,kq:-1,wh:0}};a.Kc=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(I.push("ogg"),
I.push("ogv")),""!=a.canPlayType("audio/mpeg")&&I.push("mp3"),""!=a.canPlayType("audio/mp4")&&(I.push("mp4"),I.push("m4v")),""!=a.canPlayType("audio/webm")&&I.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&u.push("ogv"),""!=b.canPlayType("video/mp4")&&u.push("m4v"),""!=b.canPlayType("video/webm")&&u.push("webm"));(E=q.Ku?l():null)&&J.log("%cINIT WEBAUDIO: "+E.sampleRate+"Hz","color: #00a")};a.Xv=function(a){var b={Nh:new Float32Array(3),Az:new Float32Array(3),rj:new Float32Array(3)};
a.ja=b;if(E){var e=E.createGain(),d=E.createGain();b.bj=e;b.xh=d;e.connect(d);d.connect(E.destination);if(a.b4w_enable_dynamic_compressor){var d=E.createDynamicsCompressor(),c=a.b4w_dynamic_compressor_settings;d.threshold.value=c.threshold;d.knee.value=c.knee;d.ratio.value=c.ratio;d.attack.value=c.attack;d.release.value=c.release;d.connect(e);b.Qk=d;b.Rc=d}else b.Qk=null,b.Rc=e;e=E.listener;b.uh=B.gr;b.uh||(e.dopplerFactor=a.audio_doppler_factor,e.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=
1;b.wh=0}};a.jL=function(a){z=a};a.er=function(a){a||(a="ogg");return-1<I.indexOf(a)?a:"ogg"==a&&-1<I.indexOf("mp4")?"mp4":"mp3"==a&&-1<I.indexOf("ogg")?"ogg":"mp4"==a&&-1<I.indexOf("ogg")?"ogg":"ogv"==a&&-1<I.indexOf("m4v")?"m4v":"webm"==a&&-1<I.indexOf("m4v")?"m4v":"m4v"==a&&-1<I.indexOf("webm")?"webm":""};a.fr=function(a){a||(a="webm");return-1<u.indexOf(a)?a:"ogv"==a&&-1<u.indexOf("m4v")?"m4v":"webm"==a&&-1<u.indexOf("m4v")?"m4v":"m4v"==a&&-1<u.indexOf("webm")?"webm":""};a.pi=function(a,b){if("SPEAKER"!=
b.type)throw"Wrong speaker object";var e=a.data,d=b.A;switch(e.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=E?e.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var c;E?(window.MediaElementAudioSourceNode?c=!0:(J.warn("MediaElementAudioSourceNode not found"),c=!1),c=c?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):c="NONE";d.behavior=c;break;default:throw"Wrong speaker behavior";}e.sound||(d.behavior="NONE");d.uh=e.b4w_disable_doppler||B.gr;d.muted=e.muted;d.volume=e.volume;d.pitch=
e.pitch;d.attenuation=e.attenuation;d.dist_ref=e.distance_reference;d.dist_max=e.distance_max||1E4;d.Kw=e.cone_angle_inner;d.Lw=e.cone_angle_outer;d.Mw=e.cone_volume_outer;d.Hb=e.b4w_cyclic_play;d.loop=e.b4w_loop;d.jx=e.b4w_delay;d.kx=e.b4w_delay_random;d.ui=e.b4w_volume_random;d.Ij=e.b4w_pitch_random;d.yh=e.b4w_fade_in;d.gd=e.b4w_fade_out;G.push(b)};a.GB=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.A.behavior){case "POSITIONAL":return a.Ip;case "BACKGROUND_SOUND":return a.Ip;
case "BACKGROUND_MUSIC":return a.Ou;case "NONE":return a.Pu;default:throw"Wrong speaker behavior";}};a.VM=function(a,b){var e=a.A;switch(e.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":e.src=b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.yK=function(){var a=E.createBufferSource();a.buffer=E.createBuffer(1,22050,22050);a.connect(E.destination);a.start(0)};a.VG=function(a,b,e){E?E.decodeAudioData(a,b,e):e()};a.VL=function(a){v(a);a.A=null;G.splice(G.indexOf(a),
1)};a.Y=function(){for(var a=0;a<G.length;a++){var b=G[a].A;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.Mb&&b.Mb.disconnect()}z&&z.ja&&(a=z.ja,a.Nh[0]=0,a.Nh[1]=0,a.Nh[2]=0,a.rj[0]=0,a.rj[1]=0,a.rj[2]=0);z=null;G.splice(0);K=null};a.update=function(a){if(E&&0!=G.length){for(var b=0;b<G.length;b++){var e=G[b],d=e.A,c=E.currentTime;E&&!d.loop&&d.Hb&&20==d.state&&d.duration&&d.ud+d.duration<c&&y(e);20==d.state&&3>d.sm-c&&r(d)}K&&K.Hf.length&&(-1==K.mb||a>K.Hv+K.qx[K.mb])&&(b=K,-1<b.mb&&v(b.Hf[b.mb]),
-1==b.mb&&b.random?e=Math.round(Math.random()*(b.Hf.length-1)):b.random?(e=1+Math.round(Math.random()*(b.Hf.length-2)),e=(b.mb+e)%b.Hf.length):e=(b.mb+1)%b.Hf.length,y(b.Hf[e]),b.mb=e,b.Hv=a)}};a.play=c;a.Us=y;a.stop=v;a.Lh=function(a){return 20==a.A.state};a.UL=g;a.WL=p;a.Tl=function(a,b){var e=a.A;e.pitch=b;!f(a)||"POSITIONAL"!=e.behavior&&"BACKGROUND_SOUND"!=e.behavior||(e.Mb.playbackRate.value=b,h(e),r(e))};a.uy=function(a){return a.A.pitch};a.Hb=function(a,b){a.A.Hb=Boolean(b)};a.mj=function(a){return a.A.Hb};
a.DJ=function(a,b,e,c){if(E&&a.ja){var f=m;f[0]=0;f[1]=-1;f[2]=0;C.transformQuat(f,e,f);w[0]=0;w[1]=0;w[2]=-1;C.transformQuat(w,e,w);e=E.listener;e.setPosition(b[0],b[1],b[2]);e.setOrientation(f[0],f[1],f[2],w[0],w[1],w[2]);C.copy(f,a.ja.Az);!a.ja.uh&&c&&(d[0]=(b[0]-a.ja.Nh[0])/c,d[1]=(b[1]-a.ja.Nh[1])/c,d[2]=(b[2]-a.ja.Nh[2])/c,n.Tj(d,a.ja.rj,c,.3,d),e.setVelocity(d[0],d[1],d[2]),C.copy(d,a.ja.rj));C.copy(b,a.ja.Nh)}};a.Bz=function(a,b){if(E&&z.ja&&!z.ja.uh){var e=m;b?C.copy(b,e):C.copy(z.ja.Az,
e);C.scale(e,a,e);E.listener.setVelocity(e[0],e[1],e[2]);C.copy(e,z.ja.rj)}};a.XL=function(a,b){var e=a.A;if(f(a)&&"POSITIONAL"==e.behavior){var d=a.f.i,c=e.Nl;c.setPosition(d[0],d[1],d[2]);var g=m;n.za(a.f.quat,n.dc,g);c.setOrientation(g[0],g[1],g[2]);g=e.ns;!e.uh&&b&&(w[0]=(d[0]-g[0])/b,w[1]=(d[1]-g[1])/b,w[2]=(d[2]-g[2])/b,n.Tj(w,e.St,b,.3,w),c.setVelocity(w[0],w[1],w[2]),C.copy(w,e.St));C.copy(d,g)}};a.HB=function(a,b,e){var d=a.A;if(f(a)&&"POSITIONAL"==d.behavior&&!d.uh){var c=m;e?C.copy(e,c):
C.copy(d.direction,c);C.scale(c,b,c);d.Nl.setVelocity(c[0],c[1],c[2]);C.copy(c,d.St);C.copy(a.f.i,d.ns)}};a.Nr=function(a){return a.A.behavior};a.vw=function(){for(var a=0;a<G.length;a++)if(f(G[a]))return!0;return!1};a.tL=function(a){var b=z.ja;b&&(b.volume=a,E&&(b.bj.gain.value=A(b)))};a.tI=function(){var a=z.ja;return a?a.volume:0};a.Ht=function(a,b){var e=a.A;e.volume=b;f(a)&&(e.bj.gain.value=A(e))};a.My=function(a){return a.A.volume};a.ge=function(a,b){a.A.muted=Boolean(b);f(a)&&(a.A.bj.gain.value=
A(a.A))};a.kz=function(a){return a.A.muted};a.dK=function(a){var b=z.ja;b&&(b.muted=Boolean(a),E&&(b.bj.gain.value=A(b)))};a.iJ=function(){var a=z.ja;return a?a.muted:!1};a.ul=function(){return G};a.pause=function(){for(var a=0;a<G.length;a++)g(G[a])};a.ke=function(){for(var a=0;a<G.length;a++)p(G[a])};a.XA=function(a,b){if(a.ja&&a.ja.Qk){var e=a.ja.Qk;e.threshold.value=b.threshold;e.knee.value=b.knee;e.ratio.value=b.ratio;e.attack.value=b.attack;e.release.value=b.release}};a.Zx=function(a){if(!a.ja||
!a.ja.Qk)return null;a=a.ja.Qk;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.px=function(a,b,e){if(f(a)){a=a.A;var d=a.xh,c=E.currentTime;d.gain.setValueAtTime(d.gain.value,c);d.gain.linearRampToValueAtTime(b,c+e);a.wh=e}};a.fC=function(a){if(f(a)){a=a.A;var b=a.xh,e=E.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(1,e+a.wh);a.wh=0}};a.eH=function(a,b){if(E){var e=z.ja,d=e.xh,c=E.currentTime;
d.gain.setValueAtTime(d.gain.value,c);d.gain.linearRampToValueAtTime(a,c+b);e.wh=b}};a.xM=function(){if(E){var a=z.ja,b=a.xh,e=E.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(1,e+a.wh);a.wh=0}};a.Pv=function(a,b,e){K={mb:-1,Hv:0,random:e,Hf:[],qx:[]};for(e=0;e<a.length;e++){var d=a[e],c=F(d);0==c?J.warn("Ignoring speaker with zero duration: "+d.name):(v(d),d.A.Hb=!1,K.Hf.push(d),K.qx.push(c+b))}};a.by=F;a.Fw=function(){if(K)for(var a=K.Hf,b=0;b<a.length;b++)v(a[b]);
K=null};a.vy=function(a){return(a=a.A)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.gB=function(a,b){var e=a.A;if(e&&"POSITIONAL"==e.behavior){e.dist_ref=b.dist_ref;e.dist_max=b.dist_max;e.attenuation=b.attenuation;var d=e.Nl;d&&(d.refDistance=e.dist_ref,d.maxDistance=e.dist_max,d.rolloffFactor=e.attenuation)}};a.aB=function(a,b){var e=a.A;e&&e.He&&(e.He.frequency.value=b.freq,e.He.Q.value=b.Q,e.He.gain.value=b.gain)};a.gy=function(a){return(a=
a.A)&&a.He?{freq:a.He.frequency.value,Q:a.He.Q.value,gain:a.He.gain.value}:null};a.fy=function(a,b,e,d){a=a.A;if(!a||!a.He)return null;a.He.getFrequencyResponse(b,e,d)}};b4w.module.__time=function(a,t){var l=t("__config");t("__print");t("__util");var c=0,b=0,y=[],h=0,r=0,x=[],v=-1;a.mB=function(a){c=a;b=performance.now();for(a=0;a<y.length;a++){var h=y[a];c>h.or&&(y.splice(a,1),a--,h.callback())}for(a=0;a<x.length;a++){var h=x[a],f=1-(h.or-c)/h.duration,f=Math.min(f,1);h.callback(h.from+f*(h.to-h.from));1==f&&(x.splice(a,1),a--)}};a.gg=function(){return c};a.Zo=function(a,l){var f;h++;f=h;y.push({id:f,callback:a,or:c+(performance.now()-b+l)/1E3});return f};a.Ni=function(a){for(var b=
0;b<y.length;b++)if(y[b].id==a){y.splice(b,1);break}};a.Jk=function(a){for(var b=x.length;b--;)if(x[b].id==a){x.splice(b,1);break}};a.fh=function(a,b,f,h){f/=1E3;var l;r++;l=r;x.push({id:l,callback:h,from:a,to:b,or:c+f,duration:f});h(a);return l};a.reset=function(){b=c=0;y.length=0;r=h=x.length=0};a.Sb=function(){return-1!==l.gh.Mn?l.gh.Mn:v};a.oL=function(a){v=a}};b4w.module.__objects=function(a,t){function l(a){a.f.bi=0;a=ca.indexOf(a);-1!=a&&ca.splice(a,1)}function c(a){if(a.Yi)for(var b=a.ba,e=0;e<b.length;e++)K.LM(b[e].Aa,a)}function b(a,b){for(var e=a.ba,d=b.ba,k=0;k<e.length;k++){for(var c=!1,f=0;f<d.length;f++)if(e[k].Aa==d[f].Aa){c=!0;break}c||y(b,e[k].Aa)&&I.Wm(b,e[k].Aa)}}function y(a,b){return!b.Dv&&"SPEAKER"==a.type||!b.sE&&("LAMP"==a.type||"CAMERA"==a.type)?!1:!0}function h(a,b){if(a.dg_parent&&a.dg_parent.Bv||a.parent&&a.parent.Bv)return!0;switch(a.type){case "MESH":var e=
a.b4w_do_not_batch,k=a.b4w_collision,c=a.b4w_vehicle,f=a.b4w_floating,m=a.b4w_character,g=u.MI(a),h=d.jw(a),q=0<a.data.b4w_shape_keys.length,l=a.b4w_dynamic_geometry;if(!(e=J.kw(a,b)||e||k||c||q||f))a:{e=a.data;for(k=0;k<e.materials.length;k++)if("LENS_FLARES"===e.materials[k].name){e=!0;break a}e=!1}return e||g||m||h||l;case "EMPTY":return m=d.jw(a),g=a.b4w_do_not_batch,J.kw(a,b)||m||g;default:return!0}}function r(a,b,e,d,k,c,f,m,g){for(var h=0;h<a.nodes.length;h++){var u=a.nodes[h];if("VALUE"==
u.type){var q=v(b,u.name);d.push(u.outputs[0].default_value);k.push(q,k.length/2)}else"RGB"==u.type?(q=v(b,u.name),u=u.outputs[0].default_value.slice(0,3),f.push(u[0],u[1],u[2]),m.push(q,m.length/2)):"GROUP"==u.type&&(q=u.node_group.node_tree,r(q,v(b,u.name),q.animation_data,d,k,c,f,m,g))}if(e)for((a=e.action)&&a.k.type==J.Su&&x(a,b,c,k,g,m),e=e.nla_tracks,d=0;d<e.length;d++)for(f=e[d].strips,h=0;h<e[d].strips.length;h++)(a=f[h].action)&&a.k.type==J.Su&&x(a,b,c,k,g,m)}function x(a,b,e,d,k,c){var f=
a.k.Ta,m;for(m in f){var h=v(b,m.match(/"(.*?)"/)[1]),f=g(d,h);null!=f?(h=v(a.name,m),e.push(h,f)):(f=g(c,h),null!=f&&(h=v(a.name,m),k.push(h,f)))}}function v(a,b){return a+"%join%"+b}function g(a,b){for(var e=0;e<a.length;e+=2)if(a[e]==b)return a[e+1];return null}function p(a,b){for(var e=a.f.Sh,d=0;d<e.length;d+=2)if(e[d]==b)return e[d+1];return null}function f(a,b){for(var e=a.f.Rh,d=0;d<e.length;d+=2)if(e[d]==b)return e[d+1];return null}function A(a,b,e){b=P[b]||[];for(var d=[],k=0;k<b.length;k++){var c=
b[k];if(c.f.Hc==e||-1==e)for(var f=c.ba,m=0;m<f.length;m++)f[m].Aa==a&&d.push(c)}return d}function F(a,b,e,d){for(var k=null,c=0;c<b.length;c++){var f=b[c];if((e?f.Zh:f.name)==a&&(f.f.Hc==d||-1==d)&&(k=f,!I.qf(k)))break}return k}function H(a){P.ALL.push(a);P[a.type]||(P[a.type]=[]);P[a.type].push(a);var b=a.f.pd;if(null!=b)for(var e=0;e<ka.length;e++){var d=ka[e];d.f.pd==b&&d.Yl.push(a)}}var J=t("__animation"),D=t("__batch"),n=t("__boundings"),C=t("__camera"),B=t("__config"),q=t("__constraints"),
m=t("__geometry"),w=t("__lights"),d=t("__nla"),I=t("__obj_util"),u=t("__particles"),E=t("__physics"),z=t("__print"),G=t("__primitives"),e=t("__quat"),K=t("__scenes"),k=t("__sfx"),M=t("__transform"),Q=t("__tsr"),aa=t("__util"),U=t("__vec3"),ba=t("__armature"),T=B.r,ea=B.Db,P={ALL:[]},S=0,da=0,ka=[],ca=[],ia=new Float32Array(3),fa=new Float32Array(4);a.Pp=0;a.Op=1;a.Pf=2;a.uc=-1;a.update=function(a){for(var b=P.ALL,e=P.ARMATURE,d=0;d<b.length;d++)for(var k=b[d],c=k.ba,f=0;f<c.length;f++){var m=c[f].Aa;
if(m.k.outline){if(-1!=ca.indexOf(k)){var g=k,h=a,u=0,q=g.Zz;0==q.pp&&(q.pp=h);h-=q.pp;if(q.lt&&h/q.od>=q.lt)l(g);else{h%=q.od;if(h<q.Ps)switch(q=h/(q.Ps/5),h=Math.floor(q),h){case 0:u=(q-h)/2;break;case 1:u=(q-h)/2+.5;break;case 2:u=1;break;case 3:u=1-(q-h)/2;break;case 4:u=.5-(q-h)/2}g.f.bi=u}}k.f.bi&&K.WK(m)}}if(e)for(d=0;d<e.length;d++)a=e[d],a.Gs&&(M.q(a),a.Gs=!1)};a.ih=function(a,b,e,d){var k=a.Zz;k.pp=0;k.Ps=b;k.od=e;k.lt=d;-1==ca.indexOf(a)&&ca.push(a)};a.Mi=l;a.pi=function(a,b){var d=a.animation_data,
c=a.data.animation_data;d&&d.action&&(d=d.action,(d.k.type==J.PC||d.k.type==J.OC&&"ARMATURE"==b.type)&&b.Sd.push(d));c&&c.action&&"SPEAKER"==b.type&&b.Sd.push(c.action);"MESH"==b.type&&b.Sd.push.apply(b.Sd,J.aI(a));a.Bv=b.xa=h(a,b);a.kP=!0;b.Mc=a.b4w_vehicle;b.Md=a.b4w_character;b.Kh=a.b4w_floating;b.mk=a.b4w_collision;c=a.game;b.ie={Go:c.physics_type,pm:c.use_ghost,rC:c.use_sleep,Me:c.mass,wC:c.velocity_min,vC:c.velocity_max,Zq:c.damping,st:c.rotation_damping,FJ:c.lock_location_x,GJ:c.lock_location_y,
HJ:c.lock_location_z,IJ:c.lock_rotation_x,JJ:c.lock_rotation_y,KJ:c.lock_rotation_z,Nk:c.collision_margin,Lk:c.collision_group,Ok:c.collision_mask,yu:c.use_collision_bounds,ln:c.collision_bounds_type,om:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.Xc={name:c.name,Qc:c.part,mM:c.suspension_rest_length,$t:c.suspension_compression,bu:c.suspension_stiffness,au:c.suspension_damping,Mu:c.wheel_friction,qt:c.roll_influence,As:c.max_suspension_travel_cm,il:c.force_max,Gk:c.brake_max,$j:c.steering_max,
wj:c.max_speed_angle,Vk:c.delta_tach_angle,gm:c.speed_ratio,im:c.steering_ratio,yl:c.inverse_control,zh:c.floating_factor,wi:c.water_lin_damp,xi:c.water_rot_damp,UB:c.synchronize_position};if(c=a.b4w_floating_settings)b.Zi={name:c.name,Qc:c.part,zh:c.floating_factor,wi:c.water_lin_damp,xi:c.water_rot_damp,UB:c.synchronize_position};if(c=a.b4w_character_settings)b.uw={AN:c.walk_speed,bL:c.run_speed,eM:c.step_height,nJ:c.jump_strength,CN:c.waterline};for(c=0;c<a.constraints.length;c++)d=a.constraints[c],
"RIGID_BODY_JOINT"==d.type&&b.Ts.push({target:d.target.ad,sK:d.pivot_type,tK:d.pivot_x,uK:d.pivot_y,vK:d.pivot_z,ze:d.axis_x,Ae:d.axis_y,Be:d.axis_z,dN:d.use_limit_x,eN:d.use_limit_y,fN:d.use_limit_z,ZM:d.use_angular_limit_x,$M:d.use_angular_limit_y,aN:d.use_angular_limit_z,xJ:d.limit_max_x,yJ:d.limit_max_y,zJ:d.limit_max_z,AJ:d.limit_min_x,BJ:d.limit_min_y,CJ:d.limit_min_z,rJ:d.limit_angle_max_x,sJ:d.limit_angle_max_y,tJ:d.limit_angle_max_z,uJ:d.limit_angle_min_x,vJ:d.limit_angle_min_y,wJ:d.limit_angle_min_z});
c=b.f=I.Si("MESH"===b.type?b.xa?"DYNAMIC":"STATIC":b.type);a.parent?(b.parent=a.parent.ad,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Pl=a.parent_bone)):a.dg_parent&&(b.parent=a.dg_parent.ad,b.tg=!0);var d=a.location,f=a.scale[0];aa.at(a.rotation_quaternion,fa);M.Pe(b,d);M.Ff(b,fa);M.Oe(b,f);b.zp=a.b4w_use_default_animation;b.Rm=J.xE(a.b4w_anim_behavior);a.b4w_object_tags&&(b.so={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,VP:a.b4w_object_tags.category});switch(a.type){case "ARMATURE":ba.pi(a,
b);var d=c.Dd,m=J.wF(d);a.b4w_animation_mixing?(c.Sc=new Float32Array(m.pa),c.qd=new Float32Array(m.pa),c.Wc=new Float32Array(m.i),c.xd=new Float32Array(m.i)):(c.Sc=m.pa,c.qd=m.pa,c.Wc=m.i,c.xd=m.i);for(var g in d)f=d[g],1==f.jn.length&&ba.FM(f,!0,m.i,m.pa);c.Ws=m;c.Jd=0;c.eh=a.b4w_animation_mixing;break;case "MESH":c.Cn=a.b4w_do_not_render;c.Ii=D.jF(a.data.b4w_bounding_box);c.Ef=ea.outlining_overview_mode||a.b4w_selectable;c.zo=a.b4w_selectable;c.Db=ea.outlining_overview_mode||a.b4w_outlining;c.yo=
a.b4w_outlining;c.$z=ea.outlining_overview_mode||a.b4w_outline_on_select;c.Ud=a.b4w_billboard;c.lq=a.b4w_pres_glob_orientation;c.Ek="BASIC";c.Dk="SPHERICAL"==a.b4w_billboard_geometry;g=c.Ej;g.Fj=a.b4w_outline_settings.outline_duration;g.Gj=a.b4w_outline_settings.outline_period;g.Hj=a.b4w_outline_settings.outline_relapses;c.Ef&&(c.mn=aa.Jx(S),S++);for(g=0;g<a.data.b4w_vertex_anim.length;g++)d=a.data.b4w_vertex_anim[g],b.cc.push({name:d.name,J:d.frame_start,aa:d.frame_end,PP:d.averaging,QP:d.averaging_interval,
vE:d.allow_nla});b.f.cc=b.cc.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;g=b.f;if(a.data.b4w_shape_keys.length)for(g.Xe=!0,d=0;d<a.data.b4w_shape_keys.length;d++)f={},f.value=a.data.b4w_shape_keys[d].value,f.name=a.data.b4w_shape_keys[d].name,g.Bg.push(f);else g.Xe=!1;if(g=J.Vx(a)){var u=g.ad,d=u.f.Ws,f=b.f,q=a.data;b.Ym=u;q=q.vertex_groups;if(q.length){var u=u.f.Dd,l=0,p={};for(m in u){var E=aa.Ub("name",m,q);E&&(p[m]={zC:E.index,Tf:u[m].Tf,cr:l++})}f.Ki=p;m=l;q=J.py();f.zf=
m;m>2*q?(f.oj=!1,z.error('too many bones for "'+a.name+'" / '+f.zf+" bones (max "+q+" with blending, "+2*q+" without blending). Skinning will be disabled.")):f.oj=!0}m=J.wH(d.i,d.pa,c.Ki);g.b4w_animation_mixing?(c.Sc=new Float32Array(m.pa),c.qd=new Float32Array(m.pa),c.Wc=new Float32Array(m.i),c.xd=new Float32Array(m.i)):(c.Sc=m.pa,c.qd=m.pa,c.Wc=m.i,c.xd=m.i);c.dq=new Float32Array(4);c.cq=e.create();c.Ws=m;c.Jd=0}m=b.f;g=a.data.materials;d=[];f=[];q=[];u=[];l=[];p=[];for(E=0;E<g.length;E++){var B=
g[E],G=B.node_tree;G&&r(G,B.name,G.animation_data,d,f,q,u,l,p)}m.yf=d;m.Sh=f;m.qo=q;m.ld=u;m.Rh=l;m.ro=p;c.td=a.b4w_shadow_cast;c.Vc=a.b4w_shadow_receive;c.Uc=a.b4w_shadow_cast_only&&c.td;c.Cc=a.b4w_reflexible;c.nc=a.b4w_reflexible_only&&c.Cc;c.Tc=a.b4w_reflective;c.Ne=a.b4w_reflection_type;c.gf=a.b4w_caustics;c.zd=a.b4w_wind_bending;c.tm=a.b4w_wind_bending_angle;m=D.DN(a.b4w_wind_bending_angle,c.Ii,a.scale[0]);c.Ye=m;c.Mf=a.b4w_wind_bending_freq;c.lf=a.b4w_detail_bending_freq;c.kf=a.b4w_detail_bending_amp;
c.ef=a.b4w_branch_bending_amp;c.jj=!1;c.wf=a.b4w_main_bend_stiffness_col;m=a.b4w_detail_bend_colors;c.ic={};c.ic.xz=m.leaves_stiffness_col;c.ic.wz=m.leaves_phase_col;c.ic.aA=m.overall_stiffness_col;c.Ui=a.b4w_do_not_cull;c.Bn=a.b4w_disable_fogging;c.Ge=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";m=a.data.materials[0];c.ll=m.physics.friction;c.el=m.physics.elasticity;c.Fl=0;c.mg=1E4;c.Ph=a.b4w_lod_transition;c.oo=!0;break;case "CAMERA":C.AF(a,b);C.cF(b);break;case "LAMP":w.oJ(a,b);
break;case "SPEAKER":b.A=k.EG();c=!1;for(m=0;m<b.ba.length;m++)if(b.ba[m].Aa.b4w_enable_audio){c=!0;break}c&&k.pi(a,b);break;case "EMPTY":c.Yb=n.Qd(),m=n.um(),c.Ed=m,a.field&&(b.Yi={type:a.field.type,OB:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Ti:a.b4w_anchor.detect_visibility,Fn:a.b4w_anchor.element_id,YJ:a.b4w_anchor.max_width})}H(b)};a.PM=function(a){var e=a.f;if(a.parent){var d=e.i,c=e.quat,k=e.scale;!a.tg&&a.ie.om&&a.parent.ie.om&&(a.mk=!1);var f=a.ie;a.Mc||a.Kh||E.Md(a)||
a.mk&&!f.pm&&0<f.Me&&("DYNAMIC"==f.Go||"RIGID_BODY"==f.Go)?(d=a.tg?Q.Fe(d,k,c):e.Ca,Q.multiply(a.parent.f.Ca,d,e.Ca),M.Pe(a,Q.gj(e.Ca)),M.Oe(a,Q.fg(e.Ca)),M.Ff(a,Q.fj(e.Ca))):a.tg||!a.Pl?(d=Q.Fe(d,k,c),q.AE(a,a.parent,d)):(d=Q.Fe(d,k,c),q.BE(a,a.parent,a.Pl,d))}if("ARMATURE"==a.type)for(d=a.La.pose.bones,c=0;c<d.length;c++)if(k=d[c],f=k.constraints)for(var m=0;m<f.length;m++){var g=f[m];"COPY_TRANSFORMS"!=g.type||g.subtarget||g.mute||q.LE(a,g.target.ad,k.name,aa.yv,aa.rv)}if("MESH"==a.type&&e.Tc)if(e=
a.f,"CUBE"==e.Ne)e.Fd=da++;else if("PLANE"==e.Ne){a:{d=a.La.constraints;for(c=0;c<d.length;c++)if(k=d[c],"LOCKED_TRACK"==k.type&&"REFLECTION PLANE"==k.name){d=k.target.ad;break a}d=null}d||(d=aa.ik("%reflection%"),d=I.Rq(d,"EMPTY"),c=I.Si("EMPTY"),d.f=c,b(a,d),q.Lv(d,a,[0,0,0],null,1),H(d));c=null;for(k=0;k<ka.length;k++)if(ka[k]==d){c=k;break}null==c&&(c=ka.length,ka.push(d));d.f.pd=c;e.pd=c;d.Yl.push(a)}};a.jC=c;a.tQ=b;a.MF=y;a.QM=function(a){for(var b=0;b<a.length;b++){var e=a[b];!e.f||"DYNAMIC"!=
e.f.type&&"CAMERA"!=e.f.type||M.q(e);e.zp&&J.Yz(e)&&(J.Xm(e),e.F.length&&J.play(e,null,J.Gm))}};a.tl=function(a){return aa.ra(a.so)};a.Y=function(){da=S=0;ka=[];ca.length=0;P={ALL:[]}};a.copy=function(a,e,d){var c=e,k=I.qf(a);e=k?I.Kx(k.name,e):e;if(F(e,P.ALL,!1,-1)){for(var k=1,f;;){f="."+(3>String(k).length?("000"+String(k)).slice(-3):String(k));if(!F(e+f,P.ALL,!1,-1))break;k++}z.error('Object "'+e+'" already exists. Name was replaced by "'+e+f+'".');c+=f;e+=f}c=I.Rq(e,a.type,c);c.xa=a.xa;c.Bl=
a.Bl;c.zp=a.zp;c.f=I.Xf(a.f);c.so=I.Xf(a.so);b(a,c);c.Ci=I.Kq(a.Ci);c.parent=I.Kq(a.parent);c.tg=a.tg;c.Pl=a.Pl;c.La=a.La;!a.m||a.Mc||a.Md||a.Kh||(c.mk=a.mk,c.m=I.Xf(a.m));c.ie=I.Xf(a.ie);e=[];k=aa.Lx();for(f=0;f<a.ba.length;f++){var g=c.ba[f],h=a.ba[f].W;if(d){for(var g=g.W,u=0;u<h.length;u++)h[u].Bh||(g.push(I.Xf(h[u])),e.push(h[u].ca));for(u=0;u<h.length;u++)if(h[u].Bh){var q=I.Xf(h[u]);g.push(q);for(var l=0;l<e.length;l++)e[l]==h[u].ca&&(q.ca=g[l].ca)}for(u=0;u<g.length;u++)g[u].ca&&m.MM(g[u].ca),
g[u].Dj=k,D.AM(g[u],D.yF(c.f))}else g.W=I.Kq(h)}I.tt(c,!1);H(c);c.f.es=!0;c.f.mn=aa.Jx(S);S++;return c};a.ZR=p;a.NR=f;a.KU=function(a){for(var b=a.f,e=a.ba[0].W,d,c,k,f,g,h,u=0;u<e.length;u++){var q=e[u];if("MAIN"==q.type){var q=q.ca.pe,l=e[u].ca.vg,z=l.a_position.offset,l=l.a_position.length+z;d=f=q[z];c=g=q[z+1];k=h=q[z+2];for(var w=z;w<l;w+=3){var z=q[w],p=q[w+1],E=q[w+2];d=Math.max(z,d);c=Math.max(p,c);k=Math.max(E,k);f=Math.min(z,f);g=Math.min(p,g);h=Math.min(E,h)}}}var B={max_x:parseFloat(d.toFixed(3)),
max_y:parseFloat(c.toFixed(3)),max_z:parseFloat(k.toFixed(3)),min_x:parseFloat(f.toFixed(3)),min_y:parseFloat(g.toFixed(3)),min_z:parseFloat(h.toFixed(3))},r=d-f,x=c-g,C=k-h;f=.5*(d+f);var A=.5*(c+g),v=.5*(k+h),K=f,y=v;g=Math.max(r,Math.max(x,C))/2;h=Math.max(r,C)/2;var t=[f/(r?r:1),A/(x?x:1),v/(C?C:1)],I=.5;if(b.Ud)z=Math.max(Math.abs(B.max_x),Math.abs(B.min_x)),p=Math.max(Math.abs(B.max_y),Math.abs(B.min_y)),E=Math.max(Math.abs(B.max_z),Math.abs(B.min_z)),g=Math.sqrt(z*z+p*p+E*E),h=Math.sqrt(z*
z+p*p),B.max_x=B.max_y=B.max_z=g,B.min_x=B.min_y=B.min_z=-g,f=new Float32Array([0,0,0]),C=new Float32Array([g,g,g]),x=new Float32Array([0,0,0]);else{for(u=0;u<e.length;u++)if(q=e[u],"MAIN"==q.type)for(q=q.ca.pe,l=e[u].ca.vg,z=l.a_position.offset,l=l.a_position.length+z,w=z;w<l;w+=3){var z=q[w],p=q[w+1],E=q[w+2],F=Math.sqrt((f-z)*(f-z)+(A-p)*(A-p)+(v-E)*(v-E));if(F>g){var Q=f-g*(z-f)/F,H=A-g*(p-A)/F,F=v-g*(E-v)/F;f=(Q+z)/2;A=(H+p)/2;v=(F+E)/2;g=Math.sqrt((f-z)*(f-z)+(A-p)*(A-p)+(v-E)*(v-E))}H=Math.sqrt((K-
z)*(K-z)+(y-E)*(y-E));H>h&&(Q=K-h*(z-K)/H,F=y-h*(E-y)/H,K=(Q+z)/2,y=(F+E)/2,h=Math.sqrt((K-z)*(K-z)+(y-E)*(y-E)));z/=r?r:1;p/=x?x:1;E/=C?C:1;F=Math.sqrt((t[0]-z)*(t[0]-z)+(t[1]-p)*(t[1]-p)+(t[2]-E)*(t[2]-E));F>I&&(Q=t[0]-I*(z-t[0])/F,H=t[1]-I*(p-t[1])/F,F=t[2]-I*(E-t[2])/F,t[0]=(Q+z)/2,t[1]=(H+p)/2,t[2]=(F+E)/2,I=Math.sqrt((t[0]-z)*(t[0]-z)+(t[1]-p)*(t[1]-p)+(t[2]-E)*(t[2]-E)))}u=r?r*t[0]:d;c=x?x*t[1]:c;k=C?C*t[2]:k;r*=I;x*=I;C*=I;f=new Float32Array([f,A,v]);C=new Float32Array([r,x,C]);x=new Float32Array([u,
c,k]);h=parseFloat(h.toFixed(3))}b.Yb=B;D.sL(b,h,h,B);B=n.tn(g,f);b.Ed=B;B=n.sn([C[0],0,0],[0,C[1],0],[0,0,C[2]],x);b.Sf=B;M.q(a);if(T.wireframe_debug)for(u=0;u<e.length;u++)if("WIREFRAME"===e[u].type&&e[u].th){a=G.zr(1,B.G);m.LA(a,[B.ze[0],B.Ae[1],B.Be[2]],B.G);m.np(a,1,!0);a.N.a_polyindex=m.rr(a);D.zM(e[u],a);break}};a.Ja=A;a.xI=function(a,b){for(var e=P.ALL||[],d=[],c=0;c<e.length;c++){var k=e[c];if((k.f.Hc==b||-1==b)&&k.La)for(var f=k.ba,m=0;m<f.length;m++)f[m].Aa==a&&d.push(k)}return d};a.On=
function(a){var b=P.ALL;if(-1==a)return b;for(var e=[],d=0;d<b.length;d++){var c=b[d];c.f.Hc==a&&e.push(c)}return e};a.SL=function(a){var b=A(a,"LAMP",-1);if(b.length==a.k.US){for(var e=[],d=0;d<b.length;d++){var c=b[d],c=I.Qa(c,a);e[c.El]=d}for(d=0;d<e.length-1;d++)for(c=d+1;c<e.length;c++){var k=b[e[d]].jc,f=b[e[c]].jc;if(f.lk&&f.ri&&(!k.lk||!k.ri)||!k.lk&&(f.lk||!k.ri&&f.ri))k=e[d],e[d]=e[c],e[c]=k}for(d=0;d<e.length;d++)c=b[e[d]],I.Qa(c,a).El=d,K.kC(b[e[d]],a)}};a.JU=function(a){for(var b=A(a,
"LAMP",-1),e=A(a,"MESH",-1),d=0;d<e.length;d++)for(var c=I.Qa(e[d],a).W,k=0;k<c.length;k++){var f=c[k];"MAIN"==f.type&&(D.BM(f,b,a),D.Vb(f))}};a.yI=function(){for(var a=[],b=P.MESH,e=0;e<b.length;e++){var d=b[e];d.f.Ef&&a.push(d)}return a};a.ce=function(b,e,d,c){var k=null,f=P.ALL;switch(b){case a.Pp:k=F(e,f,!0,d);break;case a.Op:a:{for(b=0;b<f.length;b++)if(k=f[b],k.Zh==d&&(k.f.Hc==c||-1==c)){var m=I.qf(k);if(m&&m.Zh==e)break a}k=null}break;case a.Pf:a:{for(c=0;c<f.length;c++){b=f[c];for(var k=e.length-
1,m=b,g=!0;0<=k&&g;)g=m&&m.Zh==e[k]&&(m.f.Hc==d||-1==d),m&&(m=I.qf(m)),k--;if(g&&!m){k=b;break a}}k=null}}return k};a.Rl=function(b,e){var d=K.ej();if(!d)return z.error("No active scene"),null;var c=K.rK(d,b,e);if(!c)return null;for(var d=A(d,"MESH",-1),k=0;k<d.length;k++){var f=d[k].f,m=f.mn;if(m&&3>Math.abs(255*m[0]-c[0])&&3>Math.abs(255*m[1]-c[1])&&3>Math.abs(255*m[2]-c[2]))return f.Db&&f.$z&&(ea.outlining_overview_mode?a.ih(d[k],ea.Fj,ea.Gj,ea.Hj):(c=f.Ej,a.ih(d[k],c.Fj,c.Gj,c.Hj))),d[k]}return null};
a.qB=function(a,b){for(var e=A(a,"EMPTY",-1),d=0;d<e.length;d++){var k=e[d];if(k.Yi&&"WIND"===k.Yi.type)var f=k}if(!f)return z.error("There is no wind on the scene"),0;"number"==typeof b.wind_dir&&(U.set(-Math.PI/2,b.wind_dir/180*Math.PI,0,ia),aa.bg(ia,fa),M.Ff(f,fa),c(f));"number"==typeof b.wind_strength&&(f.Yi.OB=b.wind_strength,c(f));K.wu(a)};a.DA=function(a){q.NF(a)&&q.remove(a);var b=P.ALL,e=P[a.type],d=b.indexOf(a);a=e.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&e.splice(a,1)};a.jK=H;a.kK=function(a){return P[a.type]&&
-1<P[a.type].indexOf(a)};a.vL=function(a,b,e,d,c){b=b.join("%join%");var k=f(a,b);null!=k?(a.f.ld[3*k]=e,a.f.ld[3*k+1]=d,a.f.ld[3*k+2]=c):z.error('The RGB node "'+b+'" was not found in the object "'+a.name+'".')};a.wL=function(a,b,e){b=b.join("%join%");var d=p(a,b);null!=d?a.f.yf[d]=e:z.error('The Value node "'+b+'" was not found in the object "'+a.name+'".')}};b4w.module.__nla=function(a,t){function l(a,b,d){for(var c=0;c<a.length;c++){var f=a[c],e=d+" ["+f.J+":"+f.aa+"]",m=Math.max(b.J,f.J);f.bh+=m-f.J;f.J=m;f.aa=Math.min(b.aa+1,f.aa);f.J>f.aa?(D.warn("NLA: out of scene range: "+e),a.splice(c,1),c--):f.Td||"CLIP"!=f.type||(D.warn('NLA: no action in strip for object "'+d+'".'),a.splice(c,1),c--)}}function c(a,b){for(var d=0;d<a.length;d++){for(var c=a[d],f=b.J,e=b.aa+1,m=0;m<a.length;m++){var k=a[m];c.fc==k.fc&&(k.aa<=c.J&&(f=c.J),k.J>=c.aa&&(e=Math.min(e,
k.J)))}c.vx=f;c.ux=e}}function b(){return{type:"CLIP",J:0,aa:0,Df:!1,paused:!1,Td:"",Ck:"",fc:0,bh:0,zk:0,vx:0,ux:0,qC:!1,scale:1,repeat:1}}function y(a,b){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var c=0;c<d.length;c++)b.push(d[c])}d=a.nodes;for(c=0;c<d.length;c++){var f=d[c];f.node_group&&(f=f.node_group.node_tree)&&y(f,b)}}function h(a,b){var d=Math.round(a)-b.J;b.kk&&(d%=b.aj,0>d&&(d+=b.aj));return b.Ea+d}function r(a,b,d,c){b=(b-c)*q.Sb()+a.Ea;b>a.J&&(b-=a.J,a.Hb&&d&&(b%=
a.aa-a.J+1),b+=a.J);return b}function x(a,b){a=m.da(a,b.J,b.aa);var d=a-b.J,c=(b.aa-b.J)/b.repeat,d=d/c&&0==d%c?b.zk:b.bh+d%c/b.scale;b.qC&&(d=b.zk-d+b.bh);return d}function v(a,d){for(var c=[],f=0;f<a.length;f++){var m=a[f].strips;if(m)for(var e=0;e<m.length;e++){var g=m[e],k=b();k.type=g.type;k.J=g.frame_start;k.aa=g.frame_end;k.fc=d;k.bh=g.action_frame_start;k.zk=g.action_frame_end;k.qC=g.use_reverse;k.scale=g.scale;k.repeat=g.repeat;g.action&&(k.Td=g.action.name,k.Ck=g.action.uuid);c.push(k)}}return c}
function g(a){return"SPEAKER"==a.type&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function p(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var d=a[b],c=d.node_tree;if(d=d.use_nodes&&c)a:{if(c.animation_data&&(d=c.animation_data.nla_tracks)&&d.length){d=!0;break a}c=c.nodes;for(d=0;d<c.length;d++);d=!1}if(d)return!0}return!1}function f(a){return a.b4w_use_nla||a.b4w_use_logic_editor}function A(a,b){var c=n.o();c.X&&(c.X.Ea-=
r(c.X,b,!0,d)-a,c.X.jl=!0)}var F=t("__animation");t("__camera");t("__controls");t("__config");t("__lights");t("__loader");var H=t("__objects"),J=t("__obj_util"),D=t("__print"),n=t("__scenes"),C=t("__sfx"),B=t("__textures"),q=t("__time"),m=t("__util"),w=[],d=-1;a.pi=function(a,d){var c;c=null;for(var h=d.ba.length-1;0<=h;h--){var q=d.ba[h];if(f(q.Aa)&&(c=q,q.Aa.Dv))break}if(c){c.Xz=!0;var e=0;if((h=a.animation_data)&&h.nla_tracks.length){var l=h.nla_tracks;if(J.Jh(d)||J.jd(d)||J.Lc(d)||J.ho(d)||J.gJ(d)||
J.pj(d))l=v(l,e),l.length&&(d.Od=d.Od.concat(l),e++)}g(a)&&(l=a.data.animation_data.nla_tracks,l=v(l,e),l.length&&(d.Od=d.Od.concat(l),e++));if(J.Lc(d))for(q=a.data.materials,h=0;h<q.length;h++){var k=q[h];if(k.use_nodes&&k.node_tree&&(l=[],y(k.node_tree,l),l=v(l,e),l.length)){for(var k=e,n=l,w=F.Ox(),p=[],B=0,r=0;r<n.length;r++){var x=n[r];""!=x.Ck?x=m.Ub("uuid",x.Ck,w):(x=x.Td,x=m.Ub("name",x,w)||m.Ub("name",x+"_B4W_BAKED",w));if(x){var x=x.fcurves,C=[],A;for(A in x)C.push(A);p.push(C)}}for(r=0;r<
p.length;r++){w=!1;for(x=0;x<r;x++)if(m.$E(p[r],p[x])){n[r].fc=n[x].fc;w=!0;break}w||(n[r].fc=e+B++)}e=k+B;d.Od=d.Od.concat(l)}}for(h=0;h<a.particle_systems.length;h++)q=a.particle_systems[h],A=q.settings,"EMITTER"==A.type&&A.b4w_allow_nla&&(A=b(),A.type="CLIP",A.J=c.Aa.frame_start,A.aa=c.Aa.frame_end+1,A.Td=q.name,A.fc=e,A.bh=A.J,A.zk=A.aa,d.Od.push(A),e++);q=e+1;for(h=0;h<d.cc.length;h++)l=d.cc[h],l.vE&&(e=q,A=b(),A.type="CLIP",A.J=c.Aa.frame_start,A.aa=c.Aa.frame_end+1,A.Td=l.name,A.fc=e,A.bh=
A.J,A.zk=A.aa,d.Od.push(A))}};a.SM=function(a,d,f){a.X||(a.X={J:a.frame_start,aa:a.frame_end,Ea:0,Dl:-1,No:a.frame_end,dt:a.frame_start,nk:null,Hb:d,lc:[],T:[],eL:a.name,lg:!1,jl:!1,pt:!0});d=a.X;for(var g=H.xI(a,f),h=0;h<g.length;h++){var e=g[h];if(e.Od.length){for(var q=0;q<e.ba.length;q++){var k=e.ba[q];k.Aa==a&&k.Xz&&d.lc.push(e)}l(e.Od,d,e.name);c(e.Od,d)}}a=a.k.uk;for(h=0;h<a.length;h++){var n=a[h].k;n.Au&&(n.O||n.pc)&&n.Yc==f&&(g=b(),g.type="VIDEO",n.kk?(g.J=0,g.aa=d.aa):(g.J=m.da(n.J,0,d.aa),
g.aa=m.da(n.J+n.aj,0,d.aa)),g.Td=a[h].name,n.tE=g,d.T.push(n),n.O&&(n.O.aT=function(){B.xu(n)}))}w.push(d)};a.start=function(){d=0};a.BI=function(){return d};a.ly=function(a){return a.X?a.X.Ea:null};a.cB=function(a,b){a.X&&(a.X.Ea=b)};a.update=function(a,b){if(!(0>d)){0==d&&(d=a);for(var c=0;c<w.length;c++){var f=w[c];f.lg&&(f.Ea-=q.Sb()*b);var g=r(f,a,!0,d);if((!f.lg||f.jl)&&g>=f.No)if(f.Hb){var g=f,e=a;g.nk&&g.nk();A(g.dt,e);g.pt=!0;g=r(g,e,!0,d)}else{var e=f,l=g;e.lg=!0;e.Ea-=l-e.No;e.nk&&e.nk()}if(!f.lg||
f.jl){for(var e=f,l=g,k=0;k<e.lc.length;k++){for(var n=e.lc[k],p=n.Od,v=0;v<p.length;v++){var t=p[v];"SOUND"==t.type&&l<e.Dl-1E-6&&(t.Df=!1)}for(v=0;v<p.length;v++)switch(t=p[v],t.type){case "CLIP":if(t.vx<=l&&l<t.ux&&!t.Df){var y=n,D=t;""!=D.Ck?F.SE(y,D.Ck,D.fc):F.apply(y,D.Td,D.fc);F.dm(y,F.vm,D.fc);var H=x(D.J,D);F.li(y,H,D.fc);for(y=0;y<p.length;y++)p[y]!=t&&p[y].fc==t.fc&&(p[y].Df=!1);t.Df=!0}t.Df&&(y=n,D=x(l,t),H=F.Gr(y,t.fc),1E-6<Math.abs(D-H)&&F.li(y,D,t.fc));break;case "SOUND":(l<e.Dl-1E-6||
e.Dl<t.J)&&t.J<=l&&l<t.aa&&!t.Df&&(C.play(n,(t.J-l)/q.Sb(),(t.aa-t.J)/q.Sb()),t.Df=!0),e.Dl<t.aa&&t.aa<=l&&t.Df&&(t.Df=!1)}}e=a;l=f;k=g;for(n=0;n<l.T.length;n++)if(p=l.T[n],p.O||p.pc){t=!1;y=m.da(h(k,p),p.Ea,p.Ea+B.BC(p)-1);v=B.AC(p,y);v==p.wt&&v--;if(l.jl||l.pt)p.O?B.Wo(p.name,y,p.Yc):B.Wo(p.name,v,p.Yc),t=!0;l.lg||(p.kk&&(p.O?y==p.Ea&&(B.Wo(p.name,p.Ea,p.Yc),t=!0):(D=B.AC(p,p.Ea),v==D&&(B.Wo(p.name,v,p.Yc),t=!0))),D=h(k,p),D=p.Ea<=D&&D<=p.Ea+B.BC(p),H=B.CC(p),D&&!H?(B.iA(p.name,p.Yc),p.pc&&(t=!0)):
H&&!D?p.O?Math.round(p.O.currentTime*p.Ie)<y?t=!0:B.Eo(p.name,p.Yc):B.Eo(p.name,p.Yc):H&&D&&(t=!0));B.DC(p)&&t&&(p.O?B.xu(p):(t=B.PA(p,e),t!=p.Ro&&(p.ki=v,B.nC(p)),p.Ro=t))}f.Dl=g}f.jl=!1;f.pt=!1}}};a.uF=r;a.Y=function(){w.length=0;d=-1};a.jw=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||g(a)||p(a)?!0:!1};a.MA=f;a.li=A;a.ky=function(a){var b=n.o();return b.X?r(b.X,a,!0,d):-1};a.zU=function(){var a=n.o();a.X&&(a.X.lg=!0);for(var a=a.X.T,b=0;b<a.length;b++){var d=a[b];B.Eo(d.name,
d.Yc)}};a.gT=function(a){var b=n.o();b.X&&(b.X.lg=!1,b.X.nk=a?a:null)};a.yR=function(){var a=n.o();return a.X?a.X.J:-1};a.wR=function(){var a=n.o();return a.X?a.X.aa:-1};a.Lh=function(){var a=n.o();return a.X?!a.X.lg:!1};a.aQ=function(){var a=n.o();return a.X?a.b4w_use_nla:!1};a.$P=function(){var a=n.o();return a.X?0<a.b4w_logic_nodes.length:!1};a.bU=function(a,b){var d=n.o();if(d.X)d.X.dt=a,d.X.No=b;else return!1};a.oT=function(){var a=n.o();if(a.X)a=a.X,a.dt=a.J,a.No=a.aa;else return!1};a.DT=function(a){var b=
n.o();if(b.X)b.X.Hb=a;else return!1};a.hQ=function(){var a=n.o();a.X&&(a.X.nk=null)}};b4w.module.__controls=function(a,t){function l(a){return{type:a,value:0,ma:null,Zd:!1,key:0,ob:"",De:!1,Fq:null,Eq:function(){},Dq:null,Gw:function(){},Gf:null,from:new Float32Array(3),to:new Float32Array(3),hz:!1,$n:!1,zA:0,yA:function(){},axis:"",wd:0,gk:new Float32Array(3),Ko:new Float32Array(4),threshold:0,sA:new Float32Array(4),$m:0,Zm:0,KA:0,an:0,od:0,repeat:!1,$v:!1,Yn:0,Xn:0,Wn:0,Sr:0,Rr:0,Qr:0}}function c(a,b){a.value=Number(b)}function b(a){for(var b=a.me,e=a.iL,d=0;d<b.length;d++)e[d]=
b[d].value;return a.LJ(e)}function y(a){a=e.indexOf(a);-1<a?e.splice(a,1):m.error("Wrong object")}function h(a,b){for(var e=0,d=0;d<b.length;d++)for(var c=b[d].yg,k=0;k<c.length;k++)for(var f=c[k].me,m=0;m<f.length;m++)f[m]===a&&e++;return e}function r(a,b){switch(a.type){case 80:w.mt(a.Fq,a.ob,a.Eq);a.Zd=!0;break;case 90:w.Bq(a.Dq);a.Zd=!0;break;case 100:w.nt(a.zA);a.Zd=!0;break;case 130:a.Zd=!0}var e=b.indexOf(a);-1<e&&b.splice(e,1)}function x(a){for(var b=0;b<K.length;b++){var e=K[b];20==e.type&&
a.keyCode==e.key&&c(e,1)}sa&&a.preventDefault();ga&&ga(a)}function v(a){for(var b=0;b<K.length;b++){var e=K[b];20==e.type&&0==a.keyCode&&16==e.key&&c(e,0);20==e.type&&a.keyCode==e.key&&c(e,0)}sa&&a.preventDefault();ga&&ga(a)}function g(a){var b=!1,e=null;T=!0;U=a.clientX;ba=a.clientY;Q=a.clientX;aa=a.clientY;for(var d=0;d<K.length;d++){var k=K[d];50==k.type&&(c(k,1),k.ma=a.which);160==k.type&&(b||(b=B.kn(a.clientX,a.clientY,ka),e=q.Rl(b[0],b[1]),b=!0),k.value=e==k.Gf?1:0)}oa&&a.preventDefault();V&&
V(a)}function p(a){for(var b=0;b<K.length;b++){var e=K[b];50==e.type&&c(e,0);160==e.type&&e.$v&&(e.value=0)}T=!1;oa&&!X&&a.preventDefault();V&&V(a)}function f(a){var b=a.clientX,e=a.clientY;Q=b;aa=e;if(!G.Zr||T)for(var d=b-U,k=e-ba,f=Math.sqrt(d*d+k*k),m=0;m<K.length;m++){var g=K[m];if(40===g.type)switch(g.axis){case "X":c(g,d);g.ma=b;break;case "Y":c(g,k);g.ma=e;break;case "XY":c(g,f),g.ma[0]=b,g.ma[1]=e}}oa&&!X&&a.preventDefault();V&&V(a)}function A(a){B.iz(a.relatedTarget)||p(a)}function F(a){var b=
a.wheelDelta||-40*a.detail,b=b*z.bK;M+=b;for(b=0;b<K.length;b++){var e=K[b];30===e.type&&c(e,M)}na&&a.preventDefault();ha&&ha(a)}function H(a){var b=a.targetTouches;if(1==b.length){for(var e=b[0],b=e.clientX,e=e.clientY,d=!1,c=null,k=0;k<K.length;k++){var f=K[k];160==f.type&&(d||(d=B.kn(b,e,ka),c=q.Rl(d[0],d[1]),d=!0),f.value=c==f.Gf)}S[0]=b;S[1]=-1;da[0]=e;da[1]=-1}else 1<b.length&&(ia=fa=n(b),S[0]=b[0].clientX,S[1]=b[1].clientX,da[0]=b[0].clientY,da[1]=b[1].clientY);ea.set(S);P.set(da);Z&&Z(a)}
function J(b){var e=b.targetTouches;if(0!==e.length){if(1===e.length){ea[0]=e[0].clientX;ea[1]=-1;P[0]=e[0].clientY;P[1]=-1;var e=ea[0]-S[0],d=P[0]-da[0],k=Math.sqrt(e*e+d*d);if(-1!=S[1]&&-1!=da[1]){var f=ea[0]-S[1],m=P[0]-da[1],g=Math.sqrt(f*f+m*m);g<k&&(e=f,d=m,k=g)}for(g=0;g<K.length;g++){var h=K[g];if(60===h.type)switch(h.ma=a.Fm,h.axis){case "X":c(h,e);break;case "Y":c(h,d);break;case "XY":c(h,k)}}}else if(1<e.length){ea[0]=e[0].clientX;ea[1]=e[1].clientX;P[0]=e[0].clientY;P[1]=e[1].clientY;
ia=n(e);k=ia-fa;f=ka;f[0]=(ea[0]+ea[1])/2;f[1]=(P[0]+P[1])/2;m=ca;m[0]=(S[0]+S[1])/2;m[1]=(da[0]+da[1])/2;var u,e=f[0],d=f[1],g=m[0],h=m[1];u=Math.sqrt((e-g)*(e-g)+(d-h)*(d-h));for(g=0;g<K.length;g++)if(h=K[g],70===h.type&&Math.abs(u)<Math.abs(k)&&(h.ma=a.Em,c(h,k)),60===h.type&&Math.abs(u)>Math.abs(k))switch(h.ma=a.Dm,h.axis){case "X":e=f[0]-m[0];c(h,e);break;case "Y":d=f[1]-m[1];c(h,d);break;case "XY":c(h,u)}}N&&b.preventDefault();Z&&Z(b)}}function D(a){for(var b=0;b<K.length;b++){var e=K[b];if(170==
e.type||180==e.type)e.Xn=a.beta,e.Yn=a.gamma,e.Wn=a.alpha,e.value||(e.Sr=a.gamma,e.Rr=a.beta,e.Qr=a.alpha,c(e,1))}}function n(a){var b=a[0],e=a[1];a=b.clientX;var b=b.clientY,d=e.clientX,e=e.clientY;return Math.sqrt((a-d)*(a-d)+(b-e)*(b-e))}var C=t("__config"),B=t("__container"),q=t("__objects"),m=t("__print"),w=t("__physics"),d=t("__quat"),I=t("__time"),u=t("__util"),E=t("__vec3"),z=C.controls,G=C.r,e=[],K=[],k={},M=0,Q=0,aa=0,U=0,ba=0,T=!1,ea=new Float32Array(2),P=new Float32Array(2),S=new Float32Array(2),
da=new Float32Array(2),ka=new Float32Array(2),ca=new Float32Array(2),ia=0,fa=0,R=!1,ra=0,sa=!1,oa=!1,na=!1,N=!1,X=!1,ga=null,V=null,ha=null,Z=null;a.na=10;a.Np=20;a.ue=30;a.te=40;a.Mp=50;a.Fm=0;a.Em=1;a.Dm=2;a.update=function(f,m){for(var g=0;g<K.length;g++){var h=K[g],q=f,l=m;if(l)switch(h.type){case 110:var n=h.Gf,z=n.f.i,n=n.f.quat,w=E.dist(h.gk,z),p=h.sA;d.invert(h.Ko,p);d.multiply(n,p,p);d.normalize(p,p);p=Math.abs(2*Math.acos(p[3]));w/=l;h.$m=u.sc(w,h.$m,l,.3);h.ma[0]=w;w=p/l;h.Zm=u.sc(w,h.Zm,
l,.3);h.ma[1]=w;h.$m>=h.threshold||h.Zm>=h.KA?c(h,1):c(h,0);E.copy(z,h.gk);d.copy(n,h.Ko);h.wd=q;break;case 120:n=h.Gf;z=n.f.i;n=Math.abs(z[1]-h.gk[1])/l;h.an=u.sc(n,h.an,l,.3);h.ma=n;h.an>=h.threshold?c(h,1):c(h,0);E.copy(z,h.gk);h.wd=q;break;case 130:!h.Zd&&0<=h.od&&q-h.wd>=h.od&&(c(h,1),h.repeat?h.wd=q:h.od=-h.od);break;case 140:h.wd||(h.wd=q);c(h,q-h.wd);h.wd=q;break;case 150:c(h,q);break;case 170:h.ma[0]=Math.PI*(h.Yn-h.Sr)/180;h.ma[1]=Math.PI*(h.Xn-h.Rr)/180;h.ma[2]=Math.PI*(h.Wn-h.Qr)/180;
h.Sr=h.Yn;h.Rr=h.Xn;h.Qr=h.Wn;break;case 180:h.ma[0]=Math.PI*h.Yn/180,h.ma[1]=Math.PI*h.Xn/180,h.ma[2]=Math.PI*h.Wn/180}}for(g=0;g<e.length;g++)for(l=e[g],h=l.yg,q=0;q<h.length;q++)if(z=h[q],z.hC!=ra){z.hC=ra;p=z;n=0;switch(p.type){case a.na:n=p.vf;(w=b(p))?(n=1,p.vf=1):1==n?(n=-1,p.vf=-1):n=0;break;case a.Np:n=p.vf;(w=b(p))&&-1==n?(n=1,p.vf=1):w||1!=n?n=0:(n=-1,p.vf=-1);break;case a.ue:n=p.vf;(w=b(p))&&-1==n?(n=1,p.vf=1):w||1!=n?n=0:(n=0,p.vf=-1);break;case a.te:w=b(p);p.vz!=w?(n=1,p.vz=w):n=0;break;
case a.Mp:for(var w=p.me,p=p.qJ,B=0;B<w.length;B++){var r=w[B].value;n||r==p[B]||(n=1);p[B]=r}break;default:u.fa("Wrong sensor manifold type: "+p.type)}if(n&&(w=l==k?null:l,R=!1,z.callback(w,z.id,n,z.zF),R)){g=-1;break}}for(g=0;g<e.length;g++)for(l=e[g],h=l.yg,q=0;q<h.length;q++)for(z=h[q],l=z.me,z=0;z<l.length;z++)switch(n=l[z],n.type){case 30:c(n,0);break;case 40:c(n,0);break;case 60:c(n,0);break;case 70:c(n,0);break;case 130:c(n,0)}M=0;U=Q;ba=aa;S.set(ea);da.set(P);fa=ia;ra++};a.Oq=function(a){var b=
l(10);c(b,a);return b};a.xb=function(a){var b=l(20);b.key=a;return b};a.Nq=function(a,b,e){if(!a||!w.L(a))return m.error("Wrong collision object"),null;var d=l(80);d.Fq=a;d.ob=b;d.De=e;d.ma={coll_obj:null,coll_pos:e?new Float32Array(3):null,coll_norm:e?new Float32Array(3):null,coll_dist:0};d.Eq=function(a,b,e,k,f){c(d,a);a=d.ma;a.coll_obj=b;d.De&&(a.coll_pos.set(e),a.coll_norm.set(k),a.coll_dist=f)};d.Zd=!0;return d};a.Rw=function(a){if(!a||!a.m)return m.error("Wrong collision impulse object"),null;
var b=l(90);b.Dq=a;b.Gw=function(a){c(b,a)};b.Zd=!0;return b};a.Yw=function(a,b,e,d,k,f,m){var g=l(100);g.Gf=a;g.from=b;g.to=e;g.ob=d;g.hz=k;g.De=f;g.$n=m;g.ma={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};g.yA=function(a,b,e,d,k,f){g.hz?c(g,-1==b?0:1):c(g,b);g.ma.hit_fract=b;g.ma.obj_hit=e;g.ma.hit_time=d;g.De&&(g.ma.hit_pos.set(k),g.ma.hit_norm.set(f))};g.Zd=!0;return g};a.un=function(){return l(50)};a.Qq=function(){return l(30)};a.Ri=function(a){var b=
l(40);b.axis=a||"XY";b.ma="XY"==b.axis?new Float32Array(2):0;return b};a.Rk=function(a){var b=l(60);b.axis=a||"XY";b.ma=0;return b};a.wn=function(){var a=l(70);a.ma=0;return a};a.Ww=function(a,b,e){if(!a)return m.error("Wrong collision object"),null;var d=l(110);d.Gf=a;var c=a.f.i;a=a.f.quat;d.sA=new Float32Array(4);d.gk=new Float32Array(c);d.Ko=new Float32Array(a);d.$m=0;d.Zm=0;d.threshold=b||.1;d.KA=e||.1;d.wd=0;d.ma=new Float32Array([0,0]);return d};a.ax=function(a,b){if(!a)return m.error("Wrong collision object"),
null;var e=l(120);e.Gf=a;var d=a.f.quat;e.gk=new Float32Array(a.f.i);e.Ko=new Float32Array(d);e.an=0;e.threshold=b||1;e.wd=0;e.ma=0;return e};a.$w=function(a,b){var e=l(130);e.od=a;e.repeat=b;e.Zd=!0;return e};a.GA=function(a,b,e,d){a=a||k;a=a.le;if(!a||!a[b])return m.error("reset_timer_sensor(): wrong object"),null;b=a[b].me[e];if(!b)return m.error("reset_timer_sensor(): sensor not found"),null;b.wd=I.gg();b.od=d};a.Pi=function(){var a=l(140);a.wd=0;return a};a.Uw=function(){var a=l(170);a.ma=new Float32Array(3);
return a};a.Tw=function(){var a=l(180);a.ma=new Float32Array(3);return a};a.Zw=function(){return l(150)};a.Sq=function(a,b){var e=l(160);e.Gf=a;e.$v=b;return e};a.hL=c;a.Ic=function(a,b,e){a=a||k;a=a.le;if(!a||!a[b])return m.error("get_sensor_value(): wrong object"),null;b=a[b].me[e];return b?b.value:(m.error("get_sensor_value(): sensor not found"),null)};a.Ke=function(a,b,e){a=a||k;a=a.le;if(!a||!a[b])return m.error("get_sensor_payload(): wrong object"),null;b=a[b].me[e];return b?b.ma:(m.error("get_sensor_payload(): sensor not found"),
null)};a.Y=function(){e=[];K=[];k={}};a.Li=function(a,b){a=a||k;if(!a.le)return!1;if(b&&a.le[b])return!0;if(!b)for(var e in a.le)return!0;return!1};a.Bf=function(a,b){a=a||k;var d=a.le;if(d){var c=a.yg;if(b){var f=d[b];if(f){for(var m=f.me,g=0;g<m.length;g++)1===h(m[g],e)&&r(m[g],K);delete d[b];f=c.indexOf(f);-1<f?c.splice(f,1):u.fa("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||y(a)}}else{for(b in d){f=d[b];m=f.me;for(g=0;g<m.length;g++)1===h(m[g],e)&&r(m[g],K);delete d[b];f=
c.indexOf(f);-1<f?c.splice(f,1):u.fa("Incorrect manifolds array")}y(a);R=!0}}};a.U=function(a,b,d,c,f,m,g){a=a||k;a.yg=a.yg||[];a.le=a.le||{};var q=a.le,l=a.yg,n=q[b];if(n){c=n.me;for(var z=0;z<c.length;z++)1===h(c[z],e)&&r(c[z],K);n=l.indexOf(n);-1<n?l.splice(n,1):u.fa("Incorrect manifolds array")}d={id:b,type:d,me:c.slice(0),LJ:f,iL:Array(c.length),callback:m,zF:g,vf:-1,vz:0,qJ:Array(c.length),hC:-1};q[b]=d;l.push(d);-1==e.indexOf(a)&&e.push(a);a=d.me;for(b=0;b<a.length;b++){q=a[b];if(q.Zd){switch(q.type){case 80:w.aq(q.Fq,
q.ob,q.Eq,q.De);break;case 90:w.bq(q.Dq,q.Gw);break;case 100:q.zA=w.Vm(q.Gf,q.from,q.to,q.ob,q.yA,!1,!1,q.De,q.$n);break;case 130:q.wd=I.gg(),0>q.od&&(q.od=-q.od)}q.Zd=!1}-1==K.indexOf(q)&&K.push(q)}R=!0};a.ix=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.WG=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.reset=function(){for(var a=0;a<e.length;a++){var b=e[a],d=b.le,b=b.yg,c;for(c in d)delete d[c];b.splice(0,b.length)}for(a=
0;a<K.length;a++)r(K[a],K),a--;e.splice(0,e.length)};a.debug=function(){m.log(String(e.length)+" objects with manifolds",e);m.log(String(K.length)+" sensors",K);for(var a=[],b=[],d=0;d<K.length;d++){var c=K[d];80==c.type&&a.push(c);100==c.type&&b.push(c)}m.log(String(a.length)+" collision sensors",a);m.log(String(b.length)+" ray sensors",b)};a.ht=function(a,b){a.addEventListener("keydown",x,!1);a.addEventListener("keyup",v,!1);sa=b};a.it=function(a,b,e){if(e)var d=window;else d=a,d.addEventListener("mouseout",
A,!1);a.addEventListener("mousedown",g,!1);d.addEventListener("mousemove",f,!1);d.addEventListener("mouseup",p,!1);oa=b;X=e};a.kt=function(a,b){a.addEventListener("mousewheel",F,!1);a.addEventListener("DOMMouseScroll",F,!1);na=b};a.jt=function(a,b){a.addEventListener("touchstart",H,!1);a.addEventListener("touchmove",J,!1);document.addEventListener("touchstart",function(){});N=b};a.gt=function(){window.DeviceOrientationEvent&&G.gyro_use&&window.addEventListener("deviceorientation",D,!1)};a.ou=function(a){a.removeEventListener("keydown",
x,!1);a.removeEventListener("keyup",v,!1)};a.pu=function(a){a.removeEventListener("mousedown",g,!1);a.removeEventListener("mousemove",f,!1);a.removeEventListener("mouseout",A,!1);a.removeEventListener("mouseup",p,!1)};a.ru=function(a){a.removeEventListener("mousewheel",F,!1);a.removeEventListener("DOMMouseScroll",F,!1)};a.qu=function(a){a.removeEventListener("touchstart",H,!1);a.removeEventListener("touchmove",J,!1);document.removeEventListener("touchstart",function(){})};a.nu=function(){window.DeviceOrientationEvent&&
G.gyro_use&&window.removeEventListener("deviceorientation",D,!1)};a.JP=function(a){ga=a};a.KP=function(a){V=a};a.MP=function(a){ha=a};a.LP=function(a){Z=a}};b4w.module.__physics=function(a,t){function l(a,b){for(var e=a.Wd,d=0;d<e.length;d++)e[d].ie.om&&b.push(e[d]),l(e[d],b)}function c(a,b,e){for(var d=a.lb.p,c=0;c<d.length;c++)for(var k=d[c].m,f=0;f<k.Gc.length;f++){var m=k.Gc[f];"ANY"!=m.ob&&e!=m.ob||B(m,a,b)}}function b(a,b,e){if(k.fo(a))switch(b){case k.bD:var d=y(a);d.lb.KC=!0;k.w(a,k.SD,Date.now()-performance.now(),ka.fe,ka.uq?ca.Ex:0);break;case k.cD:aa.ws("URANIUM:",e.slice(1));break;case k.YC:aa.error(e);break;case k.ZC:K.In.apply(this,e.slice(1));
break;case k.hD:var c=h(e.v);if(c){a=e.i;d=e.quat;b=e.Le;var f=e.xe,c=c.m;c.yn=e.time;ea.Ag(a,1,d,c.Xq);S.copy(b,c.Le);S.copy(f,c.xe)}break;case k.eD:(a=h(e.Aq))&&ea.Ag(e.i,1,e.quat,a.l.Vl[e.$s]);break;case k.$C:if(d=h(e[1]))a=e[4],d=d.Id.en[e[2]],T.Pe(d,e[3]),T.Ff(d,a),T.q(d);break;case k.iD:if(c=h(e[1]))c.l.speed=e[2];break;case k.UC:d=y(a);r(d,e.kh,e.lh,e.result,null,null,0);break;case k.WC:d=y(a);r(d,e.kh,e.lh,e.result,e.qh,e.coll_norm,e.coll_dist);break;case k.VC:if(c=h(e[1]))a=c.m,a.ph&&a.ph(e[2]);
break;case k.Xu:case k.fD:d=y(a);if(a=d.lb.xg[e.id])if(d=h(e.Ji),b==k.Xu)b=a.callback,b(a.id,e.hit_fract,d,e.hit_time);else{b=e.hit_fract;var f=e.hit_time,c=e.hit_pos,m=a.callback;c?m(a.id,b,d,f,c,e.hit_norm):m(a.id,b,d,f)}break;case k.gD:w(id);break;case k.dD:a=R.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(e[2]-e[1]).toFixed(3)+" ms, IN "+(performance.now()-e[2]).toFixed(3)+" ms, ALL "+(performance.now()-e[1]).toFixed(3)+" ms");break;case k.aD:fa=e[1];break;case k.XC:a=R.indexOf(a);console.log("Worker: #"+
String(a));console.log(e[1]);break;default:aa.error("Wrong message: "+b)}}function y(a){for(var b=0;b<R.length;b++)if(R[b]==a)return ra[b]}function h(a){return sa[a]||null}function r(a,b,e,d,c,k,f){a=a.lb.p;for(var m=0;m<a.length;m++)for(var g=a[m].m,u=0;u<g.Gc.length;u++){for(var q=g.Gc[u],l=q.sg,n=!1,z=0;z<l.length;z++){var w=l[z];if(w[0]===b&&w[1]===e){q.Ml[z]=d;n=!0;break}}n&&(l=x(q),c&&q.oq!=b&&(n=c,z=k,w=f,n[0]+=z[0]*w,n[1]+=z[1]*w,n[2]+=z[2]*w,z[0]*=-1,z[1]*=-1,z[2]*=-1),q.callback(l,l?q.oq==
b?h(e):h(b):null,c,k,f))}}function x(a){a=a.Ml;for(var b=!1,e=0;e<a.length;e++)b=b||a[e];return b}function v(){N.body++;return N.body}function g(a){if("ANY"==a)return 0;var b=na.indexOf(a);return-1==b?(na.push(a),na.length-1):b}function p(a){return{v:a,Me:0,io:!1,Fg:!0,Mc:!1,Md:!1,dJ:!1,pn:null,ob:"",Mk:0,qQ:{},Gc:[],ph:null,yn:0,Xq:new Float32Array([0,0,0,1,0,0,0,1]),Le:new Float32Array(3),xe:new Float32Array(3),hn:new Float32Array(3),gn:new Float32Array(4)}}function f(a,b){switch(a){case "BOX":var e=
b.Yb;break;case "CYLINDER":e=b.iq;break;case "CONE":e=b.hq;break;case "SPHERE":e=b.Ed;break;case "CAPSULE":e=b.gq}return e}function A(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=a.G);"number"===typeof a.Va&&(b.radius=
a.Va);"number"===typeof a.height&&(b.height=a.height);return b}function F(a,b,e,d,c){var f=a.f.i,m=b.f.ea,g=new Float32Array(16);M.invert(m,g);m=new Float32Array(3);S.transformMat4(f,g,m);switch(b.l.type){case 10:b=b.Xc;a=a.f.Yb;k.w(c,k.vD,e,m,b.mM,b.qt,(a.max_y-a.min_y)/2,d);break;case 20:k.w(c,k.uD,e,m,a.BU)}}function H(a){return a.m&&a.m.pn}function J(a,b,e,d,c,f,m,g,h,u){var q;N.Na++;q=N.Na.toString(16);var l=b.m.v;k.w(D(l),k.CD,q,a,g,l,e,d,c.m.v,f,m,h,u);b.m.pn=q}function D(a){for(var b=0;b<
ra.length;b++)for(var e=ra[b].lb.p,d=0;d<e.length;d++)if(e[d].m.v==a)return R[b];return null}function n(a){var b=a.m;if(b&&(0===b.Me||!0===b.io||!1===b.Fg||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.f.i[0]!=a.m.hn[0]||a.f.i[1]!=a.m.hn[1]||a.f.i[2]!=a.m.hn[2]||a.f.quat[0]!=a.m.gn[0]||a.f.quat[1]!=a.m.gn[1]||a.f.quat[2]!=a.m.gn[2])){var b=a.m,e=a.f;S.copy(e.i,b.hn);U.copy(e.quat,b.gn);var d=k.qy(k.Cm);d.v=b.v;d.i=e.i;"DYNAMIC"==b.type?U.identity(d.quat):d.quat=e.quat;k.w(D(b.v),k.Cm)}a=a.Wd;for(b=
0;b<a.length;b++)n(a[b])}function C(a,b,e,d,c){c=c||new Float32Array(3);a=a.f.quat;c[0]=b;c[1]=e;c[2]=d;S.transformQuat(c,a,c)}function B(a,b,e){var d=a.sg,c=a.Ml,f=a.oq,m=[],g=a.ob;if(!m)throw"At least one destination required";for(var h=0;h<b.lb.p.length;h++){var u=b.lb.p[h];if("ANY"==g||u.m.ob==g)u=u.m.v,m&&-1==m.indexOf(u)&&m.push(u)}for(b=0;b<m.length;b++)g=m[b],f<g&&!q(d,f,g)?(d.push([f,g]),c.push(!1)):f>g&&!q(d,g,f)&&(d.push([g,f]),c.push(!1));k.w(e,k.tD,f);k.w(e,k.BD,d,a.De)}function q(a,
b,e){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==e)return!0;return!1}function m(a){a.m&&a.m.ph&&(a=a.m,k.w(D(a.v),k.OD,a.v),a.ph=null)}function w(a){var b=I(a),e=d(a).lb;e.xg[a]&&(delete e.xg[a],e.et.splice(e.et.indexOf,1),k.w(b,k.XD,a))}function d(a){for(var b=0;b<ra.length;b++){var e=ra[b];if(e.lb.xg[a])return e}return null}function I(a){for(var b=0;b<ra.length;b++)if(ra[b].lb.xg[a])return R[b];return null}function u(a,b,e){if(b.ak){a=a.m.v;var d=b.Xi*b.il,c=b.Fk*b.Gk,f=-b.Zj*b.$j*2*Math.PI/
b.im;b.yl&&(f*=-1);switch(b.type){case 10:k.w(e,k.jE,a,d,c,f);break;case 20:k.w(e,k.iE,a,d,c,f)}}}function E(a){return a.Mc&&"CHASSIS"==a.Xc.Qc}function z(a){return a.Mc&&"HULL"==a.Xc.Qc}function G(a){return a.Kh&&"MAIN_BODY"==a.Zi.Qc}var e=t("__config");t("__constraints");var K=t("__debug"),k=t("__ipc"),M=t("__mat4"),Q=t("__obj_util"),aa=t("__print"),U=t("__quat");t("__renderer");var ba=t("__scenes"),T=t("__transform"),ea=t("__tsr"),P=t("__util"),S=t("__vec3"),da=t("__version"),ka=e.m,ca=e.r,ia=
e.ye,fa=0,R=[],ra=[],sa={},oa=[],na=[],N={body:0,Na:0,xA:0},X=new Float32Array(3),ga=new Float32Array(4),V=new Float32Array(4),ha=new Float32Array(16),Z=new Float32Array(8),W=new Float32Array(8);a.XI=function(a){a.lb={KC:!1,p:[],xg:{},et:[]};var e=ka.mm;ia.Ys&&(e+=da.timestamp());aa.log("%cLOAD PHYSICS","color: #0a0",ka.qm?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ka.fe);aa.log("%cPHYSICS PATH","color: #0a0",e);var d=k.NG(e,!ka.qm);k.gF(d,b);R.push(d);ra.push(a);ka.ping&&setInterval(function(){k.w(d,
k.UD,performance.now())},1E3)};a.WF=function(a){return a.lb?a.lb.KC:!0};a.Y=function(){for(var a=0;a<R.length;a++)k.terminate(R[a]);R.length=0;ra.length=0;sa={};oa.length=0;na.length=0;for(var b in N)N[b]=0};a.Gi=function(a,b){if(!a.f)throw"No object render: "+a.name;var e;a:{for(var d=0;d<ra.length;d++)if(ra[d]==b){e=R[d];break a}e=void 0}var m=[];a.ie.om&&l(a,m);var h=b.lb.p;if(E(a)||z(a)||a.Md||G(a)||a.mk){var q,n=a,w=e,B=n.La,r=n.f,x=n.ie,C=x.Go,t=v();if("CAMERA"==n.type)var y=x.yu?x.ln:"BOX",
K=f(y,r),D=r.ll,I=r.el,D=.5,I=0;else"EMPTY"==n.type?(y="EMPTY",K=null,I=D=0):(y=x.yu?x.ln:"BOX",K=f(y,r),D=r.ll,I=r.el);var ca=r.i,N=r.quat,T=x.pm,ka=x.rC,fa=x.Me,da=x.wC,ea=x.vC,ia=x.Zq,X=x.st,na=B.b4w_collision_id,ga=g(na),W=x.Nk,Fc=x.Lk,Gb=x.Ok,Va=r.Ed.Va,Xb=A(K),Uc=B.b4w_correct_bounding_offset,Hb;var wc=y;if(m.length){var Mc=[],nc={};nc.quat=new Float32Array([0,0,0,1]);nc.trans=new Float32Array(3);nc.worker_bounding=Xb;nc.bounding_type=wc;Mc.push(nc);M.invert(r.ea,ha);U.invert(r.quat,V);for(var Kc=
0;Kc<m.length;Kc++){var Z={},Pb=m[Kc],Qb=Pb.ie.ln,xc=new Float32Array(4),gc=new Float32Array(3);S.transformMat4(Pb.f.i,ha,gc);U.multiply(V,Pb.f.quat,xc);Z.trans=gc;Z.quat=xc;Z.bounding_type=Qb;Z.worker_bounding=A(f(Qb,Pb.f));Mc.push(Z)}Hb=Mc}else Hb=[];k.w(w,k.yD,t,ca,N,C,T,ka,fa,da,ea,ia,X,ga,W,Fc,Gb,y,Xb,Va,D,I,Hb,Uc);sa[t]=n;oa.push(n);var vc=p(t);vc.type=C;vc.Me=fa;vc.io=T;vc.ob=na;vc.Mk=ga;q=vc;a.m=q;var Yc={C:null,m:q};h.push(Yc);c(b,e,q.ob)}else for(var bd=Q.Qa(a,b).W,Ob=0;Ob<bd.length;Ob++){var hb=
bd[Ob],$a;if($a="PHYSICS"==hb.type){var Ha;a:{for(var cc=b.lb.p,xb=0;xb<cc.length;xb++){var ya=cc[xb].C;if(ya&&ya.id==hb.id){Ha=!0;break a}}Ha=!1}$a=!Ha}if($a)if(hb.vd.R)if(hb.vi&&b.k.Bb){var rb=hb,Y=b,cb=e,za=ba.ia(Y,"MAIN_OPAQUE");k.w(cb,k.HD,za.Tg);if(za.Bb&&rb.BN){var ua={};ua.dst_noise_scale0=rb.dst_noise_scale0;ua.dst_noise_scale1=rb.dst_noise_scale1;ua.dst_noise_freq0=rb.dst_noise_freq0;ua.dst_noise_freq1=rb.dst_noise_freq1;ua.dir_min_shore_fac=rb.dir_min_shore_fac;ua.dir_freq=rb.dir_freq;
ua.dir_noise_scale=rb.dir_noise_scale;ua.dir_noise_freq=rb.dir_noise_freq;ua.dir_min_noise_fac=rb.dir_min_noise_fac;ua.dst_min_fac=rb.dst_min_fac;ua.waves_hor_fac=rb.waves_hor_fac;var Da=za.Ug,Ea=za.yi;za.Bp?k.w(cb,k.nv,ua,za.Eg[0],za.Eg[1],za.Dg[0],za.Dg[1],za.vj,Da,Ea,za.Rj,Y.k.It):k.w(cb,k.nv,ua,0,0,0,0,0,Da,Ea,0,null)}}else{var Cc;if(hb.pm){var Ya=a,lb=hb,Kb=e,Db=v(),oc=lb.vd,Rb=oc.B[0].a_position,Yb=oc.sa||null,ab=lb.ob,yb=g(ab);k.w(Kb,k.ED,Db,Rb,Yb,Ya.f.i,yb,lb.Nk,lb.Lk,lb.Ok);var dc=p(Db);
dc.io=!0;dc.ob=ab;dc.Mk=yb;Cc=dc}else{var yc=a,Lb=hb,sb=e,tb=v(),Oa=Lb.vd,Wa=Oa.B[0].a_position,Eb=Oa.sa||null,ec=yc.f.i,pc=Lb.ll,db=Lb.el,qc=Lb.ob,Mb=g(qc);k.w(sb,k.GD,tb,Wa,Eb,ec,pc,db,Mb,Lb.Nk,Lb.Lk,Lb.Ok);var eb=p(tb);eb.ob=qc;eb.Mk=Mb;Cc=eb}q=Cc;Yc={C:hb,m:q};h.push(Yc);c(b,e,q.ob)}else aa.error("Object "+a.name+" has collision material with no assigned vertices")}if(E(a)||z(a)){var Ia=a,zb=e,fb=Ia.m.v;E(Ia)?(Ia.l.type=10,k.w(zb,k.zD,fb,Ia.l.$t,Ia.l.bu,Ia.l.au,Ia.l.Mu,Ia.l.As)):z(Ia)&&(Ia.l.type=
20,k.w(zb,k.xD,fb,Ia.l.zh,Ia.l.wi,Ia.l.xi));if(Ia.l.ei){var Ja=Ia.l.ei;switch(Ia.l.type){case 10:F(Ja[1],Ia,fb,!0,zb);F(Ja[0],Ia,fb,!0,zb);F(Ja[3],Ia,fb,!1,zb);F(Ja[2],Ia,fb,!1,zb);break;case 20:for(var Ba=0;Ba<Ja.length;Ba++)F(Ja[Ba],Ia,fb,!1,zb)}}u(a,a.l,e)}else if(a.Md){var mb=e,wa=a.f,bb=a.m,Sa=wa.Yb.max_y-wa.Yb.min_y,ib=bb.v,Ka=a.uw,ub=Ka.AN,Ta=Ka.bL,hc=Ka.eM,Ab=Ka.nJ,nb=Ka.CN,Fb=P.cH(a);k.w(mb,k.AD,ib,Fb,Sa,ub,Ta,hc,Ab,nb);bb.Md=!0}else if(G(a)){var ob=a,Bb=e,zc=ob.m.v;k.w(Bb,k.DD,zc,ob.Id.zh,
ob.Id.wi,ob.Id.xi);if(ob.Id.en)for(var Xa=ob.Id.en,Ca=0;Ca<Xa.length;Ca++){var Ua=Xa[Ca],Ac=Ua.f.i,Ib=ob.f.ea,rc=new Float32Array(16);M.invert(Ib,rc);var Pa=new Float32Array(3);S.transformMat4(Ac,rc,Pa);k.w(Bb,k.wD,zc,Pa,Ua.qF)}ob.m.dJ=!0}for(Ob=0;Ob<oa.length;Ob++)if(a=oa[Ob],a.m){var Jb=a;if(!H(Jb))for(var fc=0;fc<Jb.Ts.length;fc++){var Za=Jb.Ts[fc],Cb=Za.target,Nc=Za.sK;if(Cb.m){var ic=new Float32Array([Za.tK,Za.uK,Za.vK]),Sb,Tb=new Float32Array([Za.ze,Za.Ae,Za.Be]);Sb=P.bg(Tb,new Float32Array(4));
var jc=M.fromRotationTranslation(Sb,ic,new Float32Array(16)),Oc=M.multiply(Jb.f.ea,jc,new Float32Array(16)),Vc=M.invert(Cb.f.ea,new Float32Array(16)),Zb=M.multiply(Vc,Oc,Vc),kc=P.sj(Zb),vb=P.ng(Zb),La=Za,Qa={};Qa.use_limit_x=La.dN;Qa.use_limit_y=La.eN;Qa.use_limit_z=La.fN;Qa.use_angular_limit_x=La.ZM;Qa.use_angular_limit_y=La.$M;Qa.use_angular_limit_z=La.aN;Qa.limit_max_x=La.xJ;Qa.limit_min_x=La.AJ;Qa.limit_max_y=La.yJ;Qa.limit_min_y=La.BJ;Qa.limit_max_z=La.zJ;Qa.limit_min_z=La.CJ;Qa.limit_angle_max_x=
La.rJ;Qa.limit_angle_min_x=La.uJ;Qa.limit_angle_max_y=La.sJ;Qa.limit_angle_min_y=La.vJ;Qa.limit_angle_max_z=La.tJ;Qa.limit_angle_min_z=La.wJ;J(Nc,Jb,ic,Sb,Cb,kc,vb,Qa,null,null)}}}};a.AH=h;a.update=function(a,b){for(var e=0;e<R.length;e++){var d=R[e],c=a;d&&k.jz(d)&&k.w(d,k.kE,c,b);for(var f=0;f<oa.length;f++){var m=oa[f],g=m.m;if(g.Fg&&g.yn){var h=k.jz(d)?c-g.yn:performance.now()/1E3-g.yn,h=Math.min(h,10/ka.fe),h=h-1/ka.fe;ca.eK&&(h=0);var u=Z;ea.YI(g.Xq,h,g.Le,g.xe,Z);T.Pj(m,u);T.q(m);n(m);if(m.l)for(var g=
m,h=g.l.ei,u=g.f.Ca,q=Z,l=0;l<h.length;l++){var z=h[l];ea.multiply(u,g.l.Vl[l],q);T.Pj(z,q);T.q(z)}m.l&&m.l.ak&&(g=m.l,h=g.ak)&&(u=m.l.LB,z=ha,q=m.f.i,l=m.f.quat,P.ju(m.l.MB,l,q,z),P.sj(z,h.f.i),P.ng(z,h.f.quat),z=ga,P.ku(u,l,q,z),u=V,U.setAxisAngle(z,-g.Zj*g.$j*2*Math.PI,u),U.multiply(u,h.f.quat,h.f.quat),T.q(h));m.l&&m.l.Tt&&(g=m.l,h=g.Tt)&&(q=m.l.IB,u=ha,l=m.f.i,z=m.f.quat,P.ju(m.l.JB,z,l,u),P.sj(u,h.f.i),P.ng(u,h.f.quat),u=ga,P.ku(q,z,l,u),q=V,l=Math.abs(g.speed)*g.gm,l>g.wj&&(l=g.wj),U.setAxisAngle(u,
-l,q),U.multiply(q,h.f.quat,h.f.quat),T.q(h));m.l&&m.l.cu&&(g=m.l,h=g.cu)&&(u=m.l.VB,z=ha,q=m.f.i,l=m.f.quat,P.ju(m.l.WB,l,q,z),P.sj(z,h.f.i),P.ng(z,h.f.quat),m=ga,P.ku(u,l,q,m),u=V,U.setAxisAngle(m,-Math.abs(g.Xi)*g.Vk,u),U.multiply(u,h.f.quat,h.f.quat),T.q(h))}}k.zK(d);d=ba.ia(ra[e],"MAIN_OPAQUE");d.Bb&&0<d.Bb.waves_height&&(c=S.length(d.Lf),k.w(R[e],k.hE,d.time*c))}};a.VH=function(){return ra[0]};a.pause=function(){for(var a=0;a<R.length;a++)k.w(R[a],k.TD)};a.ke=function(){for(var a=0;a<R.length;a++)k.w(R[a],
k.YD)};a.sx=function(a){a=a.m;if(!a)throw"No object physics";if(!a.Fg){var b=a.v,e=D(b);a.Fg=!0;k.w(e,k.RD,b)}};a.hr=function(a){a=a.m;if(!a)throw"No object physics";if(a.Fg){var b=a.v,e=D(b);a.Fg=!1;k.w(e,k.QD,b)}};a.Qo=function(a){return Boolean(a.lb)};a.L=function(a){return Boolean(a.m)};a.$y=function(a){return(a=a.m)&&a.Fg&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Me&&0==a.io?!0:!1};a.Vr=function(a){return(a=a.m)&&a.Fg?!0:!1};a.fB=function(a,b){var e=a.m.v;k.w(D(e),k.gE,e,b)};a.LI=H;a.Nv=
J;a.Dw=function(a){a=a.m;k.w(D(body_a),k.WD,a.pn);a.pn=null};a.qA=function(b,e,d,c,k,f){e=ea.Fe(e,1,d,Z);k=ea.Fe(k,1,f,W);ea.invert(e,e);ea.multiply(k,e,e);T.vl(c,k);ea.multiply(k,e,e);T.Pj(b,e);T.q(b);a.$o(b,b.f.i,b.f.quat)};a.$o=function(a,b,e){var d=a.m;ea.Ag(a.f.i,1,a.f.quat,d.Xq);a=k.qy(k.Cm);a.v=d.v;a.i=b;a.quat=e;k.w(D(d.v),k.Cm)};a.H=n;a.Tv=function(a,b,e,d){C(a,b,e,d,X);a=a.m.v;b=Math.abs(0);e=Math.abs(0);d=Math.abs(0);var c=Math.abs(X[0]),f=Math.abs(X[1]),m=Math.abs(X[2]);X[0]=c?X[0]/c*
Math.max(c,b):0;X[1]=f?X[1]/f*Math.max(f,e):0;X[2]=m?X[2]/m*Math.max(m,d):0;k.w(D(a),k.pv,a,X[0],X[1],X[2])};a.Uv=function(a,b,e,d){a=a.m.v;k.w(D(a),k.pv,a,b,e,d)};a.Ov=function(a,b,e,d){C(a,b,e,d,X);a=a.m.v;k.w(D(a),k.ID,a,X[0],X[1],X[2])};a.Sv=function(a,b,e,d){C(a,b,e,d,X);a=a.m.v;k.w(D(a),k.KD,a,X[0],X[1],X[2])};a.yt=function(a,b,e){a=a.m.v;k.w(D(a),k.aE,a,b,e)};a.Uo=function(a,b){var e=a.m.v;k.w(D(e),k.bE,e,b)};a.WA=function(a,b){var e=a.m.v;k.w(D(e),k.fE,e,b)};a.VA=function(a,b){var e=a.m.v;
k.w(D(e),k.dE,e,b)};a.SA=function(a,b){var e=a.m.v;k.w(D(e),k.ZD,e,b)};a.sw=function(a){a=a.m.v;k.w(D(a),k.MD,a)};a.tw=function(a,b,e){a=a.m.v;k.w(D(a),k.ND,a,b,e)};a.Vo=function(a,b,e){a=a.m.v;k.w(D(a),k.cE,a,b,e)};a.TA=function(a,b){var e=a.m.v;k.w(D(e),k.$D,e,b)};a.UA=function(a,b){var e=a.m.v;k.w(D(e),k.eE,e,b)};a.aq=function(a,b,e,d){var c=a.m,k=c.v;b=b||"ANY";for(var f=0;f<c.Gc.length;f++)if(a=c.Gc[f],a.ob==b&&a.callback==e)return;a={oq:k,De:d||!1,ob:b,callback:e,sg:[],Ml:[]};c.Gc.push(a);b=
D(k);B(a,y(b),b)};a.mt=function(a,b,e){a=a.m;for(var d=D(a.v),c=y(d),f=0;f<a.Gc.length;f++){var m=a.Gc[f];if(m.ob==b&&m.callback==e){if(x(m)){var g=S.set(0,0,0,X);m.callback(!1,null,g,g,0)}a.Gc.splice(f,1);f--;for(var g=d,m=m.sg,h=c.lb.p,u=0;u<h.length;u++)for(var q=h[u].m,l=0;l<q.Gc.length;l++)for(var n=q.Gc[l],z=0;z<n.sg.length;z++)for(var w=n.sg[z],p=0;p<m.length;p++){var B=m[p];w[0]==B[0]&&w[1]==B[1]&&(m.splice(p,1),p--)}m.length&&k.w(g,k.ov,m)}}};a.bq=function(a,b){a.m&&a.m.ph&&m(a);var e=a.m;
k.w(D(e.v),k.JD,e.v);e.ph=b};a.Bq=m;a.Vm=function(a,b,e,d,c,f,m,h,u){var q;N.xA++;q=N.xA;d=d||"ANY";a={id:q,v:a?a.m.v:0,from:new Float32Array(b),to:new Float32Array(e),ob:d,Mk:g(d),bw:f,tF:m,De:h,$n:u,callback:c};b=D(a.v)||R[0];e=y(b).lb;q=a.id;e.xg[q]=a;e.et.push(a);k.w(b,k.FD,a.id,a.v,a.from,a.to,a.Mk,a.bw,a.tF,a.De,a.$n);return q};a.nt=w;a.rw=function(a,b,e){var c=I(a),f=d(a).lb.xg[a];f&&!f.bw&&(f.from.set(b),f.to.set(e),k.w(c,k.LD,a,b,e))};a.mz=function(a){return d(a).lb.xg[a]?!0:!1};a.rk=function(a,
b){var e=a.l;e.Xi=b;u(a,e,D(a.m.v))};a.qk=function(a,b){var e=a.l;e.Zj=b;u(a,e,D(a.m.v))};a.Du=function(a,b){var e=a.l;e.Fk=b;u(a,e,D(a.m.v))};a.Nc=E;a.Oc=z;a.cJ=function(a){if(!a.Mc)return!1;a=a.Xc.Qc;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.aJ=function(a){return a.Mc?"BOB"==a.Xc.Qc?!0:!1:!1};a.eJ=function(a){return a.Kh?"BOB"==a.Zi.Qc?!0:!1:!1};a.pz=function(a){return a.Mc&&"STEERING_WHEEL"==a.Xc.Qc?!0:!1};a.oz=function(a){return a.Mc&&
"SPEEDOMETER"==a.Xc.Qc?!0:!1};a.qz=function(a){return a.Mc&&"TACHOMETER"==a.Xc.Qc?!0:!1};a.Ly=function(a){return a.l.speed};a.EN=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.Md=function(a){return a.Md};a.AS=G;a.mI=function(){return fa};a.UG=function(){for(var a=0;a<R.length;a++)k.w(R[a],k.PD)};a.MK=function(a){var b=oa.indexOf(a);-1==b&&aa.error("Object "+a.name+" doesn't have bounding physics");
for(var e=a.m.v,d=D(e),c=y(d),f=c.lb.p,g=[],h=0;h<f.length;h++)for(var u=f[h].m,q=0;q<u.Gc.length;q++)for(var l=u.Gc[q],n=0;n<l.sg.length;n++){var z=l.sg[n],w=l.Ml[n];if(z[0]==e||z[1]==e)l.sg.splice(n,1),l.Ml.splice(n,1),n--,w&&!x(l)&&(w=S.set(0,0,0,X),l.callback(!1,null,w,w,0)),g.push(z)}g.length&&k.w(d,k.ov,g);a.m&&a.m.ph&&m(a);delete sa[e];oa.splice(b,1);a=c.lb.p;for(b=0;b<a.length;b++)a[b].m.v==e&&(a.splice(b,1),b--);k.w(d,k.VD,e)}};b4w.module.__debug=function(a,t){function l(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(a,b){typeof a!=typeof b&&x.fa("Structure assertion failed: incompatible types");if(null!==a&&null!==b&&"object"==typeof a){for(var c in a)c in b||x.fa("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||x.fa("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&x.fa("Structure assertion failed: incompatible types for key "+
c)}}var b=t("__extensions"),y=t("__print"),h=t("__textures"),r=t("__time"),x=t("__util"),v=null,g={},p=!1,f={},A=[],F=-1,H=null,J=!1;a.Mm=0;a.Up=1;a.Nm=2;a.Tp=3;a.Lm=4;a.oe=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var f=b[c];f in a&&(g[a[f]]=f)}v=a};a.QF=function(a){if(p){var b=v.getError();b!=v.NO_ERROR&&(b in g?x.fa("GL Error: "+b+", gl."+g[b]+" ("+a+")"):x.fa("Unknown GL error: "+b+" ("+
a+")"))}};a.KF=function(){if(p)switch(v.checkFramebufferStatus(v.FRAMEBUFFER)){case v.FRAMEBUFFER_COMPLETE:break;case v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:y.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:y.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:y.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case v.FRAMEBUFFER_UNSUPPORTED:y.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");
break;default:y.error("FRAMEBUFFER CHECK FAILED")}};a.ww=function(){if(-1!=F)return F;v.bindFramebuffer(v.FRAMEBUFFER,v.createFramebuffer());var a=h.vn("DEBUG",h.xk);h.resize(a,1,1);v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,a.tc,a.vb,0);v.checkFramebufferStatus(v.FRAMEBUFFER)!=v.FRAMEBUFFER_COMPLETE?(F=!0,y.warn("depth-only issue was found")):F=!1;v.bindFramebuffer(v.FRAMEBUFFER,null);return F};a.RF=function(a,b,c){if(p&&!v.getShaderParameter(a,v.COMPILE_STATUS))throw c=l(c),y.error("shader compilation failed:\n"+
c+"\n"+v.getShaderInfoLog(a)+" ("+b+")"),"Engine failed: see above for error messages";};a.SF=function(a,c,f,g,m,h){if(p&&!v.getProgramParameter(a,v.LINK_STATUS)){var d=b.$x();d&&(m=d.getTranslatedShaderSource(f),h=d.getTranslatedShaderSource(g));m=l(m);h=l(h);y.error("shader linking failed:\n"+m+"\n\n\n"+h+"\n"+v.getProgramInfoLog(a)+" ("+c+")");throw"Engine failed: see above for error messages";}};a.zt=function(a){p=a};a.PQ=function(a){f[a]=a in f?f[a]+1:1};a.update=function(){for(var a in f)y.log(a,
f[a]),f[a]=0};a.In=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(x.ee(c))for(var f=0;f<c.length;f++)a.push(c[f]);else a.push(arguments[b])}A.push(a)};a.Kz=function(){for(var a=1,b=0;b<A.length;b++){var c=A[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],x.ee(a))for(var f=0;f<a.length;f++)c.push(a[f]);else c.push(arguments[b]);A.push(c)};var D=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];
a.mA=function(a){a||(a=1);for(var b=0,c={},f=Math.max(0,performance.now()-1E3*a),m=0;m<A.length;m++){var g=A[m];a=g[0];if(!(a<f)){var d=String(g[1]);c[d]||(c[d]=D[b++%D.length]);a=["%c"+(a/1E3).toFixed(6),c[d],d];for(d=2;d<g.length;d++)a.push(g[d]);y.log.apply(this,a)}}A.splice(0)};a.Vs=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-1E3*a),f=0;f<A.length;f++){var m=A[f];a=m[0];if(!(a<c))for(var g=2;g<m.length;g++){var d=String(m[1]);3<m.length&&(d+="_"+String(g-2));b[d]||(b[d]=d+
"\n");b[d]+=String(a)+" "+m[g]+"\n"}}a="";for(d in b)a+=b[d]+"\n\n";y.log(a);A.splice(0)};a.ZP=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&
!b("chrome");default:return!1}};a.xw=function(a){if(x.ee(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.FP=function(a,b){a.constructor!=b&&x.fa("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.HP=c;a.IP=function(a){J?c(a,H):J=!0;H=a};a.zx=function(a,b,c,f,m){(a=a||null)||x.fa("Stage load callback is undefined");b=b||5E3;c=c||0;f=f||100;100<f&&x.fa("Max percentage must be less than 100");0>c&&
x.fa("Min percentage must be greater than 0");c>f&&x.fa("Max percentage must be greater than min percentage");var g=r.fh(c,f,b,function(b){b=b.toFixed();a(b);100==b&&(r.Jk(g),m&&m())})}};b4w.module.__textures=function(a,t){function l(){return{name:"",type:0,source:"",Qt:"",width:0,height:0,Iq:1,Qm:!0,mi:1024,rx:!1,ff:null,tc:0,vb:null,Sg:null,tE:null,nj:!1,Yc:-1,O:null,zj:0,Ie:0,J:0,Ea:0,aj:0,pc:null,wt:0,vt:0,ki:-1,xt:!1,Ro:-1,Ep:!1,bN:!1,kk:!1,Au:!1}}function c(c,f,g,h){var e=c.type,q=new Uint8Array([204,204,204,255]),k=l();switch(e){case "DATA_TEX2D":case "IMAGE":var n=d.createTexture(),w=d.TEXTURE_2D;d.bindTexture(w,n);d.texImage2D(w,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,q);c.image&&
"MOVIE"==c.image.source&&(k.nj=!0,k.J=c.frame_start,k.Ea=c.frame_offset,k.aj=c.frame_duration,k.bN=c.use_auto_refresh,k.kk=c.use_cyclic,k.zj=c.movie_length,k.Au=c.b4w_nla_video,0!=k.Ea&&D.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":n=d.createTexture();w=d.TEXTURE_2D;d.bindTexture(w,n);if("NONE"==c.b4w_source_type)return null;if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(g=C.Ub("name",c.b4w_source_id,
g)))k.mi=c.b4w_source_size,g.ve=g.ve||[],g.ve.push(c),d.texImage2D(w,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,q);else return null;break;case "ENVIRONMENT_MAP":n=d.createTexture();w=d.TEXTURE_CUBE_MAP;d.bindTexture(w,n);g="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var p=0;6>p;p++)d.texImage2D(d["TEXTURE_CUBE_MAP_"+g[p]],0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,q);break;case "BLEND":return null;default:return D.error('texture "'+c.name+'" has unsupported type "'+e+
'"'),null}"NONE"==e&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==e||"IMAGE"==e&&"MOVIE"==c.image.source?d.texParameteri(w,d.TEXTURE_MIN_FILTER,d.LINEAR):d.texParameteri(w,d.TEXTURE_MIN_FILTER,I[B.op]);d.texParameteri(w,d.TEXTURE_MAG_FILTER,d.LINEAR);q=w;g=c.b4w_anisotropic_filtering;"DEFAULT"===g&&(g=f);"OFF"!==g&&B.Sm&&(f=J.YH())&&(g=parseFloat(g.split("x")[0]),d.texParameterf(q,f.TEXTURE_MAX_ANISOTROPY_EXT,g));"REPEAT"!=c.extension||c.b4w_shore_dist_map?(d.texParameteri(w,
d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(w,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE)):(d.texParameteri(w,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(w,d.TEXTURE_WRAP_T,d.REPEAT));k.type=a.Bi;k.width=1;k.height=1;k.vb=n;k.tc=w;"CANVAS"==c.b4w_source_type&&"NONE"==e?(e=c.b4w_source_id,n=c.b4w_source_size,k.rx=c.b4w_enable_canvas_mipmapping,k.Qt=e,k.source="CANVAS",w=document.createElement("canvas"),w.width=n,w.height=n,k.ff=w.getContext("2d"),h in m||(m[h]={}),m[h][e]=k,b(k)):"SCENE"==c.b4w_source_type&&
"NONE"==e?(k.Qt=c.b4w_source_id,k.source="SCENE"):(k.source=e,d.generateMipmap(w),d.bindTexture(w,null));k.name=c.name;return c.k=k}function b(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.tc;d.bindTexture(b,a.vb);var c=r(a),f=x(a),e=a.ff.canvas;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(b,0,c,c,f,e);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);a.rx&&d.generateMipmap(b);d.bindTexture(b,null);a.width=e.width;a.height=e.height}function y(a){d.texParameteri(a,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);
d.texParameteri(a,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(a,d.TEXTURE_MAG_FILTER,d.LINEAR);d.texParameteri(a,d.TEXTURE_MIN_FILTER,d.LINEAR)}function h(a,b){var d=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384];return-1==d.indexOf(a)||-1==d.indexOf(b)}function r(b){switch(b.type){case a.Bi:b=d.RGBA;break;case a.Sp:b=d.RGB;break;case a.Jm:b=d.RGBA;break;case a.Km:b=d.RGB;break;case a.xk:b=d.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function x(b){switch(b.type){case a.Bi:b=
d.UNSIGNED_BYTE;break;case a.Sp:b=d.UNSIGNED_BYTE;break;case a.Jm:b=d.FLOAT;break;case a.Km:b=d.FLOAT;break;case a.xk:b=d.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function v(a,b){if(b in w&&a in w[b]){var d=w[b][a];d.O?d.O.play():d.pc&&(d.xt=!0);return!0}return!1}function g(a,b){if(b in w&&a in w[b]){var d=w[b][a];d.O?d.O.pause():d.pc&&(d.xt=!1);return!0}return!1}function p(a,b){if(b in w&&a in w[b]){var d=w[b][a];d.O?d.O.currentTime=d.Ea/d.Ie:d.pc&&(d.ki=A(d,d.Ea));return!0}return!1}
function f(a){return a.O?!a.O.paused:a.pc?a.xt:!1}function A(a,b){return Math.round(b*a.wt/a.zj)}var F=t("__config"),H=t("__dds"),J=t("__extensions"),D=t("__print"),n=t("__time"),C=t("__util"),B=F.r,q=F.A;a.Zc=0;a.t=0;a.pE=0;a.nE=0;a.oE=0;a.mE=0;a.Bi=10;a.Sp=20;a.Jm=30;a.Km=40;a.xk=50;a.Ai=60;var m={},w={},d=null,I;a.oe=function(b){I=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Zc=b.NEAREST;a.t=b.LINEAR;a.pE=b.NEAREST_MIPMAP_NEAREST;a.nE=b.LINEAR_MIPMAP_NEAREST;
a.oE=b.NEAREST_MIPMAP_LINEAR;a.mE=b.LINEAR_MIPMAP_LINEAR;d=b};a.nR=function(a,b){return b in m&&a in m[b]?m[b][a].ff:null};a.MU=function(a,d){return d in m&&a in m[d]?(b(m[d][a]),!0):!1};a.vn=function(b,c){var f=l();f.name=b;f.type=c;f.source="NONE";if(c==a.Ai)f.Sg=d.createRenderbuffer();else{var m=d.TEXTURE_2D,e=d.createTexture();d.bindTexture(m,e);d.texParameteri(m,d.TEXTURE_MAG_FILTER,d.LINEAR);d.texParameteri(m,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(m,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);
d.texParameteri(m,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.bindTexture(m,null);f.tc=m;f.vb=e}return f};a.pG=function(b){var c=d.createTexture(),f=d.TEXTURE_CUBE_MAP;d.bindTexture(f,c);d.texParameteri(f,d.TEXTURE_MAG_FILTER,d.LINEAR);d.texParameteri(f,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(f,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(f,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);for(var m="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
e=0;6>e;e++)d.texImage2D(d[m[e]],0,d.RGBA,b,b,0,d.RGBA,d.UNSIGNED_BYTE,null);d.bindTexture(f,null);f=l();f.name="CUBEMAP";f.type=a.Bi;f.source="NONE";f.width=3*b;f.height=2*b;f.Iq=1;f.vb=c;f.tc=d.TEXTURE_CUBE_MAP;return f};a.em=function(b,c,f){if(b.type!=a.Ai){var m=b.tc;d.bindTexture(m,b.vb);c&&d.texParameteri(m,d.TEXTURE_MIN_FILTER,c);f&&d.texParameteri(m,d.TEXTURE_MAG_FILTER,f);d.bindTexture(m,null)}};a.uR=function(b){if(b.type==a.Ai)return{min:a.Zc,NJ:a.Zc};var c=b.tc;d.bindTexture(c,b.vb);b=
d.getTexParameter(c,d.TEXTURE_MIN_FILTER);var f=d.getTexParameter(c,d.TEXTURE_MAG_FILTER);d.bindTexture(c,null);return{min:b,NJ:f}};a.resize=function(b,c,f){c=Math.max(c,B.cl?2:1);f=Math.max(f,B.cl?2:1);if(b.width!=c||b.height!=f){if(b.type==a.Ai)d.bindRenderbuffer(d.RENDERBUFFER,b.Sg),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,c,f),d.bindRenderbuffer(d.RENDERBUFFER,null);else{var m=b.tc;d.bindTexture(m,b.vb);var e=r(b),g=x(b);d.texImage2D(m,0,e,c,f,0,e,g,null);d.bindTexture(m,null)}c>
B.kc||f>B.kc?D.error('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+f+". Max available: "+B.kc+"x"+B.kc+"."):(b.width=c,b.height=f)}};a.KG=c;a.xu=function(a){var b=a.tc;d.bindTexture(b,a.vb);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);4!=a.O.length?d.texImage2D(b,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a.O):d.texImage2D(b,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,a.O);d.bindTexture(b,null)};a.nC=function(a){var b=a.tc;d.bindTexture(b,a.vb);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(b,0,d.RGBA,
d.RGBA,d.UNSIGNED_BYTE,a.pc[a.ki]);d.bindTexture(b,null)};a.lm=function(a,b,c,f,e){var m=a.source,k=a.tc;d.bindTexture(k,a.vb);if(4==b.length){var g=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==m)if(g)d.texImage2D(k,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){c=H.Py(b);if(c.width>B.kc||c.height>B.kc){D.error('Texture "'+f+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+B.kc+"x"+B.kc+".");return}H.YM(d,J.zy(),b,!0);h(c.width,
c.height)&&(a.cw||D.warn("using NPOT texture",f),y(k));a.width=c.width;a.height=c.height;a.Iq=H.eI(b)}else{d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);if(b.width>B.kc||b.height>B.kc){D.error('Texture "'+f+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+B.kc+"x"+B.kc+".");return}a.nj?B.cm?b&&(e in w||(w[e]={}),w[e][a.name]=a,a.pc=b,a.wt=b.length,a.Ie=a.vt*a.zj/b.length,d.texImage2D(k,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a.pc[0])):(b&&(e in w||(w[e]={}),w[e][a.name]=a),a.O=b,a.O.loop=a.kk,
a.Ie=b.duration?a.zj/b.duration:n.Sb(),q.ox||(b.playbackRate=n.Sb()/a.Ie,q.Bw&&2<b.playbackRate&&(b.playbackRate=2)),d.texImage2D(k,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a.O)):d.texImage2D(k,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,b);a.nj?B.cm?(a.width=b[0].width,a.height=b[0].height):(a.width=b.videoWidth,a.height=b.videoHeight):(a.width=b.width,a.height=b.height);h(a.width,a.height)?(a.cw||(a.nj?D.warn("using NPOT video texture",f):D.warn("using NPOT texture",f)),y(k)):a.nj||d.generateMipmap(k)}else if("ENVIRONMENT_MAP"==
m)if(c=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],g){for(g=0;6>g;g++)e=c[g],d.texImage2D(d["TEXTURE_CUBE_MAP_"+e[0]],0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);m=b.width/3;if(m>B.tj){D.warn('Cubemap texture "'+f+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*B.tj+"x"+2*B.tj+". Reduced image size will be used.");var l=B.tj/m*m}else l=m;for(g=
0;6>g;g++){e=c[g];var p=document.createElement("canvas");p.width=l;p.height=l;var r=p.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(r.translate(0,l),r.scale(1,-1)):(r.translate(l,0),r.scale(-1,1));r.drawImage(b,e[1]*m,e[2]*m,m,m,0,0,l,l);d.texImage2D(d["TEXTURE_CUBE_MAP_"+e[0]],0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,p)}a.width=3*l;a.height=2*l;h(b.width/3,b.height/2)?(D.warn("using NPOT cube map texture",f),y(k)):d.generateMipmap(k)}else"DATA_TEX2D"==m&&(d.texImage2D(k,0,d.RGBA,b.width,b.height,
0,d.RGBA,d.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);d.bindTexture(k,null)};a.$G=function(a){d.deleteTexture(a)};a.Cl=function(a){return a&&a.name&&(a.vb||a.Sg)?!0:!1};a.nz=function(a){return a&&a.name&&a.Sg?!0:!1};a.yS=function(b){return b.type==a.Jm||b.type==a.Km?!0:!1};a.CI=function(b){var d=0;switch(b.type){case a.Bi:case a.Sp:d=4;break;case a.Jm:case a.Km:d=16;break;case a.xk:d=3;break;case a.Ai:d=2}return d};a.UH=function(a){var b=null,b={name:"special_ssao_texture",type:"DATA_TEX2D",
extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};c(b,null,a,0);b.image={filepath:null};return b};a.Y=function(){if(!B.cm)for(var a in w)for(var b in w[a])w[a][b].O.pause(),w[a][b].O.src="",w[a][b].O.load();m={};w={}};a.pause=function(){for(var a in w)for(var b in w[a]){var d=w[a][b];f(d)&&(g(b,a),d.Ep=!0)}};a.reset=function(){for(var a in w)for(var b in w[a])p(b,a),w[a][b].Ep=!1};a.play=function(a){for(var b in w)for(var d in w[b]){var c=w[b][d];if(!a||c.Ep)v(d,b),c.Ep=!1}};a.iA=v;a.Eo=g;a.HA=
p;a.Wo=function(a,b,d){d in w&&a in w[d]&&(a=w[d][a],a.O?a.O.currentTime=b/a.Ie:a.pc&&(a.ki=b))};a.CC=f;a.DC=function(a){return a.O||a.pc?a.O?2<=a.O.readyState:!0:0};a.uN=function(a){return a.O||a.pc?a.O?Math.round(a.O.currentTime*a.Ie):a.ki:0};a.wN=function(a){return a.O||a.pc?a.O?a.Ea:A(a,a.Ea):0};a.vN=function(a){if(!a.O&&!a.pc)return 0;var b=Math.min(a.aj,a.zj-a.Ea);return a.O?a.Ea+b:A(a,a.Ea+b)};a.PA=function(a,b){return Math.round(n.Sb()/a.Ie*a.vt*b)};a.BC=function(a){return Math.min(a.aj,a.zj-
a.Ea)};a.AC=A};b4w.module.__dds=function(a,t){function l(a,b,c,g){var h=new Uint16Array(4),l=new Uint16Array(c*g),r=0,n=0,x=0,B=n=r=0,q=0,m=0,w=0,d=c/4;g/=4;for(var v=0;v<g;v++)for(var u=0;u<d;u++)x=b+4*(v*d+u),h[0]=a[x],h[1]=a[x+1],r=h[0]&31,n=h[0]&2016,B=h[0]&63488,q=h[1]&31,m=h[1]&2016,w=h[1]&63488,h[2]=5*r+3*q>>3|5*n+3*m>>3&2016|5*B+3*w>>3&63488,h[3]=5*q+3*r>>3|5*m+3*n>>3&2016|5*w+3*B>>3&63488,r=a[x+2],n=4*v*c+4*u,l[n]=h[r&3],l[n+1]=h[r>>2&3],l[n+2]=h[r>>4&3],l[n+3]=h[r>>6&3],n+=c,l[n]=h[r>>8&3],l[n+1]=h[r>>
10&3],l[n+2]=h[r>>12&3],l[n+3]=h[r>>14],r=a[x+3],n+=c,l[n]=h[r&3],l[n+1]=h[r>>2&3],l[n+2]=h[r>>4&3],l[n+3]=h[r>>6&3],n+=c,l[n]=h[r>>8&3],l[n+1]=h[r>>10&3],l[n+2]=h[r>>12&3],l[n+3]=h[r>>14];return l}function c(a,b,c,t){var y=new Int32Array(c,0,31),J,D,n,C,B,q;if(542327876!=y[0])return r.error("Invalid magic number in DDS header"),0;if(!y[20]&4)return r.error("Unsupported format, must contain a FourCC code"),0;J=y[21];switch(J){case x:D=8;n=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case v:D=16;n=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case g:D=16;n=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return r.error("Unsupported FourCC code:",h(J)),null}q=1;y[2]&131072&&!1!==t&&(q=Math.max(1,y[7]));C=y[4];B=y[3];y=y[1]+4;if(b)for(J=0;J<q;++J)t=Math.max(4,C)/4*Math.max(4,B)/4*D,b=new Uint8Array(c,y,t),a.compressedTexImage2D(a.TEXTURE_2D,J,n,C,B,0,b),y+=t,C=Math.max(.5*C,1),B=Math.max(.5*B,1);else if(J==x)Math.max(4,C),Math.max(4,B),b=new Uint16Array(c),c=l(b,y/2,C,B),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,C,B,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,c),t&&a.generateMipmap(a.TEXTURE_2D);else return r.error("No manual decoder for",h(J),"and no native support"),0;return q}function b(a,b,g,h,l,r){var x=new XMLHttpRequest;x.open("GET",g,!0);x.responseType="arraybuffer";x.onload=function(){if(200==x.status){a.bindTexture(a.TEXTURE_2D,h);var g=c(a,b,x.response,l);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<g?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}r&&
r(h)};x.send(null);return h}function y(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function h(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=t("__print"),x=y("DXT1"),v=y("DXT3"),g=y("DXT5");a.LQ=l;a.YM=c;a.Py=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.eI=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case x:b=6;break;case v:case g:b=4;break;default:r.error("Unsupported FourCC code:",h(a))}return b};
a.MS=b;a.LS=function(a,c,g,h){var l=a.createTexture();b(a,c,g,l,!0,h);return l}};b4w.module.__ipc=function(a,t){function l(a,b,c){for(var d=0;d<f.length;d+=2)f[d+1]==a&&(p[d+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var g=c[f];switch(g.constructor){case Float32Array:d+=g.length;break;case Number:d+=1}}--d;c.len=d}}a.bD=0;var b=a.UC=1,y=a.WC=2;a.VC=3;a.YC=4;a.ZC=5;a.$C=6;a.cD=7;var h=a.eD=8,r=a.Xu=9,x=a.fD=10;a.gD=11;var v=a.hD=12;a.iD=13;a.dD=14;a.aD=15;a.XC=16;a.SD=100;a.tD=101;a.uD=102;a.vD=103;a.wD=104;a.yD=105;a.xD=106;a.zD=107;
a.AD=108;a.BD=109;a.CD=110;a.DD=111;a.ED=112;a.GD=113;a.HD=114;a.VD=115;a.ID=116;a.JD=117;a.KD=118;a.MD=119;a.ND=120;a.OD=121;a.QD=122;a.RD=123;a.TD=124;a.FD=125;a.XD=126;a.LD=127;a.ov=128;a.WD=129;a.YD=130;a.ZD=131;a.$D=132;a.aE=133;a.bE=134;a.cE=135;a.dE=136;a.eE=137;a.fE=138;a.gE=139;a.pv=140;var g=a.Cm=141;a.hE=142;a.nv=143;a.iE=144;a.jE=145;a.UD=146;a.PD=147;a.kE=148;var p=b4w.worker_listeners,f=b4w.worker_namespaces,A={nd:v,v:0,time:0,i:new Float32Array(3),quat:new Float32Array(4),Le:new Float32Array(3),
xe:new Float32Array(3),len:0},F={nd:h,Aq:0,$s:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},H={nd:r,id:0,Ji:0,hit_fract:0,hit_time:0,len:0},J={nd:x,id:0,Ji:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},D={nd:b,kh:0,lh:0,result:0,len:0},n={nd:y,kh:0,lh:0,result:0,qh:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},C={nd:g,v:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},B=[A,F,H,J,D,n,C];a.NG=function(a,b){var c={ko:a?
!0:!1,Vg:null,Ce:[],of:""};if(b)if(c.Vg={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");l(c.of,c.ko,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");l(c.of,c.ko,null)},postMessage:function(a){var b;a:{for(b=0;b<f.length;b+=2)if(f[b+1]==c.of){b=p[b+Number(!!c.ko)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<f.length;a+=2)if(f[a+1]==c.of){p.splice(a,2);f.splice(a,2);break}}},c.ko){var d=t("__util"),g=t("__container"),
h=b4w.get_namespace(t),d=d.ik(h+"_worker");f.push(h);f.push(d);p.push(null);p.push(null);c.of=d;g.Ax(a)?(g=g.Ax(a),g.addEventListener("load",function(){b4w.require("__bindings",c.of)},!1)):(g=document.createElement("script"),g.src=a,g.defer="defer",g.async="async",g.addEventListener("load",function(){b4w.require("__bindings",c.of)},!1),document.head.appendChild(g))}else c.of=b4w.get_namespace(t);else c.Vg=a?new Worker(a):self;return c};a.gF=function(a,f){function l(d){if(d.constructor==ArrayBuffer)d=
new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var c=0;c<d.length;c++)l(d[c]);return}c=d[0]|0;switch(c){case v:var u=A;u.v=d[1]|0;u.time=d[2];u.i[0]=d[3];u.i[1]=d[4];u.i[2]=d[5];u.quat[0]=d[6];u.quat[1]=d[7];u.quat[2]=d[8];u.quat[3]=d[9];u.Le[0]=d[10];u.Le[1]=d[11];u.Le[2]=d[12];u.xe[0]=d[13];u.xe[1]=d[14];u.xe[2]=d[15];break;case h:u=F;u.Aq=d[1]|0;u.$s=d[2]|0;u.i[0]=d[3];u.i[1]=d[4];u.i[2]=d[5];u.quat[0]=d[6];u.quat[1]=d[7];u.quat[2]=d[8];u.quat[3]=d[9];break;case r:u=H;u.id=d[1]|
0;u.Ji=d[2]|0;u.hit_fract=d[3];u.hit_time=d[4];break;case x:u=J;u.id=d[1]|0;u.Ji=d[2]|0;u.hit_fract=d[3];u.hit_time=d[4];u.hit_pos[0]=d[5];u.hit_pos[1]=d[6];u.hit_pos[2]=d[7];u.hit_norm[0]=d[8];u.hit_norm[1]=d[9];u.hit_norm[2]=d[10];break;case b:u=D;u.kh=d[1]|0;u.lh=d[2]|0;u.result=!!d[3];break;case y:u=n;u.kh=d[1]|0;u.lh=d[2]|0;u.result=!!d[3];u.qh[0]=d[4];u.qh[1]=d[5];u.qh[2]=d[6];u.coll_norm[0]=d[7];u.coll_norm[1]=d[8];u.coll_norm[2]=d[9];u.coll_dist=d[10];break;case g:u=C;u.v=d[1]|0;u.i[0]=d[2];
u.i[1]=d[3];u.i[2]=d[4];u.quat[0]=d[5];u.quat[1]=d[6];u.quat[2]=d[7];u.quat[3]=d[8];break;default:u=d}f(a,c,u)}c(B);a.Vg.addEventListener("message",function(a){l(a.data)},!1)};a.Y=function(){};a.w=function(a,c){if(a)switch(c){case v:var f=A,d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.v;d[2]=f.time;d[3]=f.i[0];d[4]=f.i[1];d[5]=f.i[2];d[6]=f.quat[0];d[7]=f.quat[1];d[8]=f.quat[2];d[9]=f.quat[3];d[10]=f.Le[0];d[11]=f.Le[1];d[12]=f.Le[2];d[13]=f.xe[0];d[14]=f.xe[1];d[15]=f.xe[2];a.Ce.push(d.buffer);break;
case h:f=F;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.Aq;d[2]=f.$s;d[3]=f.i[0];d[4]=f.i[1];d[5]=f.i[2];d[6]=f.quat[0];d[7]=f.quat[1];d[8]=f.quat[2];d[9]=f.quat[3];a.Ce.push(d.buffer);break;case r:f=H;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.id;d[2]=f.Ji;d[3]=f.hit_fract;d[4]=f.hit_time;a.Ce.push(d.buffer);break;case x:f=J;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.id;d[2]=f.Ji;d[3]=f.hit_fract;d[4]=f.hit_time;d[5]=f.hit_pos[0];d[6]=f.hit_pos[1];d[7]=f.hit_pos[2];d[8]=f.hit_norm[0];d[9]=f.hit_norm[1];
d[10]=f.hit_norm[2];a.Ce.push(d.buffer);break;case b:f=D;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.kh;d[2]=f.lh;d[3]=f.result;a.Ce.push(d.buffer);break;case y:f=n;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.kh;d[2]=f.lh;d[3]=f.result;d[4]=f.qh[0];d[5]=f.qh[1];d[6]=f.qh[2];d[7]=f.coll_norm[0];d[8]=f.coll_norm[1];d[9]=f.coll_norm[2];d[10]=f.coll_dist;a.Ce.push(d.buffer);break;case g:f=C;d=new Float32Array(f.len);d[0]=f.nd;d[1]=f.v;d[2]=f.i[0];d[3]=f.i[1];d[4]=f.i[2];d[5]=f.quat[0];d[6]=f.quat[1];d[7]=
f.quat[2];d[8]=f.quat[3];a.Ce.push(d.buffer);break;default:d=[];for(f=1;f<arguments.length;f++)d.push(arguments[f]);a.Vg.postMessage(d)}};a.zK=function(a){a&&a.Ce.length&&(a.Vg.postMessage(a.Ce),a.Ce.length=0)};a.qy=function(a){switch(a){case v:return A;case h:return F;case r:return H;case x:return J;case b:return D;case y:return n;case g:return C;default:return null}};a.terminate=function(a){a.Vg.terminate();a.Vg=null};a.fo=function(a){return!!a.Vg};a.jz=function(a){return!!a.of}};b4w.module.__renderer=function(a,t){function l(a){for(var c=a.j,g=a.p,h=0;h<g.length;h++){var d=g[h];if(d.yb){var l=a,u=c,p=d.he,z=d.C,r=z.Ec;n.useProgram(r.Ul);for(var d=z.ca,e=z.Yv,x=r.cC,k=x.length;k--;){var A=x[k];A.yr(n,A.Oh,l,p,z,u)}u=z.Hw;n.colorMask(u,u,u,u);n.depthMask(z.ha);z.bb?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE);u=z.T;for(z=0;z<u.length;z++)x=u[z],n.activeTexture(n.TEXTURE0+z),n.bindTexture(x.tc,x.vb);if("SKY"==l.type){u=l;r=r.km;z=u.j.Cb.vb;x=u.Tk;for(k=0;6>k;k++)if(A=y(k),f.Cq?
(n.bindTexture(n.TEXTURE_CUBE_MAP,z),n.texImage2D(A,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,D)):(n.uniformMatrix4fv(r.u_cube_view_matrix,!1,x[k]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,A,z,0),b(d,e,p.Cu)),u.vo&&3!=k){var A=u,v=k,t=C;f.Cq?t.set(D):(n.readPixels(191,191,1,1,n.RGBA,n.UNSIGNED_BYTE,t),255!=t[0]&&255!=t[1]&&255!=t[2]||n.readPixels(191,220,1,1,n.RGBA,n.UNSIGNED_BYTE,t));var F=t[0],H=t[1],t=t[2],F=F/255,H=H/255,t=t/255;2===v?(A.dd[3]=F,A.dd[7]=H,A.dd[11]=t):2>v?(A.dd[4*v]=
F,A.dd[4*v+1]=H,A.dd[4*v+2]=t):(A.dd[4*(v-2)]=F,A.dd[4*(v-2)+1]=H,A.dd[4*(v-2)+2]=t)}l.Uk+=6}else b(d,e,p.Cu),l.Uk++}}}function c(a){if(a){var b=(a.qa?n.COLOR_BUFFER_BIT:0)|(a.wa?n.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=J;break;case "SHADOW_CAST":a=A;break;case "DEPTH":a=F;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=H;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=J;break;default:a=f.background_color}}else b=
n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT,a=f.background_color;n.colorMask(!0,!0,!0,!0);n.depthMask(!0);n.clearColor(a[0],a[1],a[2],a[3]);n.clear(b)}function b(a,b,c){n.bindBuffer(n.ARRAY_BUFFER,a.Pg);for(var f=0;f<b.length;f++){var d=b[f];n.enableVertexAttribArray(d.Oh);n.vertexAttribPointer(d.Oh,d.Xh,n.FLOAT,!1,0,d.iF+d.DH*c)}a.tf?(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.tf),n.drawElements(a.mode,a.count,a.Yr,0)):n.drawArrays(a.mode,0,a.count);for(f=0;f<b.length;f++)d=b[f],n.disableVertexAttribArray(d.Oh)}
function y(a){switch(a){case 0:return n.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return n.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return n.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return n.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return n.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return n.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function h(a){var b=a.km,c=[],f=[],d={},g;for(g in b){var h=!1;switch(g){case "u_proj_matrix":var l=function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.Fa)},h=!0;break;case "u_view_matrix":case "u_view_matrix_frag":l=
function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.Ba)};h=!0;break;case "u_shadow_cast_billboard_view_matrix":l=function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.uB)};h=!0;break;case "u_view_proj_prev":l=function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.FK)};h=!0;break;case "u_view_proj_inverse":l=function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.vk)};h=!0;break;case "u_sky_vp_inverse":l=function(a,b,e,d,c,f){a.uniformMatrix4fv(b,!1,f.Qe)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,
b,e,d,c,f){a.uniform3fv(b,f.cg)};h=!0;break;case "u_camera_eye_last":l=function(a,b,e,d,c,f){a.uniform3fv(b,f.yx)};h=!0;break;case "u_camera_quat":l=function(a,b,e,d,c,f){a.uniform4fv(b,f.quat)};h=!0;break;case "u_view_max_depth":l=function(a,b,e,d,c,f){a.uniform1f(b,f.pb)};h=!0;break;case "u_camera_range":l=function(a,b,e,d,c,f){a.uniform2f(b,f.rb,f.pb)};break;case "u_csm_center_dists":l=function(a,b,e,d,c,f){a.uniform4fv(b,f.bx)};break;case "u_cam_water_depth":l=function(a,b,e){a.uniform1f(b,e.xq)};
h=!0;break;case "u_waves_height":l=function(a,b,e){a.uniform1f(b,e.Ug)};break;case "u_waves_length":l=function(a,b,e){a.uniform1f(b,e.yi)};break;case "u_fog_color_density":l=function(a,b,e){a.uniform4fv(b,e.wc)};break;case "u_fog_params":l=function(a,b,e){a.uniform4fv(b,e.Ln)};break;case "u_underwater_fog_color_density":l=function(a,b,e){a.uniform4fv(b,e.re)};break;case "u_bloom_key":l=function(a,b,e){a.uniform1f(b,e.bloom_key)};break;case "u_bloom_edge_lum":l=function(a,b,e){a.uniform1f(b,e.bloom_edge_lum)};
break;case "u_time":l=function(a,b,e){a.uniform1f(b,e.time)};h=!0;break;case "u_wind":l=function(a,b,e){a.uniform3fv(b,e.Lf)};h=!0;break;case "u_sky_tex_dvar":l=function(a,b,e){a.uniform1f(b,e.AB)};break;case "u_sky_tex_fac":l=function(a,b,e){a.uniform4fv(b,e.BB)};break;case "u_sky_tex_color":l=function(a,b,e){a.uniform3fv(b,e.zB)};break;case "u_horizon_color":l=function(a,b,e){a.uniform3fv(b,e.ig)};break;case "u_zenith_color":l=function(a,b,e){a.uniform3fv(b,e.Wg)};break;case "u_environment_energy":l=
function(a,b,e){a.uniform1f(b,e.ag)};break;case "u_sky_color":l=function(a,b,e){a.uniform3fv(b,e.Sj)};break;case "u_rayleigh_brightness":l=function(a,b,e){a.uniform1f(b,e.rayleigh_brightness)};break;case "u_mie_brightness":l=function(a,b,e){a.uniform1f(b,e.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,e){a.uniform1f(b,e.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,e){a.uniform1f(b,e.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,e){a.uniform1f(b,
e.rayleigh_strength)};break;case "u_mie_strength":l=function(a,b,e){a.uniform1f(b,e.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,e){a.uniform1f(b,e.rayleigh_collection_power)};break;case "u_mie_collection_power":l=function(a,b,e){a.uniform1f(b,e.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,e){a.uniform1f(b,e.mie_distribution)};break;case "u_light_positions":l=function(a,b,e){a.uniform3fv(b,e.po)};break;case "u_light_directions":l=function(a,b,e){a.uniform3fv(b,
e.rs)};break;case "u_light_color_intensities":l=function(a,b,e){a.uniform3fv(b,e.qs)};break;case "u_light_factors":l=function(a,b,e){a.uniform4fv(b,e.ss)};break;case "u_sun_quaternion":l=function(a,b,e){a.uniform4fv(b,e.TB)};break;case "u_sun_intensity":l=function(a,b,e){a.uniform3fv(b,e.SB)};break;case "u_sun_direction":l=function(a,b,e){a.uniform3fv(b,e.Zt)};break;case "u_height":l=function(a,b,e,d,c,f){a.uniform1f(b,f.height)};h=!0;break;case "u_model_matrix":l=function(a,b,e,d){a.uniformMatrix4fv(b,
!1,d.ea)};h=!0;break;case "u_transb":l=function(a,b,e,d){a.uniform4fv(b,d.Wc)};h=!0;break;case "u_transa":l=function(a,b,e,d){a.uniform4fv(b,d.xd)};h=!0;break;case "u_arm_rel_trans":l=function(a,b,e,d){a.uniform4fv(b,d.dq)};h=!0;break;case "u_arm_rel_quat":l=function(a,b,e,d){a.uniform4fv(b,d.cq)};h=!0;break;case "u_quat":l=function(a,b,e,d){a.uniform4fv(b,d.quat)};h=!0;break;case "u_quatsb":l=function(a,b,e,d){a.uniform4fv(b,d.Sc)};h=!0;break;case "u_quatsa":l=function(a,b,e,d){a.uniform4fv(b,d.qd)};
h=!0;break;case "u_frame_factor":l=function(a,b,e,d){a.uniform1f(b,d.Jd)};h=!0;break;case "au_center_pos":l=function(){};h=!0;break;case "au_wind_bending_amp":l=function(a,b,e,d){a.uniform1f(b,d.Ye)};h=!0;break;case "au_wind_bending_freq":l=function(a,b,e,d){a.uniform1f(b,d.Mf)};h=!0;break;case "au_detail_bending_freq":l=function(a,b,e,d){a.uniform1f(b,d.lf)};h=!0;break;case "au_detail_bending_amp":l=function(a,b,e,d){a.uniform1f(b,d.kf)};h=!0;break;case "au_branch_bending_amp":l=function(a,b,e,d){a.uniform1f(b,
d.ef)};h=!0;break;case "u_node_values":l=function(a,b,e,d){a.uniform1fv(b,d.yf)};h=!0;break;case "u_node_rgbs":l=function(a,b,e,d){a.uniform3fv(b,d.ld)};h=!0;break;case "u_diffuse_color":l=function(a,b,e,d,c){a.uniform4fv(b,c.Yd)};h=!0;break;case "u_diffuse_intensity":l=function(a,b,e,d,c){a.uniform1f(b,c.Yk)};h=!0;break;case "u_diffuse_params":l=function(a,b,e,d,c){a.uniform2fv(b,c.fd)};h=!0;break;case "u_emit":l=function(a,b,e,d,c){a.uniform1f(b,c.Wi)};h=!0;break;case "u_ambient":l=function(a,b,
e,d,c){a.uniform1f(b,c.Di)};h=!0;break;case "u_specular_color":l=function(a,b,e,d,c){a.uniform3fv(b,c.fm)};h=!0;break;case "u_specular_alpha":l=function(a,b,e,d,c){a.uniform1f(b,c.Rt)};h=!0;break;case "u_specular_params":l=function(a,b,e,d,c){a.uniform3fv(b,c.Uj)};h=!0;break;case "u_reflect_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.Oo)};h=!0;break;case "u_mirror_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.Cs)};h=!0;break;case "u_grass_map_dim":l=function(a,b,e,d,c){a.uniform3fv(b,c.Jc)};h=!0;
break;case "u_grass_size":l=function(a,b,e,d,c){a.uniform1f(b,c.Pr)};h=!0;break;case "u_scale_threshold":l=function(a,b,e,d,c){a.uniform1f(b,c.Ry)};h=!0;break;case "u_cube_fog":l=function(a,b,e,d,c){a.uniformMatrix4fv(b,!1,c.dd)};break;case "u_jitter_amp":l=function(a,b,e,d,c){a.uniform1f(b,c.rz)};h=!0;break;case "u_jitter_freq":l=function(a,b,e,d,c){a.uniform1f(b,c.sz)};h=!0;break;case "u_wireframe_mode":l=function(a,b,e,d,c){a.uniform1i(b,c.wireframe_mode)};break;case "u_wireframe_edge_color":l=
function(a,b,e,d,c){a.uniform3fv(b,c.wireframe_edge_color)};break;case "u_subpixel_jitter":l=function(a,b,e){a.uniform2fv(b,e.lJ)};h=!0;break;case "u_subsample_indices":l=function(a,b,e){a.uniform4fv(b,e.mJ)};h=!0;break;case "u_refr_bump":l=function(a,b,e,d,c){a.uniform1f(b,c.CA)};h=!0;break;case "u_lamp_light_positions":l=function(a,b,e,d,c){a.uniform3fv(b,c.ms)};break;case "u_lamp_light_directions":l=function(a,b,e,d,c){a.uniform3fv(b,c.ks)};break;case "u_lamp_light_color_intensities":l=function(a,
b,e,d,c){a.uniform3fv(b,c.js)};break;case "u_lamp_light_factors":l=function(a,b,e,d,c){a.uniform4fv(b,c.ls)};break;case "u_halo_size":l=function(a,b,e,d,c){a.uniform1f(b,c.Xy)};h=!0;break;case "u_halo_hardness":l=function(a,b,e,d,c){a.uniform1f(b,c.Uy)};h=!0;break;case "u_halo_rings_color":l=function(a,b,e,d,c){a.uniform3fv(b,c.Wy)};h=!0;break;case "u_halo_lines_color":l=function(a,b,e,d,c){a.uniform3fv(b,c.Vy)};h=!0;break;case "u_halo_stars_blend":l=function(a,b,e,d,c){a.uniform1f(b,c.Yy)};h=!0;
break;case "u_halo_stars_height":l=function(a,b,e,d,c){a.uniform1f(b,c.Zy)};h=!0;break;case "u_fresnel_params":l=function(a,b,e,d,c){a.uniform4fv(b,c.Dh)};h=!0;break;case "u_texture_scale":l=function(a,b,e,d,c){a.uniform3fv(b,c.Kg)};h=!0;break;case "u_parallax_scale":l=function(a,b,e,d,c){a.uniform1f(b,c.Ao)};h=!0;break;case "u_color_id":l=function(a,b,e,d){a.uniform3fv(b,d.mn)};h=!0;break;case "u_line_points":l=function(a,b,e,d,c){a.uniform3fv(b,c.JS)};h=!0;break;case "u_diffuse_color_factor":l=
function(a,b,e,d,c){a.uniform1f(b,c.Xk)};h=!0;break;case "u_alpha_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.Bk)};h=!0;break;case "u_specular_color_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.kp)};h=!0;break;case "u_normal_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.Rz)};h=!0;break;case "u_normalmap0_scale":l=function(a,b,e,d,c){a.uniform2fv(b,c.Wh[0])};h=!0;break;case "u_normalmap1_scale":l=function(a,b,e,d,c){a.uniform2fv(b,c.Wh[1])};h=!0;break;case "u_normalmap2_scale":l=function(a,b,e,
d,c){a.uniform2fv(b,c.Wh[2])};h=!0;break;case "u_normalmap3_scale":l=function(a,b,e,d,c){a.uniform2fv(b,c.Wh[3])};h=!0;break;case "u_foam_factor":l=function(a,b,e,d,c){a.uniform1f(b,c.Kn)};h=!0;break;case "u_foam_uv_freq":l=function(a,b,e,d,c){a.uniform2fv(b,c.Dx)};h=!0;break;case "u_foam_mag":l=function(a,b,e,d,c){a.uniform2fv(b,c.Cx)};h=!0;break;case "u_foam_scale":l=function(a,b,e,d,c){a.uniform2fv(b,c.tr)};h=!0;break;case "u_water_norm_uv_velocity":l=function(a,b,e,d,c){a.uniform1f(b,c.Fp)};h=
!0;break;case "u_shallow_water_col":l=function(a,b,e,d,c){a.uniform3fv(b,c.bp)};h=!0;break;case "u_shore_water_col":l=function(a,b,e,d,c){a.uniform3fv(b,c.fp)};h=!0;break;case "u_water_shallow_col_fac":l=function(a,b,e,d,c){a.uniform1f(b,c.cp)};h=!0;break;case "u_water_shore_col_fac":l=function(a,b,e,d,c){a.uniform1f(b,c.gp)};h=!0;break;case "u_p_length":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.YB)};h=!0;break;case "u_p_cyclic":l=function(a,b,e,d,c){a.uniform1i(b,c.ua.Hb)};h=!0;break;case "u_p_max_lifetime":l=
function(a,b,e,d,c){a.uniform1f(b,c.ua.zz)};h=!0;break;case "u_p_fade_in":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.yh)};h=!0;break;case "u_p_fade_out":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.gd)};h=!0;break;case "u_p_size":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.size)};h=!0;break;case "u_p_alpha_start":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.Jv)};h=!0;break;case "u_p_alpha_end":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.Iv)};h=!0;break;case "u_p_nfactor":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.Hs)};
h=!0;break;case "u_p_gravity":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.Sy)};h=!0;break;case "u_p_mass":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.Me)};h=!0;break;case "u_p_size_ramp":l=function(a,b,e,d,c){a.uniform2fv(b,c.ua.wB)};h=!0;break;case "u_p_color_ramp":l=function(a,b,e,d,c){a.uniform4fv(b,c.ua.Iw)};h=!0;break;case "u_p_wind_fac":l=function(a,b,e,d,c){a.uniform1f(b,c.ua.JC)};h=!0;break;case "u_texel_size":l=function(a,b,e){a.uniform2fv(b,e.fu)};h=!0;break;case "u_p_time":l=function(a,b,e,d,
c){a.uniform1f(b,c.ua.time)};h=!0;break;case "u_position":l=function(a,b,e,d,c){a.uniform3fv(b,c.Jj)};h=!0;break;case "u_va_frame_factor":l=function(a,b,e,d){a.uniform1f(b,d.tC)};h=!0;break;case "u_perspective_cast_far_bound":l=function(a,b,e){a.uniform1f(b,e.pK)};break;case "u_normal_offset":l=function(a,b,e){a.uniform1f(b,e.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":l=function(a,b,e,d,c,f){a.uniform4fv(b,f.Fo)};break;case "u_v_light_matrix":l=function(a,b,e){a.uniformMatrix4fv(b,
!1,e.sC)};h=!0;break;case "u_b_light_matrix":l=function(a,b,e){a.uniformMatrix4fv(b,!1,e.dw)};break;case "u_p_light_matrix0":l=function(a,b,e){a.uniformMatrix4fv(b,!1,e.ci[0])};h=!0;break;case "u_p_light_matrix1":l=function(a,b,e){a.uniformMatrix4fv(b,!1,e.ci[1])};h=!0;break;case "u_p_light_matrix2":l=function(a,b,e){a.uniformMatrix4fv(b,!1,e.ci[2])};h=!0;break;case "u_p_light_matrix3":l=function(a,b,e){a.uniformMatrix4fv(b,!1,e.ci[3])};h=!0;break;case "u_motion_blur_exp":l=function(a,b,e){a.uniform1f(b,
e.Jz)};h=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,e){a.uniform1f(b,e.mb_decay_threshold)};h=!0;break;case "u_refl_plane":l=function(a,b,e,d){a.uniform4fv(b,d.Bc)};h=!0;break;case "u_radial_blur_step":l=function(a,b,e){a.uniform1f(b,e.Mo)};break;case "u_god_rays_intensity":l=function(a,b,e){a.uniform1f(b,e.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,e){a.uniform1f(b,e.Yj)};break;case "u_ssao_blur_discard_value":l=function(a,b,e){a.uniform1f(b,e.ssao_blur_discard_value)};
h=!0;break;case "u_ssao_influence":l=function(a,b,e){a.uniform1f(b,e.Xj)};break;case "u_ssao_dist_factor":l=function(a,b,e){a.uniform1f(b,e.Wj)};break;case "u_dof_dist":l=function(a,b,e,d,c,f){a.uniform1f(b,f.dof_distance)};h=!0;break;case "u_dof_front":l=function(a,b,e,d,c,f){a.uniform1f(b,f.dof_front)};h=!0;break;case "u_dof_rear":l=function(a,b,e,d,c,f){a.uniform1f(b,f.dof_rear)};h=!0;break;case "u_outline_intensity":l=function(a,b,e,d){a.uniform1f(b,d.bi)};h=!0;break;case "u_outline_color":l=
function(a,b,e){a.uniform3fv(b,e.Af)};break;case "u_draw_outline":l=function(a,b,e){a.uniform1f(b,e.jr)};h=!0;break;case "u_glow_mask_small_coeff":l=function(a,b,e){a.uniform1f(b,e.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,e){a.uniform1f(b,e.large_glow_mask_coeff)};h=!0;break;case "u_brightness":l=function(a,b,e){a.uniform1f(b,e.brightness)};break;case "u_contrast":l=function(a,b,e){a.uniform1f(b,e.contrast)};break;case "u_exposure":l=function(a,b,e){a.uniform1f(b,
e.exposure)};break;case "u_saturation":l=function(a,b,e){a.uniform1f(b,e.saturation)};break;default:l=null}l&&(l={name:g,yr:l,Oh:b[g]},h?c.push(l):(f.push(l),d[g]=l))}a.cC=c;a.Ql=f;a.Ss=d}var r=t("__camera"),x=t("__config"),v=t("__debug"),g=t("__textures"),p=t("__util"),f=x.r,A=[1,1,1,1],F=[1,1,1,1],H=[0,0,0,1],J=[0,0,0,0],D=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var n=null,C=new Uint8Array(4);
a.oe=function(a){var b=f.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);n=a};a.al=function(a){if(a.yb){var b=a.j;n.bindFramebuffer(n.FRAMEBUFFER,b.pf);if(a.eq){var g=b.Cb;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,g.tc,g.vb,0)}n.viewport(0,0,b.width,b.height);"MAIN_CUBE_REFLECT"!=a.type&&c(a);a.Ma?n.enable(n.BLEND):
n.disable(n.BLEND);a.$b?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST);if(a.ya){for(var b=a.j,g=a.p,p=0;p<g.length;p++){var d=g[p],x=d.C,u=x.Ec;n.useProgram(u.Ul);d=d.he;u.Ql.length||h(u);for(var u=u.Ql,C=u.length;C--;){var z=u[C];z.yr(n,z.Oh,a,d,x,b)}}a.ya=!1}switch(a.type){case "DEPTH":f.gz?(n.enable(n.POLYGON_OFFSET_FILL),n.polygonOffset(5,5)):n.disable(n.POLYGON_OFFSET_FILL);n.cullFace(n.BACK);break;case "SHADOW_CAST":n.enable(n.POLYGON_OFFSET_FILL);n.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);n.cullFace(n.BACK);break;case "MAIN_PLANE_REFLECT":n.disable(n.POLYGON_OFFSET_FILL);n.cullFace(n.FRONT);break;default:n.disable(n.POLYGON_OFFSET_FILL),n.cullFace(n.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(b=a.j,g=b.Cb.vb,p=0;6>p;p++){x=y(p);b.Ba=a.Tk[p];r.vq(b);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,x,g,0);c(a);x=a.p;for(d=0;d<x.length;d++)x[d].yb=x[d].ir[p];l(a)}else l(a);v.QF("draw subscene: "+a.type);n.bindFramebuffer(n.FRAMEBUFFER,null)}};a.clear=
function(a){n.bindFramebuffer(n.FRAMEBUFFER,a.j.pf);c(a)};a.bF=function(a){var b=a.Yv;b.length=0;var c=a.ca;a=a.Ec;c&&a||p.fa("Incomplete batch");c=c.vg;a=a.attributes;for(var f in a){var d=c[f];b.push({Oh:a[f],iF:4*d.offset,DH:1<d.frames?4*d.length:0,Xh:d.Xh})}};a.fF=h;a.Wv=function(a){var b=a.Ec,c=a.T;a=a.ac;n.useProgram(b.Ul);for(var f=0;f<c.length;f++)n.uniform1i(b.km[a[f]],f)};a.AA=function(a,b,c,f,d,g){f||(f=1);d||(d=1);g||(g=new Uint8Array(4*f*d));g.length!=4*f*d&&p.fa("read_pixels(): Wrong storage");
n.bindFramebuffer(n.FRAMEBUFFER,a);n.readPixels(b,c,f,d,n.RGBA,n.UNSIGNED_BYTE,g);n.bindFramebuffer(n.FRAMEBUFFER,null);return g};a.DM=function(a){var b=a.Ec;n.useProgram(b.Ul);b.Ql.length||h(b);b=b.Ss.u_cube_fog;b.yr(n,b.Oh,null,null,a,null)};a.SK=function(a,b){var c=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,c);if(a){var f=a,d=f.vb,f=f.tc==n.TEXTURE_CUBE_MAP?n.TEXTURE_CUBE_MAP_NEGATIVE_Z:f.tc;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,f,d,0)}g.nz(b)?n.framebufferRenderbuffer(n.FRAMEBUFFER,
n.DEPTH_ATTACHMENT,n.RENDERBUFFER,b.Sg):g.Cl(b)&&(f=b,d=f.vb,f=f.tc,n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,f,d,0));v.KF();n.bindFramebuffer(n.FRAMEBUFFER,null);return c};a.RK=function(a,b,c,f,d){null==a?(n.bindFramebuffer(n.FRAMEBUFFER,a),n.viewport(0,0,f,d),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)):(g.Cl(b)&&n.deleteTexture(b.vb),g.nz(c)?n.deleteRenderbuffer(c.Sg):g.Cl(c)&&n.deleteTexture(c.vb),n.deleteFramebuffer(a))};a.qS=function(){};a.Y=function(){}};"object"==typeof module&&module.pr&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function t(){var a=l,c=a.getDate(),c=10>c?"0"+String(c):String(c),h=a.getMonth()+1,h=10>h?"0"+String(h):String(h),r=String(a.getFullYear()),x=a.getHours(),x=10>x?"0"+String(x):String(x),v=a.getMinutes(),v=10>v?"0"+String(v):String(v),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+h+"."+r+" "+x+":"+v+":"+a}var l=new Date(2015,8,30,10,22,1),c=[15,9];a.version=function(){return c};a.rm=function(){for(var a="",l=0;l<c.length;l++)a=1==l?a+(10>c[l]?"0"+c[l]:
c[l]):a+c[l],l!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.fx=function(){return l};a.$q=t;a.timestamp=function(){var a=t(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.pr&&b4w.module.__version(exports);b4w.module.__loader=function(a,t){function l(b,g,h,m){var l=n,d=H.create(),p;for(p in g){var u=c(g[p]);(m&&u.gb||!b&&u.Ab)&&f(u);H.u(d,u)}for(p in g)for(u=g[p],u.name=p,b=0;b<u.D.length;b++)H.n(d,g[u.D[b]],u,null);g=c({name:"out",Ua:a.SC,nb:function(a,b,e,d,c){0===b.id&&(l.Vt=!0);F(b)||(b.status=2);b.Dz(b.id,!0);c(b,e);J.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},hb:5});var r=[];if(h)for(h=H.Dy(d),b=0;b<h.length;b++)r.push(H.Za(d,h[b]));else H.V(d,function(a,b){b.eb||r.push(b)});H.u(d,
g);for(b=0;b<r.length;b++)g.D.push(r[b].name),H.n(d,r[b],g,null);return d}function c(a){a.eb=a.eb||!1;a.Ua||0===a.Ua||(a.Ua=a.Ad);a.D=a.D||[];a.zl=a.zl||!1;a.Lt=a.Lt||!1;a.hb=a.hb||0;a.gb=a.gb||!1;a.Ab=a.Ab||!1;a.status=0;a.NS=0;a.us=0;a.nh=a.nh||null;return a}function b(a,b){for(var c=[],f=[],g=0;g<b.length;g++){var d=b[g];H.Za(a.Se,d).zl&&(H.Ng(a.Se,d,function(d){var f=!0;H.Kf(a.Se,d,function(a,b){if(!b.zl)return f=!1,1});f&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),f.push(g))}for(g=f.length-
1;0<=g;g--)b.splice(f[g],1);return c}function y(a){function c(b,d){var f=H.Za(a.Se,b),g=H.Za(a.Se,d),h=g.Ua-f.Ua;0==h&&(h=f.eb-g.eb);return h}var f=[],g=a.If,h=!1;do{var d=b(a,g);f.push.apply(f,g);0<d.length&&(h=!0);g=d}while(0<d.length);h&&f.sort(c);a.If=f;return a.If.length}function h(a,b,c){if(b.Lt)return b.zl=!0,x(a,b),!1;if(!b.nb&&!b.Vf&&!b.Hk)return x(a,b),!1;if(0==b.status&&(b.status++,b.nb))return b.nb(c,a,b,b.nh,x,v),!0;if(1==b.status){if(b.Vf)return b.Vf(c,a,b,b.nh,x,v),!0;b.status++}return 2==
b.status&&(b.status++,b.Hk)?(b.Hk(c,a,b,b.nh,x,v),!0):!1}function r(a){if(0==a.mp)return 100;var b=0;H.V(a.Se,function(c,f){a.do_not_load_resources&&f.gb||(b+=f.us*f.hb)});return D.trunc(100*b/a.mp)}function x(a,b){b.zl=!0;b.status=3;g(a,b,1)}function v(a,b,c){1>c?g(a,b,c):b.status++}function g(a,b,c){var f=n;if(b.nb||b.Vf||b.Hk)if(b.us=c,b=r(a),a.ex!=b||1==c)a.Ut(b,performance.now()-a.ZB),a.ex=b,f.xs=!0}function p(a,b){var c=null;H.V(a.Se,function(a,f){if(f.name==b)return c=f,1});return c}function f(a){a.Lt=
!0;a.us=1}function A(a){a.Ut=null;a.Hq=null;a.Se=null;a.If=null}function F(a){return a&&(3==a.status||4==a.status)}var H=t("__graph"),J=t("__print"),D=t("__util");a.Ad=0;a.Ze=1;a.SC=2;var n=null;a.By=function(){return n};a.DG=function(){var a={Ve:[],Yq:0,Pm:0,Vt:!1,xs:!1};return n=a};a.LG=function(a,b,c,f,g,d,h,u){var p=n,r={id:p.Ve.length,status:0,s:b,fw:"",Dz:c||function(){},Cz:u||!1,TU:d,ZB:0,ex:0,mp:0,ot:!1,Ut:f||function(){},Hq:g||function(){},Se:null,If:null,Wr:!1,Tr:!1,as:!1};a=l(0===r.id,
a,d,h);r.Se=a;b=[];c=H.zI(a);for(f=0;f<c.length;f++)b.push(c[f]);r.If=b;H.V(a,function(a,b){!(b.nb||b.Vf||b.Hk)||r.do_not_load_resources&&b.gb||(r.mp+=b.hb)});p.Ve.push(r);p.Pm++;return r.id};a.TM=function(b){var c=n;if(c&&0!=n.Pm)if(c.xs)c.xs=!1;else{var f=performance.now();do{var g=c.Ve[c.Yq],l=b[g.id];if(!F(g))if(0==g.status&&(g.status=1,g.ZB=performance.now(),g.Ut(0,0)),y(g)){var d=g,p=d.If.length;do{var u=H.Za(d.Se,d.If[0]),r=h(d,u,l);u.Ua==a.Ze&&(d.ot=!0);u=d.If.shift();d.If.push(u);p--}while(!r&&
0!=p)}else d=c,p=g,p.Hq(l,p),p.status=3,d.Pm--,A(p);c.Vt&&(c.Yq=(c.Yq+1)%c.Ve.length);if(g.ot){g.ot=!1;break}}while(16>performance.now()-f)}};a.Ev=function(a){var b=n;a.Hq(null,a);a.status=3;b.Pm--;A(a);a.status=4;0===a.id&&(b.Vt=!0);a.Dz(a.id,!1)};a.wU=v;a.Mt=function(a,b){var c=p(a,b);null!==c&&f(c)};a.qM=F;a.uf=function(a){var b=n;if(!b)return!1;a|=0;return b.Ve[a]&&(3==b.Ve[a].status||2==b.Ve[a].status)};a.Y=function(){n=null}};b4w.module.__graph=function(a,t){function l(a,b,d){d||(d=null);if(c(a,b))throw"Graph already has node with given ID";a.K.push(b,d)}function c(a,b){for(var d=a.K,c=0;c<d.length;c+=2)if(d[c]==b)return!0;return!1}function b(a,b,d,f){f||(f=null);if(c(a,b)&&c(a,d))a.Z.push(b,d,f);else throw"Wrong node IDs";}function y(a,b){if(!c(a,b))throw"Node not found";for(var d=a.K,f=0;f<d.length;f+=2)d[f]==b&&(d.splice(f,2),f-=2)}function h(a,b,c,f){if(!d(a,b,c))throw"Edge not found";a=a.Z;for(var g=0,h=0;h<a.length;h+=
3)if(a[h]==b&&a[h+1]==c){if(-1==f)a.splice(h,3);else{if(f==g){a.splice(h,3);break}g++}h-=3}}function r(a){a=a.K;for(var b=-1,d=0;d<a.length;d+=2)b=Math.max(b,a[d]);return++b}function x(a,b){for(var d=a.K,c=0;c<d.length;c+=2)if(d[c+1]==b)return d[c];return-1}function v(a){var b=[],d={};g(a,d);for(var c=a.K,f=0;f<c.length;f+=2)0==q(a,c[f])&&p(a,c[f],d,b);return{K:b,Z:a.Z.slice(0)}}function g(a,b){for(var d=a.K,c=0;c<d.length;c+=2)b[d[c]]=!1}function p(a,b,d,c){if(!d[b]){d[b]=!0;for(var f=0;f<B(a,b);f++)p(a,
m(a,b,f),d,c);c.unshift(b,C(a,b))}}function f(a,b,d,c){if(!d[b]){d[b]=!0;if(10==c||30==c)for(var g=0;g<B(a,b);g++){var h=m(a,b,g);f(a,h,d,c)}if(20==c||30==c)for(g=0;g<q(a,b);g++)h=w(a,b,g),f(a,h,d,c)}}function A(a){for(var b=[],d=a.K,c=0;c<d.length;c+=2){var f=d[c];B(a,f)||b.push(f)}return b}function F(a){var b=a.K;a=a.Z;for(var d=[],c=[],f=[],g=0;g<b.length;g++)f[b[2*g]]=g,d.push(g,b[2*g+1]);for(g=0;g<a.length;g+=3)c.push(f[a[g]],f[a[g+1]],a[g+2]);return{K:d,Z:c}}function H(a,b,d){if(d.Ee==d.og){for(var c=
0,f=0;c<d.og;c++)-1!=d.jf[c]&&(a[f]=c,b[f]=d.jf[c],f++);return!0}if(d.og>d.Aj||d.Ig>d.Jg||d.dk>d.fk||d.ck>d.ek)return!1;for(var f=c=-1,g=!1;!g&&J(d,G,c,f);)if(c=G[0],f=G[1],D(d,c,f)){var h;h=d;g={};g.nl=h.nl;g.ol=h.ol;g.Is=h.Is;g.En=h.En;g.og=h.og;g.Aj=h.Aj;g.qg=h.qg;g.Ee=g.xo=h.Ee;g.ck=h.ck;g.dk=h.dk;g.Ig=h.Ig;g.ek=h.ek;g.fk=h.fk;g.Jg=h.Jg;g.Ak=-1;g.jf=h.jf;g.rh=h.rh;g.Hh=h.Hh;g.Ih=h.Ih;g.$h=h.$h;g.ai=h.ai;g.dp=h.dp;h.dp[0]+=1;var g=h=g,l=c,u=f,p=g.nl,r=g.ol,x=g.og,z=g.Aj,A=g.jf,v=g.rh,t=g.Hh,C=
g.Ih,y=g.$h,E=g.ai;n(l<x);n(u<z);n(g.Ee<x);n(g.Ee<z);x=++g.Ee;g.Ak=l;t[l]||(t[l]=x,g.ck++,y[l]&&g.Ig++);y[l]||(y[l]=x,g.dk++,t[l]&&g.Ig++);C[u]||(C[u]=x,g.ek++,E[u]&&g.Jg++);E[u]||(E[u]=x,g.fk++,C[u]&&g.Jg++);A[l]=u;v[u]=l;for(A=0;A<q(p,l);A++)v=w(p,l,A),t[v]||(t[v]=x,g.ck++,y[v]&&g.Ig++);for(A=0;A<B(p,l);A++)v=m(p,l,A),y[v]||(y[v]=x,g.dk++,t[v]&&g.Ig++);for(A=0;A<q(r,u);A++)v=w(r,u,A),C[v]||(C[v]=x,g.ek++,E[v]&&g.Jg++);for(A=0;A<B(r,u);A++)v=m(r,u,A),E[v]||(E[v]=x,g.fk++,C[v]&&g.Jg++);g=H(a,b,h);
n(1>=h.Ee-h.xo);n(-1!=h.Ak);v=h.nl;l=h.ol;u=h.Ee;p=h.Ak;r=h.jf;t=h.rh;x=h.Hh;C=h.Ih;z=h.$h;y=h.ai;if(h.xo<u){x[p]==u&&(x[p]=0);for(E=0;E<q(v,p);E++)A=w(v,p,E),x[A]==u&&(x[A]=0);z[p]==u&&(z[p]=0);for(E=0;E<B(v,p);E++)A=m(v,p,E),z[A]==u&&(z[A]=0);v=r[p];C[v]==u&&(C[v]=0);for(E=0;E<q(l,v);E++)A=w(l,v,E),C[A]==u&&(C[A]=0);y[v]==u&&(y[v]=0);for(E=0;E<B(l,v);E++)A=m(l,v,E),y[A]==u&&(y[A]=0);r[p]=-1;t[v]=-1;h.Ee=h.xo;h.Ak=-1}}return g}function J(a,b,d,c){-1==d&&(d=0);-1==c?c=0:c++;var f=a.Ig,g=a.Jg,h=a.dk,
m=a.fk,l=a.ck,q=a.ek,n=a.Ee,u=a.og,p=a.Aj,w=a.jf,r=a.rh,x=a.Hh,A=a.Ih,z=a.$h,v=a.ai;if(f>n&&g>n)for(;d<u&&(-1!=w[d]||0==z[d]||0==x[d]);)d++,c=0;else if(h>n&&m>n)for(;d<u&&(-1!=w[d]||0==z[d]);)d++,c=0;else if(l>n&&q>n)for(;d<u&&(-1!=w[d]||0==x[d]);)d++,c=0;else if(0==d&&0!=a.qg){for(x=0;x<u&&-1!=w[d=a.qg[x]];)x++;x==u&&(d=u)}else for(;d<u&&-1!=w[d];)d++,c=0;if(f>n&&g>n)for(;c<p&&(-1!=r[c]||0==v[c]||0==A[c]);)c++;else if(h>n&&m>n)for(;c<p&&(-1!=r[c]||0==v[c]);)c++;else if(l>n&&q>n)for(;c<p&&(-1!=r[c]||
0==A[c]);)c++;else for(;c<p&&-1!=r[c];)c++;return d<u&&c<p?(b[0]=d,b[1]=c,!0):!1}function D(a,b,c){var f=a.nl,g=a.ol,h=a.Aj,l=a.jf,u=a.rh,p=a.Hh,r=a.Ih,x=a.$h,A=a.ai;n(b<a.og);n(c<h);n(-1==l[b]);n(-1==u[c]);if(!(0,a.Is)(C(f,b),C(g,c)))return!1;for(var z=h=0,v=0,t=0,y=0,E=0,F=0;F<B(f,b);F++){var D=m(f,b,F);if(-1!=l[D]){var G=l[D];if(!d(g,c,G)||!I(a.En,f,b,D,g,c,G))return!1}else p[D]&&v++,x[D]&&h++,p[D]||x[D]||y++}for(F=0;F<q(f,b);F++)if(D=w(f,b,F),-1!=l[D]){if(G=l[D],!d(g,G,c)||!I(a.En,f,D,b,g,G,c))return!1}else p[D]&&
v++,x[D]&&h++,p[D]||x[D]||y++;for(F=0;F<B(g,c);F++)if(G=m(g,c,F),-1!=u[G]){if(D=u[G],!d(f,b,D))return!1}else r[G]&&t++,A[G]&&z++,r[G]||A[G]||E++;for(F=0;F<q(g,c);F++)if(G=w(g,c,F),-1!=u[G]){if(D=u[G],!d(f,D,b))return!1}else r[G]&&t++,A[G]&&z++,r[G]||A[G]||E++;return v<=t&&h<=z&&y<=E}function n(a){if(!a)throw"Assertion failed";}function C(a,b){for(var d=a.K,c=0;c<d.length;c+=2)if(d[c]==b)return d[c+1];return null}function B(a,b){for(var d=a.Z,c=0,f=0;f<d.length;f+=3)d[f]==b&&c++;return c}function q(a,
b){for(var d=a.Z,c=0,f=0;f<d.length;f+=3)d[f+1]==b&&c++;return c}function m(a,b,d){a=a.Z;for(var c=0,f=0;f<a.length;f+=3)if(a[f]==b){if(c==d)return a[f+1];c++}return-1}function w(a,b,d){a=a.Z;for(var c=0,f=0;f<a.length;f+=3)if(a[f+1]==b){if(c==d)return a[f];c++}return-1}function d(a,b,d){a=a.Z;for(var c=0;c<a.length;c+=3)if(a[c]==b&&a[c+1]==d)return!0;return!1}function I(a,b,d,c,f,g,h){for(var m=u(b,d,c),l=u(f,g,h),q=0;q<m;q++){for(var n=!1,p=0;p<l;p++)if(a(E(b,d,c,q),E(f,g,h,p))){n=!0;break}if(!n)return!1}return!0}
function u(a,b,d){var c=0;a=a.Z;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==d&&c++;return c}function E(a,b,d,c){a=a.Z;for(var f=0,g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==d){if(f==c)return a[g+2];f++}return null}t("__print");var z=t("__util"),G=[-1,-1];a.fv=-1;a.cO=10;a.Lp=20;a.iP=30;a.create=function(){for(var a=arguments,b=[],d=[],c=0;c<a.length;c++){var f=a[c];switch(f.length){case 2:b.push(f[0],f[1]);break;case 3:d.push(f[0],f[1],f[2]);break;default:throw"Wrong graph constructor params";}}return{K:b,
Z:d}};a.clone=function(a,b,d){if(b)for(var c=Array(a.K.length),f=0;f<a.K.length;f+=2)c[f]=a.K[f],c[f+1]=b(a.K[f+1]);else c=z.ra(a.K);if(d)for(b=Array(a.Z.length),f=0;f<a.Z.length;f+=3)b[f]=a.Z[f],b[f+1]=a.Z[f+1],b[f+2]=d(a.Z[f+2]);else b=z.ra(a.Z);return a={K:c,Z:b}};a.wQ=function(a,b){for(var d=[],c=[],f=0;f<a.length;f++)d.push(a[f][0],a[f][1]);for(f=0;f<b.length;f++)c.push(b[f][0],b[f][1],b[f][2]);return{K:d,Z:c}};a.Fi=l;a.lS=c;a.gc=b;a.hi=y;a.gi=h;a.Po=function(a,b,c,f){if(!d(a,b,c))throw"Edge not found";
a=a.Z;for(var g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==c&&a[g+2][0]==f[0]&&a[g+2][1]==f[1]){a.splice(g,3);break}};a.u=function(a,b){if(-1==x(a,b)){var d=r(a);l(a,d,b);return d}throw"Non-unique attribute";};a.TK=function(a,b,d,c,f){a=a.Z;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==d&&a[g+2]==c&&(a[g+2]=f)};a.pl=r;a.Vh=x;a.n=function(a,d,c,f){d=x(a,d);c=x(a,c);if(-1!=d&&-1!=c)b(a,d,c,f);else throw"Attributes not found";};a.V=function(a,b){for(var d=a.K,c=0;c<d.length&&!b(d[c],d[c+1]);c+=2);};a.We=function(a,
b){for(var d=a.Z,c=0;c<d.length&&!b(d[c],d[c+1],d[c+2]);c+=3);};a.Kf=function(a,b,d){for(var c=a.Z,f=0;f<c.length;f+=3)if(c[f+1]==b){var g=c[f];if(d(g,C(a,g),c[f+2]))break}};a.Ng=function(a,b,d){for(var c=a.Z,f=0;f<c.length;f+=3)if(c[f]==b){var g=c[f+1];if(d(g,C(a,g),c[f+2]))break}};a.hu=v;a.rM=function(a){a=v(a).K;for(var b=[],d=0;d<a.length;d+=2)b.push(a[d+1]);return b};a.wS=function(){};a.Xt=function(a,b,d){if(!c(a,b))throw"No such node";var h={};g(a,h);f(a,b,h,d);b=[];for(var m in h)h[m]&&(m=
Number(m),b.push(m,C(a,m)));a={K:b,Z:a.Z.slice(0)};h=a.Z;for(m=0;m<h.length;m+=3)b=h[m+1],c(a,h[m])&&c(a,b)||(h.splice(m,3),m-=3);return a};a.zI=function(a){for(var b=[],d=a.K,c=0;c<d.length;c+=2){var f=d[c];q(a,f)||b.push(f)}return b};a.Dy=A;a.match=function(a,b,d,c){var f={};f.nl=F(a);f.ol=F(b);f.Is=d||function(a,b){return a==b};f.En=c||function(a,b){return a==b};c=a.K.length/2;var g=b.K.length/2;f.og=c;f.Aj=g;f.qg=0;f.Ee=f.xo=0;f.Ig=f.ck=f.dk=0;f.Jg=f.ek=f.fk=0;f.Ak=-1;f.jf=Array(c);f.rh=Array(g);
f.Hh=Array(c);f.Ih=Array(g);f.$h=Array(c);f.ai=Array(g);f.dp=[1];for(d=0;d<c;d++)f.jf[d]=-1,f.Hh[d]=0,f.$h[d]=0;for(d=0;d<g;d++)f.rh[d]=-1,f.Ih[d]=0,f.ai[d]=0;g=Array(c);c=Array(c);if(H(g,c,f)){for(d=0;d<g.length;d++)g[d]=a.K[2*g[d]],c[d]=b.K[2*c[d]];return[g,c]}return null};a.Za=C;a.rg=B;a.$r=q;a.dg=m;a.sl=w;a.rR=u;a.rf=E;a.replace=function(a,b,d){for(var c=a.Z,f=r(a),g=0;g<b.length;g++){var h=b[g];y(a,h);for(var m=0;m<c.length;m+=3)c[m]==h&&(c[m]=f),c[m+1]==h&&(c[m+1]=f),c[m]==c[m+1]&&(c.splice(m,
3),m-=3)}l(a,f,d)};a.KK=function(a,b,c,f,g){if(!d(a,b,c))throw"Edge not found";a=a.Z;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&(a[h]=f,a[h+1]=g)};a.nH=function(a,b){function d(a,b){if(-1!=l.indexOf(a)){var e=l.slice(l.indexOf(a));if(-1!=f[e[e.length-1]].indexOf(e[0])){q.push([a,e[e.length-1]]);return}}l.push(a);for(e=0;e<b.length;e++)b[e]in f&&d(b[e],f[b[e]])}b||(b=A(a)[0]);var c=a.Z;if(c.length){for(var f={},g=0,m=0;m<c.length;m+=3)c[m+1]in f?f[c[m+1]].push(c[m]):f[c[m+1]]=[c[m]],g++;var l=
[],q=[];d(b,f[b]);for(m=0;m<q.length;m++)for(var n=g=0;n<c.length;n+=3)q[m][1]==c[n+1]&&q[m][0]==c[n]&&h(a,c[n],c[n+1],g),g++}};a.zQ=function(a,b,d){var c=a.K;a=a.Z;var f;f="digraph debug {\n    node [shape=box];\n";for(var g=0;g<c.length;g+=2){var h=c[g],m=c[g+1],m=b?b(h,m):String(h);f+="    ";f+=String(h)+' [label="'+m.replace(/\"/g,'\\"')+'"];\n'}for(g=0;g<a.length;g+=3)b=a[g],c=a[g+1],m=a[g+2],f+="    ",f+=String(b)+" -> "+String(c),d&&(f+=' [label="'+d(b,c,m)+'"]'),f+=";\n";return f+="}"}};b4w.module.__primitives=function(a,t){function l(a,b,c,h){for(var l=[],r=[],v=[],t=[],n=2*c/(a-1),y=2*h/(b-1),B=0;B<a;B++)for(var q=-c+B*n,m=0;m<b;m++)if(r.push(q,0,-h+m*y),v.push(0,1,0),t.push(B/(a-1),m/(b-1)),B&&m){var w=B*b+m,d=w-1,I=(B-1)*b+m,u=I-1;l.push(w,d,I);l.push(d,u,I)}a=x.Xd();a.a_position=new Float32Array(r);a.a_normal=new Float32Array(v);v=x.Gb("GRID_PLANE");v.B[0]=a;v.N.a_texcoord=new Float32Array(t);v.sa=new Uint32Array(l);v.R=r.length/3;return v}function c(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],h=[],l=0;l<b;l+=4){var r=a[l+1],v=a[l+2],t=a[l+3];y(a[l],h);y(r,h);y(v,h);y(t,h);c.push(l,l+1,l+2);c.push(l,l+2,l+3)}a=x.Xd();a.a_position=new Float32Array(h);b=x.Gb("FROM_QUADS");b.B[0]=a;b.sa=new Uint32Array(c);b.R=h.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function y(a,b){b.push(a[0],a[1],a[2])}var h=t("__config"),r=t("__geometry");t("__print");var x=t("__util"),v=h.r;a.gR=function(a){for(var b=x.Gb("LINE"),c=[],h=0;h<2*a;h++)c.push(h);
h=x.Xd();h.a_point=new Float32Array(c);b.B[0]=h;b.sa=new Uint32Array(c);b.R=2*a;return b};a.hR=function(a,b){var c=l(2,2,a,b);c.name="PLANE";return c};a.fR=l;a.SH=function(a,b,c){function h(a,b){return 1==a%2&&(0==b||b==D-1)||1==b%2&&(0==a||a==y-1)?!0:!1}var l=c/=Math.pow(2,a-1),t=c,y=b+1,D=b+1;b=[];c=[];for(var n=0,C=0,B=-1,q=[],m=0;m<a;m++){for(var w=2*l/(y-1),d=2*t/(D-1),I=[],u=[],E=0,z=0;z<y;z++){for(var G=-l+z*w,e=[],K=0;K<D;K++){var k=-t+K*d;if(G>-n&&G<n&&k>-C&&k<C)e.push(-1),E++;else{for(var M=
null,Q=0;Q<q.length;Q+=3)if(G==q[Q]&&k==q[Q+1]){M=q[Q+2];break}Q=null!==M?M:B+1;h(z,K)?(e.push(-2),E++):(null==M&&(0==K||K==D-1||0==z||z==y-1?(M=m==a-1?w:2*w,I.push(G,k,Q)):M=w,c.push(G,M,k),B++),e.push(Q));if(z&&K)if(1==z)if(h(z-1,K)){if(1<K){var k=Q-1,M=u[z-1][K+1],aa=M-1;b.push(Q,k,aa)}else M=u[z-1][K+1],aa=M-1;b.push(Q,aa,M)}else h(z,K)||(k=Q-1,M=u[z-1][K],b.push(Q,k,M));else if(z==y-1){if(!h(z,K))if(K==D-1)k=Q-1,M=u[z-1][K-1],aa=u[z-2][K],b.push(Q,k,M),b.push(Q,M,aa);else{var k=Q-1,M=u[z-1][K],
aa=M-1,U=M+1;b.push(Q,k,aa);b.push(Q,aa,M);b.push(Q,M,U);2==K&&(U=u[z-2][K-2],b.push(k,U,aa))}}else 1==K?h(z,K-1)?(k=u[z-1][K],M=u[z-1][K-1],b.push(Q,M,k)):(k=e[K-1],M=u[z-1][K],aa=u[z-2][K-1],b.push(Q,k,M),b.push(k,aa,M)):K==D-1?h(z,K)||(k=e[K-1],M=u[z-1][K-1],aa=u[z-2][K],b.push(Q,k,M),b.push(Q,M,aa)):-1!=u[z-1][K]&&-1!=u[z-1][K-1]&&-1!=e[K-1]?(k=e[K-1],M=u[z-1][K],aa=u[z-1][K-1],b.push(Q,k,M),b.push(k,aa,M),K==D-2&&h(z,K+1)&&(U=u[z-1][K+1],b.push(Q,M,U))):K==D-2&&h(z,K+1)&&(M=u[z-1][K],U=u[z-1][K+
1],b.push(Q,M,U))}}u.push(e)}q=I;n=l;C=t;l*=2;t*=2}2E4>n&&(a=-(2*n)/(y-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-n,a,-C),c.push(-n,a,C),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(n,a,-C),c.push(n,a,C),Q=B+1,b.push(Q+3,Q+2,Q+1,Q+2,Q+0,Q+1,Q+6,Q+4,Q+2,Q+4,Q+0,Q+2,Q+5,Q+7,Q+1,Q+7,Q+3,Q+1,Q+5,Q+4,Q+7,Q+7,Q+4,Q+6));a=x.Xd();a.a_position=new Float32Array(c);l=x.Gb("multigrid_plane");l.B[0]=a;l.sa=new Uint32Array(b);l.R=c.length/3;v.IC&&(r.np(l,1,!0),a.a_polyindex=r.rr(l));return l};a.eR=function(a){var b=
a.length;if(b%3)throw"Wrong array";for(var c=[],h=[],l=0;l<b;l+=3){var r=a[l+1],v=a[l+2];y(a[l],h);y(r,h);y(v,h);c.push(l,l+1,l+2)}a=x.Xd();a.a_position=new Float32Array(h);b=x.Gb("FROM_TRIANGLES");b.B[0]=a;b.sa=new Uint32Array(c);b.R=h.length/3;return b};a.dR=c;a.OH=function(a){a=x.sN(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};
a.Ib=function(){var a=x.Gb("FULLSCREEN_TRI"),b=x.Xd();b.a_position=new Float32Array([0,0,1,0,0,1]);a.B[0]=b;a.sa=new Uint32Array([0,1,2]);a.R=3;return a};a.PH=function(){var a=x.Gb("FULLSCREEN_QUAD"),b=x.Xd();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.B[0]=b;a.sa=new Uint32Array([0,2,1,1,2,3]);a.R=4;return a};a.KH=function(){var a=x.Gb("BILLBOARD"),b=x.Xd();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.B[0]=b;a.sa=new Uint32Array([0,2,1,0,3,2]);a.R=4;return a};a.LH=function(){var a=
x.Gb("CUBEMAP_BOARD"),b=x.Xd();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.B[0]=b;a.sa=new Uint32Array([0,2,1,0,3,2]);a.R=4;return a};a.zr=function(a,c){var f=x.Gb("UV_SPHERE"),h,l,v=[],t=[],D=[];for(l=0;8>=l;l++)for(h=0;16>=h;h++){var n=h/16,C=l/8;t.push(-a*Math.cos(2*n*Math.PI)*Math.sin(C*Math.PI)+c[0],a*Math.cos(C*Math.PI)+c[1],a*Math.sin(2*n*Math.PI)*Math.sin(C*Math.PI)+c[2])}for(l=n=0;8>l;l++)for(h=0;16>h;h++){var C=b(t,17*l+h+1),B=b(t,17*l+h),q=b(t,17*(l+1)+h),m=b(t,17*(l+1)+h+1);
Math.abs(C[1])==a+c[1]?(y(C,v),y(q,v),y(m,v),D.push(n,n+1,n+2),n+=3):Math.abs(q[1])==a+c[1]?(y(C,v),y(B,v),y(q,v),D.push(n,n+1,n+2),n+=3):(y(C,v),y(B,v),y(q,v),y(m,v),D.push(n,n+1,n+2),D.push(n,n+2,n+3),n+=4)}h={};h.a_position=v;t=r.xF(D,t,v);h.a_normal=r.vF(D,v,t);h.a_tangent=[];f.N.a_influence=[];f.N.a_color=[];f.N.a_texcoord=[];f.B[0]=h;f.sa=D;f.R=v.length/3;return f};a.Mx=function(a){var b=x.Gb("INDEX"),c=x.Xd();c.a_index=new Float32Array(a);for(var h=0;h<a;h++)c.a_index[h]=h;b.B[0]=c;b.sa=new Uint16Array(0);
b.R=a;return b}};b4w.module.__nodemat=function(a,t){function l(a,b,e,g,k){var m=W.o(),m=h(b,k,m.oN);if(m in la)return la[m];if("DEPTH"!=k&&"COLOR_ID"!=k){var q=N.create(),n=a.nodes,z=a.links;b=a.animation_data;for(var t=0;t<n.length;t++)if(null==u(q,n[t],0,b,g,k))return la[m]=null;if(e&&-1==d(a,q,"GROUP_OUTPUT","group"))return null;t=ca(q);if(!ia(q,z,t))return null;if(e)return q;for(t=0;t<z.length;t++){e=z[t];for(var n=A(e.from_node,q),B=A(e.to_node,q),y=0;y<n.length;y++)for(var C=0;C<B.length;C++){var E=n[y],D=B[C],
G=N.Za(q,E),I=N.Za(q,D);if(!da(q,E,D,G,I,e))return la[m]=null}}f(q);a="GLOW"==k?d(a,q,"B4W_GLOW_OUTPUT","material",!0):d(a,q,"OUTPUT","material",!1,!0);-1==a&&(q=x(),a=0);F(q);a=N.Xt(q,a,N.Lp);c(a,b,g);v(a);J(a);w(a);p(a,b,g,k)}else g=l(a,b,e,g,"MAIN"),g=N.clone(g,function(a){var b=ja.Kk(a);b.D=ja.ra(a.D);b.ta=ja.ra(a.ta);return b}),a=d(a,g,"OUTPUT","material",!1,!0),r(g,a),a=N.Xt(g,a,N.Lp),v(a);return la[m]=a}function c(a,d,c){var e=[];N.V(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||
e.push({hK:a,node:b})});for(var f=0;f<e.length;++f){var g=e[f].hK,h=e[f].node,k=N.pl(a);N.Fi(a,k,h.data.TJ);var m=N.pl(a);N.Fi(a,m,h.data.UJ);N.gc(a,k,m,[4,2]);for(var l={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},q=N.$r(a,g),n=[],u=[],p=[],w={},r=0;r<q;r++){var x=N.sl(a,g,r);x in w||(w[x]=0);var v=N.rf(a,x,g,w[x]++);n.push([x,g,v]);var z=l[v[1]];if(z)switch(z[0]){case "MATERIAL_END":u.push([x,m,[v[0],z[1]]]);break;case "LIGHTING_APPLY":p.push([x,
[v[0],z[1]]])}else u.push([x,k,v])}b(a,h.data.value,k,m,p,d,c);for(r=0;r<n.length;r++)N.Po(a,n[r][0],n[r][1],n[r][2]);for(r=0;r<u.length;r++)N.gc(a,u[r][0],u[r][1],u[r][2]);h=N.rg(a,g);k=[];l=[];q={};for(r=0;r<h;r++)n=N.dg(a,g,r),n in q||(q[n]=0),v=N.rf(a,g,n,q[n]++),k.push([g,n,v]),l.push([m,n,v]);for(r=0;r<k.length;r++)N.Po(a,k[r][0],k[r][1],k[r][2]);for(r=0;r<l.length;r++)N.gc(a,l[r][0],l[r][1],l[r][2]);N.hi(a,g)}}function b(a,b,d,c,e,f,g){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},
k=u(a,h,0,f,g,null),m=k;y(a,d,k,"E");y(a,d,k,"A");y(a,d,k,"D");k=W.o();k=V.Ja(k,"LAMP",V.uc);if(!b.yd)for(var l,q,n=0;n<k.length;n++){var p=k[n].jc,h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=u(a,h,0,f,g,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};q=u(a,h,0,f,g,null);y(a,m,q,"color");y(a,m,q,"specular");y(a,l,q,"ldir");y(a,d,q,"normal");y(a,d,q,"D");y(a,d,q,"S");y(a,l,q,"lcolorint");y(a,d,l,"shadow_factor");m="COOKTORR"==b.Vj?"SPECULAR_PHONG":"SPECULAR_"+b.Vj;h={name:m,type:m};h=u(a,
h,0,f,g,null);y(a,l,h,"ldir");y(a,l,h,"lfac");y(a,d,h,"normal");y(a,h,q,"sfactor");"SPECULAR_PHONG"!=m&&"SPECULAR_BLINN"!=m||y(a,l,h,"norm_fac");y(a,d,h,"sp_params");m="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Zk;h={name:m,type:m};h=u(a,h,0,f,g,null);y(a,l,h,"ldir");y(a,l,h,"lfac");y(a,d,h,"normal");y(a,l,h,"norm_fac");y(a,h,q,"lfactor");"DIFFUSE_LAMBERT"!=m&&y(a,d,h,"dif_params");for(l=0;l<e.length;l++)N.gc(a,e[l][0],q,e[l][1]);m=q}y(a,m,c,"color");y(a,m,c,"specular")}function y(a,b,d,c){for(var e=
N.Za(a,b),f=N.Za(a,d),g,h=0;h<f.D.length;h++)if(c==f.D[h].identifier){g=h;break}for(var k,h=0;h<e.ta.length;h++)if(c==e.ta[h].identifier){k=h;break}void 0!=g&&void 0!=k&&N.gc(a,b,d,[k,g])}function h(a,b,d){switch(b){case "GLOW":return a+d+"11";case "COLOR_ID":case "DEPTH":return a+d+"00";default:return a+d+"10"}}function r(a,b){N.We(a,function(d,c,e){var f=N.Za(a,c);c==b&&"Color"==f.D[e[1]].identifier&&N.Po(a,d,c,e)})}function x(){var a=N.create(),b={data:null,Hd:[],Ta:[],D:[{Pa:new Float32Array([0,
0,0]),identifier:"Color",Jb:!1,name:"Color"},{Pa:1,identifier:"Alpha",Jb:!1,name:"Alpha"}],ta:[],type:"OUTPUT",Rg:[]};N.Fi(a,0,b);return a}function v(a){N.V(a,function(b,d){for(var c=d.D,e=d.ta,f=0;f<c.length;f++)g(a,c[f],b,f,1);for(f=0;f<e.length;f++)g(a,e[f],b,f,0)})}function g(a,b,d,c,e){if(b.Jb){var f=!0;N.We(a,function(a,b,g){if(!e&&a==d&&g[0]==c||e&&b==d&&g[1]==c)f=!1});f&&(b.Jb=!1)}}function p(a,b,d,c){var e=[];N.We(a,function(f,g,h){var k=N.Za(a,f),m=N.Za(a,g),k=ja.ee(k.ta[h[0]].Pa),m=ja.ee(m.D[h[1]].Pa);
if(k!=m){var l,q={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};k&&!m?l=I("vector_to_scalar","B4W_VECTOSCAL",[q],[n]):!k&&m&&(l=I("scalar_to_vector","B4W_SCALTOVEC",[n],[q]));u(a,l,0,b,d,c);e.push([f,g,a.K[a.K.length-2],h])}});for(var f=0;f<e.length;++f)N.Po(a,e[f][0],e[f][1],e[f][3]),N.gc(a,e[f][0],e[f][2],[e[f][3][0],0]),N.gc(a,e[f][2],e[f][1],[0,e[f][3][1]])}function f(a){var b=[];N.V(a,function(d,c){switch(c.type){case "B4W_TRANSLUCENCY":N.We(a,
function(a,e,f){a==d&&"Translucency"==c.ta[f[0]].name&&b.push(a,e,[f[0]+1,f[1]+1])})}});for(var d=0;d<b.length;d+=3)N.gc(a,b[d],b[d+1],b[d+2])}function A(a,b){var d=[];N.V(b,function(b,c){c.name==a.name&&d.push(b)});if(d.length)return d;throw"Node not found";}function F(a){var b=[];N.V(a,function(a,d){"B4W_PARALLAX"!=d.type&&"REROUTE"!=d.type||b.push(a,d)});for(var d=0;d<b.length;d+=2){var c=b[d],e=b[d+1];if("B4W_PARALLAX"==e.type){var f=H(a,c);if(-1!=f){var g=N.sl(a,f,0);N.gi(a,f,c,-1);-1!=g&&N.gi(a,
g,f,-1);c=N.Za(a,f);e.data=c.data;e.Ta[0]=c.Ta[0];N.hi(a,f)}e.D.splice(1,1)}else if("REROUTE"==e.type){for(var e=N.sl(a,c,0),h=N.rg(a,c),f=[],g=[],k=[],m=0;m<h;m++){var l=N.dg(a,c,m),q=g.indexOf(l);-1!=q?k[q]+=1:(g.push(l),k.push(1),f.push(c,l))}if(-1!=e)for(h=N.rf(a,e,c,0)[0],m=0;m<g.length;m++)for(l=0;l<k[m];l++)q=N.rf(a,c,g[m],l)[1],N.gc(a,e,g[m],[h,q]);for(m=0;m<f.length;m+=2)N.gi(a,f[m],f[m+1],-1)}}}function H(a,b){for(var d=a.Z,c=0;c<d.length;c+=3)if(d[c+1]==b&&1==d[c+2][1])return d[c];return-1}
function J(a){n(a);B(a);D(a)}function D(a){var b=[],d="",c="",e={};N.V(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var g=f.data.value;d?d==g||c||(c=g,e[c]=0):(d=g,e[d]=0);e[g]++}});for(var f in e)if(2>e[f]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==f&&b.splice(g,2);delete e[f];d==f&&(d=c,c="");c==f&&(c="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},h={default_value:[0,0,0],identifier:"UV_cycles",
is_linked:!1,name:"UV_cycles"};f=I("merged_uv","UV_MERGED",[],[g,h]);f.uv_layer=d;u(a,f,0,null,"",void 0);var k=a.K[a.K.length-2];f=a.K[a.K.length-1];if(c){h=I("merged_uv","UV_MERGED",[],[g,h]);h.uv_layer=c;u(a,h,0,null,"",void 0);var l=a.K[a.K.length-2],h=a.K[a.K.length-1]}else h=null;for(var q=-1,n=null,g=0;g<b.length;g+=2){var p=b[g],r=b[g+1];m(r,b[1])?(q=k,n=f):h&&(q=l,n=h);for(var w=[],x=N.rg(a,p),v={},z=0;z<x;z++){var t=N.dg(a,p,z);t in v||(v[t]=0);var A=N.rf(a,p,t,v[t]++);w.push(p,t,A);A=A.splice(0,
A.length);switch(r.type){case "GEOMETRY_UV":A[0]=0;n.ta[0].Jb=!0;break;case "UVMAP":case "TEX_COORD_UV":A[0]=1,n.ta[1].Jb=!0}N.gc(a,q,t,A)}for(var z=0;z<w.length;z+=3)N.gi(a,w[z],w[z+1],0);N.hi(a,p)}}}function n(a){var b=[];N.V(a,function(a,d){"GEOMETRY_VC"!=d.type&&"GEOMETRY_NO"!=d.type&&"GEOMETRY_FB"!=d.type&&"GEOMETRY_VW"!=d.type&&"GEOMETRY_GL"!=d.type&&"GEOMETRY_LO"!=d.type&&"GEOMETRY_OR"!=d.type||b.push(a,d)});for(var d=[],c=0;c<b.length;c+=2){for(var e=b[c],f=b[c+1],g=!0,h=0;h<d.length;h++){var k=
d[h];if(q(f,k.cd)){g=[];h=N.rg(a,e);for(n=0;n<h;n++){var m=N.dg(a,e,n),l=N.rf(a,e,m,0);g.push(e,m,l);N.gc(a,k.id,m,l)}for(var n=0;n<g.length;n+=3)N.gi(a,g[n],g[n+1],0);N.hi(a,e);g=!1;break}}g&&(k={id:e,cd:f},d.push(k))}}function C(a){for(var b={},d=0;d<a.K.length;d+=2)b[a.K[d]]=[];for(d=0;d<a.Z.length;d+=3){for(var c=a.Z[d],e=a.Z[d+1],f=b[e],g=c,h=0;h<=f.length;h++){if(h>=f.length||f[h]>g)f.splice(h,0,g);else if(f[h]!=g)continue;break}for(var e=b[e],c=b[c],g=f=0,h=e.length+c.length,k=[],m=0;m<h;m++)f>
e.length||e[f]>c[g]?k.push(c[g++]):k.push(e[f++])}return b}function B(a){var b=[];N.V(a,function(a,d){"TEXTURE_COLOR"!=d.type&&"TEXTURE_NORMAL"!=d.type||b.push(a,d)});if(b.length){for(var d=C(a),c=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<c.length;k++){var m=c[k];if(!(3<=m.xj.length||!q(g,m.cd)||-1<d[f].indexOf(m.id)||-1<d[m.id].indexOf(f))){for(var l=!1,n=0;n<m.xj.length;n++){var u=m.xj[n].id;if(-1<d[f].indexOf(u)||-1<d[u].indexOf(f)){l=!0;break}}if(!l){for(var k=[],u=N.$r(a,f),
p={},n=0;n<u;n++)l=N.sl(a,f,n),l in p||(p[l]=0),h=N.rf(a,l,f,p[l]++),k.push(l,f,h);for(var u=[],p=N.rg(a,f),w={},n=0;n<p;n++)l=N.dg(a,f,n),l in w||(w[l]=0),h=N.rf(a,f,l,w[l]++),u.push(f,l,h);h=k.concat(u);for(n=0;n<h.length;n+=3)N.gi(a,h[n],h[n+1],0);N.hi(a,f);n={id:f,cd:g,iH:k,jH:u};m.xj.push(n);h=!1;break}}}h&&(m={id:f,cd:g,xj:[]},c.push(m))}for(e=0;e<c.length;e++){m=c[e];d=m.xj.length;for(k=0;k<d;k++){g=m.xj[k];n=g.cd;f=g.iH;g=g.jH;m.cd.D[k+1].Jb=n.D[0].Jb;m.cd.D[k+1].Pa=n.D[0].Pa;m.cd.ta[2*(k+
1)].Jb=n.ta[0].Jb;m.cd.ta[2*(k+1)].Pa=n.ta[0].Pa;m.cd.ta[2*(k+1)+1].Jb=n.ta[1].Jb;m.cd.ta[2*(k+1)+1].Pa=n.ta[1].Pa;for(n=0;n<f.length;n+=3)l=f[n],h=f[n+2],h[1]+=k+1,N.gc(a,l,m.id,h);for(n=0;n<g.length;n+=3)l=g[n+1],h=g[n+2],h[0]+=2*(k+1),N.gc(a,m.id,l,h);m.cd.Hd.push(["USE_uv"+(k+2),1])}N.hi(a,m.id);N.Fi(a,m.id,m.cd)}}}function q(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}function m(a,b){var d=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=d.indexOf(a.type)&&-1!=d.indexOf(b.type)?a.data.value==b.data.value:!1}function w(a){var b=[];N.V(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d)});for(var d=0;d<b.length;d+=2){for(var c=b[d],e=b[d+1],f=!1,g=[],h=[],k=[[],[],[]],m=N.rg(a,c),l=0;l<m;l++){var q=N.dg(a,c,l);if("SEPRGB"!=N.Za(a,q).type){f=!1;break}g.push(c,q);for(var n=
{},u=N.rg(a,q),f=0;f<u;f++){var p=N.dg(a,q,f);p in n||(n[p]=0);var w=N.rf(a,q,p,n[p]++);g.push(q,p);k[w[0]].push(c,p,w)}h.push(q);f=!0}if(f){for(l=c=m=0;l<k.length;l++)k[l].length&&(m++,c|=1<<2-l);if(m){e.type+=m;e.ta=[];for(l=0;l<k.length;l++)if(k[l].length)for(e.ta.push({Pa:0,identifier:"RGB"[l],Jb:!0,name:"RGB"[l]}),f=0;f<k[l].length;f+=3)k[l][f+2][0]=ja.am(c,l);for(l=0;l<g.length;l+=2)N.gi(a,g[l],g[l+1],0);for(l=0;l<h.length;l++)N.hi(a,h[l]);for(l=0;l<k.length;l++)for(f=0;f<k[l].length;f+=3)N.gc(a,
k[l][f],k[l][f+1],k[l][f+2])}}}}function d(a,b,d,c,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==d&&(g=k):k.type==d&&(g=k)}return g?A(g,b)[0]:(f||ha.error('No "'+d+'" node in node '+c),-1)}function I(a,b,d,c){return{name:a,type:b,inputs:d,outputs:c}}function u(a,b,d,c,f,g){var h=b.name,m=b.type,l=[],q=[],n=[],p=[],w=null,r=[];switch(m){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":q=
ea(b);n=P(b);ha.warn(m+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":q=ea(b);n=P(b);break;case "UVMAP":var x=b.uv_layer;x||(m="EMPTY_UV");if("EMPTY_UV"!=m){var w=e("param_"+m+"_a"),v=e("param_"+m+"_v");l.push(S(w));l.push(S(v));p.push(S(v));w={name:w,value:x}}n=P(b);break;case "UV_MERGED":w=e("param_UV_MERGED_a");v=e("param_UV_MERGED_v");l.push(S(w));l.push(S(v));n.push(U(b,"UV_geom"));n.push(U(b,"UV_cycles"));p.push(S(v));w={name:w,value:b.uv_layer};
break;case "CAMERA":q=[];n=P(b);break;case "COMBRGB":case "COMBHSV":q=ea(b);n=P(b);break;case "CURVE_RGB":q=ea(b);n=P(b);ha.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":q=ea(b);n=P(b);ha.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!K(b))return!0;m=k(b,d);if(!m)return ha.error("Geometry output is not supported"),null;switch(m){case "GEOMETRY_UV":(x=b.uv_layer)||(m="EMPTY_UV");"EMPTY_UV"!=m&&(w=e("param_GEOMETRY_UV_a"),v=e("param_GEOMETRY_UV_v"),
l.push(S(w)),l.push(S(v)),p.push(S(v)),w={name:w,value:x});n.push(U(b,"UV"));break;case "GEOMETRY_VC":(x=b.color_layer)||(m="EMPTY_VC");"EMPTY_VC"!=m&&(w=e("param_GEOMETRY_VC_a"),v=e("param_GEOMETRY_VC_v"),l.push(S(w)),l.push(S(v)),p.push(S(v)),w={name:w,value:x});n.push(U(b,"Vertex Color"));break;case "GEOMETRY_NO":n.push(U(b,"Normal"));break;case "GEOMETRY_FB":n.push(U(b,"Front/Back"));break;case "GEOMETRY_VW":n.push(U(b,"View"));break;case "GEOMETRY_GL":n.push(U(b,"Global"));break;case "GEOMETRY_LO":n.push(U(b,
"Local"));break;case "GEOMETRY_OR":x=e("param_GEOMETRY_OR_v"),l.push(S(x)),n.push(U(b,"Orco")),p.push(S(x))}break;case "TEX_COORD":if(!K(b))return!0;m=M(b,d);if(!m)return ha.error("Texture coordinate output is not supported"),null;switch(m){case "TEX_COORD_UV":(x=b.uv_layer)||(m="EMPTY_UV");"EMPTY_UV"!=m&&(w=e("param_TEX_COORD_UV_a"),v=e("param_TEX_COORD_UV_v"),l.push(S(w)),l.push(S(v)),p.push(S(v)),w={name:w,value:b.uv_layer});n.push(U(b,"UV"));break;case "TEX_COORD_NO":n.push(U(b,"Normal"));break;
case "TEX_COORD_GE":x=e("param_TEX_COORD_GE_v");l.push(S(x));n.push(U(b,"Generated"));p.push(S(x));break;case "TEX_COORD_OB":n.push(U(b,"Object"));ha.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":n.push(U(b,"Camera"));break;case "TEX_COORD_WI":n.push(U(b,"Window"));ha.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":n.push(U(b,"Reflection")),ha.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;
case "GROUP":x=b.node_tree_name;switch(x){case "B4W_LINEAR_TO_SRGB":if(!E(b,[1],[1])){w=z(b,f,g);break}m="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!E(b,[1],[1])){w=z(b,f,g);break}m="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!E(b,[1],[1])){w=z(b,f,g);break}m="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!E(b,[1,1],[1])){w=z(b,f,g);break}m="B4W_REFLECT";break;case "B4W_REFRACTION":if(!E(b,[1,0],[1])){w=z(b,f,g);break}m="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!E(b,
[1,1,0,0,0],[1])){w=z(b,f,g);break}m="B4W_PARALLAX";v=e("temp_texture");p.push(S(v));break;case "B4W_CLAMP":if(!E(b,[1],[1])){w=z(b,f,g);break}m="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!E(b,[0,0,0,0,0],[0])){w=z(b,f,g);break}m="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!E(b,[],[0])){w=z(b,f,g);break}m="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!E(b,[0,0,0],[0])){w=z(b,f,g);break}m="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":m="B4W_GLOW_OUTPUT";break;default:w=z(b,f,g)}q=ea(b);n=P(b);"B4W_TRANSLUCENCY"==
x&&(x=T("TranslucencyParams","TranslucencyParams",[0,0,0,0]),x.Jb=n[0].Jb,n.push(x));break;case "LAMP":w=b.lamp;if(!w)return ha.error("There is no lamp in node: "+b.name),null;n.push(U(b,"Color"));n.push(U(b,"Light Vector"));n.push(U(b,"Distance"));n.push(U(b,"Visibility Factor"));w.uuid in O?r.push(["LAMP_INDEX",String(O[w.uuid])]):(O[w.uuid]=pb,r.push(["LAMP_INDEX",String(pb++)]));w=O;break;case "LIGHTING_AMBIENT":q=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0)];n=[T("color",
"color",[0,0,0],!0),T("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":n=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0),T("S","S",[0,0,0],!0),T("normal","normal",[0,0,0],!0),T("dif_params","dif_params",[0,0],!0),T("sp_params","sp_params",[0,0],!0),T("shadow_factor","shadow_factor",0,!0),T("translucency_color","translucency_color",0,!0),T("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":q=[T("color","color",[0,0,0],!0),T("specular",
"specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":q=[T("shadow_factor","shadow_factor",0,!0)];n=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("lcolorint","lcolorint",[0,0,0],!0),T("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":q=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0)];n=[T("lfactor","lfactor",0,!0)];break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":q=
[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0),T("dif_params","dif_params",[0,0],!0)];n=[T("lfactor","lfactor",0,!0)];break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":q=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0),T("sp_params","sp_params",[0,0],!0)];n=[T("sfactor","sfactor",0,!0)];break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":q=[T("ldir","ldir",[0,0,
0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("sp_params","sp_params",[0,0],!0)];n=[T("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":q=[T("color","color",[0,0,0,0],!0),T("specular","specular",[0,0,0],!0),T("lfactor","lfactor",0,!0),T("sfactor","sfactor",0,!0),T("ldir","ldir",[0,0,0],!0),T("normal","normal",[0,0,0],!0),T("translucency_params","translucency_params",[0,0,0,0],!0),T("D","D",[0,0,0],!0),T("S","S",[0,0,0],!0),T("lcolorint","lcolorint",[0,0,0],!0),T("translucency_color",
"translucency_color",0,!0)];n=[T("color","color",[0,0,0,0],!0),T("specular","specular",[0,0,0],!0)];break;case "NORMAL":q=ea(b);n=P(b);x=U(b,"Normal");p.push(S(e("param_NORMAL_Normal"),x.Pa,3));break;case "MAPPING":x=b.vector_type;m="MAPPING";q.push(aa(b,"Vector"));n.push(U(b,"Vector"));var v=b.rotation,t=b.scale,A=b.translation,B=X.create(),y=ja.oH(v);"TEXTURE"==x&&(t[0]=t[0]||1,t[1]=t[1]||1,t[2]=t[2]||1);var C=new Float32Array([t[0],0,0,0,t[1],0,0,0,t[2]]);X.multiply(y,C,B);B=ja.SJ(B,ga.create());
switch(x){case "POINT":B[12]=A[0];B[13]=A[1];B[14]=A[2];break;case "TEXTURE":B[12]=A[0];B[13]=A[1];B[14]=A[2];B=ga.invert(B,B);break;case "NORMAL":ga.invert(B,B),ga.transpose(B,B)}switch(x){case "NORMAL":r.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":r.push(["MAPPING_TRS_MATRIX",Z.M(B,16)]);break;case "POINT":0!==L.length(v)?r.push(["MAPPING_TRS_MATRIX",Z.M(B,16)]):(0!==L.length(t)&&r.push(["MAPPING_SCALE",Z.M(t,3)]),0!==L.length(A)&&r.push(["MAPPING_TRANSLATION",Z.M(A,3)]));break;case "VECTOR":0!==
L.length(v)?r.push(["MAPPING_TRS_MATRIX",Z.M(B,16)]):0!==L.length(t)&&r.push(["MAPPING_SCALE",Z.M(t,3)])}b.use_min&&r.push(["MAPPING_MIN_CLIP",Z.M(b.min,3)]);b.use_max&&r.push(["MAPPING_MAX_CLIP",Z.M(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":w=[];x=[];v=[];t=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0),T("S","S",[0,0,0],!0),T("normal","normal",[0,0,0],!0),T("dif_params","dif_params",[0,0],!0),T("sp_params","sp_params",[0,0],!0),T("shadow_factor","shadow_factor",0,
!0)];A=[T("color","color",[0,0,0],!0),T("specular","specular",[0,0,0],!0),T("normal","normal",[0,0,0],!0)];B=[U(b,"Color"),U(b,"Alpha"),U(b,"Normal")];y=[];C=aa(b,"Color");C.Pa.splice(3);v.push(C);q.push(C);C=aa(b,"Spec");C.Pa.splice(3);v.push(C);q.push(C);v.push(T("DiffuseIntensity","DiffuseIntensity",b.diffuse_intensity));q.push(C);var D=aa(b,"Normal");D.Pa.splice(3);v.push(D);q.push(D);"MATERIAL_EXT"==m?((C=aa(b,"Emit"))||(C=T("Emit","Emit",0)),v.push(C),q.push(C),(C=aa(b,"Translucency"))?(C.Pa=
0,C.name="Translucency",C.identifier="Translucency"):C=T("Translucency","Translucency",0),q.push(C),(C=aa(b,"Translucency"))?(C.Pa=[0,0,0,0],C.name="TranslucencyParams",C.identifier="TranslucencyParams"):C=T("TranslucencyParams","TranslucencyParams",[0,0,0,0]),q.push(C),n=aa(b,"Reflectivity"),C=aa(b,"Ray Mirror"),n?(C=n,n="Reflectivity"):C?n="Ray Mirror":(C=n,n="Reflectivity"),C||(C=T(n,n,0)),q.push(C),A.push(C),(C=aa(b,"SpecTra"))||(C=T("SpecTra","SpecTra",0)),q.push(C),A.push(C),(C=aa(b,"Alpha"))||
(C=T("Alpha","Alpha",b.alpha)),q.push(C),A.push(C),B.push(U(b,"Diffuse")),B.push(U(b,"Spec")),w.push(["MATERIAL_EXT",1]),x.push(["MATERIAL_EXT",1])):(v.push(T("emit_intensity","emit_intensity",0)),A.push(T("reflect_factor","reflect_factor",0)),A.push(T("specular_alpha","specular_alpha",0)),A.push(T("alpha_in","alpha_in",0)),B.push(T("diffuse_out","diffuse_out",0)),B.push(T("spec_out","spec_out",0)),w.push(["MATERIAL_EXT",0]),x.push(["MATERIAL_EXT",0]));y.push(S(e("param_MATERIAL_alpha"),b.alpha));
y.push(S(e("param_MATERIAL_spec_alpha"),b.specular_alpha));n=B;D.Jb&&w.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&(w.push(["USE_MATERIAL_DIFFUSE",1]),x.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&x.push(["USE_MATERIAL_SPECULAR",1]);var C=[],F=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":D=b.specular_hardness;break;case "WARDISO":D=b.specular_slope;break;case "TOON":D=b.specular_toon_size;F=b.specular_toon_smooth;break;case "BLINN":D=b.specular_ior;F=b.specular_hardness;break;
default:ha.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),D=b.specular_hardness}var G,I;switch(b.diffuse_shader){case "LAMBERT":I=G=0;break;case "OREN_NAYAR":G=b.roughness;I=0;break;case "FRESNEL":G=b.diffuse_fresnel;I=b.diffuse_fresnel_factor;break;case "MINNAERT":G=b.darkness;I=0;break;case "TOON":G=b.diffuse_toon_size;I=b.diffuse_toon_smooth;break;default:ha.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),
I=G=0}C.push(S(e("param_MATERIAL_diffuse"),[G,I],2));C.push(S(e("param_MATERIAL_spec"),[b.specular_intensity,D,F],3));w.push(["SHADELESS_MAT",b.use_shadeless?1:0]);D={name:b.name,value:{Vj:b.specular_shader,Zk:b.diffuse_shader,yd:b.use_shadeless}};w={name:b.name,value:{Vj:b.specular_shader,Zk:b.diffuse_shader,yd:b.use_shadeless},TJ:{name:"material_begin",type:"MATERIAL_BEGIN",D:v,ta:t,Ta:C,data:D,Hd:w,Rg:[]},UJ:{name:"material_end",type:"MATERIAL_END",D:A,ta:B,Ta:y,data:D,Hd:x,Rg:[]}};break;case "MATH":switch(b.operation){case "ADD":m=
"MATH_ADD";break;case "SUBTRACT":m="MATH_SUBTRACT";break;case "MULTIPLY":m="MATH_MULTIPLY";break;case "DIVIDE":m="MATH_DIVIDE";break;case "SINE":m="MATH_SINE";break;case "COSINE":m="MATH_COSINE";break;case "TANGENT":m="MATH_TANGENT";break;case "ARCSINE":m="MATH_ARCSINE";break;case "ARCCOSINE":m="MATH_ARCCOSINE";break;case "ARCTANGENT":m="MATH_ARCTANGENT";break;case "POWER":m="MATH_POWER";break;case "LOGARITHM":m="MATH_LOGARITHM";break;case "MINIMUM":m="MATH_MINIMUM";break;case "MAXIMUM":m="MATH_MAXIMUM";
break;case "ROUND":m="MATH_ROUND";break;case "LESS_THAN":m="MATH_LESS_THAN";break;case "GREATER_THAN":m="MATH_GREATER_THAN";break;case "MODULO":m="MATH_MODULO";break;case "ABSOLUTE":m="MATH_ABSOLUTE";break;default:return ha.error("Unsupported MATH operation: "+b.operation),null}r.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);q=ea(b);n=P(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":m="MIX_RGB_MIX";break;case "ADD":m="MIX_RGB_ADD";break;case "MULTIPLY":m="MIX_RGB_MULTIPLY";break;case "SUBTRACT":m=
"MIX_RGB_SUBTRACT";break;case "SCREEN":m="MIX_RGB_SCREEN";break;case "DIVIDE":m="MIX_RGB_DIVIDE";break;case "DIFFERENCE":m="MIX_RGB_DIFFERENCE";break;case "DARKEN":m="MIX_RGB_DARKEN";break;case "LIGHTEN":m="MIX_RGB_LIGHTEN";break;case "OVERLAY":m="MIX_RGB_OVERLAY";break;case "DODGE":m="MIX_RGB_DODGE";break;case "BURN":m="MIX_RGB_BURN";break;case "HUE":m="MIX_RGB_HUE";break;case "SATURATION":m="MIX_RGB_SATURATION";break;case "VALUE":m="MIX_RGB_VALUE";break;case "COLOR":m="MIX_RGB_COLOR";break;case "SOFT_LIGHT":m=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":m="MIX_RGB_LINEAR_LIGHT";break;default:return ha.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}r.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);q=ea(b);n=P(b);break;case "OUTPUT":q=ea(b);n=[];break;case "RGB":x=f+"%join%"+b.name;x={name:"-1",value:x};p.push(x);n.push(U(b,"Color"));break;case "SEPRGB":case "SEPHSV":q=ea(b);n=P(b);break;case "TEXTURE":m=Q(b);if("TEXTURE_EMPTY"==m)n.push(U(b,"Color")),n.push(U(b,"Normal")),n.push(U(b,"Value"));
else if("TEXTURE_ENVIRONMENT"==m)q.push(aa(b,"Vector")),n.push(U(b,"Color")),n.push(U(b,"Value"));else{if("TEXTURE_NORMAL"==m&&"ENVIRONMENT_MAP"==b.texture.type)return ha.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;for(w=0;4>w;++w)w?(C=T("Vector"+w,"Vector"+w,[0,0,0]),"TEXTURE_COLOR"==m&&(x=T("Color"+w,"Color"+w,[0,0,0]),v=T("Value"+w,"Value"+w,0)),"TEXTURE_NORMAL"==m&&(x=T("Normal"+w,"Normal"+w,[0,0,0]),v=T("Value"+w,"Value"+w,0))):(C=aa(b,"Vector"),"TEXTURE_COLOR"==m&&(x=U(b,
"Color"),v=U(b,"Value")),"TEXTURE_NORMAL"==m&&(x=U(b,"Normal"),v=U(b,"Value"))),q.push(C),n.push(x),n.push(v)}v=e("param_TEXTURE_texture");p.push(S(v));w={name:v,value:b.texture};break;case "VALTORGB":q=ea(b);n=P(b);ha.warn("VALTORGB node is not fully supported.");break;case "VALUE":m="VALUE";x=f+"%join%"+b.name;x={name:"-1",value:x};p.push(x);n.push(U(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":m="VECT_MATH_ADD";break;case "SUBTRACT":m="VECT_MATH_SUBTRACT";break;case "AVERAGE":m=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":m="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":m="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":m="VECT_MATH_NORMALIZE";break;default:return ha.error("Unsupported VECT_MATH operation: "+b.operation),null}q=ea(b);n=P(b);break;default:q=ea(b),n=P(b)}m={name:h,type:m,Rg:l,D:q,ta:n,Ta:p,data:w,Hd:r};h=N.pl(a);N.Fi(a,N.pl(a),m);if(!(m="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{m=b.outputs;for(q=l=0;q<m.length;q++)if(m[q].is_linked&&l++>d){m=!0;break a}m=
!1}m=!m}return m||null!=u(a,b,++d,c,f,g)?h:null}function E(a,b,d){for(var c=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=c[g],m=b[g];if(!h||h.default_value instanceof Array!=m)return ha.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<d.length;g++)if(b=e[g],c=d[g],!b||b.default_value instanceof Array!=c)return ha.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),
!1;return!0}function z(a,b,d){var c=a.node_group.node_tree,e={},f;for(f in c)if("links"==f||"nodes"==f){e[f]=[];for(var g=0;g<c[f].length;g++){e[f][g]={};for(var h in c[f][g])if("links"==f){e[f][g][h]={};for(var m in c[f][g][h])e[f][g][h][m]=G(c[f][g][h][m])}else e[f][g][h]=G(c[f][g][h])}}else e[f]=G(c[f]);c=a.node_tree_name;if("B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==c)f=I("Group input","GROUP_INPUT",[],a.inputs),g=I("Group output","GROUP_OUTPUT",a.outputs,[]),h=null,h="B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==
c&&(qa.quality==na.Zg||qa.ur)?{from_node:f,from_socket:f.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:g,to_socket:g.inputs[0]},e.nodes=[f,g],e.links=[h];c=a.name;f=e.nodes;g=e.links;for(h=0;h<f.length;h++)f[h].name=ka(f[h].type,c,f[h].name);for(h=0;h<g.length;h++)g[h].from_node.name=ka(g[h].from_node.type,c,g[h].from_node.name),g[h].to_node.name=ka(g[h].to_node.type,c,g[h].to_node.name);return{fK:l(e,a.node_group.uuid,!0,b,d),gK:e.links}}function G(a){var b=
typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ja.Kk(a):a}function e(a){ta[a]||(ta[a]=0);var b=a+ta[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ta[a]++;return b}function K(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function k(a,b){for(var d=a.outputs,c=0,e=0;e<d.length;e++){var f=d[e];if(f.is_linked&&!(c++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";
case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function M(a,b){for(var d=a.outputs,c=0,e=0;e<d.length;e++){var f=d[e];if(f.is_linked&&!(c++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";
default:return null}}}function Q(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,d=!1,c=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":d=!0;break;case "Normal":c=!0;break;case "Value":e=!0;break;default:throw"Unknown texture output";}}if(d)return c&&ha.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(c)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==
a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function aa(a,b){for(var d=a.inputs,c=0;c<d.length;c++){var e=d[c];if(e.identifier==b)return ba(e)}return null}function U(a,b){for(var d=a.outputs,c=0;c<d.length;c++){var e=d[c];if(e.identifier==b)return ba(e)}return null}function ba(a){var b=a.name,d=a.identifier,c=a.is_linked;a=a.default_value;a=ja.ee(a)?a.slice(0):a;return{name:b,identifier:d,Jb:c,Pa:a}}function T(a,b,d,c){return{name:a,identifier:b,Jb:c||!1,Pa:d}}function ea(a){for(var b=[],
d=0;d<a.inputs.length;d++){var c=ba(a.inputs[d]);c.Pa.length&&c.Pa.splice(3);b.push(c)}return b}function P(a){for(var b=[],d=0;d<a.outputs.length;d++){var c=ba(a.outputs[d]);b.push(c)}return b}function S(a,b,d){b=null===b||void 0===b?null:Z.M(b,d);return{name:a,value:b}}function da(a,b,d,c,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var m=c.ta;for(c=0;c<m.length;c++)if(m[c].identifier==h){g.push(c);break}e=e.D;for(c=0;c<e.length;c++)if(e[c].identifier==f){g.push(c);break}2==
g.length&&N.gc(a,b,d,g);return!0}function ka(a,b,d){return"GROUP_INPUT"==a?b+"*GI*"+d:"GROUP_OUTPUT"==a?b+"*GO*"+d:b+"%join%"+d}function ca(a){var b=[];N.V(a,function(a,d){"GROUP"==d.type&&b.push(d)});return b}function ia(a,b,d){for(var c=0;c<d.length;c++){var e=d[c].data.fK,f=d[c].data.gK;if(!e)return!1;N.V(e,function(b,d){N.Fi(a,N.pl(a),d)});for(e=0;e<f.length;e++)b.push(f[e]);oa(d[c],b,a)}return!0}function fa(a,b,d,c,e,f){switch(a.type){case "GROUP":a.name==b&&c.push(d);break;case "GROUP_INPUT":a.name.indexOf(b+
"*GI*")||e.push(d);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(d)}}function R(a,b,d){for(var c=[],e=0;e<d.length;e++){for(var f=d[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):c.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return c}function ra(a,b){if(b.length)for(var d=b[0].from_node.name,c=0;c<a.length;c++)a[c].from_node.name==d&&b.push(a[c])}function sa(a,b,d,
c){for(var e=0;e<c.length;e++){for(var f=c[e],g,h=0;h<d.D.length;h++)if(f.from_socket.identifier==d.D[h].identifier){g=d.D[h].Pa;break}for(var h=f,m=b,k=g,l=A(h.to_node,m),q=0;q<l.length;q++)for(var n=N.Za(m,l[q]),u=0;u<n.D.length;u++)if(n.D[u].identifier==h.to_socket.identifier){n.D[u].Pa=k;break}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function oa(a,b,d){for(var c=a.name,e=[],f=[],g=[],h=[],m=0;m<b.length;m++){var k=b[m];fa(k.from_node,c,k,e,g,h);fa(k.to_node,c,k,f,g,h)}f=R(b,f,g);e=R(b,h,e);ra(b,f);
sa(b,d,a,f);if(e.length){var l;N.V(d,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(c+"*GO*")||(l=b)});sa(b,d,l,e)}}var na=t("__config"),N=t("__graph"),X=t("__mat3"),ga=t("__mat4"),V=t("__objects"),ha=t("__print"),Z=t("__shaders"),W=t("__scenes"),ja=t("__util"),L=t("__vec3"),ta={},la={},O={},pb=0;new Float32Array(4);var qa=na.r;a.fG=l;a.Pq=function(a,d,c){var e=W.o();if(h(a,"MAIN",e.oN)in la)return la[a];var e=N.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=u(e,f,0,null,d,null),
f={name:"LIGHTING_END",type:"LIGHTING_END"},f=u(e,f,0,null,d,null);b(e,c,g,f,[[g,[8,10]],[g,[9,6]]],null,d);v(e);return la[a]=e};a.on=function(a){var b=[],d={};ta={};var c=N.hu(a);N.V(c,function(a,c){var f;f=[];for(var g=[],h=[],m=[],k=[],l=[],q=0;q<c.D.length;q++){var n=c.D[q];if(n.Jb)f.push(null),g.push(null);else{f.push(e("in_"+c.type+"_"+n.identifier));var u=Z.M(n.Pa,0);qa.sB&&(0<=c.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=c.type.indexOf("MATH_")&&
("Value"==n.identifier||"Value_001"==n.identifier)||0<=c.type.indexOf("VECT_MATH_")&&"Vector_001"==n.identifier)&&(n=u,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),u=n=n.replace(/\s+/g,""));g.push(u)}}for(q=0;q<c.ta.length;q++)n=c.ta[q],n.Jb?h.push(null):h.push(e("out_"+c.type+"_"+n.identifier));for(q=0;q<c.Ta.length;q++)n=c.Ta[q],m.push(n.name),k.push(n.value);for(q=0;q<c.Rg.length;q++)l.push(c.Rg[q].name);
f={id:c.type,D:f,bs:g,ta:h,Ta:m,Bo:k,Rg:l,Hd:JSON.parse(JSON.stringify(c.Hd))};b.push(f);d[a]=f});N.We(c,function(a,b,f){var g=N.Za(c,a);N.Za(c,b);var h=g.ta[f[0]];a=d[a].ta;b=d[b].D;g=a[f[0]]||e("out_"+g.type+"_"+h.identifier);a[f[0]]=g;b[f[1]]=g});return b};a.yw=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var d=a.node_tree.nodes[b];if("GROUP"==d.type&&"B4W_GLOW_OUTPUT"==d.node_tree_name)return!0}return!1};a.Y=function(){for(var a in la)delete la[a];for(var b in O)delete O[b];
pb=0}};b4w.module.__shaders=function(a,t){function l(a,b,f){var g=a.Zf;"string"==typeof f&&(a=c(a,f))&&(f=a[1]);for(a=0;a<g.length;a++)if(g[a][0]==b){g[a][1]=f;return}g.push([b,f])}function c(a,b){for(var c=a.Zf,f=0;f<c.length;f++)if(c[f][0]==b)return c[f];return!1}function b(a,b){var c=a+b;if(n[c])return n[c];if(C){var f=C[b];if(!f)return null;f=t("__gpp_parser").bT.parse(f)}else if(f=t("shader_texts")[b],!f)return null;return n[c]=f}function y(a,c,f){function g(c){c=c.a;for(var f=0;f<c.length;f++){var n=
c[f];switch(n.type){case "condition":a:for(var n=n.a,u=0;u<n.length;u++){var x=n[u];switch(x.type){case "if":case "elif":if(m(x.c)){g(x.group);break a}break;case "else":g(x.group);break a;case "ifdef":x.name in k&&g(x.group);break;case "ifndef":x.name in k||g(x.group)}}break;case "include":n=b(J.shaders_dir,J.LL+n.file);g(n);break;case "var":case "export":case "import":break;case "define":u=n.name;k[u]=n.b;n.Ta&&(p[u]=n.Ta);break;case "error":throw"Shader error: #error "+n.b.join(" ");case "line":break;
case "pragma":q.push("#pragma "+n.name+" "+n.b.join(" "));break;case "undef":n=n.name;delete k[n];delete p[n];break;case "warning":F.warn("Shader warning: #warning "+n.b.join(" "));break;case "extension":n=h(n.b,k,p,!1);q.push("#extension "+n.join(" "));break;case "#":break;case "node":w[n.name]=n;break;case "nodes_global":n=e;for(u=0;u<n.length;u++){var x=n[u],C=w[x.id];if(C)for(var B=0,y=0;y<C.h.length;y++){var D=C.h[y];"node_param"==D.type&&(D=D.qualifier.join(" ")+" ","vert"==a?D+=x.Rg[B]:"frag"==
a&&(D+=x.Ta[B],null!==x.Bo[B]&&(D+=" = "+x.Bo[B])),D+=";",q.push(D),B++)}}break;case "nodes_main":n=e;for(u=0;u<n.length;u++)if(x=n[u],C=w[x.id]){B={};y={};for(D=0;D<x.Hd.length;D++)y[x.Hd[D][0]]=[x.Hd[D][1]];A=t=v=0;for(var D=x,I=C.h,H=B,M=y,X=0;X<I.length;X++){var ba=I[X];switch(ba.type){case "node_in":var V=D.D[v];if(null!==D.bs[v]){if(("MATERIAL_BEGIN"==D.id&&3===v||!M.MATERIAL_EXT&&("MATERIAL_BEGIN"==D.id&&4===v||"MATERIAL_END"==D.id&&3===v||"MATERIAL_END"==D.id&&4===v||"MATERIAL_END"==D.id&&
5===v)||"TEXTURE_COLOR"==D.id||"TEXTURE_NORMAL"==D.id)&&ba.e){H[ba.name]=D.bs[v];v++;continue}var ha=ba.qualifier.join(" ")+" ",ha=ha+V,ha=ha+(" = "+D.bs[v]),ha=ha+";";q.push(ha)}H[ba.name]=V;v++;break;case "node_out":V=D.ta[t];if(!ba.e||-1<r.indexOf(V))ha=ba.qualifier.join(" ")+" ",ha+=V,ha+=";",q.push(ha),H[ba.name]=V;-1<r.indexOf(V)&&(M["USE_OUT_"+ba.name]=[1]);t++;break;case "node_param":"vert"==a?V=D.Rg[A]:"frag"==a&&(V=D.Ta[A]),H[ba.name]=V,A++}}q.push("{");l(x,C.g,B,y);q.push("}")}break;case "textline":n=
h(n.b,k,p,!1);q.push(n.join(" "));break;default:throw"Unknown element type: "+n.type;}}}function m(a,b){var d;d=h(a,k,p,!0,b);for(var c=[],e=0;e<d.length;e++)if(d[e]instanceof Object)switch(d[e].type){case "conditional_expr":var f=c.pop(),g=c.pop();c.pop()?c.push(g):c.push(f);break;case "logical_or_expr":f=c.pop();for(g=0;g<d[e].d-1;g++)l=c.pop(),f=f||l;c.push(f);break;case "logical_and_expr":f=c.pop();for(g=0;g<d[e].d-1;g++)l=c.pop(),f=f&&l;c.push(f);break;case "logical_bitor_expr":f=c.pop();for(g=
0;g<d[e].d-1;g++)f|=c.pop();c.push(f);break;case "logical_bitxor_expr":f=c.pop();for(g=0;g<d[e].d-1;g++)f^=c.pop();c.push(f);break;case "logical_bitand_expr":f=c.pop();for(g=0;g<d[e].d-1;g++)f&=c.pop();c.push(f);break;case "equal_expr":f=c.pop();g=c.pop();c.push(g==f);break;case "non_equal_expr":f=c.pop();g=c.pop();c.push(g!=f);break;case "le_expr":f=c.pop();g=c.pop();c.push(g<=f);break;case "ge_expr":f=c.pop();g=c.pop();c.push(g>=f);break;case "l_expr":f=c.pop();g=c.pop();c.push(g<f);break;case "g_expr":f=
c.pop();g=c.pop();c.push(g>f);break;case "left_shift_expr":g=c.pop();f=c.pop();c.push(g<<f);break;case "right_shift_expr":g=c.pop();f=c.pop();c.push(g>>f);break;case "add_expr":g=c.pop();f=c.pop();c.push(g+f);break;case "sub_expr":g=c.pop();f=c.pop();c.push(g-f);break;case "mul_expr":g=c.pop();f=c.pop();c.push(g*f);break;case "div_expr":g=c.pop();f=c.pop();c.push(g/f);break;case "mod_expr":g=c.pop();f=c.pop();c.push(g%f);break;case "pre_inc_expr":case "post_inc_expr":l=c.pop();c.push(++l);break;case "pre_dec_expr":case "post_dec_expr":l=
c.pop();c.push(--l);break;case "positive_expr":l=c.pop();c.push(+l);break;case "negative_expr":l=c.pop();c.push(-l);break;case "one_compl_expr":l=c.pop();c.push(~l);break;case "logic_negative_expr":l=c.pop();c.push(!l);break;default:H.fa("Unknown operation type: "+d[e].type)}else{var l=d[e];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(l)?c.push(0):c.push(parseFloat(d[e]))}1==c.length?d=c[0]:(H.fa("Incorrect expression: "+d.join(" ")),d=void 0);return d}function l(a,b,d,c){for(var e=0;e<b.length;e++){var f=b[e];
switch(f.type){case "node_condition":a:for(var g=a,f=f.a,n=d,u=c,w=0;w<f.length;w++){var r=f[w];switch(r.type){case "node_if":case "node_elif":if(m(r.c,u)){l(g,r.g,n,u);break a}break;case "node_else":l(g,r.g,n,u);break a;case "node_ifdef":(r.name in k||r.name in u)&&l(g,r.g,n,u);break;case "node_ifndef":r.name in k||r.name in u||l(g,r.g,n,u)}}break;case "textline":g=[];for(n=0;n<f.b.length;n++)u=f.b[n],u in d?g.push(d[u]):g.push(u);g=h(g,k,p,!0,c);q.push(g.join(" "))}}}var e=f.pg;f=f.Zf||[];for(var q=
[],k={},n=0;n<f.length;n++)k[f[n][0]]=[f[n][1]];for(n=0;n<e.length;n++)k["USE_NODE_"+e[n].id]=[1];var p={},w={},r=[];for(n in e)for(var x in e[n].D)r.push(e[n].D[x]);g(c);var v=0,t=0,A=0;return q.join("\n")}function h(a,b,c,f,g){var h=[];r(a,b,c,f,h,g);return h}function r(a,b,c,f,g,h){for(var e=0;e<a.length;e++){var m=a[e];m in b||h&&m in h?(m=h&&h[m]||b[m],0==m.length&&f?g.push(0):r(m,b,c,f,g,h)):g.push(m)}}function x(a,b,c,f){f=a.createShader(f);a.shaderSource(f,c);a.compileShader(f);A.RF(f,b,c);
return f}function v(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return g(a);case 2:return"vec2("+g(a[0])+","+g(a[1])+")";case 3:return"vec3("+g(a[0])+","+g(a[1])+","+g(a[2])+")";case 4:return"vec4("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+")";case 9:return"mat3("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+","+g(a[4])+","+g(a[5])+","+g(a[6])+","+g(a[7])+","+g(a[8])+")";case 16:return"mat4("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+","+g(a[4])+","+g(a[5])+","+g(a[6])+","+g(a[7])+
","+g(a[8])+","+g(a[9])+","+g(a[10])+","+g(a[11])+","+g(a[12])+","+g(a[13])+","+g(a[14])+","+g(a[15])+")";default:throw"Wrong glsl value dimension";}}function g(a){return a%1?String(a):String(a)+".0"}var p=t("__assets"),f=t("__config"),A=t("__debug"),F=t("__print"),H=t("__util"),J=f.Ac,D={},n={},C=null,B="anchors.glslf anchors.glslv color_id.glslf color_id.glslv depth.glslf depth.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv main.glslf main.glslv main_stack.glslf main_stack.glslv particles_color.glslf particles_color.glslv particles_texture.glslf particles_texture.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv wireframe.glslf wireframe.glslv postprocessing/anaglyph.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf include/blending.glslf include/caustics.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/gamma.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
q=[],m=null,w=!1;a.oe=function(a){m=a};a.I=l;a.iI=c;a.xS=function(a,b){for(var c=a.Zf,f=0;f<c.length;f++)if(c[f][0]==b&&1==c[f][1])return!0;return!1};a.mL=function(a){a.Zf=[];for(var b="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
c=0;c<b.length;c++){var g=b[c],h;switch(g){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":h=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":h=1;break;case "SHADOW_TEX_RES":h=v(2048);break;case "AA_METHOD":h="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":h="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":h="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":h="POST_EFFECT_NONE";break;case "SHADOW_USAGE":h="NO_SHADOWS";break;case "SSAO_QUALITY":h=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":h="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":h="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":h=f.r.precision;break;case "EPSILON":h="highp"==f.r.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":h="u_va_frame_factor";break;default:F.error("Unknown directive ("+a.tk+", "+a.$i+"): "+g)}l(a,g,h)}};a.eS=function(a){return a.tk};a.iy=function(a){return a.$i};a.rS=function(a,b){for(var f=b.Zf,g=0;g<f.length;g++){var h=f[g][0],m=
f[g][1];c(a,h)&&l(a,h,m)}};a.dI=function(a){var c=JSON.stringify(a),f=D[c];if(f)return f;var g=a.$i,f=b(J.shaders_dir,a.tk),g=b(J.shaders_dir,g);if(!f||!g)return null;var h=y("vert",f,a),l=y("frag",g,a),f=m,e=x(f,c,h,f.VERTEX_SHADER),n=x(f,c,l,f.FRAGMENT_SHADER),g=f.createProgram();f.attachShader(g,e);f.attachShader(g,n);f.linkProgram(g);f.validateProgram(g);f.getProgramParameter(g,f.VALIDATE_STATUS)==f.bO&&F.error("shader program is not valid",c);A.SF(g,c,e,n,h,l);a={Iu:e,Ix:n,Ul:g,attributes:{},
km:{},Ql:[],Ss:{},cC:[],ib:a};l=f.getProgramParameter(g,f.ACTIVE_ATTRIBUTES);for(h=0;h<l;h++)e=f.getActiveAttrib(g,h).name,a.attributes[e]=f.getAttribLocation(g,e);l=f.getProgramParameter(g,f.ACTIVE_UNIFORMS);for(h=0;h<l;h++)e=f.getActiveUniform(g,h).name.split("[0]").join(""),a.km[e]=f.getUniformLocation(g,e);return D[c]=f=a};a.EJ=function(){w=!1;if(b4w.module_check("shader_texts"))w=!0;else{for(var a=[],b=p.Tu,c=0;c<B.length;c++){var f=H.Gl(J.shaders_dir+B[c]);a.push([B[c],b,f])}b=function(a,b){C||
(C={});C[b]=a};a.length?p.vc(a,b,function(){w=!0}):F.error("Shaders have not been found.")}};a.TF=function(){return w};a.AQ=function(){return q};a.Yx=function(){return D};a.Y=function(){for(var a in D){var b=D[a];m.deleteProgram(b.Ul);m.deleteShader(b.Iu);m.deleteShader(b.Ix);delete D[a]}for(var c in n)delete n[c];for(var f in q)delete q[f]};a.BQ=function(a){var b=a.Zf;F.log("Shader: "+a.tk+" "+a.$i+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)F.log("  "+b[a][0],b[a][1])};a.M=v;a.Aw=
function(a,b){return b in a.km?!0:!1};a.DI=function(a){return(m.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__assets=function(a,t){function l(){return H.bJ()?t(H.Ac.fn).data:null}function c(){var a={Om:null,uE:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Om=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=l();b&&a.Om in b&&(a.status=200,b[a.Om]&&(a.response=a.uE(b[a.Om])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=m.XJ)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.wm:y(f,"arraybuffer");break;case a.Jp:y(f,"json");break;case a.Tu:y(f,"text");break;case a.Qu:h(f);break;case a.xm:r(f);break;case a.Ru:x(f);break;case a.zm:v(f);break;
case a.ym:g(f);break;default:C.fa("Wrong asset type: "+f.type)}}}function y(a,b){var d=l(),f=d&&a.s in d?new c:new XMLHttpRequest;f.open("GET",a.s,!0);"text"==b?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==b?(f.overrideMimeType("application/json"),f.responseType="text"):f.responseType=b;f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var c=f.response;if(c){if("json"==b&&"string"==typeof c)try{c=JSON.parse(c)}catch(d){D.error(d+" (parsing JSON "+
a.s+")");a.Eb(null,a.uri,a.type,a.s,a.Lb);return}a.Eb(c,a.uri,a.type,a.s,a.Lb)}else D.error("empty responce when trying to get "+a.s),a.Eb(null,a.uri,a.type,a.s,a.Lb)}else D.error(f.status+" when trying to get "+a.s),a.Eb(null,a.uri,a.type,a.s,a.Lb);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.pA(b.loaded/b.total)},!1);f.send(null)}function h(a){var b=l(),d=b&&a.s in b?new c:new XMLHttpRequest;d.open("GET",a.s,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=
a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?n.VG(b,function(b){a.Eb(b,a.uri,a.type,a.s,a.Lb);a.state=30},function(){a.Eb(null,a.uri,a.type,a.s,a.Lb);D.error("failed to decode "+a.s);a.state=30}):(a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error("empty responce when trying to get "+a.s),a.state=30)}else a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error(d.status+" when trying to get "+a.s),a.state=30};d.send(null)}function r(a){var b=document.createElement("img");q.allow_cors&&(b.crossOrigin=
"Anonymous");b.onload=function(){40!=a.state&&(a.Eb(b,a.uri,a.type,a.s,a.Lb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error("could not load image: "+a.s),a.state=30)},!1);var c=l();if(c&&a.s in c)if(c[a.s]){var d=f(a.s);b.src="data:"+d+";base64,"+c[a.s]}else J.hs()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.s}function x(a){var b=document.createElement("audio");
if(q.allow_cors||q.Nw)b.crossOrigin="Anonymous";b.addEventListener("loadeddata",function(){40!=a.state&&(a.Eb(b,a.uri,a.type,a.s,a.Lb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error("could not load sound: "+a.s),a.state=30)},!1);var c=l();if(c&&a.s in c)if(c[a.s]){var d=A(a.s);b.src="data:"+d+";base64,"+c[a.s];40!=a.state&&(a.Eb(b,a.uri,a.type,a.s,a.Lb),a.state=30)}else J.hs()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",
!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.s,q.kg&&b.load();q.Ds&&(b.autoplay=!0,b.pause());setTimeout(function(){b.RL=1},5E3)}function v(a){function b(){40!=a.state&&(a.Eb(null,a.uri,a.type,a.s),D.error("could not load video: "+a.s,a.Lb),a.state=30)}var c=document.createElement("video");c.muted=!0;if(q.allow_cors||q.kg)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.Eb(c,a.uri,a.type,a.s,a.Lb),a.state=
30)},!1);c.addEventListener("error",b,!1);var d=l();if(d&&a.s in d)if(d[a.s]){var e=F(a.s);c.src="data:"+e+";base64,"+d[a.s];40!=a.state&&c.addEventListener("loadeddata",function(){a.Eb(c,a.uri,a.type,a.s,a.Lb);a.state=30},!1)}else J.hs()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.s,q.kg&&c.load();q.Ds&&(c.autoplay=!0,c.pause());setTimeout(function(){c.RL=1},1E4)}function g(a){function b(c){a.Eb(c,a.uri,
a.type,a.s,a.Lb)}var d=l(),f=d&&a.s in d?new c:new XMLHttpRequest;f.open("GET",a.s,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var c=f.response;c?p(c,b):(a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error("empty responce when trying to get "+a.s))}else a.Eb(null,a.uri,a.type,a.s,a.Lb),D.error(f.status+" when trying to get "+a.s);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.pA(b.loaded/b.total)},
!1);f.send(null)}function p(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],hw:[],Ie:c[4]},g=20,h=0;h<e;h++){var m=c[g/4],l=new Blob([d.subarray(g+4,g+4+m)],{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(l);f.images.push(n);f.hw.push(l);g+=m+8-m%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.hw;b(f)}}function f(a){var b="image";switch(C.Ir(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function A(a){var b="audio";switch(C.Ir(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function F(a){var b="video";switch(C.Ir(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var H=t("__config"),J=t("__compat"),D=t("__print"),n=t("__sfx"),C=t("__util"),B=t("__version"),q=H.r,m=H.ye;a.wm=10;a.Jp=
20;a.Tu=30;a.Qu=40;a.xm=50;a.Ru=60;a.zm=70;a.ym=80;var w=[],d=0,I={};a.hm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.WR=function(a){if(I[a])return I[a];var b=m.Ys?a+B.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return I[a]=b;C.fa("Error XHR: responce is empty, GET "+a)}else C.fa("Error XHR: "+c.status+", GET "+a)};a.Y=
function(){for(var a=0;a<w.length;a++)w[a].state=40;w=[];d=0;I={}};a.vc=function(a,c,f,g){for(var e=0;e<a.length;e++){var h=a[e],h={uri:h[0],type:h[1],s:h[2],Lb:h[3],state:10,Eb:c||function(){},cA:f||function(){},pA:g||function(){},dA:d};if(m.Ys){var k=l();k&&h.s in k||(h.s+=B.timestamp())}w.push(h)}b(w);d++};a.update=function(){b(w);for(var a=w,c=0,d=!0,f=0;f<a.length;f++){var e=a[f];e.dA===a[c].dA?30!==e.state&&(d=!1):(d&&(a[f-1].cA(),d=f-c,a.splice(c,d),f-=d),c=f,d=30===a[f].state?!0:!1);f===a.length-
1&&d&&(a[f].cA(),a.splice(c))}}};b4w.module.__compat=function(a,t){function l(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var y=t("__config"),h=t("__extensions"),r=t("__print");
t("__util");a.bH=function(a){a.getError()==a.INVALID_ENUM&&r.warn("Possible Tegra invalid enum issue detected, ignoring")};a.qL=function(a){var v=y.gh,g=y.r,p=y.context,f=y.Mj,t=y.A,F=y.m;g.Hz=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);g.kc=a.getParameter(a.MAX_TEXTURE_SIZE);g.tj=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var H=Boolean(h.hI());l("Firefox/28.0")&&(l("Linux")||l("Macintosh"))&&(r.warn("Firefox 28 detected, applying depth hack"),H=!1);l("Windows Phone")||(l("iPad")||l("iPhone")?(r.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, applying ios depth hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),
p.alpha||(g.background_color[3]=1),g.yC=!0,g.smaa=!1,g.Re=!1,g.precision="highp",g.ez=!0,g.gz=!0):l("Mac OS X")&&l("Safari")&&!l("Chrome")&&(r.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures."),t.Zv=!0,t.Bw=!0));l("Windows")&&(l("Chrome/40")||l("Firefox/33")||l("Firefox/34")||l("Firefox/35")||l("Firefox/36"))&&(r.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),g.Cq=!0);c()&&(r.warn("Mobile detected, applying various hacks for video textures."),
g.kg=!0,l("iPad")||l("iPhone")||l("Windows Phone")||(r.warn("Mobile (not iOS) detected, disable playback rate for video textures."),t.ox=!0));(l("Firefox/35.0")||l("Firefox/36.0"))&&l("Windows")&&(r.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),g.Bx=!0);if(l("iPhone")||b()||l("Edge"))r.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),g.cm=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(r.warn("Not enough varyings, disable shadows on blend objects"),
g.nx=!0);l("Windows Phone")&&(r.warn("Windows Phone detected. Disable wireframe mode, glow materials, ssao, smaa, shadows, reflections, refractions."),g.wireframe_debug=!1,g.precision="highp",g.sf=!1,g.Re=!1,g.smaa=!1,g.Qj=!1,g.Xl=!1,g.Dc=!1,g.rA=!1);l("Firefox")&&g.kg&&(r.warn("Mobile FireFox detected, applying depth hack"),H=F.qm=!1);if(p=h.xy())l("Macintosh")&&-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(r.warn("OS X / Intel HD 3000 detected, applying depth hack"),
H=!1),-1<a.getParameter(p.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&(r.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),H=!1,v.Gx=!0),-1<a.getParameter(p.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(r.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),g.precision="highp",g.Qj=!1),-1<a.getParameter(p.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&
-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(r.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),g.precision="highp",g.Re=!1),-1<a.getParameter(p.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(r.warn("Qualcomm Adreno detected, applying shader constants hack."),g.sB=!0,-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(r.warn('Qualcomm Adreno305 detected, set "highp" precision.'),g.precision=
"highp"),-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(r.warn('Qualcomm Adreno330 detected, set "highp" precision.'),g.precision="highp")),-1<a.getParameter(p.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(p.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&(r.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),g.ur=!0),l("Windows")&&l("Chrome")&&!l("Edge")&&a.getParameter(p.UNMASKED_RENDERER_WEBGL).match(/NVIDIA GeForce 8..0/)&&(r.warn("Chrome / Windows / NVIDIA GeForce 8000 series detected, setting max cubemap size to 256."),
g.tj=256);0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(r.warn("Vertex textures are not allowed. Disabling vertex textures"),g.Xp=!1);g.allow_hidpi&&1<window.devicePixelRatio&&(r.log("%cENABLE HIDPI MODE","color: #00a"),g.render_resolution_factor=1,g.smaa=!1);H||(g.hl=!1,g.Ol=!1,g.Rb=!1,g.water_dynamic=!1,g.Cg=!1,g.ep=!1,g.smaa=!1);g.oC=Boolean(h.zy());g.Wk=H;0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision&&(g.precision="mediump");b()&&(r.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),
f.xn=512);if(b()&&l("Touch")||l("Edge"))r.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),g.Zr=!0;128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&(r.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),g.ur=!0);l("Chrome")&&!l("Edge")&&(r.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),g.Nw=!0);if(l("Chrome")&&!l("Edge")||l("Firefox"))g.gr=!0;if(b()||l("iPad"))r.warn("iPad or Internet Explorer detected. Applying alpha clip hack."),
g.Yp=!0;c()&&l("Firefox")&&(r.log("Mobile firefox detected. Applying autoplay media hack."),g.Ds=!0);l("Edge")&&(r.warn("Microsoft Edge detected, set up new minimal texture size."),g.cl=!0)};a.mx=c;a.TE=function(){l("Firefox/35.0")&&l("Windows")&&(r.warn("Windows/Firefox 35 detected, forcing context's alpha"),y.context.alpha=!0)};a.hs=b};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",
b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"pack.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},
{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_color_id",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bQ ; varying vec4 bR ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_perspective_cast_far_bound ; varying vec4 bW ; varying vec4 bX ; varying vec4 bY ; varying vec4 bZ ; uniform float u_perspective_cast_far_bound ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"vec3 tA = u_camera_eye_frag - bQ ; vec3 tB = normalize ( tA ) ; vec3 tC ; vec3 tD ; vec3 tE ; float tF ; float tG ; tz ( tB , tC , tD , tE , tF , tG ) ; float tH = tG ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"float tH = ( texture2D ( u_sampler , b_ ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float tH = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( tH < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",
a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",
a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bQ ; varying vec4 bR ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},
{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec3 wB = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",
b:["vec3","wC","=","a_normal",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 wD = vec3 ( a_tangent ) ; vec3 wE = a_tangent [ 3 ] * cross ( wC , wD ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 wD = vec3 ( 0.0 ) ; vec3 wE = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 wC = vec3 ( 0.0 ) ; vec3 wD = vec3 ( 0.0 ) ; vec3 wE = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wB = mix ( wB , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"wC = mix ( wC , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 wF = vec3 ( a_tangent ) ; vec3 wG = a_tangent_next [ 3 ] * cross ( a_normal_next , wF ) ; wD = mix ( wD , wF , u_va_frame_factor ) ; wE = mix ( wE , wG , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vD ( wB , wD , wE , wC ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["vec3","wH","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 wH = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 wI = ( u_model_matrix * vec4 ( wH , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"mat4 wJ = um ( u_camera_eye , wI , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 wJ = ug ( u_camera_eye , wI , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 wK = ( u_model_matrix * vec4 ( wH , 1.0 ) ) . xyz ; wJ = wJ * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wK ) ;".split(" ")}]}}]},
{type:"textline",b:"bh wL = ut ( wB - wH , wH , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wJ ) ; wL . b = wI ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bh wL = ut ( wB , wH , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wv ( wL . a , wL . b , wC ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec3","wM","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 wM = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"wv ( wL . a , wL . b , wM ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"b_ = uw ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bQ = wL . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",
d:5}],group:{type:"group",a:[{type:"textline",b:"bS = wL . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"float wN = ( dot ( cross ( wL . e , wL . c ) , wL . d ) < 0.0 ) ? - 1.0 : 1.0 ; bT = vec4 ( wL . c , wN ) ;".split(" ")}]}}]},{type:"textline",b:"bR = u_view_matrix * vec4 ( wL . a , 1.0 ) ; vec4 wO = u_proj_matrix * bR ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",
b:"wO . xy += u_subpixel_jitter * wO . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float wP = wO . x ; float wQ = wO . y ; float wR = wO . w ; bU . x = ( wP + wR ) / 2.0 ; bU . y = ( wQ + wR ) / 2.0 ; bU . z = wR ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"bV = - bR . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["wA","(",")",";"]}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( wL . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",
b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",
b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1},"NODES",
"ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",
file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bQ",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]}]}},{type:"else",group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",
{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1},"NODES","ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"vec3 wB = u_camera_eye_frag - bQ ; vec3 wC = normalize ( wB ) ; vec3 wD ; vec3 wE ; vec3 wF ; float wG ; float wH ; tz ( wC , wD , wE , wF , wG , wH ) ; float wI = wH ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"float wI = ( texture2D ( u_colormap0 , b_ ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float wI = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( wI < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",
d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( dT ( bR . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",
a:[{type:"textline",b:"gl_FragColor . a += 0.00001 * bT . r ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",
"ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",
{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",
d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],
group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION",
"float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bQ",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4",
"bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","float","bV",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec3 xA = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",d:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["vec3","xB","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 xB = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",
b:"vec3 xC = vec3 ( a_tangent ) ; vec3 xD = a_tangent [ 3 ] * cross ( xB , xC ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 xC = vec3 ( 0.0 ) ; vec3 xD = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"xA = mix ( xA , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"xB = mix ( xB , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 xE = vec3 ( a_tangent ) ; vec3 xF = a_tangent_next [ 3 ] * cross ( a_normal_next , xE ) ; xC = mix ( xC , xE , u_va_frame_factor ) ; xD = mix ( xD , xF , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vD ( xA , xC , xD , xB ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","xG","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 xG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",
b:"bh xH = xp ( xA , vec3 ( 0.0 ) , vec3 ( 0.0 ) , xB , xG , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 xI = ( u_model_matrix * vec4 ( xG , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["HAIR_BILLBOARD",{type:"logic_negative_expr",d:1},"SHADOW_USAGE","SHADOW_CASTING",
{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["mat4","xJ","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["mat4","xJ","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 xK = um ( u_camera_eye , xI , xJ , u_model_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 xK = ug ( u_camera_eye , xI , xJ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 xL = ( u_model_matrix * vec4 ( xG , 1.0 ) ) . xyz ; xK = xK * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , xL ) ;".split(" ")}]}}]},{type:"textline",b:"bh xH = ut ( xA - xG , xG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , xB , xK ) ; xH . b = xI ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bh xH = ut ( xA , xG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , xB , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec3","xM","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 xM = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"wv ( xH . a , xH . b , xM ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bQ = xH . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"bS = xH . e ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"float xN = ( dot ( cross ( xH . e , xH . c ) , xH . d ) < 0.0 ) ? - 1.0 : 1.0 ; bT = vec4 ( xH . c , xN ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"vec4 xO = u_view_matrix * vec4 ( xH . a , 1.0 ) ; vec4 xP = u_proj_matrix * xO ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"xP . xy += u_subpixel_jitter * xP . w ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bU = bP ( xP ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bV = - bR . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["wA","(",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"b_ = uw ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xz ( xH . a , xH . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["bR","=","xO",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 xQ = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; float xR = SHADOW_TEX_RES / 2.0 ; xQ = floor ( xQ * xR + 0.5 ) / xR - xQ ; xP . xy += xQ ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","xP",";","}"]}]};
a["grass_map.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","xA",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","xA",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","xA",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["gl_FragColor","=","xA",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( xA , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , xA ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",
a:[{type:"textline",b:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","xA",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","xA",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","xA",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",
b:"vec3 xB = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; mat4 xC = ug ( u_camera_eye , xB , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xC = xC * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"bh xD = ut ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , xC ) ; xD . b = xB ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bh xD = ut ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 xE = u_proj_matrix * u_view_matrix * vec4 ( xD . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"xA = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["xA","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["xA","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",b:["gl_Position","=","xE",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",
b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",
d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 xB ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 b_ ; varying float xC ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const int xD = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"const int xD = NUM_LINES ;".split(" ")}]}}]},{type:"textline",b:"float xF ( float xE ) { return xE - floor ( xE * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void xO ( inout float xG , in float xH [ xD ] , in float xI ) { for ( int xJ = 0 ; xJ < NUM_RINGS ; xJ ++ ) { float xK = 40.0 * xH [ xJ ] ; float xL = 300.0 * ( xF ( xK ) - 0.005 ) ; float xM = xK ; float xN = abs ( xM * ( u_halo_size * xL - xI ) ) ; xG += 1.0 - min ( xN , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void xX ( inout float xP , in float xQ [ xD ] , in float xR ) { for ( int xS = 0 ; xS < NUM_LINES ; xS ++ ) { float xT = xQ [ xS ] ; float xU = xT ; float xV = 1000.0 * ( xF ( xT ) - 0.005 ) ; float xW = 20.0 * abs ( xU * b_ . x + xV * b_ . y ) ; xP += 1.0 - min ( xW , 1.0 ) ; } xP *= xR ; }".split(" ")}]}}]},{type:"textline",b:"void yd ( inout float xY , in vec2 xZ ) { float x_ , ya ; ya = atan ( xZ . y , xZ . x ) ; ya *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float yb = cos ( ya ) ; float yc = sin ( ya ) ; ya = ( yb * xZ . x + yc * xZ . y ) * ( yb * xZ . y - yc * xZ . x ) ; x_ = abs ( ya ) ; if ( x_ < 1.0 ) { x_ = ( 0.01 * u_halo_size ) / ( x_ ) ; xY *= sqrt ( min ( x_ , 1.0 ) ) ; } } void main ( ) { float ye = ( b_ . x * b_ . x + b_ . y * b_ . y ) ; float yf = sqrt ( ye ) ; ye = max ( 1.0 - ye , 0.0 ) ; ye = pow ( ye , u_halo_hardness ) ; float yg = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float yh [ xD ] ; for ( int yi = 0 ; yi < xD ; yi ++ ) { yh [ yi ] = fract ( xC / ( float ( yi ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"float yj = 0.0 ; xO ( yj , yh , yf ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",
b:"float yk = 0.0 ; xX ( yk , yh , ye ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"yd ( ye , b_ ) ;".split(" ")}]}}]},{type:"textline",b:"ye *= yg ; vec3 yl = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"yj *= ye ; yl += u_halo_rings_color * yj ; ye += yj ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",
b:"yk *= yg ; yl += u_halo_lines_color * yk ; ye += yk ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"ye *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float ym = u_halo_stars_blend * ( xB . y - u_halo_stars_height ) ; ye *= clamp ( ym , 0.0 , 1.0 ) ; ye *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"bb ( yl ) ; be ( yl , ye ) ; gl_FragColor = vec4 ( yl , ye ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 b_ ; varying float xC ;".split(" ")},{type:"condition",a:[{type:"if",
c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","xB",";"]}]}}]},{type:"textline",b:"void main ( ) { vec3 xD = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; b_ = a_halo_bb_vertex * 2.0 ; xC = fract ( xD . x + xD . y + xD . z ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"mat4 xE = tG ( xD , u_view_matrix ) ; mat4 xF = u_view_matrix ; xF [ 3 ] [ 0 ] = 0.0 ; xF [ 3 ] [ 1 ] = 0.0 ; xF [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 xE = tG ( xD , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 xG = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; vec4 xH = xE * xG ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"vec4 xI = u_proj_matrix * xF * xH ; xI . z = 0.99999 * xI . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["xB","=","xH",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 xI = u_proj_matrix * u_view_matrix * xH ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","xI",";",
"}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 xD = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( xD , 1.0 ) ; }".split(" ")}]};
a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",
name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},
{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3",
"u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",
b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D",
"u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","bQ",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"textline",b:["varying","vec4","bR",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",
{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",
a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"nodes.glslf"},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",
b:"void main ( ) { float yx = length ( bR ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"float yy = bQ . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","yz","=","u_sun_intensity",";"]}]}}]},{type:"textline",b:"vec3 yA = normalize ( u_camera_eye_frag - bQ ) ; vec3 yB ; vec3 yC ; vec3 yD ; float yE ; float yF ; tz ( yA , yB , yC , yD , yE , yF ) ; vec3 yG = yB ; float yH = yF ; vec3 yI = yD ; float yJ = yE ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"yG = max ( yG - sqrt ( 0.01 * - min ( yy , 0.0 ) ) , 0.5 * yG ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"aY ( yG , yy , u_time , yJ , yI , u_sun_direction , yz , u_sun_quaternion , bQ , yx ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( yH <= 0.5 ) discard ; yH = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["yH","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"yw ( yG , length ( bR ) , yA , yy ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yw ( yG , length ( bR ) , yA , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 yK = texture2DProj ( u_shadow_mask , bU ) . rg ; float yL = yK . g ; yG = vec3 ( yL ) ;".split(" ")}]}}]},
{type:"textline",b:["bb","(","yG",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},"NODES_GLOW",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"be ( yG , yH ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( yG , yH ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",
b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND",
"DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},
{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",
a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",
a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",
{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","bQ",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yx",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yy",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float",
"bV",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec3 yz = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{type:"logical_and_expr",d:3},"NODES",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["vec3","yA","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 yA = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"vec3 yB = vec3 ( a_tangent ) ; vec3 yC = a_tangent [ 3 ] * cross ( yA , yB ) ;".split(" ")}]}},{type:"elif",c:["NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 yD = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 yE = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 yF = yD - u_camera_eye ; vec3 yC = cross ( yF , yE ) ; vec3 yB = cross ( yE , yC ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 yB = vec3 ( 0.0 ) ; vec3 yC = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"yz = mix ( yz , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",
b:"yA = mix ( yA , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vec3 yG = vec3 ( a_tangent ) ; vec3 yH = a_tangent_next [ 3 ] * cross ( a_normal_next , yG ) ; yB = mix ( yB , yG , u_va_frame_factor ) ; yC = mix ( yC , yH , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vD ( yz , yB , yC , yA ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","yI","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 yI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"bh yJ = xp ( yz , yB , yC , yA , yI , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 yK = ( u_model_matrix * vec4 ( yI , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 yL = um ( u_camera_eye , yK , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"mat4 yL = ug ( u_camera_eye , yK , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 yM = ( u_model_matrix * vec4 ( yI , 1.0 ) ) . xyz ; yL = yL * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , yM ) ;".split(" ")}]}}]},{type:"textline",b:"bh yJ = ut ( yz - yI , yI , yB , yC , yA , yL ) ; yJ . b = yK ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"bh yJ = ut ( yz , yI , yB , yC , yA , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float yN = ( dot ( cross ( yJ . e , yJ . c ) , yJ . d ) < 0.0 ) ? - 1.0 : 1.0 ; bT = vec4 ( yJ . c , yN ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"wv ( yJ . a , yJ . b , yA ) ;".split(" ")}]}}]},
{type:"textline",b:"bQ = yJ . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"bS = yJ . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"yx = u_camera_eye - yJ . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"b_ = uw ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"yy = yJ . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["yy","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"vec4 yO = u_view_matrix * vec4 ( yJ . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["bR","=","yO",";"]}]}}]},{type:"textline",b:"vec4 yP = u_proj_matrix * yO ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"yP . xy += u_subpixel_jitter * yP . w ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"bU = bP ( yP ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xz ( yJ . a , yJ . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE",
"NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bV = - yO . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["wA","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","yP",";","}"]}]};a["main_stack.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",
b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",
b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],
group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",
b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],
group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],
group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D",
"u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D",
"u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform",
"float","u_normal_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",
c:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"textline",b:"varying vec3 bQ ; varying vec3 bS ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS",
"CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},{type:"textline",b:["varying","vec3","yx",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yy",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],
group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",
a:[{type:"textline",b:"float Br = length ( bR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"float Bs = bQ . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","Bt","=","u_sun_intensity",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["vec2","Bu","=","b_",";"]}]}}]},{type:"textline",b:"vec3 Bv = normalize ( bS ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) Bv = Bv ; else Bv = - Bv ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vec3 Bw = cross ( Bv , bT . xyz ) * bT . w ; mat3 Bx = mat3 ( bT . xyz , Bw , Bv ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"vec2 By = normalize ( u_view_matrix_frag * vec4 ( bS , 0.0 ) ) . st ; By = By * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( Br < PARALLAX_LOD_DIST ) { float Bz = clamp ( 0.5 * ( PARALLAX_LOD_DIST - Br ) , 0.0 , 1.0 ) ; float BA = u_parallax_scale * Bz ; vec3 BB = normalize ( yx * Bx ) ; float BC = 1.0 / PARALLAX_STEPS ; vec2 BD = BB . xy * BA / ( PARALLAX_STEPS * BB . z ) ; float BE = 1.0 ; float BF ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec2","BG","=","By",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec2","BG","=","Bu",";"]}]}}]},{type:"textline",b:"BF = texture2D ( u_normalmap0 , BG ) . a ; for ( float BH = 1.0 ; BH <= PARALLAX_STEPS ; BH ++ ) { if ( BF < BE ) { BE -= BC ; BG -= BD ; BF = texture2D ( u_normalmap0 , BG ) . a ; } } vec2 BI = BG + BD ; float BJ = texture2D ( u_normalmap0 , BI ) . a - ( BE + BC ) ; float BK = BF - BE ; float BL = BK / ( BK - BJ ) ; BG = BL * BI + ( 1.0 - BL ) * BG ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"Bu += BG - By ;".split(" ")}]}}]},{type:"textline",b:["By","=","BG",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"By += BG - Bu ;".split(" ")}]}}]},{type:"textline",b:["Bu","=","BG",";"]}]}}]},
{type:"textline",b:["}"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["vec4","BM",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BM = texture2D ( u_normalmap0 , By ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"BM = texture2D ( u_normalmap0 , Bu ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 BN = BM . rgb - 0.5 ; BN = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , BN , u_normal_factor ) ; vec3 BO = Bx * BN ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","BO","=","Bv",";"]}]}}]},{type:"textline",b:"BO = normalize ( BO ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"By = normalize ( u_view_matrix_frag * vec4 ( BO , 0.0 ) ) . st ; By = By * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 BP = normalize ( yx ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 BQ = yy ; a_ ( BQ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 BR = vec4 ( BQ , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec4","BR","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["float","BS","=","1.0",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 BT = texture2D ( u_colormap0 , By ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 BT = texture2D ( u_colormap0 , Bu ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"a_ ( BT . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],
group:{type:"group",a:[{type:"textline",b:["vec4","BU",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BU = texture2D ( u_colormap1 , By ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"BU = texture2D ( u_colormap1 , Bu ) ;".split(" ")}]}}]},{type:"textline",b:"a_ ( BU . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 BV = texture2D ( u_stencil0 , By ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 BV = texture2D ( u_stencil0 , Bu ) ;".split(" ")}]}}]},{type:"textline",b:"BT = mix ( BT , BU , BV . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BR . rgb = mix ( BR . rgb , BT . rgb , u_diffuse_color_factor ) ; float BW = u_alpha_factor * BT . a ; BW += ( 1.0 - step ( 0.0 , BW ) ) ; BR . a = mix ( BW , 1.0 , u_diffuse_color . a ) ; BS = BT . a ;".split(" ")}]}},
{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BR . rgb *= mix ( vec3 ( 1.0 ) , BT . rgb , u_diffuse_color_factor ) ; BR . a = BT . a ; BS = BT . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"vec3 BX = u_diffuse_intensity * BR . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["vec3","BY","=","BX",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"vec3 BZ = u_environment_energy * ew ( BO ) ; vec3 B_ = u_ambient * BZ ; float Ca = dY ( BX ) ; vec3 Cb = u_emit * BR . rgb ; vec3 Cc = u_specular_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"vec3 Cd = vec3 ( BS ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"vec3 Cd = texture2D ( u_specmap0 , By ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Cd = texture2D ( u_specmap0 , Bu ) . rgb ;".split(" ")}]}}]},{type:"textline",b:"a_ ( Cd . rgb ) ; Cc = mix ( Cc , Cd , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"float Ce = u_specular_params [ 0 ] ; vec2 Cf = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 Cg = Ce * Cc ; vec3 BY ; vec3 Ch ; Bq ( Cb , B_ , BX , Cg , bQ , BO , BP , Cf , u_diffuse_params , Ca , 0.0 , vec4 ( 0.0 ) , BY , Ch ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"et ( BY , BP , BO , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"et ( BY , BP , BO , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["BY","+=","Ch",";"]}]}}]},{type:"textline",b:"float Ci = BR . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"BY = max ( BY - sqrt ( 0.01 * - min ( Bs , 0.0 ) ) , 0.5 * BY ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"aY ( BY , Bs , u_time , Ca , BO , u_sun_direction , Bt , u_sun_quaternion , bQ , Br ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( Ci <= 0.5 ) discard ; Ci = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],
group:{type:"group",a:[{type:"textline",b:"float Cj = max ( max ( Ch . r , Ch . g ) , Ch . b ) * u_specular_alpha ; Ci = BR . a * ( 1.0 - Cj ) + Cj ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["Ci","=","1.0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"BY = mix ( eK ( bU , BO . xz * u_refr_bump ) , BY , Ci ) ; Ci = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"yw ( BY , Br , BP , Bs ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yw ( BY , Br , BP , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["bb","(","BY",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"be ( BY , Ci ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( BY , Ci ) ; }".split(" ")}]};a["main_stack.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute",
"vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],
group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",
b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1},"BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},
{type:"textline",b:["varying","vec3","bQ",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO",
"PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bT",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","yx",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yy",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bW",";"]},{type:"condition",
a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",
d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},
{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec3 Br = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"NODES",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",
b:["vec3","Bs","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Bs = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Bt = vec3 ( a_tangent ) ; vec3 Bu = a_tangent [ 3 ] * cross ( Bs , Bt ) ;".split(" ")}]}},{type:"elif",
c:["NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Bv = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 Bw = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 Bx = Bv - u_camera_eye ; vec3 Bu = cross ( Bx , Bw ) ; vec3 Bt = cross ( Bw , Bu ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Bt = vec3 ( 0.0 ) ; vec3 Bu = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"Br = mix ( Br , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"Bs = mix ( Bs , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vec3 By = vec3 ( a_tangent ) ; vec3 Bz = a_tangent_next [ 3 ] * cross ( a_normal_next , By ) ; Bt = mix ( Bt , By , u_va_frame_factor ) ; Bu = mix ( Bu , Bz , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vD ( Br , Bt , Bu , Bs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",
d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","BA","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 BA = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"bh BB = xp ( Br , Bt , Bu , Bs , BA , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 BC = ( u_model_matrix * vec4 ( BA , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 BD = um ( u_camera_eye , BC , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 BD = ug ( u_camera_eye , BC , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 BE = ( u_model_matrix * vec4 ( BA , 1.0 ) ) . xyz ; BD = BD * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , BE ) ;".split(" ")}]}}]},{type:"textline",b:"bh BB = ut ( Br - BA , BA , Bt , Bu , Bs , BD ) ; BB . b = BC ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bh BB = ut ( Br , BA , Bt , Bu , Bs , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float BF = ( dot ( cross ( BB . e , BB . c ) , BB . d ) < 0.0 ) ? - 1.0 : 1.0 ; bT = vec4 ( BB . c , BF ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"wv ( BB . a , BB . b , Bs ) ;".split(" ")}]}}]},{type:"textline",b:"bQ = BB . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"bS = BB . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"yx = u_camera_eye - BB . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",
b:"b_ = uw ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"yy = BB . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["yy","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"vec4 BG = u_view_matrix * vec4 ( BB . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["bR","=","BG",";"]}]}}]},{type:"textline",b:"vec4 BH = u_proj_matrix * BG ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"BH . xy += u_subpixel_jitter * BH . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE",
"SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"bU = bP ( BH ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xz ( BB . a , BB . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bV = - BG . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["wA","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","BH",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",
a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec2 u_texel_size ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"varying float Br ; varying vec3 yy ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"varying vec4 bR ; varying vec3 bU ; varying float Bs ;".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec2 Bt = gl_PointCoord - 0.5 ; float Bu = 2.0 * length ( Bt ) ; float Bv = smoothstep ( u_p_alpha_start , u_p_alpha_end , Bu ) ; float Bw = u_diffuse_color . a * Br * ( 1.0 - Bv ) ; vec3 Bx = yy * u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",
a:[{type:"textline",b:"vec2 By = bU . xy / bU . z ; vec2 Bz = vec2 ( Bt . x , - Bt . y ) * Bs * u_texel_size ; vec2 BA = vec2 ( By + Bz ) ; vec4 BB = texture2D ( u_scene_depth , BA ) ; float BC = l ( BB ) ; float BD = - bR . z / u_view_max_depth ; float BE = BC - BD ; float BF = u_view_max_depth / SOFT_STRENGTH * BE ; Bw = Bw * min ( BF , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["bb","(","Bx",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"be ( Bx , Bw ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( Bx , Bw ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float Br ; varying vec3 yy ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"varying vec4 bR ; varying vec3 bU ; varying float Bs ;".split(" ")}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { Bt Ci ; Ci = Ch ( ) ; vec4 Cj = u_view_matrix * vec4 ( Ci . b , 1.0 ) ; vec4 Ck = u_proj_matrix * Cj ; gl_Position = Ck ; Br = Ci . c ; yy = Ci . d ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["bR","=","Cj",";"]}]}}]},{type:"textline",b:"float Cl = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; float Cm = Ci . a * Cl ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"float Cn = Ck . x ; float Co = Ck . y ; float Cp = Ck . w ; bU . x = ( Cn + Cp ) / 2.0 ; bU . y = ( Co + Cp ) / 2.0 ; bU . z = Cp ; Bs = Cm ;".split(" ")}]}}]},
{type:"textline",b:["gl_PointSize","=","Cm",";","}"]}]};a["particles_texture.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",
file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",
";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",
";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float Br ; varying vec3 yy ; varying vec2 b_ ; varying vec3 bQ ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1},"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yx",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],
group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec4 Ci = u_diffuse_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"vec4 Cj = texture2D ( u_sampler , b_ ) ; a_ ( Cj . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ci . rgb = mix ( Ci . rgb , Cj . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"Ci . rgb *= mix ( vec3 ( 1.0 ) , Cj . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"Ci . a = Cj . a ;".split(" ")}]}}]},{type:"textline",b:"Ci . rgb *= yy ; vec3 Ck = u_diffuse_intensity * Ci . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1},"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Cl = normalize ( yx ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec3 Cm = u_emit * Ci . rgb ; vec3 Cn = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logic_negative_expr",d:1},"SKY_COLOR",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec3 Co = u_environment_energy * ew ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"vec3 Co = u_environment_energy * ew ( Cn ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Cp = u_ambient * Co ; float Cq = u_specular_params [ 0 ] ; vec2 Cr = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 Cs = Cq * u_specular_color ; vec3 Ct ; vec3 Cu ; Bq ( Cm , Cp , Ck , Cs , bQ , Cn , Cl , Cr , u_diffuse_params , 1.0 , 0.0 , vec4 ( 0.0 ) , Ct , Cu ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","Ct","=","Ck",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"yw ( Ct , length ( bR ) , Cl , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"float Cv = Ci . a * Br ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"float Cw = - bR . z / u_view_max_depth ; vec4 Cx = texture2DProj ( u_scene_depth , bU ) ; float Cy = l ( Cx ) ; float Cz = Cy - Cw ; float CA = u_view_max_depth / SOFT_STRENGTH * Cz ; Cv = Cv * min ( CA , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["bb","(","Ct",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"be ( Ct , Cv ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( Ct , Cv ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",
file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform vec3 u_wind ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float Br ; varying vec3 yy ; varying vec2 b_ ; varying vec3 yx ; varying vec3 bQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bR",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float Ck ( vec2 Ci , vec2 Cj ) { return ( atan ( Cj . y , Cj . x ) - atan ( Ci . y , Ci . x ) ) ; } void main ( ) { Bt Cl ; Cl = Ch ( ) ; float Cm ; mat4 Cn ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { Cm = Cl . e ; Cn = tG ( Cl . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { Cm = Cl . e ; Cn = bB ( ) ; Cn [ 3 ] = vec4 ( Cl . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { Cm = Cl . e ; Cn = bF ( radians ( 90.0 ) ) ; Cn [ 3 ] = vec4 ( Cl . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { Cm = Ck ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + Cl . e ; Cn = bD ( radians ( - 90.0 ) ) ; Cn [ 3 ] = vec4 ( Cl . b , 1.0 ) ; } vec4 Co = vec4 ( a_p_bb_vertex * 2.0 * Cl . a * u_p_size , 0.0 , 1.0 ) ; vec4 Cp = Cn * bH ( Cm ) * Co ; vec4 Cq = u_view_matrix * Cp ; vec4 Cr = u_proj_matrix * Cq ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"float Cs = Cr . x ; float Ct = Cr . y ; float Cu = Cr . w ; bU . x = ( Cs + Cu ) / 2.0 ; bU . y = ( Ct + Cu ) / 2.0 ; bU . z = Cu ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = Cr ; Br = Cl . c ; yy = Cl . d ; b_ = a_p_bb_vertex + 0.5 ; bQ = Cp . xyz ; yx = u_camera_eye - Cp . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["bR","=","Cq",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 Ci ; const float Cj = 0.99 ; const float Ck = 1.8 ; const int Cl = 8 ; float Cv ( vec3 Cm , vec3 Cn ) { float Co = dot ( Cn , Cn ) ; float Cp = 2.0 * dot ( Cn , Cm ) ; float Cq = dot ( Cm , Cm ) - 1.0 ; float Cr = Cp * Cp - 4.0 * Co * Cq ; float Cs = sqrt ( Cr ) ; float Ct = ( - Cp - Cs ) / 2.0 ; float Cu = Cq / Ct ; return Cu ; } float CC ( float Cw , float Cx ) { float Cy = 3.0 * ( 1.0 - Cx * Cx ) ; float Cz = 2.0 * ( 2.0 + Cx * Cx ) ; float CA = 1.0 + Cw * Cw ; float CB = pow ( 1.0 + Cx * Cx - 2.0 * Cx * Cw , 1.5 ) ; CB = max ( CB , 0.00001 ) ; return ( Cy / Cz ) * ( CA / CB ) ; } float CK ( vec3 CD , vec3 CE , float CF ) { float CG = dot ( CE , - CD ) ; if ( CG < 0.0 ) { return 1.0 ; } vec3 CH = CD + CG * CE ; if ( length ( CH ) < CF ) { return 0.0 ; } else if ( length ( CH ) >= CF ) { vec3 CI = normalize ( CH ) * CF - CD ; float CJ = acos ( dot ( normalize ( CI ) , CE ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( CJ * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 CO ( float CL , vec3 CM , float CN ) { return CM - CM * pow ( u_sky_color , vec3 ( CN / CL ) ) ; } void main ( ) { vec3 CP = normalize ( Ci ) ; vec3 CQ = u_sun_direction ; float CR = dot ( CP , CQ ) ; float CS = CC ( CR , - 0.01 ) * u_rayleigh_brightness * CQ . y ; float CT = CC ( CR - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - CQ . y ) ; float CU = smoothstep ( 0.0 , 100.0 , CC ( CR , 0.9995 ) ) * u_spot_brightness ; vec3 CV = vec3 ( 0.0 , Cj , 0.0 ) ; float CW = Cv ( CV , CP ) ; float CX = CW / float ( Cl ) ; float CY = CK ( CV , CP , Cj - 0.3 ) ; vec3 CZ = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 C_ = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int Da = 0 ; Da < Cl ; Da ++ ) { float Db = CX * float ( Da ) ; vec3 Dc = CV + CP * Db ; float Dd = CK ( Dc , CQ , Cj - 0.2 ) ; float De = Cv ( Dc , CQ ) ; vec3 Df = CO ( De , vec3 ( Ck ) , u_scatter_strength ) * Dd ; CZ += CO ( sqrt ( Db ) , u_sky_color * Df , u_rayleigh_strength ) ; C_ += CO ( Db , Df , u_mie_strength ) ; } CZ = CZ * CY * pow ( CW , u_rayleigh_collection_power ) / float ( Cl ) ; C_ = ( C_ * CY * pow ( CW , u_mie_collection_power ) ) / float ( Cl ) ; vec3 Dg = vec3 ( CU * C_ + CT * C_ + CS * CZ ) ; bb ( Dg ) ; gl_FragColor = vec4 ( Dg , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 Ci ; void main ( ) { vec4 Cj = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 Ck = u_cube_view_matrix * Cj ; Ci = Ck . xyz ; gl_Position = Cj ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 b_ ; void main ( ) { vec4 Cj = texture2D ( u_sampler , b_ ) ; bb ( Cj . rgb ) ; be ( Cj . rgb , Cj . a ) ; gl_FragColor = Cj ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 b_ ; void main ( ) { b_ = a_texcoord ; vec3 Cj = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 Ck = u_proj_matrix * u_view_matrix * vec4 ( Cj , 0.0 ) ; Ck . x /= Ck . w ; Ck . y /= Ck . w ; Ck += 99999.0 * step ( Ck . z , 0.0 ) ; Ck += 100.0 * ( step ( 1.0 , abs ( Ck . x ) ) + step ( 1.0 , abs ( Ck . y ) ) ) ; Ck . x = - a_lf_dist * Ck . x ; Ck . y = - a_lf_dist * Ck . y ; float Cl = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 Cm = vec2 ( a_lf_bb_vertex . x / Cl , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float Cn = 1.9 ; Cm *= ( 1.0 + Cn * length ( Ck . xy ) ) ; } gl_Position = vec4 ( Ck . xy + Cm , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 Et ( vec3 Eo , vec3 Ep , float Eq , float Er ) { float Es = Eq * Er ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CB ( Ep , Eo , Es ) ;".split(" ")}]}},{type:"elif",
c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CF ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CJ ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CO ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"return CT ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CY ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Db ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Df ( Eo , Ep , Es ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Dj ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Dn ( Eo , Ep , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","HUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Du ( Ep , Eo , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SATURATION",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"return DA ( Ep , Eo , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","VALUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DG ( Ep , Eo , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","COLOR",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DN ( Ep , Eo , Es ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DS ( Ep , Eo , Es ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DW ( Ep , Eo , Es ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float EB ( float Eu , float Ev , float Ew , float Ex ) { vec3 Ey = vec3 ( Eu ) , Ez = vec3 ( Ev ) ; float EA = Ew * Ex ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CB ( Ez , Ey , EA ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CF ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return CJ ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Eb ( Eu , Ev , EA , Ex ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Eh ( Eu , Ev , EA , Ex ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return En ( Eu , Ev , EA , Ex ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Db ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"return Df ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Dj ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Dn ( Ey , Ez , EA ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DS ( Ez , Ey , EA ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return DW ( Ez , Ey , EA ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",
d:1},"REFLECTION_PASS",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","Ci",";"]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"textline",b:"void main ( ) { vec3 EC ; vec3 ED = normalize ( Ci ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"EC = textureCube ( u_sky , ED ) . rgb ;".split(" ")}]}},{type:"elif",c:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"EC = u_horizon_color ; bb ( EC ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","EE",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"EE = vec3 ( b_ , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"EE = vec3 ( Ci . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["float","EF","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"EF = abs ( b_ . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"EF = ( b_ . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float EG = acos ( ED . y ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"EF = abs ( EG * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"EF = 1.0 - EG * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"vec3 EH = u_horizon_color ; vec3 EI = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"float EJ = 1.0 ; vec4 EK = textureCube ( u_sky , ED ) ; a_ ( EK . rgb ) ; EJ = EK . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"EJ = dot ( EK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"EK = vec4 ( vec3 ( 1.0 ) - EK . rgb , EK . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"EJ = 1.0 - EJ ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"EK = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"EJ = EK . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"EH = Et ( EK . rgb , EH , EJ , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:["float","EL","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( EE , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"EL = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",
b:"else EL = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"EL = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"EL = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( EL != 0.0 ) EI = Et ( EK . rgb , EI , EJ , EL ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_BLEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"EJ = dot ( EK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"EF = EB ( u_sky_tex_dvar , EF , EJ , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"EC = mix ( EH , EI , EF ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["EC","=","EH",";"]}]}}]},{type:"textline",b:["bb","(","EC",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bb ( EH ) ; bb ( EI ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"EC = mix ( EH , EI , EF ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["EC","=","EH",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"REFLECTION_PASS",
{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"a_ ( EC ) ; float EM = u_camera_eye_frag . y - WATER_LEVEL ; EM = min ( - EM * 0.03 , 0.8 ) ; float EN = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; vec3 EO = vec3 ( 0.0 ) ; vec4 EP = u_underwater_fog_color_density ; EP . rgb = mix ( EP . rgb , EO , min ( - ED . y + EM , 1.0 ) ) * EN ; float EQ = clamp ( sign ( ED . y - 0.05 * EM ) , 0.0 , 1.0 ) ; EC = mix ( EP . rgb , EC , EQ ) ; bb ( EC ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( EC , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 Ci ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 Eo = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 Ep = u_sky_vp_inverse * Eo ; Ci = Ep . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"b_ = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","Eo",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",
b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2",
"u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float Eo = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 yx ; varying vec3 bQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH",
{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bT ; varying vec3 Ep ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bS",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Eq",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Er",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",
d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Es",";"]}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",b:"vec3 EG ( in vec2 Et , in vec3 Eu , in vec3 Ev , in vec3 Ew , out float Ex ) { Ex = 0.0 ; vec3 Ey = reflect ( - Ev , Eu ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Ez = Et . xy + Eu . xz * REFL_BUMP / bV ; Ex = u_reflect_factor ; vec3 EA ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EA = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"EA = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"} else { EA = texture2D ( u_plane_reflection , Ez ) . rgb ; a_ ( EA ) ; }".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ex = u_mirror_factor ; vec3 EA = Ew * textureCube ( u_mirrormap , Ey ) . rgb ; a_ ( EA ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ex = u_reflect_factor ; vec3 EA = Ew * vec3 ( 0.3 , 0.5 , 1.0 ) ; a_ ( EA ) ;".split(" ")}]}}]},
{type:"textline",b:"vec3 EB = normalize ( Ey + Ev ) ; float EC = 1.0 - dot ( Ev , EB ) ; float ED = u_fresnel_params [ 3 ] ; float EE = u_fresnel_params [ 2 ] ; float EF = ED + ( 1.0 - ED ) * pow ( EC , EE ) ; Ex = min ( Ex * EF , 1.0 ) ; return EA ; }".split(" ")},{type:"include",file:"lighting_nodes.glslf"},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat3 EH = mat3 ( bT , Ep , bS ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"vec3 EI = normalize ( bS ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 EI = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","FOAM",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float EJ = bQ . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",
{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"vec2 EK = vec2 ( Eq . x , - Eq . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec2 EK = vec2 ( bQ . x , - bQ . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec2","EK","=","b_",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 EL = vec3 ( 0.0 ) ; vec3 EM = texture2D ( u_normalmap0 , EK * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; EL += EM ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"vec3 EN = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORM_FOAM0"],group:{type:"group",a:[{type:"textline",b:["EN",
"+=","EM",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EM = texture2D ( u_normalmap0 , EK * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; EL += EM ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM1"],group:{type:"group",a:[{type:"textline",b:["EN","+=","EM",";"]}]}}]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EM = texture2D ( u_normalmap0 , EK * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; EL += EM ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["EN","+=","EM",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,
{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EM = texture2D ( u_normalmap0 , EK * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; EL += EM ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM3"],group:{type:"group",a:[{type:"textline",b:["EN","+=","EM",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"vec3 EO = EH * EN ; if ( ! bk ( EO , vec3 ( 0.0 ) ) ) EO = normalize ( EO ) ; vec3 EP = mix ( EI , EO , 0.2 ) ; EP = normalize ( EP ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"EI = mix ( EI , normalize ( EH * EL ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"EI = mix ( EI , normalize ( EH * EL ) , 0.5 ) ;".split(" ")}]}}]},
{type:"textline",b:"EI = normalize ( EI ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 EQ = normalize ( yx ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 ER = bU . xy / bU . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"float ES = bV * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"float ET = u_diffuse_color . a ; vec4 EU = texture2DProj ( u_scene_depth , bU ) ; float EV = l ( EU ) ; float EW = max ( EV - bV , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"vec2 EX = ER + EI . xz * u_refr_bump / bV ; float EY = eC ( EV , EX , ER ) ; float EZ = max ( EY - bV , 0.0 ) ; float E_ = u_view_max_depth / ABSORB * EZ ; float Fa ; if ( u_cam_water_depth < 0.0 ) Fa = 0.0 ; else Fa = min ( ET * E_ , 1.0 ) ; float Fb = u_view_max_depth / ABSORB * EW ; ET = min ( 15.0 * ET * u_view_max_depth * EW , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"float Fb = u_view_max_depth / ABSORB * EW ; if ( u_cam_water_depth > 0.0 ) ET = min ( ET * Fb , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"ET *= min ( 5.0 * ES , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float ET = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"float Fa = 1.0 - ET ; vec2 EX = ER + EI . xz * u_refr_bump / bV ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"vec3 Fc = texture2D ( u_refractmap , EX ) . rgb ; a_ ( Fc ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"float Fd = pow ( min ( Er . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 Fe = mix ( u_shallow_water_col , u_diffuse_color . rgb , Fd ) ; Fd = pow ( min ( Er . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; Fe = mix ( u_shore_water_col , Fe , Fd ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Fe = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"float Ff = max ( 1.0 - u_view_max_depth * EW , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float Ff = 1.0 - ET ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",
a:[{type:"textline",b:"float Fg = max ( EJ / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 Fh = normalize ( vec3 ( Er . r , 0.0 , Er . g ) ) ; vec3 Fi = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , Fh , 0.8 ) ) ; float Fj = 1.25 * max ( dot ( EP , Fi ) - 0.2 , 0.0 ) ; Fj += max ( dot ( EP , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; Ff += Fj * ( 1.0 - Er . b ) ; Fg *= ( 1.0 - 0.95 * pow ( Er . b , 0.1 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"Ff += Fg ; Ff = min ( u_foam_factor * Ff , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 Fk = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + EK * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"float Fl = u_specular_params [ 0 ] ; vec2 Fm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 Fn = Fl * u_specular_color ; vec3 Fo = u_environment_energy * ew ( EI ) ; vec3 Fp = u_ambient * Fo ; vec3 Fq = Fp + u_sun_intensity ; float Fr ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Fs = EG ( ER , EI , EQ , Fq , Fr ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Fs = EG ( vec2 ( 0.0 ) , EI , EQ , Fq , Fr ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Ft = u_diffuse_intensity * Fe ; vec3 Fu ; vec3 Fv ; Bq ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ft , Fn , bQ , EI , EQ , Fm , u_diffuse_params , 1.0 , 0.0 , vec4 ( 0.0 ) , Fu , Fv ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"float Fw = max ( dot ( u_sun_direction , - bS ) + SSS_WIDTH , 0.0 ) * max ( dot ( - EQ , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; Fw = clamp ( SSS_STRENGTH * Fw , 0.0 , 1.0 ) ; Fu = mix ( Fu , u_shallow_water_col , Fw ) ; Fu = mix ( Fu , u_shore_water_col , Fw ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",
b:"Fu = mix ( Fc , Fu , Fa ) ;".split(" ")}]}}]},{type:"textline",b:"Fu = mix ( Fu , Fs , Fr ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"float Fx = mix ( Fk . g , Fk . r , max ( 4.0 * ( Ff - 0.75 ) , 0.0 ) ) ; Fx = mix ( Fk . b , Fx , max ( 2.0 * Ff - 1.0 , 0.0 ) ) ; Fx = mix ( 0.0 , Fx , Ff ) ; Fu = mix ( Fu , Fq , Fx ) ;".split(" ")}]}}]},{type:"textline",b:["Fu","+=","Fv",";"]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { yp ( Fu , ES , u_cam_water_depth ) ; } else { yw ( Fu , ES , EQ , 1.0 ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yw ( Fu , ES , EQ , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["bb","(","Fu",")",";"]},{type:"condition",a:[{type:"if",c:["REFRACTIVE",{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"textline",b:"ET = max ( ET , Fv . r ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["ET","+=","Fx",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"be ( Fu , ET ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"vec3 Fy = fwidth ( Es ) ; vec3 Fz = smoothstep ( vec3 ( 0.0 ) , Fy * Eo , Es ) ; float FA = min ( min ( Fz . x , Fz . y ) , Fz . z ) ; FA = clamp ( FA , 0.0 , 1.0 ) ; Fu = mix ( u_wireframe_edge_color , Fu , FA ) ; ET = mix ( 1.0 , ET , FA ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( Fu , ET ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"DYNAMIC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["GENERATED_MESH",{type:"logic_negative_expr",d:1},"NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",
"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 yx ; varying vec3 bQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},
"GENERATED_MESH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","b_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bT ; varying vec3 Ep ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3",
"bS",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Eq",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Er",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",
{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","bV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Es",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 Ey ( in vec2 Eo ) { vec2 Et = 0.5 + vec2 ( ( Eo . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( Eo . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 Eu = texture2D ( u_shore_dist_map , Et ) ; const vec2 Ev = vec2 ( 1.0 / 255.0 , 1.0 ) ; float Ew = dot ( Eu . ba , Ev ) ; vec2 Ex = normalize ( Eu . rg * 2.0 - 1.0 ) ; return vec3 ( Ex , Ew ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void EP ( inout vec3 Ez , in float EA , in vec3 EB ) { float EC = au ( DST_NOISE_SCALE_0 * ( Ez . xz + DST_NOISE_FREQ_0 * EA ) ) * au ( DST_NOISE_SCALE_1 * ( Ez . zx - DST_NOISE_FREQ_1 * EA ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"float ED = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float EE = EB . b ; float EF = sqrt ( EE ) ; float EG = max ( EE , DIR_MIN_SHR_FAC ) * sin ( EF / ED + DIR_FREQ * EA ) ; float EH = max ( au ( DIR_NOISE_SCALE * ( Ez . xz + DIR_NOISE_FREQ * EA ) ) , DIR_MIN_NOISE_FAC ) ; EG *= EH ; float EI = WAVES_HEIGHT * mix ( EG , EC , max ( EF , DST_MIN_FAC ) ) ; vec2 EJ = EB . rg ; float EK = WAVES_HOR_FAC * EG * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - EE ) , 0.0 ) ; vec2 EL = EK * EJ ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"float EI = WAVES_HEIGHT * EC ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"vec2 EM = 2.0 * ( Ez . xz - 0.1 * EA ) ; vec2 EN = 1.3 * ( Ez . zx + 0.03 * EA ) ; float EO = Q ( 0.5 * EM ) . x + Q ( 0.5 * EN ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Ez . xz += EL ; EO *= EE ;".split(" ")}]}}]},{type:"textline",
b:"EI += SMALL_WAVES_FAC * EO ;".split(" ")}]}}]},{type:"textline",b:"Ez . y += EI ; }".split(" ")}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) Es = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) Es = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) Es = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["vec3","EQ","=","a_position",
";"]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"float ER = abs ( EQ . y ) ; vec2 ES = u_camera_eye . xz - mod ( u_camera_eye . xz , ER ) ; EQ . y = WATER_LEVEL ; EQ . xz += ES ;".split(" ")}]}},{type:"elif",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["b_","=","a_texcoord",";"]}]}}]},{type:"textline",b:"bh ET = ut ( EQ , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Er = Ey ( ET . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"float EU = length ( u_wind ) ; float EV = u_time ; EV *= EU ;".split(" ")},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"float EW = ER ; vec3 EX = ET . a + vec3 ( EW , 0.0 , 0.0 ) ; vec3 EY = ET . a + vec3 ( 0.0 , 0.0 , EW ) ; if ( a_position . y < 0.0 ) { ET . a . y = WATER_LEVEL - 1.0 ; EX . y = ET . a . y ; EY . y = ET . a . y ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Eq = ET . a ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 EX = ET . a + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 EY = ET . a + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 EZ = Ey ( EX . xz ) ; vec3 E_ = Ey ( EY . xz ) ; EP ( EX , EV , EZ ) ; EP ( EY , EV , E_ ) ; EP ( ET . a , EV , Er ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"EP ( EX , EV , vec3 ( 0.0 ) ) ; EP ( EY , EV , vec3 ( 0.0 ) ) ; EP ( ET . a , EV , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Fa = normalize ( EX - ET . a ) ; vec3 Fb = normalize ( EY - ET . a ) ; bS = normalize ( cross ( Fb , Fa ) ) ; float Fc = dot ( bS , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float Fd = clamp ( 0.8 - Fc , 0.0 , 1.0 ) ; bS = mix ( bS , vec3 ( 0.0 , 1.0 , 0.0 ) , Fd ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec3 Fb = a_tangent ; bS = a_normal ;".split(" ")}]}}]},{type:"textline",b:"bT = Fb ; Ep = cross ( bS , bT ) ;".split(" ")}]}}]},{type:"textline",b:"bQ = ET . a ; yx = u_camera_eye - ET . a ; vec4 Fe = u_view_matrix * vec4 ( ET . a , 1.0 ) ; vec4 Ff = u_proj_matrix * Fe ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"float Fg = Ff . x ; float Fh = Ff . y ; float Fi = Ff . w ; bU . x = ( Fg + Fi ) / 2.0 ; bU . y = ( Fh + Fi ) / 2.0 ; bU . z = Fi ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",
d:4}],group:{type:"group",a:[{type:"textline",b:"bV = - Fe . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","Ff",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",name:"WM_NONE",b:["0"]},{type:"define",name:"WM_OPAQUE_WIREFRAME",b:["1"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["2"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["3"]},{type:"define",name:"WM_DEBUG_SPHERES",b:["4"]},{type:"include",file:"precision_statement.glslf"},{type:"include",
file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 Es ; const float Eo = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 Et = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 Et = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 Eu = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 Ev = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 Ew = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec3 Ex = vec3 ( 0.0 ) ; float Ey = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",
b:"vec3 Ez = sign ( Es - vec3 ( 0.02 * Eo ) ) ; if ( Ez . x < 0.0 || Ez . y < 0.0 || Ez . z < 0.0 ) { Ex = Et ; Ey = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",c:["WIREFRAME_QUALITY",0,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Ez = sign ( Es - vec3 ( 0.02 * Eo ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( Ez . x < 0.0 || Ez . y < 0.0 || Ez . z < 0.0 ) Ex = u_wireframe_edge_color ; else Ex = Ew ; Ey = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( Ez . x < 0.0 || Ez . y < 0.0 || Ez . z < 0.0 ) Ey = 1.0 ; else Ey = 0.0 ; Ex = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( Ez . x < 0.0 || Ez . y < 0.0 || Ez . z < 0.0 ) Ex = u_wireframe_edge_color ; else if ( gl_FrontFacing ) Ex = Eu ; else Ex = Ev ; Ey = 1.0 ; }".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY",1,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"vec3 EA = fwidth ( Es ) ; vec3 EB = smoothstep ( vec3 ( 0.0 ) , EA * Eo , Es ) ; float EC = min ( min ( EB . x , EB . y ) , EB . z ) ; EC = clamp ( EC , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { Ex = vec3 ( mix ( u_wireframe_edge_color , Ew , EC ) ) ; Ey = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { Ex = u_wireframe_edge_color ; Ey = mix ( 1.0 , 0.0 , EC ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) Ex = mix ( u_wireframe_edge_color , Eu , EC ) ; else Ex = mix ( u_wireframe_edge_color , Ev , EC ) ; Ey = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["bb","(","Ex",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"be ( Ex , Ey ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( Ex , Ey ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",b:["varying","vec3","Es",";"]},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { if ( a_polyindex == 0.0 ) Es = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) Es = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) Es = vec3 ( 0.0 , 0.0 , 1.0 ) ; vec3 Eo = a_position ; vec3 Et = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"bh Eu = ut ( Eo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"Eo = mix ( Eo , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vec3 Ev = vec3 ( 0.0 ) ; vec3 Ew = vec3 ( 0.0 ) ; vD ( Eo , Ev , Ew , Et ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vec3","Ex","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Ex = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"bh Eu = xp ( Eo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ex , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 Ey = ( u_model_matrix * vec4 ( Ex , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 Ez = um ( u_camera_eye , Ey , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"mat4 Ez = ug ( u_camera_eye , Ey , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 EA = ( u_model_matrix * vec4 ( Ex , 1.0 ) ) . xyz ; Ez = Ez * tW ( u_wind , u_time , u_jitter_amp , u_jitter_freq , EA ) ;".split(" ")}]}}]},{type:"textline",b:"bh Eu = ut ( Eo - Ex , Ex , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ez ) ; Eu . b = Ey ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bh Eu = ut ( Eo , Ex , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"wv ( Eu . a , Eu . b , Et ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"vec4 EB = u_view_matrix * vec4 ( Eu . a , 1.0 ) ; gl_Position = u_proj_matrix * EB ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},
{type:"textline",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_sampler_left , b_ ) ; vec4 Et = texture2D ( u_sampler_right , b_ ) ; gl_FragColor = vec4 ( Eo [ 0 ] , Et [ 1 ] , Et [ 2 ] , Eo [ 3 ] + Et [ 3 ] ) ; }".split(" ")}]};a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"AA_METHOD_PASS",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_LIGHT",
b:["2"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["3"]},{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 b_ ; vec4 Ev ( float Eo , float Et ) { vec2 Eu = b_ + vec2 ( Eo , Et ) * u_texel_size ; return texture2D ( u_color , Eu ) ; } float Ez ( vec4 Ew ) { vec3 Ex = vec3 ( 0.299 , 0.587 , 0.114 ) ; float Ey = dot ( Ew . rgb , Ex ) ; return Ey ; } vec4 ES ( ) { vec4 EA = Ev ( - 1.0 , - 1.0 ) ; vec4 EB = Ev ( 1.0 , - 1.0 ) ; vec4 EC = Ev ( - 1.0 , 1.0 ) ; vec4 ED = Ev ( 1.0 , 1.0 ) ; vec4 EE = Ev ( 0.0 , 0.0 ) ; float EF = Ez ( EA ) ; float EG = Ez ( EB ) ; float EH = Ez ( EC ) ; float EI = Ez ( ED ) ; float EJ = Ez ( EE ) ; float EK = min ( EJ , min ( min ( EF , EG ) , min ( EH , EI ) ) ) ; float EL = max ( EJ , max ( max ( EF , EG ) , max ( EH , EI ) ) ) ; vec2 EM ; EM . x = - ( ( EF + EG ) - ( EH + EI ) ) ; EM . y = ( ( EF + EH ) - ( EG + EI ) ) ; float EN = max ( ( EF + EG + EH + EI ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float EO = 1.0 / ( min ( abs ( EM . x ) , abs ( EM . y ) ) + EN ) ; EM = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , EM * EO ) ) * u_texel_size ; vec4 EP = 0.5 * ( texture2D ( u_color , b_ + EM * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , b_ + EM * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 EQ = EP * 0.5 + 0.25 * ( texture2D ( u_color , b_ + EM * - 0.5 ) + texture2D ( u_color , b_ + EM * 0.5 ) ) ; float ER = Ez ( EQ ) ; if ( ( ER < EK ) || ( ER > EL ) ) return EP ; else return EQ ; }".split(" ")},
{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["(","1.0","/","6.0",")"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["(","1.0","/","12.0",")"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["(","3.0","/","4.0",")"]},{type:"textline",b:"vec4 GD ( ) { vec2 ET ; ET . x = b_ . x ; ET . y = b_ . y ; vec4 EU = texture2D ( u_color , ET ) ; vec4 EV = Ev ( 0.0 , 1.0 ) ; vec4 EW = Ev ( 1.0 , 0.0 ) ; vec4 EX = Ev ( 0.0 , - 1.0 ) ; vec4 EY = Ev ( - 1.0 , 0.0 ) ; float EZ = Ez ( EV ) ; float E_ = Ez ( EW ) ; float Fa = Ez ( EX ) ; float Fb = Ez ( EY ) ; float Fc = Ez ( EU ) ; float Fd = max ( EZ , Fc ) ; float Fe = min ( EZ , Fc ) ; float Ff = max ( E_ , Fd ) ; float Fg = min ( E_ , Fe ) ; float Fh = max ( Fa , Fb ) ; float Fi = min ( Fa , Fb ) ; float Fj = max ( Fh , Ff ) ; float Fk = min ( Fi , Fg ) ; float Fl = Fj * FXAA_QUALITY_EDGE_THRESHOLD ; float Fm = Fj - Fk ; float Fn = max ( FXAA_QUALITY_EDGE_THRESHOLD_MIN , Fl ) ; bool Fo = Fm < Fn ; if ( Fo ) return EU ; vec4 Fp = Ev ( - 1.0 , - 1.0 ) ; vec4 Fq = Ev ( 1.0 , 1.0 ) ; vec4 Fr = Ev ( 1.0 , - 1.0 ) ; vec4 Fs = Ev ( - 1.0 , 1.0 ) ; float Ft = Ez ( Fp ) ; float Fu = Ez ( Fq ) ; float Fv = Ez ( Fr ) ; float Fw = Ez ( Fs ) ; float Fx = Fa + EZ ; float Fy = Fb + E_ ; float Fz = 1.0 / Fm ; float FA = Fx + Fy ; float FB = ( - 2.0 * Fc ) + Fx ; float FC = ( - 2.0 * Fc ) + Fy ; float FD = Fv + Fu ; float FE = Ft + Fv ; float FF = ( - 2.0 * E_ ) + FD ; float FG = ( - 2.0 * Fa ) + FE ; float FH = Ft + Fw ; float FI = Fw + Fu ; float FJ = ( abs ( FB ) * 2.0 ) + abs ( FF ) ; float FK = ( abs ( FC ) * 2.0 ) + abs ( FG ) ; float FL = ( - 2.0 * Fb ) + FH ; float FM = ( - 2.0 * EZ ) + FI ; float FN = abs ( FL ) + FJ ; float FO = abs ( FM ) + FK ; float FP = FH + FD ; float FQ = u_texel_size . x ; bool FR = FN >= FO ; float FS = FA * 2.0 + FP ; if ( ! FR ) Fa = Fb ; if ( ! FR ) EZ = E_ ; if ( FR ) FQ = u_texel_size . y ; float FT = ( FS * ( 1.0 / 12.0 ) ) - Fc ; float FU = Fa - Fc ; float FV = EZ - Fc ; float FW = Fa + Fc ; float FX = EZ + Fc ; bool FY = abs ( FU ) >= abs ( FV ) ; float FZ = max ( abs ( FU ) , abs ( FV ) ) ; if ( FY ) FQ = - FQ ; float F_ = clamp ( abs ( FT ) * Fz , 0.0 , 1.0 ) ; vec2 Ga ; Ga . x = ET . x ; Ga . y = ET . y ; vec2 Gb ; Gb . x = ( ! FR ) ? 0.0 : u_texel_size . x ; Gb . y = ( FR ) ? 0.0 : u_texel_size . y ; if ( ! FR ) Ga . x += FQ * 0.5 ; if ( FR ) Ga . y += FQ * 0.5 ; vec2 Gc ; Gc . x = Ga . x - Gb . x ; Gc . y = Ga . y - Gb . y ; vec2 Gd ; Gd . x = Ga . x + Gb . x ; Gd . y = Ga . y + Gb . y ; float Ge = ( ( - 2.0 ) * F_ ) + 3.0 ; float Gf = Ez ( texture2D ( u_color , Gc ) ) ; float Gg = F_ * F_ ; float Gh = Ez ( texture2D ( u_color , Gd ) ) ; if ( ! FY ) FW = FX ; float Gi = FZ * 1.0 / 4.0 ; float Gj = Fc - FW * 0.5 ; float Gk = Ge * Gg ; bool Gl = Gj < 0.0 ; Gf -= FW * 0.5 ; Gh -= FW * 0.5 ; bool Gm = abs ( Gf ) >= Gi ; bool Gn = abs ( Gh ) >= Gi ; if ( ! Gm ) Gc . x -= Gb . x * 1.5 ; if ( ! Gm ) Gc . y -= Gb . y * 1.5 ; bool Go = ( ! Gm ) || ( ! Gn ) ; if ( ! Gn ) Gd . x += Gb . x * 1.5 ; if ( ! Gn ) Gd . y += Gb . y * 1.5 ; if ( Go ) { if ( ! Gm ) Gf = Ez ( texture2D ( u_color , Gc . xy ) ) ; if ( ! Gn ) Gh = Ez ( texture2D ( u_color , Gd . xy ) ) ; if ( ! Gm ) Gf = Gf - FW * 0.5 ; if ( ! Gn ) Gh = Gh - FW * 0.5 ; Gm = abs ( Gf ) >= Gi ; Gn = abs ( Gh ) >= Gi ; if ( ! Gm ) Gc . x -= Gb . x * 2.0 ; if ( ! Gm ) Gc . y -= Gb . y * 2.0 ; Go = ( ! Gm ) || ( ! Gn ) ; if ( ! Gn ) Gd . x += Gb . x * 2.0 ; if ( ! Gn ) Gd . y += Gb . y * 2.0 ; if ( Go ) { if ( ! Gm ) Gf = Ez ( texture2D ( u_color , Gc . xy ) ) ; if ( ! Gn ) Gh = Ez ( texture2D ( u_color , Gd . xy ) ) ; if ( ! Gm ) Gf = Gf - FW * 0.5 ; if ( ! Gn ) Gh = Gh - FW * 0.5 ; Gm = abs ( Gf ) >= Gi ; Gn = abs ( Gh ) >= Gi ; if ( ! Gm ) Gc . x -= Gb . x * 2.0 ; if ( ! Gm ) Gc . y -= Gb . y * 2.0 ; Go = ( ! Gm ) || ( ! Gn ) ; if ( ! Gn ) Gd . x += Gb . x * 2.0 ; if ( ! Gn ) Gd . y += Gb . y * 2.0 ; if ( Go ) { if ( ! Gm ) Gf = Ez ( texture2D ( u_color , Gc . xy ) ) ; if ( ! Gn ) Gh = Ez ( texture2D ( u_color , Gd . xy ) ) ; if ( ! Gm ) Gf = Gf - FW * 0.5 ; if ( ! Gn ) Gh = Gh - FW * 0.5 ; Gm = abs ( Gf ) >= Gi ; Gn = abs ( Gh ) >= Gi ; if ( ! Gm ) Gc . x -= Gb . x * 4.0 ; if ( ! Gm ) Gc . y -= Gb . y * 4.0 ; Go = ( ! Gm ) || ( ! Gn ) ; if ( ! Gn ) Gd . x += Gb . x * 4.0 ; if ( ! Gn ) Gd . y += Gb . y * 4.0 ; if ( Go ) { if ( ! Gm ) Gf = Ez ( texture2D ( u_color , Gc . xy ) ) ; if ( ! Gn ) Gh = Ez ( texture2D ( u_color , Gd . xy ) ) ; if ( ! Gm ) Gf = Gf - FW * 0.5 ; if ( ! Gn ) Gh = Gh - FW * 0.5 ; Gm = abs ( Gf ) >= Gi ; Gn = abs ( Gh ) >= Gi ; if ( ! Gm ) Gc . x -= Gb . x * 2.0 ; if ( ! Gm ) Gc . y -= Gb . y * 2.0 ; if ( ! Gn ) Gd . x += Gb . x * 2.0 ; if ( ! Gn ) Gd . y += Gb . y * 2.0 ; } } } } float Gp = ET . x - Gc . x ; float Gq = Gd . x - ET . x ; if ( ! FR ) Gp = ET . y - Gc . y ; if ( ! FR ) Gq = Gd . y - ET . y ; bool Gr = ( Gf < 0.0 ) != Gl ; float Gs = ( Gq + Gp ) ; bool Gt = ( Gh < 0.0 ) != Gl ; float Gu = 1.0 / Gs ; bool Gv = Gp < Gq ; float Gw = min ( Gp , Gq ) ; bool Gx = Gv ? Gr : Gt ; float Gy = Gk * Gk ; float Gz = ( Gw * ( - Gu ) ) + 0.5 ; float GA = Gy * FXAA_QUALITY_SUBPIX ; float GB = Gx ? Gz : 0.0 ; float GC = max ( GB , GA ) ; if ( ! FR ) ET . x += GC * FQ ; if ( FR ) ET . y += GC * FQ ; return texture2D ( u_color , ET ) ; }".split(" ")},
{type:"define",name:"FXAA_CONSOLE_EDGE_SHARPNESS",b:["8.0"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD",b:["0.125"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD_MIN",b:["0.05"]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_PASS",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , b_ ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"gl_FragColor = ES ( ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = GD ( ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 0.0 , 1.0 ) * texture2D ( u_color , b_ ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},
{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 b_ ; void main ( ) { vec2 Eo = vec2 ( 0.0 , 0.0 ) ; vec2 Et = u_texel_size ; vec4 Eu = texture2D ( u_color , b_ ) ; gl_FragColor = Eu * 0.0875447373698 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0858112354248 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0808139781061 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0731235112908 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0635705267419 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0530985673112 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0426125984122 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0328565115809 ; Eo += Et ; gl_FragColor += texture2D ( u_color , b_ + Eo ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , b_ - Eo ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * Eu , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_main , b_ ) ; vec4 Et = texture2D ( u_bloom , b_ ) ; vec4 Eu = Eo ; Eu += Et ; gl_FragColor = vec4 ( Eu . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"PI_4",
b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_color , b_ ) ; vec3 Et = Eo . rgb ; if ( u_brightness < 0.0 ) Et = Et * ( 1.0 + u_brightness ) ; else Et = Et + ( ( 1.0 - Et ) * u_brightness ) ; Et = ( Et - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; Et *= u_exposure ; vec3 Eu = vec3 ( 0.299 , 0.587 , 0.114 ) ; float Ev = dot ( Et , Eu ) ; Et = mix ( vec3 ( Ev ) , Et , u_saturation ) ; gl_FragColor = vec4 ( Et , Eo . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 b_ ; void main ( ) { gl_FragColor = h ( clamp ( EA ( u_depth , b_ , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_sharp , b_ ) ; if ( u_dof_dist > 0.0 ) { float EB = EA ( u_depth , b_ , u_camera_range ) ; EB *= u_view_max_depth ; float EC ; if ( EB < u_dof_dist ) EC = ( u_dof_dist - EB ) / u_dof_front ; else EC = ( EB - u_dof_dist ) / u_dof_rear ; EC = clamp ( EC , 0.0 , 1.0 ) ; vec4 ED = texture2D ( u_blurred , b_ ) ; gl_FragColor = mix ( Eo , ED , EC ) ; } else gl_FragColor = Eo ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_src_color , b_ ) ; vec4 EB = texture2D ( u_glow_mask_small , b_ ) ; vec4 EC = texture2D ( u_glow_mask_large , b_ ) ; gl_FragColor = Eo ; if ( EC . a != 0.0 ) { float ED = u_glow_mask_large_coeff * EC . a ; ED = clamp ( ED , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , EC . rgb / EC . a , ED ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , ED ) ; } if ( EB . a != 0.0 ) { float EE = u_glow_mask_small_coeff * EB . a ; EE = clamp ( EE , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , EB . rgb / EB . a , EE ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , EE ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float EB ; varying vec2 EC ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 b_ ; varying vec4 ED ; void main ( ) { vec2 EE = ( ED . xy - b_ ) ; float EF = length ( EE ) ; vec2 EG = u_radial_blur_step * EE / EF ; float EH = EF / u_radial_blur_step ; EG *= min ( EH , STEPS_PER_PASS ) / STEPS_PER_PASS ; EH = max ( EH , STEPS_PER_PASS ) ; vec2 EI = b_ ; float EJ = 0.0 ; for ( float EK = 0.0 ; EK < STEPS_PER_PASS ; EK += 1.0 ) { if ( EK <= EH ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"float EL = EA ( u_input , EI , u_camera_range ) ; EJ += max ( ( 1.0 - pow ( EF , 0.3 ) ) * step ( 0.9 , EL ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 EM = texture2D ( u_input , EI ) ; EJ += l ( EM ) ;".split(" ")}]}}]},{type:"textline",b:"} EI += EG ; }".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"vec2 EN = b_ + EC ; float EO = Q ( vec2 ( 2.5 * ( EN . x ) , 2.5 * ( EN . y ) + 1.0 * u_time ) ) . x + 0.75 * Q ( vec2 ( 5.0 * ( EN . x ) - 0.66 * u_time , 5.0 * ( EN . y ) + 0.66 * u_time ) ) . x + 0.5 * au ( vec2 ( 7.5 * ( EN . x ) + 0.33 * u_time , 7.5 * ( EN . y ) - 0.33 * u_time ) ) ; EO *= clamp ( 1.2 - sqrt ( 0.2 * EF ) , 0.0 , 1.0 ) * EB ; EJ = max ( EO , EJ ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = h ( EJ / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float EB ; varying vec2 EC ;".split(" ")}]}}]}]}}]},{type:"textline",
b:"varying vec2 b_ ; varying vec4 ED ; void main ( ) { b_ = a_bb_vertex + 0.5 ; vec3 Eo = normalize ( u_sun_direction ) ; ED = u_proj_matrix * u_view_matrix * vec4 ( Eo , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { EB = 1.0 ; vec3 EE = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 EF = bn ( u_camera_quat , EE ) ; EF = normalize ( EF ) ; float EG = dot ( EF , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float EH = atan ( EF . x , EF . z ) ; EC = vec2 ( - EH , acos ( EG ) ) ; } else { EB = 0.0 ; }".split(" ")}]}}]},
{type:"textline",b:"ED . xy = 0.5 * ( ED . xy / ED . w + 1.0 ) ; ED += 99999.0 * step ( ED . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_main , b_ ) ; vec3 EE = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; a_ ( Eo . rgb ) ; float EF = l ( texture2D ( u_god_rays , b_ ) ) ; vec3 EG = Eo . rgb + u_god_rays_intensity * vec3 ( EF ) * EE ; bb ( EG ) ; gl_FragColor . rgb = EG ; gl_FragColor . a = Eo . a ; }".split(" ")}]};
a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_input , b_ ) ; float EE = dot ( Eo . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( EE ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float Eo ; float EE = 0.0 ; for ( float EF = 0.025 ; EF < 1.0 ; EF += 0.05 ) for ( float EG = 0.025 ; EG < 1.0 ; EG += 0.05 ) { Eo = max ( texture2D ( u_input , vec2 ( EF , EG ) ) . r , 0.01 ) ; EE += log ( Eo ) ; } float EH = exp ( EE / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( EH ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 b_ ; varying float EE ; void main ( ) { float EF = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; float EG = texture2D ( u_luminance , b_ ) . r ; vec4 EH = texture2D ( u_main , b_ ) ; float EI = EG / EF ; float EJ = u_bloom_edge_lum ; gl_FragColor = EH * max ( EI - EJ , 0.0 ) * EE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 b_ ; varying float EE ; const vec3 Eo = vec3 ( 0.0 , 1.0 , 0.0 ) ; void EM ( in vec4 EF , in vec3 EG , out vec3 EH ) { float EI = EF . w * EG . x + EF . y * EG . z - EF . z * EG . y ; float EJ = EF . w * EG . y + EF . z * EG . x - EF . x * EG . z ; float EK = EF . w * EG . z + EF . x * EG . y - EF . y * EG . x ; float EL = - EF . x * EG . x - EF . y * EG . y - EF . z * EG . z ; EH . x = EI * EF . w - EL * EF . x - EJ * EF . z + EK * EF . y ; EH . y = EJ * EF . w - EL * EF . y - EK * EF . x + EI * EF . z ; EH . z = EK * EF . w - EL * EF . z - EI * EF . y + EJ * EF . x ; } void main ( ) { b_ = 2.0 * a_position ; vec3 EN ; EM ( u_camera_quat , Eo , EN ) ; EE = dot ( - EN , u_sun_direction ) * u_bloom_key ; EE *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 b_ ; float Eo = 0.0042 ; void main ( ) { vec4 EF = texture2D ( u_mb_tex_curr , b_ ) ; vec4 EG = texture2D ( u_mb_tex_accum , b_ ) ; if ( length ( EF - EG ) > u_motion_blur_decay_threshold ) { vec4 EH = ( 1.0 - u_motion_blur_exp ) * EF + u_motion_blur_exp * EG ; vec4 EI = EH - EG ; vec4 EJ = EF - EG ; vec4 EK = min ( max ( abs ( EI ) , vec4 ( Eo ) ) , abs ( EJ ) ) * sign ( EI ) ; gl_FragColor = EG + EK ; } else { gl_FragColor = EF ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 b_ ; void main ( ) { vec4 Eo = texture2D ( u_outline_src , b_ ) ; gl_FragColor = Eo ; if ( u_draw_outline != 0.0 ) { vec4 EF = texture2D ( u_outline_mask , b_ ) ; vec4 EG = texture2D ( u_outline_mask_blurred , b_ ) ; float EH = EG . a - EF . a ; if ( EH != 0.0 ) { float EI = smoothstep ( 0.0 , 1.0 , EG . a ) ; if ( EF . a == 0.0 ) { vec3 EJ = u_outline_color ; bb ( EJ ) ; vec4 EK = vec4 ( clamp ( EJ , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( Eo , EK , EI ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 b_ ; void main ( ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , b_ ) ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Eo = texture2D ( u_color , b_ ) ; gl_FragColor . rgb = vec3 ( ( Eo . r + Eo . g + Eo . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_BLUR",
{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 EF = vec2 ( 0.0 , 0.0 ) ; vec2 EG = u_texel_size ; vec4 EH ; EH = texture2D ( u_color , b_ ) ; gl_FragColor = EH * 0.2270270270 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * 0.1945945946 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * 0.1945945946 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * 0.1216216216 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * 0.1216216216 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * 0.0540540541 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * 0.0540540541 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * 0.0162162162 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * 0.0162162162 ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 EF = vec2 ( 0.0 , 0.0 ) ; vec2 EG = u_texel_size ; vec4 EH ; EH = texture2D ( u_color , b_ ) ; gl_FragColor = EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.152507 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.141763 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.141763 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.113861 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.113861 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.079019 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.079019 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.047383 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.047383 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.024549 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.024549 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.01099 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.01099 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.00425 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.00425 ; EF += EG ; EH = texture2D ( u_color , b_ + EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.00142 ; EH = texture2D ( u_color , b_ - EF ) ; gl_FragColor += EH * ( 1.0 - step ( 0.0 , - EH . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 EG = u_texel_size ; vec4 EH = texture2D ( u_color , b_ ) ; gl_FragColor = EH ; if ( EH . a == 0.0 ) { EH = texture2D ( u_color , b_ + EG ) ; if ( EH . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , EH . a ) ; else { EH = texture2D ( u_color , b_ - EG ) ; if ( EH . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , EH . a ) ; } }".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 b_ ; void main ( ) { b_ = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2},"SMAA_PREDICATION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 b_ ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","EF",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 EG ; varying vec4 EH ; varying vec4 EI ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","EJ",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",
name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},
{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 EP ( vec2 EK , sampler2D EL ) { float EM = texture2D ( EL , EK ) . r ; float EN = texture2D ( EL , EG . xy ) . r ; float EO = texture2D ( EL , EG . zw ) . r ; return vec3 ( EM , EN , EO ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 EV ( vec2 EQ , sampler2D ER ) { vec3 ES = EP ( EQ , ER ) ; vec2 ET = abs ( ES . xx - ES . yz ) ; vec2 EU = step ( SMAA_PREDICATION_THRESHOLD , ET ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * EU ) ; }".split(" ")}]}}]},
{type:"textline",b:"void EZ ( bvec2 EW , inout vec2 EX , vec2 EY ) { if ( EW . x ) EX . x = EY . x ; if ( EW . y ) EX . y = EY . y ; } void EZ ( bvec4 E_ , inout vec4 Fa , vec4 Fb ) { EZ ( E_ . xy , Fa . xy , Fb . xy ) ; EZ ( E_ . zw , Fa . zw , Fb . zw ) ; } vec2 Fd ( vec2 Fc ) { return sign ( Fc ) * floor ( abs ( Fc ) + .5 ) ; } vec4 Fd ( vec4 Fe ) { return sign ( Fe ) * floor ( abs ( Fe ) + .5 ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Fv ( vec2 Ff , sampler2D Fg".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Fh"]}]}}]},{type:"textline",b:[")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"vec2 Fi = EV ( Ff , Fh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec2 Fi = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},
{type:"textline",b:"vec3 Fj = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float Fk = dot ( texture2D ( Fg , Ff ) . rgb , Fj ) ; float Fl = dot ( texture2D ( Fg , EG . xy ) . rgb , Fj ) ; float Fm = dot ( texture2D ( Fg , EG . zw ) . rgb , Fj ) ; vec4 Fn ; Fn . xy = abs ( Fk - vec2 ( Fl , Fm ) ) ; vec2 Fo = step ( Fi , Fn . xy ) ; if ( dot ( Fo , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float Fp = dot ( texture2D ( Fg , EH . xy ) . rgb , Fj ) ; float Fq = dot ( texture2D ( Fg , EH . zw ) . rgb , Fj ) ; Fn . zw = abs ( Fk - vec2 ( Fp , Fq ) ) ; vec2 Fr = max ( Fn . xy , Fn . zw ) ; float Fs = dot ( texture2D ( Fg , EI . xy ) . rgb , Fj ) ; float Ft = dot ( texture2D ( Fg , EI . zw ) . rgb , Fj ) ; Fn . zw = abs ( vec2 ( Fl , Fm ) - vec2 ( Fs , Ft ) ) ; Fr = max ( Fr . xy , Fn . zw ) ; float Fu = max ( Fr . x , Fr . y ) ; Fo . xy *= step ( Fu , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * Fn . xy ) ; return Fo ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec2 Fx ( vec2 Fw ) { Fw . r = Fw . r * abs ( 5.0 * Fw . r - 5.0 * 0.75 ) ; return Fd ( Fw ) ; } vec4 Fx ( vec4 Fy ) { Fy . rb = Fy . rb * abs ( 5.0 * Fy . rb - 5.0 * 0.75 ) ; return Fd ( Fy ) ; } vec2 FG ( sampler2D Fz , vec2 FA , vec2 FB , out vec2 FC ) { vec4 FD = vec4 ( FA , - 1.0 , 1.0 ) ; vec3 FE = vec3 ( u_texel_size , 1.0 ) ; for ( int FF = 0 ; FF < SMAA_MAX_SEARCH_STEPS_DIAG ; FF ++ ) { if ( FD . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && FD . w > 0.9 ) { FD . xyz += FE * vec3 ( FB , 1.0 ) ; FC = texture2D ( Fz , FD . xy , 0.0 ) . rg ; FD . w = dot ( FC , vec2 ( 0.5 , 0.5 ) ) ; } } return FD . zw ; } vec2 FO ( sampler2D FH , vec2 FI , vec2 FJ , out vec2 FK ) { vec4 FL = vec4 ( FI , - 1.0 , 1.0 ) ; FL . x += 0.25 * u_texel_size . x ; vec3 FM = vec3 ( u_texel_size , 1.0 ) ; for ( int FN = 0 ; FN < SMAA_MAX_SEARCH_STEPS_DIAG ; FN ++ ) { if ( FL . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && FL . w > 0.9 ) { FL . xyz = FM * vec3 ( FJ , 1.0 ) + FL . xyz ; FK = texture2D ( FH , FL . xy , 0.0 ) . rg ; FK = Fx ( FK ) ; FL . w = dot ( FK , vec2 ( 0.5 , 0.5 ) ) ; } } return FL . zw ; } vec2 FU ( sampler2D FP , vec2 FQ , vec2 FR , float FS ) { vec2 FT = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * FR + FQ ; FT = SMAA_AREATEX_PIXEL_SIZE * FT + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; FT . x += 0.5 ; FT . y += SMAA_AREATEX_SUBTEX_SIZE * FS ; return texture2D ( FP , FT , 0.0 ) . rg ; } vec2 Gi ( sampler2D FV , sampler2D FW , vec2 FX , vec2 FY , vec4 FZ ) { vec2 F_ = vec2 ( 0.0 , 0.0 ) ; vec4 Ga ; vec2 Gb ; if ( FY . r > 0.0 ) { Ga . xz = FG ( FV , FX , vec2 ( - 1.0 , 1.0 ) , Gb ) ; Ga . x += float ( Gb . y > 0.9 ) ; } else Ga . xz = vec2 ( 0.0 , 0.0 ) ; Ga . yw = FG ( FV , FX , vec2 ( 1.0 , - 1.0 ) , Gb ) ; if ( Ga . x + Ga . y > 2.0 ) { vec4 Gc = vec4 ( - Ga . x + 0.25 , Ga . x , Ga . y , - Ga . y - 0.25 ) * u_texel_size . xyxy + FX . xyxy ; vec4 Gd ; Gd . xy = texture2D ( FV , Gc . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; Gd . zw = texture2D ( FV , Gc . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; Gd . yxwz = Fx ( Gd . xyzw ) ; vec2 Ge = vec2 ( 2.0 , 2.0 ) * Gd . xz + Gd . yw ; EZ ( bvec2 ( step ( 0.9 , Ga . zw ) ) , Ge , vec2 ( 0.0 , 0.0 ) ) ; F_ += FU ( FW , Ga . xy , Ge , FZ . z ) ; } Ga . xz = FO ( FV , FX , vec2 ( - 1 , - 1 ) , Gb ) ; if ( texture2D ( FV , FX + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { Ga . yw = FO ( FV , FX , vec2 ( 1 , 1 ) , Gb ) ; Ga . y += float ( Gb . y > 0.9 ) ; } else Ga . yw = vec2 ( 0.0 , 0.0 ) ; if ( Ga . x + Ga . y > 2.0 ) { vec4 Gf = vec4 ( - Ga . x , - Ga . x , Ga . y , Ga . y ) * u_texel_size . xyxy + FX . xyxy ; vec4 Gg ; Gg . x = texture2D ( FV , Gf . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; Gg . y = texture2D ( FV , Gf . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; Gg . zw = texture2D ( FV , Gf . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 Gh = vec2 ( 2.0 , 2.0 ) * Gg . xz + Gg . yw ; EZ ( bvec2 ( step ( 0.9 , Ga . zw ) ) , Gh , vec2 ( 0 , 0 ) ) ; F_ += FU ( FW , Ga . xy , Gh , FZ . w ) . gr ; } return F_ ; }".split(" ")}]}}]},
{type:"textline",b:"float Go ( sampler2D Gj , vec2 Gk , float Gl ) { vec2 Gm = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 Gn = SMAA_SEARCHTEX_SIZE * vec2 ( Gl , 1.0 ) ; Gm += vec2 ( - 1.0 , 1.0 ) ; Gn += vec2 ( 0.5 , - 0.5 ) ; Gm *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Gn *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( Gj , Gm * Gk + Gn , 0.0 ) . r ; } float Gw ( sampler2D Gp , sampler2D Gq , vec2 Gr , float Gs ) { vec2 Gt = vec2 ( 0.0 , 1.0 ) ; for ( int Gu = 0 ; Gu < SMAA_MAX_SEARCH_STEPS ; Gu ++ ) { if ( Gr . x > Gs && Gt . g > 0.8281 && Gt . r == 0.0 ) { Gt = texture2D ( Gp , Gr , 0.0 ) . rg ; Gr = - vec2 ( 2.0 , 0.0 ) * u_texel_size + Gr ; } } float Gv = - ( 255.0 / 127.0 ) * Go ( Gq , Gt , 0.0 ) + 3.25 ; return u_texel_size . x * Gv + Gr . x ; } float GE ( sampler2D Gx , sampler2D Gy , vec2 Gz , float GA ) { vec2 GB = vec2 ( 0.0 , 1.0 ) ; for ( int GC = 0 ; GC < SMAA_MAX_SEARCH_STEPS ; GC ++ ) { if ( Gz . x < GA && GB . g > 0.8281 && GB . r == 0.0 ) { GB = texture2D ( Gx , Gz , 0.0 ) . rg ; Gz = vec2 ( 2.0 , 0.0 ) * u_texel_size + Gz ; } } float GD = - ( 255.0 / 127.0 ) * Go ( Gy , GB , 0.5 ) + 3.25 ; return - u_texel_size . x * GD + Gz . x ; } float GM ( sampler2D GF , sampler2D GG , vec2 GH , float GI ) { vec2 GJ = vec2 ( 1.0 , 0.0 ) ; for ( int GK = 0 ; GK < SMAA_MAX_SEARCH_STEPS ; GK ++ ) { if ( GH . y > GI && GJ . r > 0.8281 && GJ . g == 0.0 ) { GJ = texture2D ( GF , GH , 0.0 ) . rg ; GH = - vec2 ( 0.0 , 2.0 ) * u_texel_size + GH ; } } float GL = - ( 255.0 / 127.0 ) * Go ( GG , GJ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * GL + GH . y ; } float GU ( sampler2D GN , sampler2D GO , vec2 GP , float GQ ) { vec2 GR = vec2 ( 1.0 , 0.0 ) ; for ( int GS = 0 ; GS < SMAA_MAX_SEARCH_STEPS ; GS ++ ) { if ( GP . y < GQ && GR . r > 0.8281 && GR . g == 0.0 ) { GR = texture2D ( GN , GP , 0.0 ) . rg ; GP = vec2 ( 0.0 , 2.0 ) * u_texel_size + GP ; } } float GT = - ( 255.0 / 127.0 ) * Go ( GO , GR . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * GT + GP . y ; } vec2 Ha ( sampler2D GV , vec2 GW , float GX , float GY , float GZ ) { vec2 G_ = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * Fd ( 4.0 * vec2 ( GX , GY ) ) + GW ; G_ = SMAA_AREATEX_PIXEL_SIZE * G_ + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; G_ . y = SMAA_AREATEX_SUBTEX_SIZE * GZ + G_ . y ; return texture2D ( GV , G_ , 0.0 ) . rg ; } void Hi ( sampler2D Hb , inout vec2 Hc , vec4 Hd , vec2 He ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec2 Hf = step ( He . xy , He . yx ) ; vec2 Hg = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Hf ; Hg /= Hf . x + Hf . y ; vec2 Hh = vec2 ( 1.0 , 1.0 ) ; Hh . x -= Hg . x * texture2D ( Hb , Hd . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; Hh . x -= Hg . y * texture2D ( Hb , Hd . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; Hh . y -= Hg . x * texture2D ( Hb , Hd . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; Hh . y -= Hg . y * texture2D ( Hb , Hd . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; Hc *= clamp ( Hh , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void Hq ( sampler2D Hj , inout vec2 Hk , vec4 Hl , vec2 Hm ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec2 Hn = step ( Hm . xy , Hm . yx ) ; vec2 Ho = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Hn ; Ho /= Hn . x + Hn . y ; vec2 Hp = vec2 ( 1.0 , 1.0 ) ; Hp . x -= Ho . x * texture2D ( Hj , Hl . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; Hp . x -= Ho . y * texture2D ( Hj , Hl . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; Hp . y -= Ho . x * texture2D ( Hj , Hl . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; Hp . y -= Ho . y * texture2D ( Hj , Hl . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; Hk *= clamp ( Hp , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 HJ ( vec2 Hr , vec2 Hs , sampler2D Ht , sampler2D Hu , sampler2D Hv , vec4 Hw ) { vec4 Hx = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 Hy = texture2D ( Ht , Hr ) . rg ; if ( Hy . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",
b:"Hx . rg = Gi ( Ht , Hu , Hr , Hy , Hw ) ; if ( Hx . r == - Hx . g ) {".split(" ")}]}}]},{type:"textline",b:"vec2 Hz ; vec3 HA ; HA . x = Gw ( Ht , Hv , EG . xy , EI . x ) ; HA . y = EH . y ; Hz . x = HA . x ; float HB = texture2D ( Ht , HA . xy , 0.0 ) . r ; HA . z = GE ( Ht , Hv , EG . zw , EI . y ) ; Hz . y = HA . z ; Hz = abs ( Fd ( Hz / u_texel_size . xx - Hs . xx ) ) ; vec2 HC = sqrt ( Hz ) ; float HD = texture2D ( Ht , HA . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; Hx . rg = Ha ( Hu , HC , HB , HD , Hw . y ) ; HA . y = Hr . y ; Hi ( Ht , Hx . rg , HA . xyzy , Hz ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"} else Hy . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( Hy . r > 0.0 ) { vec2 HE ; vec3 HF ; HF . y = GM ( Ht , Hv , EH . xy , EI . z ) ; HF . x = EG . x ; HE . x = HF . y ; float HG = texture2D ( Ht , HF . xy , 0.0 ) . g ; HF . z = GU ( Ht , Hv , EH . zw , EI . w ) ; HE . y = HF . z ; HE = abs ( Fd ( HE / u_texel_size . yy - Hs . yy ) ) ; vec2 HH = sqrt ( HE ) ; float HI = texture2D ( Ht , HF . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; Hx . ba = Ha ( Hu , HH , HG , HI , Hw . x ) ; HF . x = Hr . x ; Hq ( Ht , Hx . ba , HF . xyxz , HE ) ; } return Hx ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 H_ ( vec2 HK , sampler2D HL , sampler2D HM".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","HN"]}]}}]},{type:"textline",b:") { vec4 HO ; HO . x = texture2D ( HM , EF . xy ) . a ; HO . y = texture2D ( HM , EF . zw ) . g ; HO . wz = texture2D ( HM , HK ) . xz ; if ( dot ( HO , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 HP = texture2D ( HL , HK , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 HQ = texture2D ( HN , b_ ) ; vec2 HR = 2.0 * t ( HQ ) - 1.0 ; HP . a = sqrt ( 2.0 * length ( HR ) ) ;".split(" ")}]}}]},{type:"textline",b:"return HP ; } else { bool HS = max ( HO . x , HO . z ) > max ( HO . y , HO . w ) ; vec4 HT = vec4 ( 0.0 , HO . y , 0.0 , HO . w ) ; vec2 HU = HO . yw ; EZ ( bvec4 ( HS , HS , HS , HS ) , HT , vec4 ( HO . x , 0.0 , HO . z , 0.0 ) ) ; EZ ( bvec2 ( HS , HS ) , HU , HO . xz ) ; HU /= dot ( HU , vec2 ( 1.0 , 1.0 ) ) ; vec4 HV = HT * vec4 ( u_texel_size , - u_texel_size ) + HK . xyxy ; vec4 HW = HU . x * texture2D ( HL , HV . xy , 0.0 ) ; HW += HU . y * texture2D ( HL , HV . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 HX = texture2D ( HN , HV . xy ) ; vec2 HY = 2.0 * t ( HX ) - 1.0 ; vec2 HZ = HU . x * HY ; HX = texture2D ( HN , HV . zw ) ; HY = 2.0 * t ( HX ) - 1.0 ; HZ += HU . y * HY ; HW . a = sqrt ( 2.0 * length ( HZ ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","HW",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"vec4 Il ( vec2 Ia , sampler2D Ib , sampler2D Ic".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Id"]}]}}]},{type:"textline",b:[")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 Ie = texture2D ( Id , b_ ) ; vec2 If ; If = 2.0 * t ( Ie ) - 1.0 ; vec4 Ig = texture2D ( Ib , Ia ) ; vec4 Ih = texture2D ( Ic , Ia - If ) ; float Ii = abs ( Ig . a * Ig . a - Ih . a * Ih . a ) / 2.0 ; float Ij = 0.5 * clamp ( 1.0 - sqrt ( Ii ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 Ik = mix ( Ig , Ih , Ij ) ; Ik . a = 1.0 ; return Ik ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 Ig = texture2D ( Ib , Ia ) ; vec4 Ih = texture2D ( Ic , Ia ) ; return mix ( Ig , Ih , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Im = vec4 ( Fv ( b_ , u_color".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",
a:[{type:"textline",b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Im = HJ ( b_ , EJ , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Im = H_ ( b_ , u_color , u_blend".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Im = vec4 ( Il ( b_ , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"vec4 Im = texture2D ( u_color , b_ ) ;".split(" ")}]}}]},{type:"textline",b:["gl_FragColor","=","Im",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 b_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","EF",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 EG ; varying vec4 EH ; varying vec4 EI ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","EJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",c:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void EK ( vec2 Eo ) { EG = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + Eo . xyxy ; EH = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Eo . xyxy ; EI = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + Eo . xyxy ; }".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void EN ( vec2 EL , out vec2 EM ) { EM = EL / u_texel_size ; EG = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + EL . xyxy ; EH = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + EL . xyxy ; EI = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( EG . xz , EH . yw ) ; }".split(" ")}]}},
{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void EP ( vec2 EO ) { EF = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + EO . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { b_ = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["EK","(","b_",")",";"]}]}},{type:"elif",c:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EN ( b_ , EJ ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["EP","(","b_",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",
b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 b_ ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float EK ( in vec2 Eo ) { return EA ( u_depth , Eo , u_camera_range ) ; } void main ( ) { float EL = texture2D ( u_color , b_ ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( EL , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"vec3 EM = normalize ( 2.0 * texture2D ( u_ssao_special_tex , b_ * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float EN = EK ( b_ ) ; float EO = EN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"const float EP = 8.0 ; const int EQ = 1 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float EP = 16.0 ; const int EQ = 2 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float EP = 24.0 ; const int EQ = 3 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"const float EP = 32.0 ; const int EQ = 4 ;".split(" ")}]}}]},{type:"textline",b:"float ER = u_ssao_radius_increase * 0.001 ; const float ES = 1.0 + 2.4 / EP ; float ET = 0.0 ; for ( int EU = 0 ; EU < EQ ; EU ++ ) for ( int EV = - 1 ; EV <= 1 ; EV += 2 ) for ( int EW = - 1 ; EW <= 1 ; EW += 2 ) for ( int EX = - 1 ; EX <= 1 ; EX += 2 ) { vec3 EY = reflect ( normalize ( vec3 ( EV , EW , EX ) ) , EM ) * ( ER *= ES ) ; vec3 EZ = vec3 ( b_ , EO ) ; EZ += vec3 ( EY . xy , EY . z * EO * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"EZ . z -= 1.4 * ( EZ . z - EO ) * step ( EO , EZ . z ) ;".split(" ")}]}}]},{type:"textline",b:"float E_ = EK ( EZ . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float Fa = clamp ( ( EO - E_ ) / E_ , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"ET += mix ( 1.0 , Fa , step ( E_ , EZ . z ) ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"ET += mix ( step ( EZ . z , E_ ) , 0.5 , Fa ) ;".split(" ")}]}}]},{type:"textline",b:"} ET = ET / EP ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"ET = clamp ( ET * ET + 0.6 * ET , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ET = clamp ( ET * ET + ET , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"float Fb = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * EN ) ; ET = mix ( 1.0 , ET , Fb ) ; gl_FragColor = vec4 ( EL , ET , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 b_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float EK ( in vec2 Eo ) { return EA ( u_depth , Eo , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { float EL = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"float EM = EK ( b_ ) ; float EN = 0.0 ; float EO = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{type:"textline",b:"vec2 EP = vec2 ( - 2.0 ) ; for ( int EQ = 0 ; EQ < 4 ; ++ EQ ) { for ( int ER = 0 ; ER < 4 ; ++ ER ) { vec2 ES = ( EP + vec2 ( float ( EQ ) , float ( ER ) ) ) * u_texel_size ; float ET = texture2D ( u_ssao_mask , b_ + ES ) . g ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"float EU = EK ( b_ + ES ) ; float EV = 1.0 - clamp ( abs ( EU - EM ) * EO , 0.0 , 1.0 ) ; EL += ET * EV ; EN += EV ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["EL","+=","ET",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , b_ ) . r , EL / EN , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , b_ ) . r , EL / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 b_ ; void main ( ) { float Eo = texture2D ( u_depth , b_ ) . x ; vec4 EK = vec4 ( b_ * 2.0 - 1.0 , 2.0 * Eo - 1.0 , 1.0 ) ; vec4 EL = u_view_proj_inverse * EK ; vec4 EM = EL / EL . w ; vec4 EN = u_view_proj_prev * EM ; EN /= EN . w ; vec2 EO = ( EK . xy - EN . xy ) / 4.0 + 0.5 ; EO = clamp ( EO , 0.0 , 1.0 ) ; gl_FragColor = h ( EO ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",
b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",
name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"SPECULAR_TOON",b:["5"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",
b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MIX",b:["0"]},{type:"define",name:"ADD",b:["1"]},{type:"define",name:"SUBTRACT",b:["2"]},{type:"define",name:"MULTIPLY",b:["3"]},{type:"define",name:"SCREEN",b:["4"]},{type:"define",name:"OVERLAY",b:["5"]},{type:"define",name:"DIFFERENCE",b:["6"]},{type:"define",name:"DIVIDE",b:["7"]},{type:"define",name:"DARKEN",b:["8"]},{type:"define",name:"LIGHTEN",b:["9"]},
{type:"define",name:"HUE",b:["10"]},{type:"define",name:"SATURATION",b:["11"]},{type:"define",name:"VALUE",b:["12"]},{type:"define",name:"COLOR",b:["13"]},{type:"define",name:"SOFT_LIGHT",b:["14"]},{type:"define",name:"LINEAR_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",b:["3"]},{type:"define",name:"INVERSE_QUADRATIC",b:["0"]},{type:"define",name:"LINEAR",b:["1"]},{type:"define",
name:"QUADRATIC",b:["2"]},{type:"define",name:"HEMI",b:["1"]},{type:"define",name:"SPOT",b:["2"]},{type:"define",name:"POINT",b:["3"]},{type:"define",name:"SUN",b:["4"]}]};a["include/pack.glslf"]={type:"group",a:[{type:"textline",b:"float a = 255.0 ; float b = 0.0 ; float c = 1.0 ; vec4 h ( const in float d ) { vec4 e = vec4 ( a * a * a , a * a , a , c ) ; vec4 f = vec4 ( b , c / a , c / a , c / a ) ; vec4 g = fract ( d * e ) ; g -= g . xxyz * f ; return g ; } float l ( const in vec4 i ) { float j ; vec4 k = vec4 ( c / ( a * a * a ) , c / ( a * a ) , c / a , c ) ; j = dot ( i , k ) ; return j ; } vec4 h ( const in vec2 m ) { vec2 n = vec2 ( a , c ) ; vec2 o = vec2 ( b , c / a ) ; vec4 p = fract ( m . xxyy * n . xyxy ) ; p -= p . xxzz * o . xyxy ; if ( m . r == c ) p . rg = vec2 ( b , c ) ; if ( m . g == c ) p . ba = vec2 ( b , c ) ; return p ; } vec2 t ( const in vec4 q ) { vec2 r ; vec2 s = vec2 ( c / a , c ) ; r . r = dot ( q . rg , s ) ; r . g = dot ( q . ba , s ) ; return r ; }".split(" ")}]};
a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float u = 0.0 ; float v = 1.0 ; vec4 x ( vec4 w ) { return w - floor ( w * ( v / 289.0 ) ) * 289.0 ; } vec3 x ( vec3 y ) { return y - floor ( y * ( v / 289.0 ) ) * 289.0 ; } vec2 x ( vec2 z ) { return z - floor ( z * ( v / 289.0 ) ) * 289.0 ; } vec4 B ( vec4 A ) { return A - floor ( A * ( v / 7.0 ) ) * 7.0 ; } vec4 D ( vec4 C ) { return x ( ( 34.0 * C + 5.0 ) * C ) ; }".split(" ")},{type:"define",name:"K",b:["0.142857142857"]},{type:"define",
name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 Q ( vec2 E ) { vec2 F = x ( floor ( E ) ) ; vec2 G = fract ( E ) ; vec4 H = G . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 I = G . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 J = D ( F . x + vec4 ( u , v , u , v ) ) ; J = D ( J + F . y + vec4 ( u , u , v , v ) ) ; vec4 L = B ( J ) * K + K2 ; vec4 M = B ( floor ( J * K ) ) * K + K2 ; vec4 N = H + JITTER * L ; vec4 O = I + JITTER * M ; vec4 P = N * N + O * O ;".split(" ")},
{type:"condition",a:[{type:"if",c:[1],group:{type:"group",a:[{type:"textline",b:"P . xy = min ( P . xy , P . zw ) ; P . x = min ( P . x , P . y ) ; return P . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"P . xy = ( P . x < P . y ) ? P . xy : P . yx ; P . xz = ( P . x < P . z ) ? P . xz : P . zx ; P . xw = ( P . x < P . w ) ? P . xw : P . wx ; P . y = min ( P . y , P . z ) ; P . y = min ( P . y , P . w ) ; return sqrt ( P . xy ) ;".split(" ")}]}}]},{type:"textline",
b:"} vec3 ae ( vec2 R , float S ) { vec2 T = x ( floor ( R ) ) ; vec2 U = fract ( R ) ; vec4 V = U . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 W = U . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 X = D ( T . x + vec4 ( u , v , u , v ) ) ; X = D ( X + T . y + vec4 ( u , u , v , v ) ) ; vec4 Y = B ( X ) * K + K2 ; vec4 Z = B ( floor ( X * K ) ) * K + K2 ; vec4 _ = V + JITTER * Y ; vec4 aa = W + JITTER * Z ; vec4 ab = _ * _ + aa * aa ; _ += S ; aa += S ; vec4 ac = _ * _ + aa * aa ; _ += S ; aa += S ; vec4 ad = _ * _ + aa * aa ; ab . xy = min ( ab . xy , ab . zw ) ; ab . x = min ( ab . x , ab . y ) ; ac . xy = min ( ac . xy , ac . zw ) ; ac . x = min ( ac . x , ac . y ) ; ad . xy = min ( ad . xy , ad . zw ) ; ad . x = min ( ad . x , ad . y ) ; return vec3 ( ab . x , ac . x , ad . x ) ; } vec3 ag ( vec3 af ) { return x ( ( ( af * 34.0 ) + v ) * af ) ; } float au ( vec2 ah ) { const vec4 ai = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 aj = floor ( ah + dot ( ah , ai . yy ) ) ; vec2 ak = ah - aj + dot ( aj , ai . xx ) ; vec2 al ; al = ( ak . x > ak . y ) ? vec2 ( v , u ) : vec2 ( u , v ) ; vec4 am = ak . xyxy + ai . xxzz ; am . xy -= al ; aj = x ( aj ) ; vec3 an = ag ( ag ( aj . y + vec3 ( u , al . y , v ) ) + aj . x + vec3 ( u , al . x , v ) ) ; vec3 ao = max ( 0.5 - vec3 ( dot ( ak , ak ) , dot ( am . xy , am . xy ) , dot ( am . zw , am . zw ) ) , u ) ; ao = ao * ao ; ao = ao * ao ; vec3 ap = 2.0 * fract ( an * ai . www ) - v ; vec3 aq = abs ( ap ) - 0.5 ; vec3 ar = floor ( ap + 0.5 ) ; vec3 as = ap - ar ; ao *= 1.79284291400159 - 0.85373472095314 * ( as * as + aq * aq ) ; vec3 at ; at . x = as . x * ak . x + aq . x * ak . y ; at . yz = as . yz * am . xz + aq . yz * am . yw ; return 130.0 * dot ( ao , at ) ; } vec2 aA ( vec2 av ) { float aw = dot ( av , vec2 ( 12.9898 , 78.233 ) ) ; float ax = dot ( av , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float ay = fract ( sin ( aw ) * 43758.5453 ) * 2.0 - v ; float az = fract ( sin ( ax ) * 43758.5453 ) * 2.0 - v ; return vec2 ( ay , az ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{type:"textline",b:"void aY ( inout vec3 aB , float aC , float aD , float aE , vec3 aF , vec3 aG , vec3 aH , vec4 aI , vec3 aJ , float aK ) { if ( aK > CAUSTICS_VIEW_DISTANCE ) return ; vec4 aL = aI ; vec3 aM = aJ + aF ; aM . xz = 10.0 * sin ( 0.1 * aM . xz ) ; vec3 aN = aM + 2.0 * cross ( - aL . xyz , cross ( - aL . xyz , aM ) + aL . w * aM ) ; vec2 aO = aN . xz ; vec3 aP = aG ; float aQ = max ( dot ( aF , aP ) , 0.0 ) ; float aR = 0.025 ; vec2 aS = CAUST_SPEED * aD ; aO . s += 0.25 * sin ( dot ( aJ + aD , vec3 ( 1.0 ) ) ) ; aO . t += 0.35 * ( - sin ( dot ( aJ - aD , vec3 ( - 0.7 ) ) ) ) ; aO . st += 0.15 * cos ( 4.0 * aC - aS . x ) + 1.5 * sin ( aC - 0.3 * aS . y ) ; float aT = CAUST_SCALE * ( 1.0 + max ( 0.1 * aC , 0.0 ) ) ; vec3 aU = ae ( ( aO / aT ) , aR ) ; aU *= CAUST_BRIGHT ; aU *= aU ; float aV = min ( 0.25 * aC , - aC ) + 1.0 ; aV = max ( aV , 0.0 ) ; float aW = aE * aQ ; float aX = max ( sign ( aC ) , 0.0 ) ; aW = aW + max ( 0.5 * sign ( - aF . y ) * aX , 0.0 ) ; aW = min ( aW , 1.0 ) ; aB += aH * aU * aV * aW ; }".split(" ")}]};
a["include/gamma.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void a_ ( inout vec3 aZ ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"aZ = max ( vec3 ( 0.0 ) , aZ ) ; aZ = pow ( aZ , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void bb ( inout vec3 ba ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",
b:"ba = max ( vec3 ( 0.0 ) , ba ) ; ba = pow ( ba , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void be ( inout vec3 bc , in float bd ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",b:"bc = bc * bd ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float bf = 0.0 ; float bg = 1.0 ; struct bh { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool bk ( vec3 bi , vec3 bj ) { return any ( lessThan ( abs ( bi - bj ) , vec3 ( EPSILON ) ) ) ; } vec3 bn ( in vec4 bl , in vec3 bm ) { return bm + 2.0 * cross ( bl . xyz , cross ( bl . xyz , bm ) + bl . w * bm ) ; } vec4 bp ( in vec4 bo ) { return vec4 ( - bo . xyz , bo . w ) / dot ( bo , bo ) ; } vec3 bu ( vec4 bq , vec4 br , vec4 bs ) { vec3 bt = bs . xyz * bq . w ; bt = bn ( br , bt ) ; bt += bq . xyz * bs . w ; return bt ; } vec3 bA ( vec4 bv , vec4 bw , vec4 bx ) { vec3 by = bx . xyz - bv . xyz * bx . w ; vec4 bz = bp ( bw ) ; by = bn ( bz , by ) ; by /= bv . w ; return by ; } mat4 bB ( ) { return mat4 ( bg , bf , bf , bf , bf , bg , bf , bf , bf , bf , bg , bf , bf , bf , bf , bg ) ; } mat4 bD ( float bC ) { return mat4 ( bg , bf , bf , bf , bf , cos ( bC ) , sin ( bC ) , bf , bf , - sin ( bC ) , cos ( bC ) , bf , bf , bf , bf , bg ) ; } mat4 bF ( float bE ) { return mat4 ( cos ( bE ) , bf , - sin ( bE ) , bf , bf , bg , bf , bf , sin ( bE ) , bf , cos ( bE ) , bf , bf , bf , bf , bg ) ; } mat4 bH ( float bG ) { return mat4 ( cos ( bG ) , sin ( bG ) , bf , bf , - sin ( bG ) , cos ( bG ) , bf , bf , bf , bf , bg , bf , bf , bf , bf , bg ) ; } bh bJ ( in bh bI ) { return bh ( bI . a , bI . b , normalize ( bI . c ) , normalize ( bI . d ) , normalize ( bI . e ) , bI . f ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"vec3 bP ( vec4 bK ) { float bL = bK . x ; float bM = bK . y ; float bN = bK . w ; vec3 bO ; bO . x = ( bL + bN ) / 2.0 ; bO . y = ( bM + bN ) / 2.0 ; bO . z = bN ; return bO ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={type:"group",
a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec4","ca",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float cb = 0.1 ; const float cc = 0.1 ; const float cd = - 0.01 ; const float ce = 0.05 ; vec4 cf = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 cg = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 ch = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 ci = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 cj = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 ck = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 cl = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 cm = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool cp ( vec2 cn , float co ) { return all ( lessThanEqual ( cn , vec2 ( 1.0 + co ) ) ) && all ( greaterThanEqual ( cn , vec2 ( 0.0 - co ) ) ) ; } float cy ( float cq , float cr , mat2 cs , vec3 ct , float cu , PRECISION sampler2D cv ) { vec2 cw , cx ; cx . x = cq ; cx . y = cr ; cx = cs * cx ; cw = ct . xy + cx * cu / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"if ( ! cp ( cw , cd ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"return step ( ct . z , texture2D ( cv , cw ) . r ) ; } void cM ( inout float cz , inout float cA , float cB , float cC , mat2 cD , vec3 cE , vec3 cF , float cG , float cH , PRECISION sampler2D cI , PRECISION sampler2D cJ ) { vec2 cK , cL ; cL . x = cB ; cL . y = cC ; cL = cD * cL ; cK = cE . xy + cL * cG / SHADOW_TEX_RES ; cz += step ( cE . z , texture2D ( cI , cK ) . r ) ; cK = cF . xy + cL * cH / SHADOW_TEX_RES ; cA += step ( cF . z , texture2D ( cJ , cK ) . r ) ; } float cW ( vec3 cN , PRECISION sampler2D cO , float cP ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( cN . z > u_perspective_cast_far_bound ) return 1.0 ; else {".split(" ")}]}}]},{type:"textline",b:"cN . z = clamp ( cN . z , 0.0 , 1.0 ) ; float cQ = 0.0 ; float cR = aA ( cN . xy ) . x * M_PI ; float cS = cos ( cR ) ; float cT = sin ( cR ) ; mat2 cU = mat2 ( cS , cT , - cT , cS ) ; for ( int cV = 0 ; cV < 4 ; cV ++ ) { cQ += cy ( cf [ cV ] , cj [ cV ] , cU , cN , cP , cO ) ; cQ += cy ( cg [ cV ] , ck [ cV ] , cU , cN , cP , cO ) ; cQ += cy ( ch [ cV ] , cl [ cV ] , cU , cN , cP , cO ) ; cQ += cy ( ci [ cV ] , cm [ cV ] , cU , cN , cP , cO ) ; } cQ /= 16.0 ; return clamp ( cQ , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["}"]}]}}]},{type:"textline",b:"return 1.0 ; } float dk ( vec3 cX , PRECISION sampler2D cY , vec3 cZ , PRECISION sampler2D c_ , float da , float db , float dc ) { float dd , de ; cX . z = clamp ( cX . z , 0.0 , 1.0 ) ; cZ . z = clamp ( cZ . z , 0.0 , 1.0 ) ; dd = 0.0 ; de = 0.0 ; float df = aA ( cX . xy ) . x * M_PI ; float dg = cos ( df ) ; float dh = sin ( df ) ; mat2 di = mat2 ( dg , dh , - dh , dg ) ; for ( int dj = 0 ; dj < 4 ; dj ++ ) { cM ( dd , de , cf [ dj ] , cj [ dj ] , di , cX , cZ , da , db , cY , c_ ) ; cM ( dd , de , cg [ dj ] , ck [ dj ] , di , cX , cZ , da , db , cY , c_ ) ; cM ( dd , de , ch [ dj ] , cl [ dj ] , di , cX , cZ , da , db , cY , c_ ) ; cM ( dd , de , ci [ dj ] , cm [ dj ] , di , cX , cZ , da , db , cY , c_ ) ; } dd = mix ( dd , de , dc ) ; dd /= 16.0 ; return clamp ( dd , 0.0 , 1.0 ) ; } float dp ( vec2 dl ) { float dm = min ( dl . x , dl . y ) ; float dn = min ( 1.0 - dl . x , 1.0 - dl . y ) ; return min ( dm , dn ) ; } float ds ( float dq , float dr ) { if ( dr >= 0.0 && dr <= cc ) dq = ( dq - 1.0 ) / cc * dr + 1.0 ; return dq ; } float dE ( vec3 dt , vec3 du , PRECISION sampler2D dv , PRECISION sampler2D dw , float dx , float dy , float dz , float dA ) { float dB ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"float dC = dp ( dt . xy ) ; if ( - dA > dz && dC >= 0.0 && dC <= cb && cp ( du . xy , 0.0 ) ) { float dD = 1.0 - dC / cb ; dB = dk ( dt , dv , du , dw , dx , dy , dD ) ; } else".split(" ")}]}}]},{type:"textline",b:"dB = cW ( dt , dv , dx ) ; return dB ; } float dM ( vec3 dF , PRECISION sampler2D dG , float dH , float dI , float dJ ) { float dK = cW ( dF , dG , dH ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - dJ > dI ) { float dL = dp ( dF . xy ) ; dK = ds ( dK , dL ) ; }".split(" ")}]}}]},{type:"textline",b:"return dK ; } float dT ( float dN ) { float dO = 1.0 ; vec3 dP = bW . xyz / bW . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"vec3 dQ = bX . xyz / bX . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"vec3 dR = bY . xyz / bY . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"vec3 dS = bZ . xyz / bZ . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( cp ( dP . xy , 0.0 ) ) { dO = dE ( dP , dQ , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , dN ) ; }".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"if ( cp ( dP . xy , ce ) ) { dO = dM ( dP , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , dN ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( cp ( dQ . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"dO = dE ( dQ , dR , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , dN ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"dO = dM ( dQ , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , dN ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( cp ( dR . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"dO = dE ( dR , dS , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , dN ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"dO = dM ( dR , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , dN ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( cp ( dS . xy , 0.0 ) ) dO = dM ( dS , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , dN ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","dO",";","}"]}]}}]},{type:"textline",b:"float dY ( inout vec3 dU ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 dV = texture2DProj ( u_shadow_mask , bU ) . rg ; vec3 dW = vec3 ( dV . r ) ; float dX = dV . g ; ca = vec4 ( dW , dX ) ; dU *= ca . a ; return ca . r ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return dT ( bR . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float ef ( in vec3 dZ , vec3 d_ , float ea , float eb ) { vec3 ec = normalize ( d_ + dZ ) ; float ed = 1.0 - dot ( dZ , ec ) ; float ee = eb + ( 1.0 - eb ) * pow ( ed , ea ) ; return ee ; } void et ( inout vec3 eg , vec3 eh , vec3 ei , float ej ) { vec3 ek = reflect ( - eh , ei ) ; float el = u_fresnel_params [ 2 ] ; float em = u_fresnel_params [ 3 ] ; float en = 1.0 ; if ( el != 0.0 ) en = ef ( eh , ek , el , em ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 eo = textureCube ( u_cube_reflection , ek ) . xyz ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 ep = u_refl_plane . xyz * dot ( ei , u_refl_plane . xyz ) ; vec3 eq = ei - ep ; vec2 er = ( u_view_matrix_frag * vec4 ( eq , 0.0 ) ) . xy ; vec2 es = bU . xy / bU . z ; es += er * REFL_BUMP ; vec3 eo = texture2D ( u_plane_reflection , es ) . rgb ;".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 eo = textureCube ( u_mirrormap , ek ) . xyz ; ej = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"a_ ( eo . rgb ) ; eg = mix ( eg , eo , ej * en ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 ew ( vec3 eu ) {".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , eu ) . rgb ;".split(" ")}]}},{type:"elif",c:["SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"float ev = 0.5 * eu . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ev ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"float eC ( in float ex , inout vec2 ey , in vec2 ez ) { vec4 eA = texture2D ( u_scene_depth , ey ) ; float eB = l ( eA ) ; if ( eB < bV ) { ey = ez ; return ex ; } else { return eB ; } return ex ; }".split(" ")}]}}]},{type:"textline",b:"vec3 eK ( in vec3 eD , in vec2 eE ) { vec2 eF = eD . xy / eD . z ; vec2 eG = eF + eE ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 eH = texture2DProj ( u_scene_depth , eD ) ; float eI = l ( eH ) ; eC ( eI , eG , eF ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 eJ = texture2D ( u_refractmap , eG ) . rgb ; a_ ( eJ ) ; return eJ ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},
{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eL",";"]}]}}]},{type:"textline",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float eM = 0.5 ; vec3 eN = vec3 ( ZERO_VALUE_NODES ) ; vec3 eO = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 eS ( in vec3 eP , in float eQ ) { vec3 eR = eN ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"eR = eK ( bU , eP . xz * eQ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"eR = texture2D ( u_refractmap , bU . xy / bU . z ) . rgb ; a_ ( eR ) ;".split(" ")}]}}]},{type:"textline",b:["return","eR",";","}"]}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 eZ ( vec3 eT ) { vec4 eU = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; vec4 eV = mix ( vec4 ( eT . bg , eU . wz ) , vec4 ( eT . gb , eU . xy ) , step ( eT . b , eT . g ) ) ; vec4 eW = mix ( vec4 ( eV . xyw , eT . r ) , vec4 ( eT . r , eV . yzx ) , step ( eV . x , eT . r ) ) ; float eX = eW . x - min ( eW . w , eW . y ) ; float eY = 1.0e-10 ; return vec3 ( abs ( eW . z + ( eW . w - eW . y ) / ( 6.0 * eX + eY ) ) , eX / ( eW . x + eY ) , eW . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 fc ( vec3 e_ ) { vec4 fa = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; vec3 fb = abs ( fract ( vec3 ( e_ . r , e_ . r , e_ . r ) + fa . xyz ) * 6.0 - fa . www ) ; return e_ . b * mix ( fa . xxx , clamp ( fb - fa . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , e_ . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec3 fe ( vec2 fd ) { return vec3 ( fd * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec2 fg ( vec3 ff ) { return vec2 ( ff . xy * 0.5 + vec2 ( 0.5 , 0.5 ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"fL",qualifier:["vec3"],e:!0},{type:"node_out",name:"fM",qualifier:["float"],e:!0},{type:"node_out",name:"fN",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fL"],g:[{type:"textline",b:"fL = normalize ( fI . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fM"],g:[{type:"textline",b:"fM = abs ( fI . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fN"],
g:[{type:"textline",b:"fN = length ( fI . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"fO",qualifier:["float"],e:!1},{type:"node_in",name:"fP",qualifier:["float"],e:!1},{type:"node_in",name:"fQ",qualifier:["float"],e:!1},{type:"node_out",name:"fR",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fR = vec3 ( fO , fP , fQ ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"fS",qualifier:["float"],e:!1},{type:"node_in",name:"fT",qualifier:["float"],
e:!1},{type:"node_in",name:"fU",qualifier:["float"],e:!1},{type:"node_out",name:"fV",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fV = fc ( vec3 ( fS , fT , fU ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"fW",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fW = vec3 ( - 1.0 , - 1.0 , 0.0 ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"fX",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["fX","=","eN",";"]}]},{type:"node",name:"GEOMETRY_UV",
h:[{type:"node_out",name:"fY",qualifier:["vec3"],e:!1},{type:"node_param",name:"fh",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"fY = fe ( fh ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"fZ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fZ = 2.0 * eL - eO ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"f_",qualifier:["vec3"],e:!1},{type:"node_param",name:"fi",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["f_","=","fi",
";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"ga",qualifier:["float"],e:!1},{type:"node_param",name:"fj",qualifier:["varying","float"]}],g:[{type:"textline",b:["ga","=","fj",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"gb",qualifier:["float"],e:!1},{type:"node_out",name:"gc",qualifier:["float"],e:!1},{type:"node_param",name:"fk",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"gb = fk [ 0 ] ; gc = fk [ 1 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",
h:[{type:"node_out",name:"gd",qualifier:["float"],e:!1},{type:"node_out",name:"ge",qualifier:["float"],e:!1},{type:"node_out",name:"gf",qualifier:["float"],e:!1},{type:"node_param",name:"fl",qualifier:["varying","vec3"]}],g:[{type:"textline",b:"gd = fl [ 0 ] ; ge = fl [ 1 ] ; gf = fl [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",name:"gg",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gg","=","fD",";"]}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"gh",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"gh = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",name:"gi",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gi","=","fu",";"]}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"gj",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"gj [ 0 ] = fI [ 0 ] ; gj [ 1 ] = fI [ 1 ] ; gj [ 2 ] = fI [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",
name:"gk",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"gk = vec3 ( fH . r , - fH . b , fH . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"gl",qualifier:["vec3"],e:!1},{type:"node_out",name:"gm",qualifier:["vec3"],e:!1},{type:"node_out",name:"gn",qualifier:["vec3"],e:!1},{type:"node_out",name:"go",qualifier:["vec3"],e:!1},{type:"node_out",name:"gp",qualifier:["vec3"],e:!1},{type:"node_out",name:"gq",qualifier:["vec3"],e:!1},{type:"node_out",name:"gr",qualifier:["float"],
e:!1},{type:"node_out",name:"gs",qualifier:["float"],e:!1}],g:[{type:"textline",b:"gl = eN ; gm = eN ; gn = eN ; go = eN ; gp = eN ; gq = eN ; gr = ZERO_VALUE_NODES ; gs = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"gt",qualifier:["float"],e:!1},{type:"node_in",name:"gu",qualifier:["float"],e:!1},{type:"node_in",name:"gv",qualifier:["float"],e:!1},{type:"node_in",name:"gw",qualifier:["float"],e:!1},{type:"node_in",name:"gx",qualifier:["vec3"],e:!1},{type:"node_out",
name:"gy",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"vec3 gz = eZ ( gx ) ; gz [ 0 ] += ( gt - 0.5 ) ; if ( gz [ 0 ] > UNITY_VALUE_NODES ) gz [ 0 ] -= UNITY_VALUE_NODES ; else if ( gz [ 0 ] < ZERO_VALUE_NODES ) gz [ 0 ] += UNITY_VALUE_NODES ; gz *= vec3 ( UNITY_VALUE_NODES , gu , gv ) ; gz = mix ( eO , mix ( eN , gz , step ( eN , gz ) ) , step ( gz , eO ) ) ; gy = mix ( gx , fc ( gz ) , gw ) ;".split(" ")}]},{type:"node",name:"INVERT",h:[{type:"node_in",name:"gA",qualifier:["float"],e:!1},{type:"node_in",
name:"gB",qualifier:["vec3"],e:!1},{type:"node_out",name:"gC",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"gC = mix ( gB , eO - gB , gA ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"gD",qualifier:["vec3"],e:!0},{type:"node_out",name:"gE",qualifier:["vec3"],e:!1},{type:"node_out",name:"gF",qualifier:["float"],e:!1},{type:"node_out",name:"gG",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gD"],g:[{type:"textline",b:"gD = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},
{type:"textline",b:"vec4 gH = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 gI = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 gJ = u_lamp_light_positions [ LAMP_INDEX ] ; float gK = gH . z ; if ( gK != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"gE = gJ - bQ ; gF = length ( gE ) ; gE = normalize ( gE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gG"],g:[{type:"textline",b:"gG = gK / ( gK + gF * gF ) ; float gL = gH . x ; float gM = gH . y ; if ( gL > - UNITY_VALUE_NODES ) { float gN = dot ( gE , gI ) ; gN *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( gN - gL ) / gM ) ; gG *= gN ; }".split(" ")}]}]},
{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gE"],g:[{type:"textline",b:["gE","=","gI",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gF"],g:[{type:"textline",b:"gF = length ( gJ - bQ ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gG"],g:[{type:"textline",b:["gG","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"gO",qualifier:["vec3"],e:!1},{type:"node_out",
name:"gP",qualifier:["vec3"],e:!0},{type:"node_out",name:"gQ",qualifier:["float"],e:!0},{type:"node_param",name:"fm",qualifier:["vec3"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gP"],g:[{type:"textline",b:["gP","=","fm",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gQ"],g:[{type:"textline",b:"gQ = - dot ( gO , fm ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"gR",qualifier:["vec3"],e:!1},{type:"node_out",name:"gS",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:"gS = - ( u_view_matrix_frag * vec4 ( gR , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"gT",qualifier:["vec3"],e:!1},{type:"node_in",name:"gU",qualifier:["float"],e:!1},{type:"node_in",name:"gV",qualifier:["float"],e:!1},{type:"node_in",name:"gW",qualifier:["float"],e:!1},{type:"node_in",name:"gX",qualifier:["vec3"],e:!1},{type:"node_in",name:"gY",qualifier:["vec3"],e:!1},{type:"node_out",name:"gZ",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:["gZ","=","gT",";"]},{type:"textline",b:"gU ; gV ; gW ; gX ; gY ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"g_",qualifier:["vec3"],e:!1},{type:"node_in",name:"ha",qualifier:["float"],e:!1},{type:"node_in",name:"hb",qualifier:["vec3"],e:!1},{type:"node_out",name:"hc",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hc","=","g_",";"]},{type:"textline",b:["ha",";","hb",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"hd",qualifier:["vec3"],
e:!1},{type:"node_in",name:"he",qualifier:["float"],e:!1},{type:"node_in",name:"hf",qualifier:["float"],e:!1},{type:"node_in",name:"hg",qualifier:["vec3"],e:!1},{type:"node_out",name:"hh",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hh","=","hd",";"]},{type:"textline",b:"he ; hf ; hg ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"hi",qualifier:["vec3"],e:!1},{type:"node_in",name:"hj",qualifier:["float"],e:!1},{type:"node_in",name:"hk",qualifier:["vec3"],e:!1},{type:"node_out",
name:"hl",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hl","=","hi",";"]},{type:"textline",b:["hj",";","hk",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"hm",qualifier:["vec3"],e:!1},{type:"node_in",name:"hn",qualifier:["float"],e:!1},{type:"node_in",name:"ho",qualifier:["float"],e:!1},{type:"node_in",name:"hp",qualifier:["float"],e:!1},{type:"node_out",name:"hq",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hq","=","hm",";"]},{type:"textline",b:"hn ; ho ; hp ;".split(" ")}]},
{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"hr",qualifier:["vec3"],e:!1},{type:"node_out",name:"hs",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hs","=","hr",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"ht",qualifier:["vec3"],e:!1},{type:"node_in",name:"hu",qualifier:["vec3"],e:!1},{type:"node_out",name:"hv",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hv","=","ht",";"]},{type:"textline",b:["hu",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",
name:"hw",qualifier:["vec3"],e:!1},{type:"node_in",name:"hx",qualifier:["float"],e:!1},{type:"node_in",name:"hy",qualifier:["float"],e:!1},{type:"node_in",name:"hz",qualifier:["vec3"],e:!1},{type:"node_out",name:"hA",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hA [ 0 ] = hA [ 1 ] = hA [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"hw ; hx ; hy ; hz ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"hB",qualifier:["vec3"],e:!1},{type:"node_in",name:"hC",qualifier:["float"],
e:!1},{type:"node_in",name:"hD",qualifier:["float"],e:!1},{type:"node_in",name:"hE",qualifier:["vec3"],e:!1},{type:"node_out",name:"hF",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hF","=","hB",";"]},{type:"textline",b:"hC ; hD ; hE ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"hG",qualifier:["vec3"],e:!1},{type:"node_in",name:"hH",qualifier:["float"],e:!1},{type:"node_in",name:"hI",qualifier:["vec3"],e:!1},{type:"node_out",name:"hJ",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["hJ","=","hG",";"]},{type:"textline",b:["hH",";","hI",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",h:[{type:"node_in",name:"hK",qualifier:["vec3"],e:!1},{type:"node_in",name:"hL",qualifier:["float"],e:!1},{type:"node_in",name:"hM",qualifier:["vec3"],e:!1},{type:"node_in",name:"hN",qualifier:["float"],e:!1},{type:"node_in",name:"hO",qualifier:["float"],e:!1},{type:"node_in",name:"hP",qualifier:["vec3"],e:!1},{type:"node_out",name:"hQ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hQ [ 0 ] = hQ [ 1 ] = hQ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:"hK ; hM ; hN ; hO ; hP ; hL ;".split(" ")}]},{type:"node",name:"EMISSION",h:[{type:"node_in",name:"hR",qualifier:["vec3"],e:!1},{type:"node_in",name:"hS",qualifier:["float"],e:!1},{type:"node_out",name:"hT",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hT","=","hR",";"]},{type:"textline",b:["hS",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"hU",qualifier:["vec3"],e:!1},{type:"node_out",name:"hV",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hV [ 0 ] = hV [ 1 ] = hV [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["hU",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"hW",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hW [ 0 ] = hW [ 1 ] = hW [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"hX",qualifier:["vec3"],e:!1},{type:"node_in",name:"hY",qualifier:["float"],e:!1},{type:"node_out",name:"hZ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hZ [ 0 ] = hZ [ 1 ] = hZ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
b:["hX",";","hY",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"h_",qualifier:["vec3"],e:!1},{type:"node_in",name:"ia",qualifier:["float"],e:!1},{type:"node_in",name:"ib",qualifier:["float"],e:!1},{type:"node_out",name:"ic",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ic [ 0 ] = ic [ 1 ] = ic [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"h_ ; ia ; ib ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"id",qualifier:["float"],e:!1},{type:"node_in",
name:"ie",qualifier:["float"],e:!1},{type:"node_in",name:"ig",qualifier:["float"],e:!1},{type:"node_in",name:"ih",qualifier:["vec3"],e:!1},{type:"node_out",name:"ii",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["ii","=","ih",";"]},{type:"textline",b:"id ; ie ; ig ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"ij",qualifier:["float"],e:!1},{type:"node_in",name:"ik",qualifier:["vec3"],e:!1},{type:"node_out",name:"il",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["il",
"=","ik",";"]},{type:"textline",b:["ij",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"im",qualifier:["vec3"],e:!1},{type:"node_out",name:"io",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"io [ 0 ] = io [ 1 ] = io [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["im",";"]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"ip",qualifier:["float"],e:!1},{type:"node_out",name:"iq",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"iq [ 0 ] = iq [ 1 ] = iq [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["ip",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"ir",qualifier:["float"],e:!1},{type:"node_out",name:"is",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"is [ 0 ] = is [ 1 ] = is [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["ir",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"it",qualifier:["vec3"],e:!1},{type:"node_out",name:"iu",qualifier:["float"],e:!1},{type:"node_out",name:"iv",qualifier:["float"],e:!1},{type:"node_out",name:"iw",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"iu = it [ 0 ] ; iv = it [ 1 ] ; iw = it [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"ix",qualifier:["float"],e:!1},{type:"node_in",name:"iy",qualifier:["float"],e:!1},{type:"node_in",name:"iz",qualifier:["float"],e:!1},{type:"node_out",name:"iA",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"iA [ 0 ] = ix ; iA [ 1 ] = iy ; iA [ 2 ] = iz ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"iB",
qualifier:["vec3"],e:!1},{type:"node_in",name:"iC",qualifier:["float"],e:!1},{type:"node_in",name:"iD",qualifier:["float"],e:!1},{type:"node_out",name:"iE",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float iF = iC - iD * 0.5 ; iE = max ( ( UNITY_VALUE_NODES + iD ) * iB + iF , eN ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"iG",qualifier:["float"],e:!1},{type:"node_in",name:"iH",qualifier:["float"],e:!1},{type:"node_out",name:"iI",qualifier:["float"],e:!1},{type:"node_out",
name:"iJ",qualifier:["float"],e:!1},{type:"node_out",name:"iK",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iI = iJ = iK = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["iG",";","iH",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"iL",qualifier:["vec3"],e:!1},{type:"node_out",name:"iM",qualifier:["vec3"],e:!1},{type:"node_out",name:"iN",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iM [ 0 ] = iM [ 1 ] = iM [ 2 ] = ZERO_VALUE_NODES ; iN = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:["iL",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"iO",qualifier:["vec3"],e:!1},{type:"node_out",name:"iP",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"iP [ 0 ] = iP [ 1 ] = iP [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["iO",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"iQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"iR",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"iR [ 0 ] = iR [ 1 ] = iR [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["iQ",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"iS",qualifier:["vec3"],e:!1},{type:"node_in",name:"iT",qualifier:["float"],e:!1},{type:"node_in",name:"iU",qualifier:["float"],e:!1},{type:"node_in",name:"iV",qualifier:["float"],e:!1},{type:"node_out",name:"iW",qualifier:["vec3"],e:!1},{type:"node_out",name:"iX",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iW [ 0 ] = iW [ 1 ] = iW [ 2 ] = ZERO_VALUE_NODES ; iX = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
b:"iS ; iT ; iU ; iV ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"iY",qualifier:["vec3"],e:!1},{type:"node_in",name:"iZ",qualifier:["float"],e:!1},{type:"node_in",name:"i_",qualifier:["float"],e:!1},{type:"node_in",name:"ja",qualifier:["float"],e:!1},{type:"node_in",name:"jb",qualifier:["float"],e:!1},{type:"node_out",name:"jc",qualifier:["vec3"],e:!1},{type:"node_out",name:"jd",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jc [ 0 ] = jc [ 1 ] = jc [ 2 ] = ZERO_VALUE_NODES ; jd = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"iY ; iZ ; i_ ; ja ; jb ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"je",qualifier:["vec3"],e:!1},{type:"node_in",name:"jf",qualifier:["float"],e:!1},{type:"node_out",name:"jg",qualifier:["vec3"],e:!1},{type:"node_out",name:"jh",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jg [ 0 ] = jg [ 1 ] = jg [ 2 ] = ZERO_VALUE_NODES ; jh = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["je",";","jf",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"ji",qualifier:["vec3"],e:!1},{type:"node_in",name:"jj",qualifier:["float"],e:!1},{type:"node_in",name:"jk",qualifier:["float"],e:!1},{type:"node_in",name:"jl",qualifier:["float"],e:!1},{type:"node_in",name:"jm",qualifier:["float"],e:!1},{type:"node_in",name:"jn",qualifier:["float"],e:!1},{type:"node_in",name:"jo",qualifier:["float"],e:!1},{type:"node_out",name:"jp",qualifier:["vec3"],e:!1},{type:"node_out",name:"jq",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jp [ 0 ] = jp [ 1 ] = jp [ 2 ] = ZERO_VALUE_NODES ; jq = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"ji ; jj ; jk ; jl ; jm ; jn ; jo ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"jr",qualifier:["vec3"],e:!1},{type:"node_out",name:"js",qualifier:["vec3"],e:!1},{type:"node_out",name:"jt",qualifier:["float"],e:!1}],g:[{type:"textline",b:"js [ 0 ] = js [ 1 ] = js [ 2 ] = ZERO_VALUE_NODES ; jt = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["jr",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"ju",qualifier:["vec3"],e:!1},{type:"node_in",
name:"jv",qualifier:["float"],e:!1},{type:"node_in",name:"jw",qualifier:["float"],e:!1},{type:"node_out",name:"jx",qualifier:["vec3"],e:!1},{type:"node_out",name:"jy",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jx [ 0 ] = jx [ 1 ] = jx [ 2 ] = ZERO_VALUE_NODES ; jy = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"ju ; jv ; jw ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"jz",qualifier:["vec3"],e:!1},{type:"node_in",name:"jA",qualifier:["vec3"],e:!1},{type:"node_in",
name:"jB",qualifier:["vec3"],e:!1},{type:"node_in",name:"jC",qualifier:["float"],e:!1},{type:"node_out",name:"jD",qualifier:["vec3"],e:!1},{type:"node_out",name:"jE",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jD [ 0 ] = jD [ 1 ] = jD [ 2 ] = ZERO_VALUE_NODES ; jE = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"jz ; jA ; jB ; jC ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"jF",qualifier:["vec3"],e:!1},{type:"node_in",name:"jG",qualifier:["vec3"],e:!1},{type:"node_in",
name:"jH",qualifier:["vec3"],e:!1},{type:"node_in",name:"jI",qualifier:["vec3"],e:!1},{type:"node_in",name:"jJ",qualifier:["float"],e:!1},{type:"node_in",name:"jK",qualifier:["float"],e:!1},{type:"node_in",name:"jL",qualifier:["float"],e:!1},{type:"node_in",name:"jM",qualifier:["float"],e:!1},{type:"node_in",name:"jN",qualifier:["float"],e:!1},{type:"node_out",name:"jO",qualifier:["vec3"],e:!1},{type:"node_out",name:"jP",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jO [ 0 ] = jO [ 1 ] = jO [ 2 ] = ZERO_VALUE_NODES ; jP = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"jF ; jG ; jH ; jI ; jJ ; jK ; jL ; jM ; jN ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"jQ",qualifier:["vec3"],e:!1},{type:"node_in",name:"jR",qualifier:["vec3"],e:!1},{type:"node_out",name:"jS",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jS = clamp ( jQ + jR , eN , eO ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"jT",qualifier:["float"],e:!1},{type:"node_in",name:"jU",qualifier:["vec3"],e:!1},{type:"node_in",name:"jV",
qualifier:["vec3"],e:!1},{type:"node_out",name:"jW",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float jX = clamp ( jT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; jW = jX * jU + ( UNITY_VALUE_NODES - jX ) * jV ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"jY",qualifier:["vec3"],e:!1},{type:"node_out",name:"jZ",qualifier:["vec3"],e:!1},{type:"node_param",name:"fn",qualifier:["varying","vec2"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jY"],g:[{type:"textline",
b:"jY = fe ( fn ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jZ"],g:[{type:"textline",b:"jZ = vec3 ( fn , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"j_",qualifier:["vec3"],e:!1},{type:"node_param",name:"fo",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"j_ = vec3 ( fo , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",name:"ka",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["ka","=","fC",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"kb",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["kb","=","eL",";"]}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"kc",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"kc [ 0 ] = kc [ 1 ] = kc [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"kd",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"kd [ 0 ] = fI [ 0 ] ; kd [ 1 ] = fI [ 1 ] ; kd [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",h:[{type:"node_out",name:"ke",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ke [ 0 ] = ke [ 1 ] = ke [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"kf",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"kf [ 0 ] = kf [ 1 ] = kf [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"kg",qualifier:["vec3"],e:!1},{type:"node_param",name:"fp",qualifier:["varying","vec2"]}],
g:[{type:"textline",b:"kg = vec3 ( fp , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_out",name:"kh",qualifier:["float"],e:!1},{type:"node_out",name:"ki",qualifier:["float"],e:!1},{type:"node_out",name:"kj",qualifier:["float"],e:!1},{type:"node_out",name:"kk",qualifier:["vec3"],e:!1},{type:"node_out",name:"kl",qualifier:["float"],e:!1},{type:"node_out",name:"km",qualifier:["vec3"],e:!1},{type:"node_out",name:"kn",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:"kh = ZERO_VALUE_NODES ; ki = ZERO_VALUE_NODES ; kj = ZERO_VALUE_NODES ; kk = vec3 ( ZERO_VALUE_NODES ) ; kl = ZERO_VALUE_NODES ; km = kk ; kn = kk ;".split(" ")}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"ko",qualifier:["float"],e:!1},{type:"node_out",name:"kp",qualifier:["float"],e:!1},{type:"node_out",name:"kq",qualifier:["float"],e:!1},{type:"node_out",name:"kr",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ko = ZERO_VALUE_NODES ; kp = ZERO_VALUE_NODES ; kq = ZERO_VALUE_NODES ; kr = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"ks",qualifier:["vec3"],e:!1},{type:"node_out",name:"kt",qualifier:["float"],e:!1},{type:"node_out",name:"ku",qualifier:["float"],e:!1},{type:"node_out",name:"kv",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kt = ZERO_VALUE_NODES ; ku = ZERO_VALUE_NODES ; kv = ZERO_VALUE_NODES ; ks = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"kw",qualifier:["float"],e:!1},{type:"node_out",name:"kx",
qualifier:["float"],e:!1}],g:[{type:"textline",b:["kx","=","kw",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"ky",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ky = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"kz",qualifier:["float"],e:!1},{type:"node_in",name:"kA",qualifier:["vec3"],e:!1},{type:"node_out",name:"kB",qualifier:["float"],e:!1},{type:"node_out",name:"kC",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kB = kC = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["kA",";","kz",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"kD",qualifier:["float"],e:!1},{type:"node_out",name:"kE",qualifier:["float"],e:!1},{type:"node_out",name:"kF",qualifier:["float"],e:!1},{type:"node_out",name:"kG",qualifier:["float"],e:!1},{type:"node_out",name:"kH",qualifier:["float"],e:!1},{type:"node_out",name:"kI",qualifier:["float"],e:!1},{type:"node_out",name:"kJ",qualifier:["float"],e:!1},{type:"node_out",name:"kK",qualifier:["float"],e:!1},{type:"node_out",
name:"kL",qualifier:["float"],e:!1},{type:"node_out",name:"kM",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kD = kE = kF = ZERO_VALUE_NODES ; kG = kH = kI = ZERO_VALUE_NODES ; kJ = kJ = kL = kM = ZERO_VALUE_NODES ; kK = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"kN",qualifier:["vec3"],e:!1},{type:"node_out",name:"kO",qualifier:["vec3"],e:!1},{type:"node_out",name:"kP",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kN = kO = vec3 ( ZERO_VALUE_NODES ) ; kP = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",h:[],g:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"kQ",qualifier:["float"],e:!1},{type:"node_in",name:"kR",qualifier:["vec3"],e:!1},{type:"node_out",name:"kS",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["kS","=","kR",";"]},{type:"textline",b:["kQ",";"]}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"kT",qualifier:["float"],e:!1},{type:"node_in",name:"kU",qualifier:["vec3"],e:!1},{type:"node_out",name:"kV",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["kV","=","kU",";"]},{type:"textline",b:["kT",";"]}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"kW",qualifier:["float"],e:!1},{type:"node_out",name:"kX",qualifier:["vec3"],e:!1},{type:"node_out",name:"kY",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kX [ 0 ] = kX [ 1 ] = kX [ 2 ] = clamp ( kW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; kY = kX [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",h:[{type:"node_in",name:"kZ",qualifier:["vec3"],e:!1},{type:"node_out",name:"k_",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:["k_","=","kZ",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",g:[{type:"textline",b:"k_ = ( MAPPING_TRS_MATRIX * vec4 ( k_ , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",g:[{type:"textline",b:"k_ = k_ * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",g:[{type:"textline",b:"k_ = k_ + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",g:[{type:"textline",b:"k_ = max ( k_ , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",g:[{type:"textline",b:"k_ = min ( k_ , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["MAPPING_IS_NORMAL"],g:[{type:"textline",b:"k_ = normalize ( k_ ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"la",qualifier:["float"],
e:!1},{type:"node_in",name:"lb",qualifier:["float"],e:!1},{type:"node_out",name:"lc",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lc = la + lb ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lc = clamp ( lc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"ld",qualifier:["float"],e:!1},{type:"node_in",name:"le",qualifier:["float"],e:!1},{type:"node_out",name:"lf",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"lf = ld - le ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lf = clamp ( lf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",h:[{type:"node_in",name:"lg",qualifier:["float"],e:!1},{type:"node_in",name:"lh",qualifier:["float"],e:!1},{type:"node_out",name:"li",qualifier:["float"],e:!1}],g:[{type:"textline",b:"li = lg * lh ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"li = clamp ( li , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"lj",qualifier:["float"],e:!1},{type:"node_in",name:"lk",qualifier:["float"],e:!1},{type:"node_out",name:"ll",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ll = ( lk != ZERO_VALUE_NODES ) ? lj / lk : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ll = clamp ( ll , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"lm",qualifier:["float"],e:!1},{type:"node_in",name:"ln",qualifier:["float"],e:!1},{type:"node_out",name:"lo",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lo = sin ( lm ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lo = clamp ( lo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["ln",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"lp",
qualifier:["float"],e:!1},{type:"node_in",name:"lq",qualifier:["float"],e:!1},{type:"node_out",name:"lr",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lr = cos ( lp ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lr = clamp ( lr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lq",";"]}]},{type:"node",name:"MATH_TANGENT",h:[{type:"node_in",name:"ls",qualifier:["float"],e:!1},{type:"node_in",name:"lt",qualifier:["float"],
e:!1},{type:"node_out",name:"lu",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lu = tan ( ls ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lu = clamp ( lu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lt",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"lv",qualifier:["float"],e:!1},{type:"node_in",name:"lw",qualifier:["float"],e:!1},{type:"node_out",name:"lx",qualifier:["float"],e:!1}],
g:[{type:"textline",b:"lx = ( lv <= UNITY_VALUE_NODES && lv >= - UNITY_VALUE_NODES ) ? asin ( lv ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lx = clamp ( lx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lw",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"ly",qualifier:["float"],e:!1},{type:"node_in",name:"lz",qualifier:["float"],e:!1},{type:"node_out",name:"lA",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"lA = ( ly <= UNITY_VALUE_NODES && ly >= - UNITY_VALUE_NODES ) ? acos ( ly ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lA = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lz",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"lB",qualifier:["float"],e:!1},{type:"node_in",name:"lC",qualifier:["float"],e:!1},{type:"node_out",name:"lD",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"lD = atan ( lB ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lC",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"lE",qualifier:["float"],e:!1},{type:"node_in",name:"lF",qualifier:["float"],e:!1},{type:"node_out",name:"lG",qualifier:["float"],e:!1}],g:[{type:"textline",b:"if ( lE < ZERO_VALUE_NODES || lE == ZERO_VALUE_NODES && lF == ZERO_VALUE_NODES ) lG = ZERO_VALUE_NODES ; else lG = pow ( lE , lF ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lG = clamp ( lG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"lH",qualifier:["float"],e:!1},{type:"node_in",name:"lI",qualifier:["float"],e:!1},{type:"node_out",name:"lJ",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lJ = ( lH > ZERO_VALUE_NODES && lI > ZERO_VALUE_NODES ) ? log2 ( lH ) / log2 ( lI ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lJ = clamp ( lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"lK",qualifier:["float"],e:!1},{type:"node_in",name:"lL",qualifier:["float"],e:!1},{type:"node_out",name:"lM",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lM = min ( lK , lL ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lM = clamp ( lM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"lN",qualifier:["float"],e:!1},{type:"node_in",name:"lO",qualifier:["float"],e:!1},{type:"node_out",name:"lP",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lP = max ( lN , lO ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lP = clamp ( lP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"lQ",qualifier:["float"],e:!1},
{type:"node_in",name:"lR",qualifier:["float"],e:!1},{type:"node_out",name:"lS",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lS = floor ( lQ + 0.5 ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lS = clamp ( lS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lR",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"lT",qualifier:["float"],e:!1},{type:"node_in",name:"lU",qualifier:["float"],e:!1},
{type:"node_out",name:"lV",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lV = ( lT < lU ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lV = clamp ( lV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"lW",qualifier:["float"],e:!1},{type:"node_in",name:"lX",qualifier:["float"],e:!1},{type:"node_out",name:"lY",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"lY = ( lW > lX ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lY = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"lZ",qualifier:["float"],e:!1},{type:"node_in",name:"l_",qualifier:["float"],e:!1},{type:"node_out",name:"ma",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ma = abs ( l_ ) > 0.000001 ? mod ( lZ , l_ ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ma = clamp ( ma , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"mb",qualifier:["float"],e:!1},{type:"node_in",name:"mc",qualifier:["float"],e:!1},{type:"node_out",name:"md",qualifier:["float"],e:!1}],g:[{type:"textline",b:"md = abs ( mb ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"md = clamp ( md , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",b:["mc",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"me",qualifier:["float"],e:!1},{type:"node_in",name:"mf",qualifier:["vec3"],e:!1},{type:"node_in",name:"mg",qualifier:["vec3"],e:!1},{type:"node_out",name:"mh",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mi = clamp ( me , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mh = mix ( mf , mg , mi ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mh = clamp ( mh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"mj",qualifier:["float"],e:!1},{type:"node_in",name:"mk",qualifier:["vec3"],e:!1},{type:"node_in",name:"ml",qualifier:["vec3"],e:!1},{type:"node_out",name:"mm",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mn = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mm = mix ( mk , mk + ml , mn ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mm = clamp ( mm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"mo",qualifier:["float"],e:!1},{type:"node_in",name:"mp",qualifier:["vec3"],e:!1},{type:"node_in",name:"mq",qualifier:["vec3"],e:!1},{type:"node_out",name:"mr",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float ms = clamp ( mo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mr = mix ( mp , mp * mq , ms ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mr = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"mt",qualifier:["float"],e:!1},{type:"node_in",name:"mu",qualifier:["vec3"],e:!1},{type:"node_in",name:"mv",qualifier:["vec3"],e:!1},{type:"node_out",name:"mw",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mx = clamp ( mt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mw = mix ( mu , mu - mv , mx ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mw = clamp ( mw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"my",qualifier:["float"],e:!1},{type:"node_in",name:"mz",qualifier:["vec3"],e:!1},{type:"node_in",name:"mA",qualifier:["vec3"],e:!1},{type:"node_out",name:"mB",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mC = clamp ( my , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float mD = UNITY_VALUE_NODES - mC ; mB = eO - ( vec3 ( mD ) + mC * ( eO - mA ) ) * ( eO - mz ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],
g:[{type:"textline",b:"mB = clamp ( mB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"mE",qualifier:["float"],e:!1},{type:"node_in",name:"mF",qualifier:["vec3"],e:!1},{type:"node_in",name:"mG",qualifier:["vec3"],e:!1},{type:"node_out",name:"mH",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mI = clamp ( mE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float mJ = UNITY_VALUE_NODES - mI ; mG += step ( mG , eN ) ; mH = mJ * mF + mI * mF / mG ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mH = clamp ( mH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"mK",qualifier:["float"],e:!1},{type:"node_in",name:"mL",qualifier:["vec3"],e:!1},{type:"node_in",name:"mM",qualifier:["vec3"],e:!1},{type:"node_out",name:"mN",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mO = clamp ( mK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mN = mix ( mL , abs ( mL - mM ) , mO ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mN = clamp ( mN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"mP",qualifier:["float"],e:!1},{type:"node_in",name:"mQ",qualifier:["vec3"],e:!1},{type:"node_in",name:"mR",qualifier:["vec3"],e:!1},{type:"node_out",name:"mS",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mT = clamp ( mP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mS = min ( mQ . rgb , mR . rgb * mT ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mS = clamp ( mS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"mU",qualifier:["float"],e:!1},{type:"node_in",name:"mV",qualifier:["vec3"],e:!1},{type:"node_in",name:"mW",qualifier:["vec3"],e:!1},{type:"node_out",name:"mX",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float mY = clamp ( mU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mX = max ( mV . rgb , mW . rgb * mY ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mX = clamp ( mX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"mZ",qualifier:["float"],e:!1},{type:"node_in",name:"m_",qualifier:["vec3"],e:!1},{type:"node_in",name:"na",qualifier:["vec3"],e:!1},{type:"node_out",name:"nb",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float nc = clamp ( mZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 nd = vec3 ( UNITY_VALUE_NODES - nc ) ; nb = mix ( m_ * ( nd + 2.0 * nc * na ) , eO - ( nd + 2.0 * nc * ( eO - na ) ) * ( eO - m_ ) , step ( 0.5 , m_ ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nb = clamp ( nb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"ne",qualifier:["float"],e:!1},{type:"node_in",name:"nf",qualifier:["vec3"],e:!1},{type:"node_in",name:"ng",qualifier:["vec3"],e:!1},{type:"node_out",name:"nh",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float ni = clamp ( ne , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 nj = eO - ni * ng ; vec3 nk = clamp ( nf / nj , 0.0 , 1.0 ) ; nh = mix ( mix ( nk , eO , step ( nj , eN ) ) , nf , step ( nf , eN ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nh = clamp ( nh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"nl",qualifier:["float"],e:!1},{type:"node_in",name:"nm",qualifier:["vec3"],e:!1},{type:"node_in",name:"nn",qualifier:["vec3"],e:!1},{type:"node_out",name:"no",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float np = clamp ( nl , 0.0 , 1.0 ) ; vec3 nq = vec3 ( 1.0 - np ) ; vec3 nr = nq + np * nn ; vec3 ns = clamp ( eO - ( eO - nm ) / nr , 0.0 , 1.0 ) ; no = mix ( ns , eN , step ( nr , eN ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"no = clamp ( no , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"nt",qualifier:["float"],e:!1},{type:"node_in",name:"nu",qualifier:["vec3"],e:!1},{type:"node_in",name:"nv",qualifier:["vec3"],e:!1},{type:"node_out",name:"nw",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float nx = clamp ( nt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 ny , nz , nA ; nw = nu ; nz = eZ ( nv ) ; if ( nz . y != ZERO_VALUE_NODES ) { ny = eZ ( nw ) ; ny . x = nz . x ; nA = fc ( ny ) ; nw = mix ( nw , nA , nx ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nw = clamp ( nw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"nB",qualifier:["float"],e:!1},{type:"node_in",name:"nC",qualifier:["vec3"],e:!1},{type:"node_in",name:"nD",qualifier:["vec3"],e:!1},{type:"node_out",name:"nE",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float nF = clamp ( nB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float nG = UNITY_VALUE_NODES - nF ; nE = nC ; vec3 nH , nI ; nH = eZ ( nE ) ; if ( nH . y != ZERO_VALUE_NODES ) { nI = eZ ( nD ) ; nH . y = nG * nH . y + nF * nI . y ; nE = fc ( nH ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nE = clamp ( nE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"nJ",qualifier:["float"],e:!1},{type:"node_in",name:"nK",qualifier:["vec3"],e:!1},{type:"node_in",name:"nL",qualifier:["vec3"],e:!1},{type:"node_out",name:"nM",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float nN = clamp ( nJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float nO = UNITY_VALUE_NODES - nN ; vec3 nP , nQ ; nP = eZ ( nK ) ; nQ = eZ ( nL ) ; nP . z = nO * nP . z + nN * nQ . z ; nM = fc ( nP ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nM = clamp ( nM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"nR",qualifier:["float"],e:!1},{type:"node_in",name:"nS",qualifier:["vec3"],e:!1},{type:"node_in",name:"nT",qualifier:["vec3"],e:!1},{type:"node_out",name:"nU",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float nV = clamp ( nR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 nW , nX , nY ; nU = nS ; nX = eZ ( nT ) ; if ( nX . y != ZERO_VALUE_NODES ) { nW = eZ ( nU ) ; nW . x = nX . x ; nW . y = nX . y ; nY = fc ( nW ) ; nU = mix ( nU , nY , nV ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"nU = clamp ( nU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"nZ",qualifier:["float"],e:!1},{type:"node_in",name:"n_",qualifier:["vec3"],e:!1},{type:"node_in",name:"oa",qualifier:["vec3"],e:!1},{type:"node_out",name:"ob",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float oc = clamp ( nZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float od = UNITY_VALUE_NODES - oc ; vec3 oe = oa + n_ - oa * n_ ; ob = n_ * ( vec3 ( od ) + vec3 ( oc ) * ( ( eO - n_ ) * oa + oe ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"ob = clamp ( ob , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"of",qualifier:["float"],e:!1},{type:"node_in",name:"og",qualifier:["vec3"],e:!1},{type:"node_in",name:"oh",qualifier:["vec3"],e:!1},{type:"node_out",name:"oi",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"float oj = clamp ( of , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; oi = og + oj * ( 2.0 * oh - eO ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"oi = clamp ( oi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"ok",qualifier:["vec3"],e:!1},{type:"node_in",name:"ol",qualifier:["float"],e:!1}],g:[{type:"textline",b:"fv = ok ; fz = ol ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"om",qualifier:["vec3"],e:!1},{type:"node_in",name:"on",qualifier:["vec3"],e:!1},{type:"node_in",
name:"oo",qualifier:["float"],e:!1},{type:"node_in",name:"op",qualifier:["vec3"],e:!0},{type:"node_in",name:"oq",qualifier:["float"],e:!0},{type:"node_out",name:"or",qualifier:["vec3"],e:!1},{type:"node_out",name:"os",qualifier:["vec3"],e:!1},{type:"node_out",name:"ot",qualifier:["vec3"],e:!1},{type:"node_out",name:"ou",qualifier:["vec3"],e:!1},{type:"node_out",name:"ov",qualifier:["vec3"],e:!1},{type:"node_out",name:"ow",qualifier:["vec2"],e:!1},{type:"node_out",name:"ox",qualifier:["vec2"],e:!1},
{type:"node_out",name:"oy",qualifier:["float"],e:!1},{type:"node_param",name:"fq",qualifier:["const","vec2"]},{type:"node_param",name:"fr",qualifier:["const","vec3"]}],g:[{type:"textline",b:"ot = clamp ( om , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"ou = fr [ 0 ] * clamp ( on , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],g:[{type:"textline",b:"ov = normalize ( op ) ;".split(" ")}]},{type:"node_else",
g:[{type:"textline",b:["ov","=","fC",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["SHADELESS_MAT",{type:"logic_negative_expr",d:1},"NODES_GLOW",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],g:[{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT"],g:[{type:"textline",b:"or = oq * ot ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:"or = fJ * ot ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:["ot",
"*=","oo",";"]}]}]},{type:"textline",b:"os = fK * u_environment_energy * ew ( ov ) ; oy = dY ( ot ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],g:[{type:"textline",b:"ow = vec2 ( fq [ 0 ] , fq [ 1 ] ) ;".split(" ")},{type:"textline",b:"ox = vec2 ( fr [ 1 ] , fr [ 2 ] ) ;".split(" ")}]}]},{type:"textline",b:["fy","=","oy",";"]}]},{type:"node_else",g:[{type:"textline",b:"or = eN ; os = eO ;".split(" ")}]}]}]},{type:"node",name:"MATERIAL_END",h:[{type:"node_in",
name:"oz",qualifier:["vec4"],e:!1},{type:"node_in",name:"oA",qualifier:["vec3"],e:!1},{type:"node_in",name:"oB",qualifier:["vec3"],e:!1},{type:"node_in",name:"oC",qualifier:["float"],e:!0},{type:"node_in",name:"oD",qualifier:["float"],e:!0},{type:"node_in",name:"oE",qualifier:["float"],e:!0},{type:"node_out",name:"oF",qualifier:["vec3"],e:!0},{type:"node_out",name:"oG",qualifier:["float"],e:!0},{type:"node_out",name:"oH",qualifier:["vec3"],e:!0},{type:"node_out",name:"oI",qualifier:["vec3"],e:!0},
{type:"node_out",name:"oJ",qualifier:["vec3"],e:!0},{type:"node_param",name:"fs",qualifier:["float"]},{type:"node_param",name:"ft",qualifier:["float"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oF"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:"oF = oz . rgb ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["oF","=","eN",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",
d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"et ( oF , fu , oB , oC ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:["oF","+=","oA",";"]}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oH"],g:[{type:"textline",b:["oH","=","oB",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oI"],g:[{type:"textline",b:"oI = oz . rgb ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oJ"],g:[{type:"textline",b:["oJ","=","oA",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oG"],g:[{type:"textline",b:"oG = clamp ( oE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"float oK = max ( max ( oA . r , oA . g ) , oA . b ) * oD ; oG = clamp ( oE * ( UNITY_VALUE_NODES - oK ) + oK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},
{type:"node_else",g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oG"],g:[{type:"textline",b:"oG = clamp ( fs , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"float oK = max ( max ( oA . r , oA . g ) , oA . b ) * ft ; oG = fs * ( UNITY_VALUE_NODES - oK ) + oK ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:["fw","=","oA",
";"]}]},{type:"node_else",g:[{type:"textline",b:["fw","=","eN",";"]}]}]},{type:"textline",b:["fx","=","oB",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"oL",qualifier:["vec3"],e:!1},{type:"node_in",name:"oM",qualifier:["vec3"],e:!1},{type:"node_in",name:"oN",qualifier:["vec3"],e:!1},{type:"node_out",name:"oO",qualifier:["vec4"],e:!1},{type:"node_out",name:"oP",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"oO = vec4 ( oL + oN * oM , ZERO_VALUE_NODES ) ; oP = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"oQ",qualifier:["float"],e:!1},{type:"node_out",name:"oR",qualifier:["vec3"],e:!1},{type:"node_out",name:"oS",qualifier:["vec2"],e:!1},{type:"node_out",name:"oT",qualifier:["vec3"],e:!1},{type:"node_out",name:"oU",qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1},"NUM_LIGHTS",0,{type:"g_expr",d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"oS = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","HEMI",{type:"equal_expr",d:2}],g:[{type:"textline",b:["oU","=","eM",";"]}]},{type:"node_else",g:[{type:"textline",b:["oU","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",b:"oT = u_light_color_intensities [ LAMP_IND ] ; if ( LAMP_SHADOW_MAP_IND != - 1 ) oT *= oQ ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2},"LAMP_TYPE","POINT",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],g:[{type:"textline",
b:"vec3 oV = u_light_positions [ LAMP_IND ] ; oR = oV - fH ;".split(" ")},{type:"textline",b:"float oW = length ( oR ) ; oT *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + oW * oW ) ; oR = normalize ( oR ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2}],g:[{type:"textline",b:"vec3 oX = u_light_directions [ LAMP_IND ] ; float oY = dot ( oR , oX ) ; oY *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( oY - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oT *= oY ;".split(" ")}]}]}]},
{type:"node_else",g:[{type:"textline",b:"oR = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"oZ",qualifier:["vec3"],e:!1},{type:"node_in",name:"o_",qualifier:["vec2"],e:!1},{type:"node_in",name:"pa",qualifier:["vec3"],e:!1},{type:"node_in",name:"pb",qualifier:["float"],e:!1},{type:"node_in",name:"pc",qualifier:["vec2"],e:!1},{type:"node_out",name:"pd",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pd = ZERO_VALUE_NODES ; if ( o_ . r != ZERO_VALUE_NODES ) { float pe = ( UNITY_VALUE_NODES - pb ) * dot ( pa , oZ ) + pb ; if ( pc [ 0 ] == ZERO_VALUE_NODES ) { pd = UNITY_VALUE_NODES ; } else { float pf = UNITY_VALUE_NODES + abs ( pe ) ; pf = pc [ 1 ] + ( UNITY_VALUE_NODES - pc [ 1 ] ) * pow ( pf , pc [ 0 ] ) ; pd = clamp ( pf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } pd = max ( pd , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"pg",qualifier:["vec3"],e:!1},{type:"node_in",name:"ph",qualifier:["vec2"],e:!1},{type:"node_in",name:"pi",qualifier:["vec3"],e:!1},{type:"node_in",name:"pj",qualifier:["float"],e:!1},{type:"node_out",name:"pk",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pk = ZERO_VALUE_NODES ; if ( ph . r != ZERO_VALUE_NODES ) { float pl = ( UNITY_VALUE_NODES - pj ) * dot ( pi , pg ) + pj ; pk = max ( pl , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"pm",qualifier:["vec3"],e:!1},{type:"node_in",name:"pn",qualifier:["vec2"],e:!1},{type:"node_in",name:"po",qualifier:["vec3"],e:!1},{type:"node_in",name:"pp",qualifier:["float"],e:!1},{type:"node_in",name:"pq",qualifier:["vec2"],e:!1},{type:"node_out",name:"pr",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pr = ZERO_VALUE_NODES ; if ( pn . r != ZERO_VALUE_NODES ) { float ps = ( UNITY_VALUE_NODES - pp ) * dot ( po , pm ) + pp ; if ( pq [ 0 ] > ZERO_VALUE_NODES ) { float pt = max ( dot ( po , fu ) , ZERO_VALUE_NODES ) ; float pu = pq [ 0 ] * pq [ 0 ] ; float pv = UNITY_VALUE_NODES - eM * ( pu / ( pu + 0.33 ) ) ; vec3 pw = pm - ps * po ; vec3 px = fu - pt * po ;".split(" ")},
{type:"textline",b:"if ( length ( pw ) == ZERO_VALUE_NODES || length ( px ) == ZERO_VALUE_NODES || abs ( ps ) > UNITY_VALUE_NODES || abs ( pt ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",b:"pr = ps * pv ; else { float py = acos ( ps ) ; float pz = acos ( pt ) ; vec3 pA = normalize ( pw ) ; vec3 pB = normalize ( px ) ; float pC , pD ; pC = max ( py , pz ) ; pD = min ( py , pz ) ; pD *= 0.95 ; float pE = max ( dot ( pA , pB ) , ZERO_VALUE_NODES ) ; float pF = 0.45 * ( pu / ( pu + 0.09 ) ) ; pr = ps * ( pv + ( pF * pE * sin ( pC ) * tan ( pD ) ) ) ; } } else pr = ps ; pr = max ( pr , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"pG",qualifier:["vec3"],e:!1},{type:"node_in",name:"pH",qualifier:["vec2"],e:!1},{type:"node_in",name:"pI",qualifier:["vec3"],e:!1},{type:"node_in",name:"pJ",qualifier:["float"],e:!1},{type:"node_in",name:"pK",qualifier:["vec2"],e:!1},{type:"node_out",name:"pL",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pL = ZERO_VALUE_NODES ; if ( pH . r != ZERO_VALUE_NODES ) { float pM = ( UNITY_VALUE_NODES - pJ ) * dot ( pI , pG ) + pJ ; float pN = max ( dot ( pI , fu ) , ZERO_VALUE_NODES ) ; if ( pK [ 0 ] <= UNITY_VALUE_NODES ) pL = pM * pow ( max ( pN * pM , 0.1 ) , pK [ 0 ] - UNITY_VALUE_NODES ) ; else pL = pM * pow ( 1.0001 - pN , pK [ 0 ] - UNITY_VALUE_NODES ) ; pL = max ( pL , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"pO",qualifier:["vec3"],e:!1},{type:"node_in",name:"pP",qualifier:["vec2"],e:!1},{type:"node_in",name:"pQ",qualifier:["vec3"],e:!1},{type:"node_in",name:"pR",qualifier:["float"],e:!1},{type:"node_in",name:"pS",qualifier:["vec2"],e:!1},{type:"node_out",name:"pT",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pT = ZERO_VALUE_NODES ; if ( pP . r != ZERO_VALUE_NODES ) { float pU = ( UNITY_VALUE_NODES - pR ) * dot ( pQ , pO ) + pR ; float pV = acos ( pU ) ; if ( pV < pS [ 0 ] ) pT = UNITY_VALUE_NODES ; else if ( pV > ( pS [ 0 ] + pS [ 1 ] ) || pS [ 1 ] == ZERO_VALUE_NODES ) pT = ZERO_VALUE_NODES ; else pT = UNITY_VALUE_NODES - ( ( pV - pS [ 0 ] ) / pS [ 1 ] ) ; pT = max ( pT , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"pW",qualifier:["vec3"],e:!1},{type:"node_in",name:"pX",qualifier:["vec2"],e:!1},{type:"node_in",name:"pY",qualifier:["vec3"],e:!1},{type:"node_in",name:"pZ",qualifier:["float"],e:!1},{type:"node_in",name:"p_",qualifier:["vec2"],e:!1},{type:"node_out",name:"qa",qualifier:["float"],e:!1}],g:[{type:"textline",b:"qa = ZERO_VALUE_NODES ; if ( pX . g == UNITY_VALUE_NODES ) { vec3 qb = normalize ( pW + fu ) ; qa = ( UNITY_VALUE_NODES - pZ ) * max ( dot ( pY , qb ) , ZERO_VALUE_NODES ) + pZ ; qa = pow ( qa , p_ [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"qc",qualifier:["vec3"],e:!1},{type:"node_in",name:"qd",qualifier:["vec2"],e:!1},{type:"node_in",name:"qe",qualifier:["vec3"],e:!1},{type:"node_in",name:"qf",qualifier:["vec2"],e:!1},{type:"node_out",name:"qg",qualifier:["float"],e:!1}],g:[{type:"textline",b:"qg = ZERO_VALUE_NODES ; if ( qd . g == UNITY_VALUE_NODES ) { vec3 qh = normalize ( qc + fu ) ; float qi = max ( dot ( qe , qh ) , 0.001 ) ;".split(" ")},{type:"textline",b:"float qj = max ( dot ( qe , fu ) , 0.01 ) ; float qk = max ( dot ( qe , qc ) , 0.01 ) ; float ql = tan ( acos ( qi ) ) ; float qm = max ( qf [ 0 ] , 0.001 ) ; qg = qk * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * qm * qm ) ) * ( exp ( - ( ql * ql ) / ( qm * qm ) ) / ( sqrt ( qj * qk ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"qn",qualifier:["vec3"],e:!1},{type:"node_in",name:"qo",qualifier:["vec2"],e:!1},{type:"node_in",name:"qp",qualifier:["vec3"],e:!1},{type:"node_in",name:"qq",qualifier:["vec2"],e:!1},{type:"node_out",name:"qr",qualifier:["float"],e:!1}],g:[{type:"textline",b:"qr = ZERO_VALUE_NODES ; if ( qo . g == UNITY_VALUE_NODES ) { vec3 qs = normalize ( qn + fu ) ; float qt = acos ( dot ( qs , qp ) ) ; if ( qt < qq [ 0 ] ) qr = UNITY_VALUE_NODES ; else if ( qt >= qq [ 0 ] + qq [ 1 ] || qq [ 1 ] == ZERO_VALUE_NODES ) qr = ZERO_VALUE_NODES ; else qr = UNITY_VALUE_NODES - ( qt - qq [ 0 ] ) / qq [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"qu",qualifier:["vec3"],e:!1},{type:"node_in",name:"qv",qualifier:["vec2"],e:!1},{type:"node_in",name:"qw",qualifier:["vec3"],e:!1},{type:"node_in",name:"qx",qualifier:["float"],e:!1},{type:"node_in",name:"qy",qualifier:["vec2"],e:!1},{type:"node_out",name:"qz",qualifier:["float"],e:!1}],g:[{type:"textline",b:"qz = ZERO_VALUE_NODES ; if ( qv . g == UNITY_VALUE_NODES ) { if ( qy [ 0 ] < 1.0 || qy [ 1 ] == ZERO_VALUE_NODES ) qz = ZERO_VALUE_NODES ; else { if ( qy [ 1 ] < 100.0 ) qy [ 1 ] = sqrt ( 1.0 / qy [ 1 ] ) ; else qy [ 1 ] = 10.0 / qy [ 1 ] ; vec3 qA = normalize ( fu + qu ) ; float qB = ( UNITY_VALUE_NODES - qx ) * max ( dot ( qw , qA ) , ZERO_VALUE_NODES ) + qx ; if ( qB < ZERO_VALUE_NODES ) qz = ZERO_VALUE_NODES ; else { float qC = max ( dot ( qw , fu ) , 0.01 ) ; float qD = dot ( qw , qu ) ; if ( qD <= 0.01 ) qz = ZERO_VALUE_NODES ; else { float qE = max ( dot ( fu , qA ) , 0.01 ) ; float qF = UNITY_VALUE_NODES ; float qG = ( 2.0 * qB * qC ) / qE ; float qH = ( 2.0 * qB * qD ) / qE ; float qI = min ( min ( qF , qG ) , qH ) ; float qJ = sqrt ( pow ( qy [ 0 ] , 2.0 ) + pow ( qE , 2.0 ) - UNITY_VALUE_NODES ) ; float qK = pow ( qJ - qE , 2.0 ) / pow ( qJ + qE , 2.0 ) * ( UNITY_VALUE_NODES + pow ( qE * ( qJ + qE ) - UNITY_VALUE_NODES , 2.0 ) / pow ( qE * ( qJ - qE ) + UNITY_VALUE_NODES , 2.0 ) ) ; float qL = acos ( qB ) ; qz = max ( qK * qI * exp ( - pow ( qL , 2.0 ) / ( 2.0 * pow ( qy [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"qM",qualifier:["vec4"],e:!1},{type:"node_in",name:"qN",qualifier:["vec3"],e:!1},{type:"node_in",name:"qO",qualifier:["float"],e:!1},{type:"node_in",name:"qP",qualifier:["float"],e:!1},{type:"node_in",name:"qQ",qualifier:["vec3"],e:!1},{type:"node_in",name:"qR",qualifier:["vec3"],e:!1},{type:"node_in",name:"qS",qualifier:["vec4"],e:!1},{type:"node_in",name:"qT",qualifier:["vec3"],e:!1},{type:"node_in",name:"qU",qualifier:["vec3"],e:!1},{type:"node_in",
name:"qV",qualifier:["vec3"],e:!1},{type:"node_in",name:"qW",qualifier:["float"],e:!1},{type:"node_out",name:"qX",qualifier:["vec4"],e:!1},{type:"node_out",name:"qY",qualifier:["vec3"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_NODE_B4W_TRANSLUCENCY"],g:[{type:"textline",b:"if ( dot ( qQ , qR ) * dot ( fu , qR ) < ZERO_VALUE_NODES ) { float qZ = qS . x ; float q_ = qS . y ; float ra = qS . z ; float rb = qS . w ;".split(" ")},{type:"textline",b:"float rc = clamp ( abs ( dot ( qQ , qR ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float rd = clamp ( dot ( fu , - qQ ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float re = pow ( rd , q_ ) ;".split(" ")},
{type:"textline",b:"qX = qM + qW * vec4 ( qV * rc * pow ( qT , vec3 ( qZ ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"qX += ra * mix ( vec4 ( qT , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , rb ) * qW * vec4 ( qV * rc * vec3 ( re ) , UNITY_VALUE_NODES ) ; qY = qN ; } else {".split(" ")},{type:"textline",b:"qY = qN + qV * qU * qP ; qX = qM + vec4 ( qV * qT * qO , qP ) ; }".split(" ")}]},{type:"node_else",g:[{type:"textline",b:"qY = qN + qV * qU * qP ; qX = qM + vec4 ( qV * qT * qO , qP ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"rf",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"rf = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"rg",qualifier:["vec3"],e:!1},{type:"node_out",name:"rh",qualifier:["float"],e:!1}],g:[{type:"textline",b:"rh = dot ( rg , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"ri",qualifier:["vec3"],e:!1},{type:"node_out",name:"rj",qualifier:["float"],e:!0},
{type:"node_out",name:"rk",qualifier:["float"],e:!0},{type:"node_out",name:"rl",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rj"],g:[{type:"textline",b:"rj = ri . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rk"],g:[{type:"textline",b:"rk = ri . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rl"],g:[{type:"textline",b:"rl = ri . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"rm",
qualifier:["vec3"],e:!1},{type:"node_out",name:"rn",qualifier:["float"],e:!0},{type:"node_out",name:"ro",qualifier:["float"],e:!0},{type:"node_out",name:"rp",qualifier:["float"],e:!0}],g:[{type:"textline",b:"vec3 rq = eZ ( rm ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rn"],g:[{type:"textline",b:"rn = rq . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ro"],g:[{type:"textline",b:"ro = rq . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_rp"],g:[{type:"textline",b:"rp = rq . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"rr",qualifier:["float"],e:!1},{type:"node_in",name:"rs",qualifier:["float"],e:!1},{type:"node_in",name:"rt",qualifier:["float"],e:!1},{type:"node_out",name:"ru",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ru = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( ( rr - rt ) * rs ) ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"rv",
qualifier:["vec3"],e:!1},{type:"node_in",name:"rw",qualifier:["float"],e:!1},{type:"node_out",name:"rx",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"rx = max ( eN , rv ) ; rx = pow ( rx , vec3 ( rw ) ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"ry",qualifier:["vec3"],e:!1},{type:"node_out",name:"rz",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"rz = max ( eN , ry ) ; rz = pow ( rz , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",
h:[{type:"node_in",name:"rA",qualifier:["vec3"],e:!1},{type:"node_out",name:"rB",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"rB = max ( eN , rA ) ; rB = pow ( rB , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"rC",qualifier:["vec3"],e:!1},{type:"node_out",name:"rD",qualifier:["vec3"],e:!1},{type:"node_out",name:"rE",qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rE"],g:[{type:"textline",b:"rC [ 2 ] = rC [ 1 ] = rC [ 0 ] = 0.0 ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rE"],g:[{type:"textline",b:"rD [ 2 ] = rD [ 1 ] = rD [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rE"],g:[{type:"textline",b:["rE","=","0.0",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",h:[{type:"node_in",name:"rF",qualifier:["vec3"],e:!1},{type:"node_out",name:"rG",qualifier:["vec3"],e:!0},{type:"node_out",name:"rH",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",
qualifier:["uniform","samplerCube"]}],g:[{type:"textline",b:"vec4 rI = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , rF ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rG"],g:[{type:"textline",b:"rG = rI . xyz ; a_ ( rG ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rH"],g:[{type:"textline",b:"rH = rI . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"rJ",qualifier:["vec3"],e:!0},{type:"node_in",name:"rK",qualifier:["vec3"],
e:!0},{type:"node_in",name:"rL",qualifier:["vec3"],e:!0},{type:"node_in",name:"rM",qualifier:["vec3"],e:!0},{type:"node_out",name:"rN",qualifier:["vec3"],e:!0},{type:"node_out",name:"rO",qualifier:["float"],e:!0},{type:"node_out",name:"rP",qualifier:["vec3"],e:!0},{type:"node_out",name:"rQ",qualifier:["float"],e:!0},{type:"node_out",name:"rR",qualifier:["vec3"],e:!0},{type:"node_out",name:"rS",qualifier:["float"],e:!0},{type:"node_out",name:"rT",qualifier:["vec3"],e:!0},{type:"node_out",name:"rU",
qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"vec4 rV = texture2D ( node_TEXTURE_COLOR_var_texture , fg ( rJ ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rN"],g:[{type:"textline",b:"rN = rV . xyz ; a_ ( rN ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rO"],g:[{type:"textline",b:"rO = rV . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_uv2"],g:[{type:"textline",b:"rV = texture2D ( node_TEXTURE_COLOR_var_texture , fg ( rK ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rP"],g:[{type:"textline",b:"rP = rV . xyz ; a_ ( rP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rQ"],g:[{type:"textline",b:"rQ = rV . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",b:"rV = texture2D ( node_TEXTURE_COLOR_var_texture , fg ( rL ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rR"],g:[{type:"textline",b:"rR = rV . xyz ; a_ ( rR ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rS"],g:[{type:"textline",b:"rS = rV . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"rV = texture2D ( node_TEXTURE_COLOR_var_texture , fg ( rM ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rT"],g:[{type:"textline",b:"rT = rV . xyz ; a_ ( rT ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rU"],g:[{type:"textline",b:"rU = rV . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"rW",qualifier:["vec3"],e:!0},{type:"node_in",name:"rX",qualifier:["vec3"],e:!0},{type:"node_in",name:"rY",qualifier:["vec3"],e:!0},{type:"node_in",name:"rZ",qualifier:["vec3"],e:!0},{type:"node_out",name:"r_",qualifier:["vec3"],e:!0},{type:"node_out",name:"sa",qualifier:["float"],e:!0},{type:"node_out",name:"sb",qualifier:["vec3"],
e:!0},{type:"node_out",name:"sc",qualifier:["float"],e:!0},{type:"node_out",name:"sd",qualifier:["vec3"],e:!0},{type:"node_out",name:"se",qualifier:["float"],e:!0},{type:"node_out",name:"sf",qualifier:["vec3"],e:!0},{type:"node_out",name:"sg",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"vec4 sh = texture2D ( node_TEXTURE_NORMAL_var_texture , fg ( rW ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_r_"],g:[{type:"textline",b:"r_ = normalize ( fG * ( sh . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sa"],g:[{type:"textline",b:"sa = sh . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],g:[{type:"textline",b:"sh = texture2D ( node_TEXTURE_NORMAL_var_texture , fg ( rX ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sb"],g:[{type:"textline",b:"sb = normalize ( fG * ( sh . xyz - 0.5 ) ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sc"],g:[{type:"textline",b:"sc = sh . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",b:"sh = texture2D ( node_TEXTURE_NORMAL_var_texture , fg ( rY ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sd"],g:[{type:"textline",b:"sd = normalize ( fG * ( sh . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_se"],g:[{type:"textline",b:"se = sh . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"sh = texture2D ( node_TEXTURE_NORMAL_var_texture , fg ( rZ ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sf"],g:[{type:"textline",b:"sf = normalize ( fG * ( sh . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sg"],g:[{type:"textline",b:"sg = sh . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",name:"si",qualifier:["float"],e:!1}],
g:[{type:"textline",b:"si = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"sj",qualifier:["vec3"],e:!1},{type:"node_in",name:"sk",qualifier:["vec3"],e:!1},{type:"node_out",name:"sl",qualifier:["vec3"],e:!1},{type:"node_out",name:"sm",qualifier:["float"],e:!0}],g:[{type:"textline",b:"sl = sj + sk ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sm"],g:[{type:"textline",b:"sm = ( abs ( sl [ 0 ] ) + abs ( sl [ 1 ] ) + abs ( sl [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"sn",qualifier:["vec3"],e:!1},{type:"node_in",name:"so",qualifier:["vec3"],e:!1},{type:"node_out",name:"sp",qualifier:["vec3"],e:!1},{type:"node_out",name:"sq",qualifier:["float"],e:!0}],g:[{type:"textline",b:"sp = sn - so ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sq"],g:[{type:"textline",b:"sq = ( abs ( sp [ 0 ] ) + abs ( sp [ 1 ] ) + abs ( sp [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
h:[{type:"node_in",name:"sr",qualifier:["vec3"],e:!1},{type:"node_in",name:"ss",qualifier:["vec3"],e:!1},{type:"node_out",name:"st",qualifier:["vec3"],e:!1},{type:"node_out",name:"su",qualifier:["float"],e:!0}],g:[{type:"textline",b:"st = sr + ss ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_su"],g:[{type:"textline",b:"su = length ( st ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_st"],g:[{type:"textline",b:"st = normalize ( st ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"sv",qualifier:["vec3"],e:!1},{type:"node_in",name:"sw",qualifier:["vec3"],e:!1},{type:"node_out",name:"sx",qualifier:["vec3"],e:!1},{type:"node_out",name:"sy",qualifier:["float"],e:!0}],g:[{type:"textline",b:["sx","=","eN",";"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sy"],g:[{type:"textline",b:"sy = dot ( sv , sw ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",name:"sz",qualifier:["vec3"],
e:!1},{type:"node_in",name:"sA",qualifier:["vec3"],e:!1},{type:"node_out",name:"sB",qualifier:["vec3"],e:!1},{type:"node_out",name:"sC",qualifier:["float"],e:!0}],g:[{type:"textline",b:"sB = cross ( sz , sA ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sC"],g:[{type:"textline",b:"sC = length ( sB ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"sD",qualifier:["vec3"],e:!1},{type:"node_in",name:"sE",qualifier:["vec3"],e:!1},{type:"node_out",
name:"sF",qualifier:["vec3"],e:!1},{type:"node_out",name:"sG",qualifier:["float"],e:!0}],g:[{type:"textline",b:"sF = normalize ( sD ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sG"],g:[{type:"textline",b:"sG = length ( sD ) ;".split(" ")}]}]},{type:"textline",b:["sE",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"sH",qualifier:["vec3"],e:!1},{type:"node_in",name:"sI",qualifier:["vec3"],e:!1},{type:"node_out",name:"sJ",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:"sJ = reflect ( - sH , sI ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"sK",qualifier:["vec3"],e:!1},{type:"node_in",name:"sL",qualifier:["float"],e:!1},{type:"node_in",name:"sM",qualifier:["const","float"],e:!1},{type:"node_in",name:"sN",qualifier:["const","float"],e:!1},{type:"node_out",name:"sO",qualifier:["vec3"],e:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"float sP = length ( fI ) ; if ( sP < sN ) { vec2 sQ = fg ( sK ) ; float sR = clamp ( 0.5 * ( sN - sP ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float sS = sL * sR ;".split(" ")},
{type:"textline",b:"vec3 sT = normalize ( fu * fG ) ;".split(" ")},{type:"textline",b:"float sU = UNITY_VALUE_NODES / sM ;".split(" ")},{type:"textline",b:"vec2 sV = sT . xy * sS / ( sM * sT . z ) ; float sW = UNITY_VALUE_NODES ; float sX = texture2D ( node_B4W_PARALLAX_var_texture , sQ ) . a ;".split(" ")},{type:"textline",b:"for ( float sY = 1.0 ; sY <= sM ; sY ++ ) { if ( sX < sW ) { sW -= sU ; sQ -= sV ; sX = texture2D ( node_B4W_PARALLAX_var_texture , sQ ) . a ; } }".split(" ")},{type:"textline",
b:"vec2 sZ = sQ + sV ; float s_ = texture2D ( node_B4W_PARALLAX_var_texture , sZ ) . a - ( sW + sU ) ; float ta = sX - sW ; float tb = ta / ( ta - s_ ) ;".split(" ")},{type:"textline",b:"sQ = tb * sZ + ( UNITY_VALUE_NODES - tb ) * sQ ; sO = fe ( sQ ) ; } else sO = sK ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"tc",qualifier:["vec3"],e:!1},{type:"node_out",name:"td",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"td = clamp ( tc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"te",qualifier:["vec3"],e:!1},{type:"node_in",name:"tf",qualifier:["float"],e:!1},{type:"node_out",name:"tg",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"tg = eS ( te , tf ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"th",qualifier:["float"],e:!1},{type:"node_in",name:"ti",qualifier:["float"],e:!1},{type:"node_in",name:"tj",qualifier:["float"],e:!1},{type:"node_in",name:"tk",qualifier:["float"],e:!1},
{type:"node_in",name:"tl",qualifier:["float"],e:!1},{type:"node_out",name:"tm",qualifier:["float"],e:!0},{type:"node_out",name:"tn",qualifier:["vec4"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tm"],g:[{type:"textline",b:["tm","=","th",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tn"],g:[{type:"textline",b:"tn = vec4 ( ti , tj , tk , tl ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"to",qualifier:["float"],e:!1}],g:[{type:"textline",
b:["to","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"tp",qualifier:["float"],e:!1},{type:"node_in",name:"tq",qualifier:["float"],e:!1},{type:"node_in",name:"tr",qualifier:["float"],e:!1},{type:"node_out",name:"ts",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ts = smoothstep ( tq , tr , tp ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"tt",qualifier:["vec3"],e:!1},{type:"node_in",name:"tu",qualifier:["float"],e:!1}],g:[{type:"textline",
b:"fv = tt ; fz = tu ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"tv",qualifier:["vec3"],e:!1},{type:"node_out",name:"tw",qualifier:["float"],e:!1}],g:[{type:"textline",b:"tw = ( tv . r + tv . g + tv . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"tx",qualifier:["float"],e:!1},{type:"node_out",name:"ty",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ty [ 0 ] = tx ; ty [ 1 ] = tx ; ty [ 2 ] = tx ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",b:"void tz ( in vec3 fu , out vec3 fv , out vec3 fw , out vec3 fx , out float fy , out float fz ) { fv = eN ; fw = eN ; fx = eN ; fy = ZERO_VALUE_NODES ; fz = ZERO_VALUE_NODES ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"vec3 fA = normalize ( bS ) ; vec3 fB = fA ;".split(" ")},{type:"condition",a:[{type:"if",
c:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) fB = fB ; else fB = - fB ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:["vec3","fC","=","fB",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","fC","=","fA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_NO"],group:{type:"group",a:[{type:"textline",
b:["vec3","fD","=","fB",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 fE = cross ( fB , bT . xyz ) * bT . w ; mat3 fF = mat3 ( bT . xyz , fE , fB ) ; mat3 fG = fF ;".split(" ")}]}}]},{type:"textline",b:"vec3 fH = bQ ; vec4 fI = bR ; float fJ = u_emit ; float fK = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},
{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 tA = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 tG ( vec3 tB , mat4 tC ) { vec3 tD = vec3 ( tC [ 0 ] [ 0 ] , tC [ 1 ] [ 0 ] , tC [ 2 ] [ 0 ] ) ; vec3 tE = vec3 ( tC [ 0 ] [ 1 ] , tC [ 1 ] [ 1 ] , tC [ 2 ] [ 1 ] ) ; vec3 tF = vec3 ( tC [ 0 ] [ 2 ] , tC [ 1 ] [ 2 ] , tC [ 2 ] [ 2 ] ) ; tE = cross ( tF , tD ) ; tD = normalize ( tD ) ; tE = normalize ( tE ) ; tF = normalize ( tF ) ; return mat4 ( vec4 ( tD , 0.0 ) , vec4 ( tE , 0.0 ) , vec4 ( tF , 0.0 ) , vec4 ( tB , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 tM ( vec3 tH , vec3 tI ) { vec3 tJ = tH - tI ; tJ . y = 0.0 ; vec3 tK = cross ( tA , tJ ) ; vec3 tL = cross ( tJ , tK ) ; tK = normalize ( tK ) ; tL = normalize ( tL ) ; tJ = normalize ( tJ ) ; return mat4 ( vec4 ( tK , 0.0 ) , vec4 ( tL , 0.0 ) , vec4 ( tJ , 0.0 ) , vec4 ( tI , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 tW ( in vec3 tN , float tO , float tP , float tQ , vec3 tR ) { float tS = fract ( length ( tR ) / 0.17 ) ; float tT = tQ + tS / 10.0 ; float tU = tS ; if ( tQ != 0.0 ) tU /= tQ ; tN *= 1.0 + 0.5 * sin ( tO ) ; float tV = length ( tN ) * tP * sin ( 2.0 * 3.14 * tO * tT + tU ) ; return bH ( tV ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 ug ( in vec3 tX , in vec3 tY , in mat4 tZ ) {".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 t_ = tG ( tY , tZ ) ;".split(" ")}]}},{type:"elif",c:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",b:"float ua = fract ( ( tY . x * 1.43 + tY . y * 0.123 + tY . z * 6.1 ) ) ; float ub = 2.0 * M_PI * ua ; vec3 uc = normalize ( vec3 ( tZ [ 0 ] [ 2 ] , 0.0 , tZ [ 2 ] [ 2 ] ) ) ; float ud = acos ( uc [ 2 ] ) ; if ( uc [ 0 ] < 0.0 ) ud = 2.0 * M_PI - ud ; float ue = ud - ub ; if ( ue < 0.0 ) ue = 2.0 * M_PI + ue ; float uf = ub ; if ( ue <= MAX_BILLBOARD_ANGLE ) uf += ue ; else if ( ue <= M_PI - MAX_BILLBOARD_ANGLE ) uf += MAX_BILLBOARD_ANGLE * ( 2.0 * ue - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( ue <= M_PI + MAX_BILLBOARD_ANGLE ) uf += ue - M_PI ; else if ( ue <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) uf += MAX_BILLBOARD_ANGLE * ( 2.0 * ue - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else uf += ue - 2.0 * M_PI ; mat4 t_ = bF ( uf ) ; t_ [ 3 ] = vec4 ( tY , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 t_ = tM ( tX , tY ) ;".split(" ")}]}}]},{type:"textline",b:["return","t_",";","}"]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 um ( in vec3 uh , in vec3 ui , in mat4 uj , mat4 uk ) { mat4 ul = ug ( uh , ui , uj ) ; uk [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; ul = ul * uk ; return ul ; }".split(" ")}]}}]},
{type:"textline",b:"bh ut ( in vec3 un , in vec3 uo , in vec3 up , in vec3 uq , in vec3 ur , in mat4 us ) { un = ( us * vec4 ( un , 1.0 ) ) . xyz ; uo = ( us * vec4 ( uo , 1.0 ) ) . xyz ; up = ( us * vec4 ( up , 0.0 ) ) . xyz ; uq = ( us * vec4 ( uq , 0.0 ) ) . xyz ; ur = ( us * vec4 ( ur , 0.0 ) ) . xyz ; return bJ ( bh ( un , uo , up , uq , ur , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 uw ( vec2 uu , vec3 uv ) { return ( uu + 0.5 ) * uv . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 uF ( in vec4 ux , in vec4 uy , in float uz ) { float uA = ux [ 0 ] * uy [ 0 ] + ux [ 1 ] * uy [ 1 ] + ux [ 2 ] * uy [ 2 ] + ux [ 3 ] * uy [ 3 ] ; if ( uA < 0.0 ) { uy *= - 1.0 ; uA = - uA ; } if ( abs ( uA ) >= 1.0 ) return ux ; float uB = acos ( uA ) ; float uC = sqrt ( 1.0 - uA * uA ) ; if ( abs ( uC ) < 0.001 ) return vec4 ( ux * 0.5 + uy * 0.5 ) ; float uD = sin ( ( 1.0 - uz ) * uB ) / uC ; float uE = sin ( uz * uB ) / uC ; return ux * uD + uy * uE ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 uV ( in vec3 uG , in vec4 uH , in vec4 uI , in vec4 uJ , in vec4 uK , in float uL ) { vec3 uM = bu ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uG , 1.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 uN = uF ( uH , uI , uL ) ; vec4 uO = mix ( uJ , uK , uL ) ; vec3 uP = bn ( uN , uM ) ; vec3 uQ = uP * uO . w + uO . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 uR = bn ( uH , uM ) ; vec3 uS = bn ( uI , uM ) ; vec3 uT = uR * uJ . w + uJ . xyz ; vec3 uU = uS * uK . w + uK . xyz ; vec3 uQ = mix ( uT , uU , uL ) ;".split(" ")}]}}]},{type:"textline",b:"return bA ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uQ , 1.0 ) ) ; } vec3 ve ( in vec3 uW , in vec4 uX , in vec4 uY , in float uZ ) { vec3 u_ = bu ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uW , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 va = uF ( uX , uY , uZ ) ; vec3 vb = bn ( va , u_ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 vc = bn ( uX , u_ ) ; vec3 vd = bn ( uY , u_ ) ; vec3 vb = mix ( vc , vd , uZ ) ;".split(" ")}]}}]},{type:"textline",b:"return bA ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( vb , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 uV ( in vec3 vf , in vec4 vg , in vec4 vh ) { vec3 vi = bu ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( vf , 1.0 ) ) ; vec3 vj = bn ( vg , vi ) ; vec3 vk = vj * vh . w + vh . xyz ; return bA ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( vk , 1.0 ) ) ; } vec3 ve ( in vec3 vl , in vec4 vm ) { vec3 vn = bu ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( vl , 0.0 ) ) ; vec3 vo = bn ( vm , vn ) ; return bA ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( vo , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void vD ( inout vec3 vp , inout vec3 vq , inout vec3 vr , inout vec3 vs ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["float","vt","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { vec3 vu = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 vv = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 vw = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 vx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 vy = a_influence ; for ( int vz = 0 ; vz < 4 ; vz ++ ) { int vA = int ( vy [ vz ] ) ; float vB = fract ( vy [ vz ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vu += vB * uV ( vp , u_quatsb [ vA ] , u_quatsa [ vA ] , u_transb [ vA ] , u_transa [ vA ] , vt ) ; vv += vB * ve ( vq , u_quatsb [ vA ] , u_quatsa [ vA ] , vt ) ; vw += vB * ve ( vr , u_quatsb [ vA ] , u_quatsa [ vA ] , vt ) ; vx += vB * ve ( vs , u_quatsb [ vA ] , u_quatsa [ vA ] , vt ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vu += vB * uV ( vp , u_quatsb [ vA ] , u_transb [ vA ] ) ; vv += vB * ve ( vq , u_quatsb [ vA ] ) ; vw += vB * ve ( vr , u_quatsb [ vA ] ) ; vx += vB * ve ( vs , u_quatsb [ vA ] ) ;".split(" ")}]}}]},
{type:"textline",b:"} vp = vu ; vq = vv ; vr = vw ; vs = vx ; } if ( ! ( a_influence . y > 0.0 ) ) { int vC = int ( a_influence [ 0 ] - 1.0 ) ; if ( vC > - 1 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vp = uV ( vp , u_quatsb [ vC ] , u_quatsa [ vC ] , u_transb [ vC ] , u_transa [ vC ] , vt ) ; vq = ve ( vq , u_quatsb [ vC ] , u_quatsa [ vC ] , vt ) ; vr = ve ( vr , u_quatsb [ vC ] , u_quatsa [ vC ] , vt ) ; vs = ve ( vs , u_quatsb [ vC ] , u_quatsa [ vC ] , vt ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vp = uV ( vp , u_quatsb [ vC ] , u_transb [ vC ] ) ; vq = ve ( vq , u_quatsb [ vC ] ) ; vr = ve ( vr , u_quatsb [ vC ] ) ; vs = ve ( vs , u_quatsb [ vC ] ) ;".split(" ")}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void vS ( inout vec3 vE , in vec3 vF , in float vG , in float vH , in float vI , in vec3 vJ , in float vK ) { float vL = length ( vF ) ; float vM = vH * ( 1.0 + 0.1 * fract ( vL ) ) ; float vN = vG * vK * ( 1.0 + sin ( 2.0 * 3.14 * vI * vM + vL ) ) ; float vO = ( vE . y - vF . y ) * abs ( vN ) ; vO += 1.0 ; vO *= vO ; vO = vO * vO - vO ; vec3 vP = vE ; vP . xz += vJ . xz * vO * sign ( vN ) ; vec3 vQ = vP - vF ; if ( all ( equal ( vQ , vec3 ( 0.0 ) ) ) ) vE = vF ; else { float vR = length ( vE - vF ) ; vE = vF + normalize ( vQ ) * vR ; } }".split(" ")},
{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 vU ( vec4 vT ) { return vT * vT * ( 3.0 - 2.0 * vT ) ; } vec4 vW ( vec4 vV ) { return abs ( fract ( vV + 0.5 ) * 2.0 - 1.0 ) ; } vec4 vY ( vec4 vX ) { return vU ( vW ( vX ) ) ; } void wo ( inout vec3 vZ , in float v_ , in vec3 wa , in vec3 wb , in vec3 wc , in float wd , in float we , in float wf , in vec3 wg ) { float wh ; float wi ; float wj ; vec2 wk ; vec4 wl ; vec2 wm ; vec3 wn ; wh = dot ( wc , vec3 ( 1.0 ) ) ; wi = wh + wg . g ; wj = dot ( vZ , vec3 ( wg . g ) ) ; wk = ( v_ + vec2 ( wj , wi ) ) ; wl = ( ( fract ( ( wk . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( wb ) * wd ; wl = vY ( wl ) ; wm = wl . xz + wl . yw ; wm . y = 0.5 - wm . y ; wn = wm . xyx * wg . rbr * vec3 ( we * wa . x , wf , we * wa . z ) ; vZ += wn ; }".split(" ")}]}}]},
{type:"textline",b:"void wv ( inout vec3 wp , inout vec3 wq , in vec3 wr ) { vec3 ws = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vec3 wt = wq ; vec3 wu = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 wt = wp ; vec3 wu = wq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"wo ( wt , u_time , wr , ws , wu , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"vS ( wt , wu , au_wind_bending_amp , au_wind_bending_freq , u_time , ws , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vS ( wt , wu , au_wind_bending_amp , au_wind_bending_freq , u_time , ws , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"wp += wt - wq ; wq = wt ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wp = wt ; wq = wu ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 eL ;".split(" ")}]}}]},
{type:"node",name:"TEX_COORD_UV",h:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"fo",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["fo","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",h:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"fn",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["fn","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",
name:"UVMAP",h:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"fp",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["fp","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"fh",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["fh","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_param",
name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"ww",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["ww","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"wx",qualifier:["varying","float"]}],g:[{type:"textline",b:["wx","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",
h:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"wy",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["wy","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"wz",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["wz","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},
{type:"nodes_global"},{type:"textline",b:["void","wA","(",")","{"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["eL","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 wF ( vec3 wB , float wC , vec2 wD ) { vec2 wE = vec2 ( ( wB . x - wD . x ) / wC , - ( wB . z - wD . y ) / wC ) ; return fract ( wE ) ; } vec2 wJ ( vec2 wG , float wH , vec2 wI ) { return vec2 ( wG . x * wH , - wG . y * wH ) + wI ; } bh wK ( ) { return bh ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } bh xp ( vec3 wL , vec3 wM , vec3 wN , vec3 wO , vec3 wP , PRECISION sampler2D wQ , sampler2D wR , vec3 wS , float wT , vec3 wU , vec4 wV , mat4 wW ) { vec3 wX = bn ( wV , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; float wY = - wX . x ; float wZ = - wX . z ; vec2 w_ = vec2 ( wU . x + wT * ( - 1.0 - wY ) / 2.0 , wU . z + wT * ( 1.0 - wZ ) / 2.0 ) ; vec2 xa = wF ( wP , wT , w_ ) ; float xb = wT / 2.0 ; vec2 xc = abs ( wJ ( xa - vec2 ( 0.5 ) , wT , vec2 ( 0.0 ) ) ) ; float xd = xb * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( xc ) > xd ) return wK ( ) ; float xe = wT / wS . z ; vec2 xf = ( xa - vec2 ( 0.5 ) ) * xe + vec2 ( 0.5 ) ; vec3 xg = wX * ( wT / wS . z - 1.0 ) / 2.0 ; xf . x += xg . x ; xf . y -= xg . z ; vec4 xh = texture2D ( wR , xf ) ; float xi = xh . r ; if ( xi < u_scale_threshold ) return wK ( ) ; float xj = wS . y - wS . x ; float xk = wS . y - texture2D ( wQ , xf ) . r * xj ; vec2 xl = wL . xz - wP . xz ; wP . xz = wJ ( xa , wT , w_ ) ; wP . y = xk ; wL . xz = wP . xz + xl ; wL . y *= xi ; wL . y += xk ; vec3 xm = xh . gba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wL -= wP ; mat4 xn = ug ( wU , wP , wW ) ; bh xo = ut ( wL , wP , wM , wN , wO , xn ) ; xo . b = wP ; xo . f = xm ; return bJ ( xo ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return bJ ( bh ( wL , wP , wM , wN , wO , xm ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 xv ( mat4 xq , vec4 xr ) { vec2 xs = ( xq * u_v_light_matrix [ 3 ] ) . xy ; float xt = SHADOW_TEX_RES / 2.0 ; xs = floor ( xs * xt + 0.5 ) / xt - xs ; vec4 xu = xq * xr ; xu . xy += xs ; xu = u_b_light_matrix * xu ; return xu ; } void xz ( vec3 xw , vec3 xx ) { vec4 xy = u_v_light_matrix * vec4 ( xw + u_normal_offset * xx , 1.0 ) ; bW = xv ( u_p_light_matrix0 , xy ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"bX = xv ( u_p_light_matrix1 , xy ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"bY = xv ( u_p_light_matrix2 , xy ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"bZ = xv ( u_p_light_matrix3 , xy ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/fog.glslf"]=
{type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"textline",b:"void xK ( inout vec3 xD , in float xE , in float xF , in vec4 xG ) {".split(" ")},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:"float xH = clamp ( ( xE - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOG_TYPE","QUADRATIC",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["xH","*=","xH",";"]}]}},{type:"elif",
c:["FOG_TYPE","LINEAR",{type:"equal_expr",d:2}],group:{type:"group",a:[]}},{type:"elif",c:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xH = sqrt ( xH ) ;".split(" ")}]}}]},{type:"textline",b:"if ( u_fog_params . w > 0.0 ) { if ( xF > u_fog_params . w ) xH = 0.0 ; else if ( xF > 0.0 ) { float xI = ( u_fog_params . w - xF ) / u_fog_params . w ; xH *= xI * xI ; } } float xJ = 1.0 - ( 1.0 - xH ) * ( 1.0 - u_fog_params . x ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["float","xJ","=","0.0",";"]}]}}]},{type:"textline",b:"xD = mix ( xD , xG . rgb , xJ ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 xR ( in mat4 xL , in vec3 xM ) { vec3 xN = mix ( xL [ 0 ] . rgb , xL [ 1 ] . rgb , max ( sign ( xM . x ) , 0.0 ) ) ; vec3 xO = mix ( xL [ 2 ] . rgb , xL [ 3 ] . rgb , max ( sign ( xM . z ) , 0.0 ) ) ; vec3 xP = vec3 ( xL [ 0 ] . a , xL [ 1 ] . a , xL [ 2 ] . a ) ; vec3 xQ = mix ( xN , xO , abs ( xM . z ) ) ; xQ = mix ( xQ , xP , abs ( xM . y ) ) ; a_ ( xQ ) ; return xQ ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void xT ( inout float xS ) { xS -= 0.5 ; xS = 4.0 * ( xS * xS * xS ) + 0.5 ; } void yi ( inout vec3 xU , in float xV , in vec3 xW , in float xX , in vec4 xY , in vec4 xZ , in float x_ ) { float ya = xZ . w * xV ; float yb = exp ( - ya * ya ) ; yb = clamp ( yb , 0.0 , 1.0 ) ; float yc = max ( xW . y , 0.0 ) ; xV = max ( xV - max ( xX / yc , 0.0 ) , 0.0 ) ; float yd = xY . w * xV ; float ye = 1.0 - yd ; ye = max ( ye , 0.0 ) ; xT ( ye ) ; ye += max ( x_ - 0.5 , 0.0 ) ; if ( ye < yb ) { vec3 yf = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 yg = xY . rgb ; xX = clamp ( - xX * 0.03 , 0.0 , 0.8 ) ; vec3 yh = mix ( yg , yf , min ( yc , 1.0 ) ) ; yh = mix ( yh , vec3 ( 0.0 ) , xX ) ; xU = mix ( yh , xU , ye ) ; } if ( ye >= yb ) { xU = mix ( xZ . rgb , xU , yb ) ; } } void yp ( inout vec3 yj , in float yk , in float yl ) { float ym = u_underwater_fog_color_density . w * yk ; float yn = 1.0 - ym ; yn = clamp ( yn , 0.0 , 1.0 ) ; xT ( yn ) ; yl = clamp ( - yl * 0.03 , 0.0 , 0.8 ) ; vec3 yo = mix ( u_underwater_fog_color_density . rgb , vec3 ( 0.0 ) , yl ) ; yj = mix ( yo , yj , yn ) ; }".split(" ")}]}}]},
{type:"textline",b:"void yw ( inout vec3 yq , float yr , vec3 ys , float yt ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 yu = xR ( u_cube_fog , ys ) ; vec4 yv = vec4 ( yu , u_fog_color_density . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec4","yv","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"yi ( yq , yr , ys , u_cam_water_depth , u_underwater_fog_color_density , yv , yt ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"xK ( yq , yr , bQ . y , yv ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/lighting_nodes.glslf"]={type:"group",a:[{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"define",
name:"M_PI",b:["3.14159265359"]},{type:"textline",b:"float yz = 0.0 ; float yA = 1.0 ; float yB = 0.5 ; vec3 yC = vec3 ( yz ) ;".split(" ")},{type:"node",name:"LIGHTING_BEGIN",h:[{type:"node_out",name:"yR",qualifier:["vec3"],e:!1},{type:"node_out",name:"yS",qualifier:["vec3"],e:!1},{type:"node_out",name:"yT",qualifier:["vec3"],e:!1},{type:"node_out",name:"yU",qualifier:["vec3"],e:!0},{type:"node_out",name:"yV",qualifier:["vec3"],e:!0},{type:"node_out",name:"yW",qualifier:["vec2"],e:!0},{type:"node_out",
name:"yX",qualifier:["vec2"],e:!0},{type:"node_out",name:"yY",qualifier:["float"],e:!0},{type:"node_out",name:"yZ",qualifier:["float"],e:!0},{type:"node_out",name:"y_",qualifier:["vec4"],e:!0}],g:[{type:"textline",b:"yR = yD ; yS = yE ; yT = yF ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yU"],g:[{type:"textline",b:["yU","=","yG",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yV"],g:[{type:"textline",b:["yV","=","yI",";"]}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_yX"],g:[{type:"textline",b:["yX","=","yK",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yW"],g:[{type:"textline",b:["yW","=","yL",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yY"],g:[{type:"textline",b:["yY","=","yM",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yZ"],g:[{type:"textline",b:["yZ","=","yN",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_y_"],g:[{type:"textline",b:["y_","=","yO",";"]}]}]}]},{type:"node",
name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"za",qualifier:["vec3"],e:!1},{type:"node_in",name:"zb",qualifier:["vec3"],e:!1},{type:"node_in",name:"zc",qualifier:["vec3"],e:!1},{type:"node_out",name:"zd",qualifier:["vec4"],e:!1},{type:"node_out",name:"ze",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"zd = vec4 ( za + zc * zb , yz ) ; ze = yC ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"zf",qualifier:["float"],e:!1},{type:"node_out",name:"zg",qualifier:["vec3"],
e:!1},{type:"node_out",name:"zh",qualifier:["vec2"],e:!1},{type:"node_out",name:"zi",qualifier:["vec3"],e:!1},{type:"node_out",name:"zj",qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1},"NUM_LIGHTS",0,{type:"g_expr",d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"zh = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","HEMI",{type:"equal_expr",
d:2}],g:[{type:"textline",b:["zj","=","yB",";"]}]},{type:"node_else",g:[{type:"textline",b:["zj","=","yz",";"]}]}]},{type:"textline",b:"zi = u_light_color_intensities [ LAMP_IND ] ; if ( LAMP_SHADOW_MAP_IND != - 1 ) zi *= zf ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2},"LAMP_TYPE","POINT",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],g:[{type:"textline",b:"vec3 zk = u_light_positions [ LAMP_IND ] ; zg = zk - yH ;".split(" ")},{type:"textline",
b:"float zl = length ( zg ) ; zi *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + zl * zl ) ; zg = normalize ( zg ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2}],g:[{type:"textline",b:"vec3 zm = u_light_directions [ LAMP_IND ] ; float zn = dot ( zg , zm ) ; zn *= smoothstep ( yz , yA , ( zn - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; zi *= zn ;".split(" ")}]}]}]},{type:"node_else",g:[{type:"textline",b:"zg = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]}]}]},
{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"zo",qualifier:["vec3"],e:!1},{type:"node_in",name:"zp",qualifier:["vec2"],e:!1},{type:"node_in",name:"zq",qualifier:["vec3"],e:!1},{type:"node_in",name:"zr",qualifier:["float"],e:!1},{type:"node_in",name:"zs",qualifier:["vec2"],e:!1},{type:"node_out",name:"zt",qualifier:["float"],e:!1}],g:[{type:"textline",b:"zt = yz ; if ( zp . r != yz ) { float zu = ( yA - zr ) * dot ( zq , zo ) + zr ; if ( zs [ 0 ] == yz ) { zt = yA ; } else { float zv = yA + abs ( zu ) ; zv = zs [ 1 ] + ( yA - zs [ 1 ] ) * pow ( zv , zs [ 0 ] ) ; zt = clamp ( zv , yz , yA ) ; } zt = max ( zt , yz ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"zw",qualifier:["vec3"],e:!1},{type:"node_in",name:"zx",qualifier:["vec2"],e:!1},{type:"node_in",name:"zy",qualifier:["vec3"],e:!1},{type:"node_in",name:"zz",qualifier:["float"],e:!1},{type:"node_out",name:"zA",qualifier:["float"],e:!1}],g:[{type:"textline",b:"zA = yz ; if ( zx . r != yz ) { float zB = ( yA - zz ) * dot ( zy , zw ) + zz ; zA = max ( zB , yz ) ; }".split(" ")}]},{type:"node",name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"zC",
qualifier:["vec3"],e:!1},{type:"node_in",name:"zD",qualifier:["vec2"],e:!1},{type:"node_in",name:"zE",qualifier:["vec3"],e:!1},{type:"node_in",name:"zF",qualifier:["float"],e:!1},{type:"node_in",name:"zG",qualifier:["vec2"],e:!1},{type:"node_out",name:"zH",qualifier:["float"],e:!1}],g:[{type:"textline",b:"zH = yz ; if ( zD . r != yz ) { float zI = ( yA - zF ) * dot ( zE , zC ) + zF ; if ( zG [ 0 ] > yz ) { float zJ = max ( dot ( zE , yJ ) , yz ) ; float zK = zG [ 0 ] * zG [ 0 ] ; float zL = yA - yB * ( zK / ( zK + 0.33 ) ) ; vec3 zM = zC - zI * zE ; vec3 zN = yJ - zJ * zE ;".split(" ")},
{type:"textline",b:"if ( length ( zM ) == yz || length ( zN ) == yz || abs ( zI ) > yA || abs ( zJ ) > yA )".split(" ")},{type:"textline",b:"zH = zI * zL ; else { float zO = acos ( zI ) ; float zP = acos ( zJ ) ; vec3 zQ = normalize ( zM ) ; vec3 zR = normalize ( zN ) ; float zS , zT ; zS = max ( zO , zP ) ; zT = min ( zO , zP ) ; zT *= 0.95 ; float zU = max ( dot ( zQ , zR ) , yz ) ; float zV = 0.45 * ( zK / ( zK + 0.09 ) ) ; zH = zI * ( zL + ( zV * zU * sin ( zS ) * tan ( zT ) ) ) ; } } else zH = zI ; zH = max ( zH , yz ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"zW",qualifier:["vec3"],e:!1},{type:"node_in",name:"zX",qualifier:["vec2"],e:!1},{type:"node_in",name:"zY",qualifier:["vec3"],e:!1},{type:"node_in",name:"zZ",qualifier:["float"],e:!1},{type:"node_in",name:"z_",qualifier:["vec2"],e:!1},{type:"node_out",name:"Aa",qualifier:["float"],e:!1}],g:[{type:"textline",b:"Aa = yz ; if ( zX . r != yz ) { float Ab = ( yA - zZ ) * dot ( zY , zW ) + zZ ; float Ac = max ( dot ( zY , yJ ) , yz ) ; if ( z_ [ 0 ] <= yA ) Aa = Ab * pow ( max ( Ac * Ab , 0.1 ) , z_ [ 0 ] - yA ) ; else Aa = Ab * pow ( 1.0001 - Ac , z_ [ 0 ] - yA ) ; Aa = max ( Aa , yz ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"Ad",qualifier:["vec3"],e:!1},{type:"node_in",name:"Ae",qualifier:["vec2"],e:!1},{type:"node_in",name:"Af",qualifier:["vec3"],e:!1},{type:"node_in",name:"Ag",qualifier:["float"],e:!1},{type:"node_in",name:"Ah",qualifier:["vec2"],e:!1},{type:"node_out",name:"Ai",qualifier:["float"],e:!1}],g:[{type:"textline",b:"Ai = yz ; if ( Ae . r != yz ) { float Aj = ( yA - Ag ) * dot ( Af , Ad ) + Ag ; float Ak = acos ( Aj ) ; if ( Ak < Ah [ 0 ] ) Ai = yA ; else if ( Ak > ( Ah [ 0 ] + Ah [ 1 ] ) || Ah [ 1 ] == yz ) Ai = yz ; else Ai = yA - ( ( Ak - Ah [ 0 ] ) / Ah [ 1 ] ) ; Ai = max ( Ai , yz ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"Al",qualifier:["vec3"],e:!1},{type:"node_in",name:"Am",qualifier:["vec2"],e:!1},{type:"node_in",name:"An",qualifier:["vec3"],e:!1},{type:"node_in",name:"Ao",qualifier:["float"],e:!1},{type:"node_in",name:"Ap",qualifier:["vec2"],e:!1},{type:"node_out",name:"Aq",qualifier:["float"],e:!1}],g:[{type:"textline",b:"Aq = yz ; if ( Am . g != yz ) { vec3 Ar = normalize ( Al + yJ ) ; Aq = ( yA - Ao ) * max ( dot ( An , Ar ) , yz ) + Ao ; Aq = pow ( Aq , Ap [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"As",qualifier:["vec3"],e:!1},{type:"node_in",name:"At",qualifier:["vec2"],e:!1},{type:"node_in",name:"Au",qualifier:["vec3"],e:!1},{type:"node_in",name:"Av",qualifier:["vec2"],e:!1},{type:"node_out",name:"Aw",qualifier:["float"],e:!1}],g:[{type:"textline",b:"Aw = yz ; if ( At . g != yz ) { vec3 Ax = normalize ( As + yJ ) ; float Ay = max ( dot ( Au , Ax ) , 0.001 ) ;".split(" ")},{type:"textline",b:"float Az = max ( dot ( Au , yJ ) , 0.01 ) ; float AA = max ( dot ( Au , As ) , 0.01 ) ; float AB = tan ( acos ( Ay ) ) ; float AC = max ( Av [ 0 ] , 0.001 ) ; Aw = AA * ( yA / ( 4.0 * M_PI * AC * AC ) ) * ( exp ( - ( AB * AB ) / ( AC * AC ) ) / ( sqrt ( Az * AA ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"AD",qualifier:["vec3"],e:!1},{type:"node_in",name:"AE",qualifier:["vec2"],e:!1},{type:"node_in",name:"AF",qualifier:["vec3"],e:!1},{type:"node_in",name:"AG",qualifier:["vec2"],e:!1},{type:"node_out",name:"AH",qualifier:["float"],e:!1}],g:[{type:"textline",b:"AH = yz ; if ( AE . g != yz ) { vec3 AI = normalize ( AD + yJ ) ; float AJ = acos ( dot ( AI , AF ) ) ; if ( AJ < AG [ 0 ] ) AH = yA ; else if ( AJ >= AG [ 0 ] + AG [ 1 ] || AG [ 1 ] == yz ) AH = yz ; else AH = yA - ( AJ - AG [ 0 ] ) / AG [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"AK",qualifier:["vec3"],e:!1},{type:"node_in",name:"AL",qualifier:["vec2"],e:!1},{type:"node_in",name:"AM",qualifier:["vec3"],e:!1},{type:"node_in",name:"AN",qualifier:["float"],e:!1},{type:"node_in",name:"AO",qualifier:["vec2"],e:!1},{type:"node_out",name:"AP",qualifier:["float"],e:!1}],g:[{type:"textline",b:"AP = yz ; if ( AL . g != yz ) { if ( AO [ 0 ] < 1.0 || AO [ 1 ] == yz ) AP = yz ; else { if ( AO [ 1 ] < 100.0 ) AO [ 1 ] = sqrt ( 1.0 / AO [ 1 ] ) ; else AO [ 1 ] = 10.0 / AO [ 1 ] ; vec3 AQ = normalize ( yJ + AK ) ; float AR = ( yA - AN ) * max ( dot ( AM , AQ ) , yz ) + AN ; if ( AR < yz ) AP = yz ; else { float AS = max ( dot ( AM , yJ ) , 0.01 ) ; float AT = dot ( AM , AK ) ; if ( AT <= 0.01 ) AP = yz ; else { float AU = max ( dot ( yJ , AQ ) , 0.01 ) ; float AV = yA ; float AW = ( 2.0 * AR * AS ) / AU ; float AX = ( 2.0 * AR * AT ) / AU ; float AY = min ( min ( AV , AW ) , AX ) ; float AZ = sqrt ( pow ( AO [ 0 ] , 2.0 ) + pow ( AU , 2.0 ) - yA ) ; float A_ = pow ( AZ - AU , 2.0 ) / pow ( AZ + AU , 2.0 ) * ( yA + pow ( AU * ( AZ + AU ) - yA , 2.0 ) / pow ( AU * ( AZ - AU ) + yA , 2.0 ) ) ; float Ba = acos ( AR ) ; AP = max ( A_ * AY * exp ( - pow ( Ba , 2.0 ) / ( 2.0 * pow ( AO [ 1 ] , 2.0 ) ) ) , yz ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"Bb",qualifier:["vec4"],e:!1},{type:"node_in",name:"Bc",qualifier:["vec3"],e:!1},{type:"node_in",name:"Bd",qualifier:["float"],e:!1},{type:"node_in",name:"Be",qualifier:["float"],e:!1},{type:"node_in",name:"Bf",qualifier:["vec3"],e:!1},{type:"node_in",name:"Bg",qualifier:["vec3"],e:!1},{type:"node_in",name:"Bh",qualifier:["vec4"],e:!1},{type:"node_in",name:"Bi",qualifier:["vec3"],e:!1},{type:"node_in",name:"Bj",qualifier:["vec3"],e:!1},{type:"node_in",
name:"Bk",qualifier:["vec3"],e:!1},{type:"node_in",name:"Bl",qualifier:["float"],e:!1},{type:"node_out",name:"Bm",qualifier:["vec4"],e:!1},{type:"node_out",name:"Bn",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"Bn = Bc + Bk * Bj * Be ; Bm = Bb + vec4 ( Bk * Bi * Bd , Be ) ;".split(" ")}]},{type:"node",name:"LIGHTING_END",h:[{type:"node_in",name:"Bo",qualifier:["vec4"],e:!1},{type:"node_in",name:"Bp",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"yP = Bo . rgb ; yQ = Bp ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",b:"void Bq ( vec3 yD , vec3 yE , vec3 yF , vec3 yG , vec3 yH , vec3 yI , vec3 yJ , vec2 yK , vec2 yL , float yM , float yN , vec4 yO , out vec3 yP , out vec3 yQ ) {".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/particles.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct Bt { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"void BA ( inout float Bu , float Bv , vec2 Bw , vec2 Bx ) { float By = Bx . x - Bw . x ; float Bz = ( Bv - Bw . x ) / By ; Bu = mix ( Bu , Bx . y , clamp ( Bz , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void BH ( inout vec3 BB , float BC , vec4 BD , vec4 BE ) { float BF = BE . x - BD . x ; float BG = ( BC - BD . x ) / BF ; BB = mix ( BB , BE . yzw , clamp ( BG , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float BN ( float BI , float BJ , vec2 BK [ SIZE_RAMP_LENGTH ] ) { float BL = BI / BJ ; float BM = BK [ 0 ] . y ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BA ( BM , BL , BK [ 0 ] , BK [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",2,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"BA ( BM , BL , BK [ 1 ] , BK [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BA ( BM , BL , BK [ 2 ] , BK [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","BM",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 BT ( float BO , float BP , vec4 BQ [ COLOR_RAMP_LENGTH ] ) { float BR = BO / BP ; vec3 BS = BQ [ 0 ] . yzw ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BH ( BS , BR , BQ [ 0 ] , BQ [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BH ( BS , BR , BQ [ 1 ] , BQ [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"BH ( BS , BR , BQ [ 2 ] , BQ [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",b:["return","BS",";","}"]}]}}]},{type:"textline",b:"float Cb ( float BU , float BV , float BW , float BX ) { float BY = max ( 0.01 , min ( BV , BW ) ) ; float BZ = max ( 0.01 , min ( BV , BX ) ) ; float B_ = BV - BZ ; float Ca = clamp ( BU / BY , 0.0 , 1.0 ) - step ( B_ , BU ) * ( BU - B_ ) / BZ ; return Ca ; } Bt Ch ( ) { Bt Cc ; float Cd ; if ( u_p_cyclic == 1 ) { Cd = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( Cd < 0.0 ) Cd += u_p_length ; } if ( u_p_cyclic != 1 ) { Cd = u_p_time - a_p_delay ; } if ( Cd < 0.0 || Cd >= a_p_lifetime ) { Cc . a = 0.0001 ; Cc . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( Cd < 0.0 || Cd >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 Ce = a_position ; vec3 Cf = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 Ce = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 Cf = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"Ce += u_p_nfactor * Cd * Cf ; Ce += a_p_vels . xyz * Cd ; Ce . y -= u_p_gravity * Cd * Cd / 2.0 ; float Cg = max ( u_p_mass , EPSILON ) ; Ce += ( u_p_wind_fac * u_wind / Cg ) * Cd * Cd / 2.0 ; Cc . b = Ce ; Cc . e = a_p_vels . w * Cd ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Cc . a = BN ( Cd , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Cc . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Cc . d = BT ( Cd , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"Cc . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"Cc . c = Cb ( Cd , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return Cc ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float Cj = 0.0 ; float Ck = 1.0 ; vec3 Cl = vec3 ( Cj ) ; vec3 Cm = vec3 ( Ck ) ; vec3 Ct ( vec3 Cn ) { vec4 Co = vec4 ( Cj , - Ck / 3.0 , 2.0 / 3.0 , - Ck ) ; vec4 Cp = mix ( vec4 ( Cn . bg , Co . wz ) , vec4 ( Cn . gb , Co . xy ) , step ( Cn . b , Cn . g ) ) ; vec4 Cq = mix ( vec4 ( Cp . xyw , Cn . r ) , vec4 ( Cn . r , Cp . yzx ) , step ( Cp . x , Cn . r ) ) ; float Cr = Cq . x - min ( Cq . w , Cq . y ) ; float Cs = 1.0e-10 ; return vec3 ( abs ( Cq . z + ( Cq . w - Cq . y ) / ( 6.0 * Cr + Cs ) ) , Cr / ( Cq . x + Cs ) , Cq . x ) ; } vec3 Cx ( vec3 Cu ) { vec4 Cv = vec4 ( Ck , 2.0 / 3.0 , Ck / 3.0 , 3.0 ) ; vec3 Cw = abs ( fract ( vec3 ( Cu . r , Cu . r , Cu . r ) + Cv . xyz ) * 6.0 - Cv . www ) ; return Cu . b * mix ( Cv . xxx , clamp ( Cw - Cv . xxx , Cj , Ck ) , Cu . g ) ; } vec3 CB ( vec3 Cy , vec3 Cz , float CA ) { return mix ( Cy , Cz , CA ) ; } vec3 CF ( vec3 CC , vec3 CD , float CE ) { return CE * CC + CD ; } vec3 CJ ( vec3 CG , vec3 CH , float CI ) { return CH - CI * CG ; } vec3 CO ( vec3 CK , vec3 CL , float CM ) { float CN = Ck - CM ; return ( vec3 ( CN ) + CM * CK ) * CL ; } vec3 CT ( vec3 CP , vec3 CQ , float CR ) { vec3 CS = vec3 ( Ck - CR ) ; return Cm - ( CS + CR * ( Cm - CP ) ) * ( Cm - CQ ) ; } vec3 CY ( vec3 CU , vec3 CV , float CW ) { vec3 CX = vec3 ( Ck - CW ) ; return mix ( CV * ( CX + 2.0 * CW * CU ) , Cm - ( CX + 2.0 * CW * ( Cm - CU ) ) * ( Cm - CV ) , step ( 0.5 , CV ) ) ; } vec3 Db ( vec3 CZ , vec3 C_ , float Da ) { return mix ( C_ , abs ( CZ - C_ ) , Da ) ; } vec3 Df ( vec3 Dc , vec3 Dd , float De ) { return mix ( Dd , Dd / ( Dc + step ( Dc , Cl ) ) , De ) ; } vec3 Dj ( vec3 Dg , vec3 Dh , float Di ) { return mix ( Dh , min ( Dg , Dh ) , Di ) ; } vec3 Dn ( vec3 Dk , vec3 Dl , float Dm ) { return max ( Dm * Dk , Dl ) ; } vec3 Du ( vec3 Do , vec3 Dp , float Dq ) { vec3 Dr = Ct ( Dp ) ; if ( Dr . y != Cj ) { vec3 Ds = Ct ( Do ) ; vec3 Dt = Cx ( vec3 ( Dr . x , Ds . yz ) ) ; return mix ( Do , Dt , Dq ) ; } return Do ; } vec3 DA ( vec3 Dv , vec3 Dw , float Dx ) { vec3 Dy = Ct ( Dv ) ; if ( Dy . y != Cj ) { vec3 Dz = Ct ( Dw ) ; return Cx ( vec3 ( Dy . x , mix ( Dy . y , Dz . y , Dx ) , Dy . z ) ) ; } return Dv ; } vec3 DG ( vec3 DB , vec3 DC , float DD ) { vec3 DE = Ct ( DB ) ; vec3 DF = Ct ( DC ) ; return Cx ( vec3 ( DE . xy , mix ( DE . z , DF . z , DD ) ) ) ; } vec3 DN ( vec3 DH , vec3 DI , float DJ ) { vec3 DK = Ct ( DI ) ; if ( DK . y != Cj ) { vec3 DL = Ct ( DH ) ; vec3 DM = Cx ( vec3 ( DK . xy , DL . z ) ) ; return mix ( DH , DM , DJ ) ; } return DH ; } vec3 DS ( vec3 DO , vec3 DP , float DQ ) { vec3 DR = Cm - ( Cm - DP ) * ( Cm - DO ) ; return mix ( DO , ( ( Cm - DO ) * DP * DO ) + DO * DR , DQ ) ; } vec3 DW ( vec3 DT , vec3 DU , float DV ) { return DT + DV * ( 2.0 * DU - Ck ) ; } float Eb ( float DX , float DY , float DZ , float D_ ) { float Ea = Ck - D_ ; return ( Ea + DZ * DX ) * DY ; } float Eh ( float Ec , float Ed , float Ee , float Ef ) { float Eg = Ck - Ef ; return Ck - ( Eg + Ee * ( Ck - Ec ) ) * ( Ck - Ed ) ; } float En ( float Ei , float Ej , float Ek , float El ) { float Em = Ck - El ; return mix ( Ej * ( Em + 2.0 * Ek * Ei ) , Ck - ( Em + 2.0 * Ek * ( Ck - Ei ) ) * ( Ck - Ej ) , step ( 0.5 , Ej ) ) ; }".split(" ")}]};
a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float EA ( in sampler2D Et , in vec2 Eu , in vec2 Ev ) { float Ew = texture2D ( Et , Eu ) . r ; float Ex = Ev . x ; float Ey = Ev . y ; float Ez = 2.0 * Ex / ( Ex + Ey - ( 2.0 * Ew - 1.0 ) * ( Ey - Ex ) ) ; return Ez ; }".split(" ")}]}};b4w.module.__reformer=function(a,t){function l(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in
a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));
"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",
a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}}}
function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var f=a[c],g=0;g<f.strips.length;g++){var h=f.strips[g];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",
h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in J||(J[c]={Wt:[],FA:"undefined",type:a});J[c].Wt.push(b.name)}function y(a,b,c){c=c+">>"+a;c in J||(J[c]={Wt:[],FA:"deprecated",type:a});J[c].Wt.push(b.name)}function h(a,b){b||(b=a.name+"_COPY");var c=a.materials,g=a.submeshes;a.materials=null;a.submeshes=null;var h=f.oh(a);a.materials=c;a.submeshes=g;h.name=b;h.materials=a.materials.slice(0);h.submeshes=[];for(c=0;c<g.length;c++){var m=f.Kk(g[c]);h.submeshes.push(m)}return h}var r=t("__boundings"),x=
t("__curve"),v=t("__mat4"),g=t("__print"),p=t("__quat"),f=t("__util"),A=t("__vec3"),F=t("__vec4"),H=[5,4],J={};a.zw=function(a){return-1!=f.xC(a,H)};a.LF=function(a){J={};var h=a.worlds;if(0==h.length){g.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var p={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,
intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};h.push(p)}for(var h=a.worlds,r=0;r<h.length;r++){p=h[r];"use_sky_blend"in p||(b("world",p,"use_sky_blend"),p.use_sky_blend=!1);"use_sky_paper"in p||(b("world",p,"use_sky_paper"),p.use_sky_paper=!1);"use_sky_real"in p||(b("world",p,"use_sky_real"),p.use_sky_real=!1);"b4w_sky_settings"in p&&"rayleigh_brightness"in p.b4w_sky_settings||
(b("world",p,"rayleigh_brightness"),p.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in p||(b("world",p,"fog_settings"),p.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},
"b4w_fog_color"in p&&(p.fog_settings.use_custom_color=!0,p.fog_settings.color=p.b4w_fog_color),"b4w_fog_density"in p&&0<p.b4w_fog_density&&(p.fog_settings.depth=1/p.b4w_fog_density));"render_sky"in p.b4w_sky_settings||(b("world",p,"render_sky"),p.b4w_sky_settings.render_sky=!1);for(var q=p.texture_slots,p=0;p<q.length;p++){var m=q[p];"blend_type"in m||(m.blend_type="MIX",b("world_texture_slot",m,"blend_type"));"use_map_blend"in m||(m.use_map_blend=!1,b("world_texture_slot",m,"use_map_blend"));"use_map_horizon"in
m||(m.use_map_horizon=!0,b("world_texture_slot",m,"use_map_horizon"));"use_map_zenith_up"in m||(m.use_map_zenith_up=!1,b("world_texture_slot",m,"use_map_zenith_up"));"use_rgb_to_intensity"in m||(m.use_rgb_to_intensity=!1,b("world_texture_slot",m,"use_rgb_to_intensity"));"invert"in m||(m.invert=!1,b("world_texture_slot",m,"invert"));"color"in m||(m.color=[1,0,1],b("world_texture_slot",m,"color"));"blend_factor"in m||(m.blend_factor=0,b("world_texture_slot",m,"blend_factor"));"horizon_factor"in m||
(m.horizon_factor=1,b("world_texture_slot",m,"horizon_factor"));"zenith_up_factor"in m||(m.zenith_up_factor=0,b("world_texture_slot",m,"zenith_up_factor"));"zenith_down_factor"in m||(m.zenith_down_factor=0,b("world_texture_slot",m,"zenith_down_factor"));"default_value"in m||(m.default_value=1,b("world_texture_slot",m,"default_value"))}}p=a.scenes;for(r=0;r<p.length;r++)q=p[r],m=q.world,"timeline_markers"in q||(q.timeline_markers=null,b("scene",q,"timeline_markers")),"b4w_reflection_quality"in q||
(q.b4w_reflection_quality="MEDIUM",b("scene",q,"b4w_reflection_quality")),"b4w_use_nla"in q||(q.b4w_use_nla=!1,b("scene",q,"b4w_use_nla")),"fps"in q||(q.fps=24,b("scene",q,"fps")),"b4w_nla_cyclic"in q||(q.b4w_nla_cyclic=!1,b("scene",q,"b4w_nla_cyclic")),"b4w_logic_nodes"in q||(q.b4w_logic_nodes=[],b("scene",q,"b4w_logic_nodes")),"b4w_detect_collisions"in q&&(y("scene",q,"b4w_detect_collisions"),delete q.b4w_detect_collisions),"audio_doppler_speed"in q||(q.audio_doppler_speed=343.3),"audio_doppler_factor"in
q||(q.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in q||(q.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},b("scene",q,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in q||(q.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in q||(q.b4w_enable_bloom=!1,b("scene",q,"b4w_enable_bloom")),"b4w_enable_motion_blur"in q||(q.b4w_enable_motion_blur=!1,b("scene",q,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in q||(q.b4w_enable_color_correction=
!1,b("scene",q,"b4w_enable_color_correction")),"b4w_enable_antialiasing"in q||(q.b4w_enable_antialiasing=!0,b("scene",q,"b4w_enable_antialiasing")),"b4w_tags"in q||(q.b4w_tags={title:"",description:""},b("scene",q,"b4w_tags")),"b4w_enable_object_selection"in q||(q.b4w_enable_object_selection="AUTO",b("scene",q,"b4w_enable_object_selection")),"b4w_enable_outlining"in q||(q.b4w_enable_outlining="AUTO",b("scene",q,"b4w_enable_outlining")),"b4w_enable_glow_materials"in q||(q.b4w_enable_glow_materials=
"AUTO",b("scene",q,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in q||(q.b4w_enable_anchors_visibility="AUTO",b("scene",q,"b4w_enable_anchors_visibility")),"b4w_outline_color"in q||(q.b4w_outline_color=[1,1,1],b("scene",q,"b4w_outline_color")),"b4w_outline_factor"in q||(q.b4w_outline_factor="b4w_glow_factor"in q?q.b4w_glow_factor:1,b("scene",q,"b4w_outline_factor")),"b4w_shadow_settings"in q||(b("scene",q,"b4w_shadow_settings"),h=m.b4w_shadow_settings,q.b4w_shadow_settings=h?h:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),h=q.b4w_shadow_settings,"csm_resolution"in h||(b("scene",q,"b4w_shadow_settings.csm_resolution"),h.csm_resolution=2048),"self_shadow_polygon_offset"in h||(b("scene",q,"b4w_shadow_settings.self_shadow_polygon_offset"),h.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in h||
(b("scene",q,"b4w_shadow_settings.self_shadow_normal_offset"),h.self_shadow_normal_offset=.01),"b4w_enable_csm"in h||(b("scene",q,"b4w_shadow_settings.b4w_enable_csm"),h.b4w_enable_csm=!1),"csm_num"in h||(b("scene",q,"b4w_shadow_settings.csm_num"),h.csm_num=1),"csm_first_cascade_border"in h||(b("scene",q,"b4w_shadow_settings.csm_first_cascade_border"),h.csm_first_cascade_border=10),"first_cascade_blur_radius"in h||(b("scene",q,"b4w_shadow_settings.first_cascade_blur_radius"),h.first_cascade_blur_radius=
3),"csm_last_cascade_border"in h||(b("scene",q,"b4w_shadow_settings.csm_last_cascade_border"),h.csm_last_cascade_border=100),"last_cascade_blur_radius"in h||(b("scene",q,"b4w_shadow_settings.last_cascade_blur_radius"),h.last_cascade_blur_radius=1.5),"fade_last_cascade"in h||(b("scene",q,"b4w_shadow_settings.fade_last_cascade"),h.fade_last_cascade=!0),"blend_between_cascades"in h||(b("scene",q,"b4w_shadow_settings.blend_between_cascades"),h.blend_between_cascades=!0),"b4w_ssao_settings"in q||(b("scene",
q,"b4w_ssao_settings"),h=m.b4w_ssao_settings,q.b4w_ssao_settings=h?h:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),h=q.b4w_ssao_settings,"dist_factor"in h||(b("scene",q,"b4w_ssao_settings.dist_factor"),h.dist_factor=0),"samples"in h||(b("scene",q,"b4w_ssao_settings.samples"),h.samples=16),"hemisphere"in h||(b("scene",q,"b4w_ssao_settings.hemisphere"),h.hemisphere=!1),"blur_depth"in h||(b("scene",q,"b4w_ssao_settings.blur_depth"),h.blur_depth=!1),"blur_discard_value"in
h||(b("scene",q,"b4w_ssao_settings.blur_discard_value"),h.blur_discard_value=1),"b4w_bloom_settings"in q||(b("scene",q,"b4w_bloom_settings"),h=m.b4w_bloom_settings,q.b4w_bloom_settings=h?h:{key:.2,blur:4,edge_lum:1}),"key"in q.b4w_bloom_settings||(b("scene",q,"b4w_bloom_settings.key"),q.b4w_bloom_settings.key=.2),"blur"in q.b4w_bloom_settings||(b("scene",q,"b4w_bloom_settings.blur"),q.b4w_bloom_settings.blur=4),"edge_lum"in q.b4w_bloom_settings||(b("scene",q,"b4w_bloom_settings.edge_lum"),q.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in q||(b("scene",q,"b4w_motion_blur_settings"),h=m.b4w_motion_blur_settings,q.b4w_motion_blur_settings=h?h:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in q.b4w_motion_blur_settings||(b("scene",q,"b4w_motion_blur_settings.motion_blur_factor"),q.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in q.b4w_motion_blur_settings||(b("scene",q,"b4w_motion_blur_settings.motion_blur_decay_threshold"),q.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in q||(b("scene",q,"b4w_color_correction_settings"),h=m.b4w_color_correction_settings,q.b4w_color_correction_settings=h?h:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in q||(b("scene",q,"b4w_god_rays_settings"),h=m.b4w_god_rays_settings,q.b4w_god_rays_settings=h?h:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in q.b4w_god_rays_settings||(b("scene",q,"b4w_god_rays_settings.steps_per_pass"),q.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in q||(b("scene",q,"b4w_glow_settings"),q.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},h=q.b4w_glow_settings,"b4w_render_glow_over_blend"in m&&(h.render_glow_over_blend=m.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in m&&(h.small_glow_mask_coeff=m.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in m&&(h.large_glow_mask_coeff=m.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
m&&(h.small_glow_mask_width=m.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in m&&(h.large_glow_mask_width=m.b4w_large_glow_mask_width)),m=q.b4w_render_shadows,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(q.b4w_render_shadows=m?"ON":"OFF"),m=q.b4w_render_reflections,"OFF"!=m&&"ON"!=m&&(q.b4w_render_reflections=m?"ON":"OFF"),m=q.b4w_render_refractions,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(q.b4w_render_refractions=m?"ON":"OFF"),q.b4w_nla_script&&y("scene",q,"b4w_nla_script");q=a.meshes;for(r=0;r<q.length;r++){m=
q[r];m.b4w_bounding_box||(b("mesh",m,"b4w_bounding_box"),m.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});m.b4w_bounding_box_source||(b("mesh",m,"b4w_bounding_box_source"),m.b4w_bounding_box_source=m.b4w_bounding_box);m.uv_textures||(b("mesh",m,"uv_textures"),m.uv_textures=[]);m.b4w_bounding_sphere_center||(m.b4w_bounding_sphere_center=[0,0,0]);m.b4w_bounding_cylinder_center||(m.b4w_bounding_cylinder_center=[0,0,0]);m.b4w_bounding_ellipsoid_center||(m.b4w_bounding_ellipsoid_center=
[0,0,0]);m.b4w_bounding_ellipsoid_axes||(p=m.b4w_bounding_box,m.b4w_bounding_ellipsoid_axes=[(p.max_x-p.min_x)/2,(p.max_y-p.min_y)/2,(p.max_z-p.min_z)/2]);"b4w_shape_keys"in m||(m.b4w_shape_keys=[],b("mesh",m,"b4w_shape_keys"));for(var p=m,h=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],w=null,d=0;d<h.length;d++)p[h[d]]&&(w?(p[h[d]]=!1,g.warn('WARNING property "'+h[d]+'" of object "'+p.name+'" has been set to "false". Foreground property "'+
w+'" already exists.')):w=h[d]);for(p=0;p<m.b4w_vertex_anim.length;p++)h=m.b4w_vertex_anim[p],"allow_nla"in h||(b('mesh["b4w_vertex_anim"]',m,"allow_nla"),h.allow_nla=!0)}p=a.cameras;for(r=0;r<p.length;r++)q=p[r],q.type||(q.type="PERSP",b("camera",q,"type")),"b4w_eye_target_dist"in q&&(delete q.b4w_eye_target_dist,y("camera",q,"b4w_eye_target_dist")),"b4w_hover_zero_level"in q||(q.b4w_hover_zero_level=0,b("camera",q,"b4w_hover_zero_level")),"b4w_trans_velocity"in q||(q.b4w_trans_velocity=1,b("camera",
q,"b4w_trans_velocity")),"b4w_rot_velocity"in q||(q.b4w_rot_velocity=1,b("camera",q,"b4w_rot_velocity")),"b4w_zoom_velocity"in q||(q.b4w_zoom_velocity=.1,b("camera",q,"b4w_zoom_velocity")),"b4w_use_distance_limits"in q||(q.b4w_use_distance_limits=!1,b("camera",q,"b4w_use_distance_limits")),"b4w_distance_min"in q||(q.b4w_distance_min=1,b("camera",q,"b4w_distance_min")),"b4w_distance_max"in q||(q.b4w_distance_max=100,b("camera",q,"b4w_distance_max")),"b4w_horizontal_translation_min"in q||(q.b4w_horizontal_translation_min=
-100,b("camera",q,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in q||(q.b4w_horizontal_translation_max=100,b("camera",q,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in q||(q.b4w_vertical_translation_min=-100,b("camera",q,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in q||(q.b4w_vertical_translation_max=100,b("camera",q,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in q||(q.b4w_use_horizontal_clamping=!1,b("camera",q,"b4w_use_horizontal_clamping")),
"b4w_rotation_left_limit"in q||(q.b4w_rotation_left_limit=-Math.PI,b("camera",q,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in q||(q.b4w_rotation_right_limit=Math.PI,b("camera",q,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in q||(q.b4w_horizontal_clamping_type="LOCAL",b("camera",q,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in q||(q.b4w_use_vertical_clamping=!1,b("camera",q,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in q||(q.b4w_rotation_down_limit=
-Math.PI/2,b("camera",q,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in q||(q.b4w_rotation_up_limit=Math.PI/2,b("camera",q,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in q||(q.b4w_vertical_clamping_type="LOCAL",b("camera",q,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in q||(q.b4w_hover_angle_min=Math.PI/6,b("camera",q,"b4w_hover_angle_min")),"b4w_hover_angle_max"in q||(q.b4w_hover_angle_max=Math.PI/6,b("camera",q,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in q||
(q.b4w_enable_hover_hor_rotation=!0,b("camera",q,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in q||(q.b4w_use_panning=!0,b("camera",q,"b4w_use_panning"));p=a.lamps;for(r=0;r<p.length;r++)q=p[r],"b4w_generate_shadows"in q||(q.b4w_generate_shadows=!1,b("lamp",q,"b4w_generate_shadows")),"b4w_dynamic_intensity"in q||(q.b4w_dynamic_intensity=!1,b("lamp",q,"b4w_dynamic_intensity")),"use_diffuse"in q||(q.use_diffuse=!0,b("lamp",q,"use_diffuse")),"use_specular"in q||(q.use_specular=!0,b("lamp",q,"use_specular"));
p=a.speakers;for(r=0;r<p.length;r++)q=p[r],"b4w_behavior"in q||(q.b4w_behavior=q.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in q||(q.b4w_disable_doppler=!1),"b4w_delay"in q||(q.b4w_delay=0),"b4w_delay_random"in q||(q.b4w_delay_random=0),"b4w_volume_random"in q||(q.b4w_volume_random=0),"b4w_pitch_random"in q||(q.b4w_pitch_random=0),"b4w_fade_in"in q||(q.b4w_fade_in=0),"b4w_fade_out"in q||(q.b4w_fade_out=0),"b4w_loop"in q||(q.b4w_loop=!1),"b4w_loop_count"in q||(q.b4w_loop_count=
0),"b4w_loop_count_random"in q||(q.b4w_loop_count_random=0),"b4w_playlist_id"in q||(q.b4w_playlist_id=""),q.animation_data&&c(q.animation_data);p=a.textures;for(r=0;r<p.length;r++)q=p[r],"b4w_anisotropic_filtering"in q||(q.b4w_anisotropic_filtering="OFF",b("texture",q,"b4w_anisotropic_filtering")),"b4w_water_foam"in q||(q.b4w_water_foam=!1,b("texture",q,"b4w_water_foam")),"b4w_foam_uv_freq"in q||(q.b4w_foam_uv_freq=[1,1],b("texture",q,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in q||(q.b4w_foam_uv_magnitude=
[1,1],b("texture",q,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in q||(q.b4w_parallax_steps=5,b("material",q,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in q||(q.b4w_parallax_lod_dist=10,b("material",q,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in q||(q.b4w_shore_dist_map=!1,b("texture",q,"b4w_shore_dist_map")),"b4w_shore_boundings"in q||(q.b4w_shore_boundings=new Float32Array(4),q.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",q,"b4w_shore_boundings")),"b4w_max_shore_dist"in q||(q.b4w_max_shore_dist=
100,b("texture",q,"b4w_max_shore_dist")),"b4w_disable_compression"in q||(q.b4w_disable_compression=!1,b("texture",q,"b4w_disable_compression")),"b4w_source_type"in q||(q.b4w_source_type="",b("texture",q,"b4w_source_type")),"b4w_source_id"in q||(q.b4w_source_id="",b("texture",q,"b4w_source_id")),"b4w_source_size"in q||(q.b4w_source_size=1024,b("texture",q,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in q||(q.b4w_enable_canvas_mipmapping=!0,b("texture",q,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in
q||(q.b4w_nla_video=!1,b("texture",q,"b4w_nla_video"));h=a.materials;for(r=0;r<h.length;r++){w=h[r];"b4w_node_mat_type"in w&&y("material",w,"b4w_node_mat_type");"b4w_skydome"in w&&y("material",w,"b4w_skydome");"b4w_procedural_skydome"in w&&y("material",w,"b4w_procedural_skydome");w.b4w_water&&("b4w_water_shore_smoothing"in w||(w.b4w_water_shore_smoothing=!1,b("material",w,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in w||(w.b4w_water_dynamic=!1,b("material",w,"b4w_water_dynamic")),"b4w_waves_height"in
w||(w.b4w_waves_height=1,b("material",w,"b4w_waves_height")),"b4w_waves_length"in w||(w.b4w_waves_length=1,b("material",w,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in w||(w.b4w_water_dst_noise_scale0=.05,b("material",w,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in w||(w.b4w_water_dst_noise_scale1=.03,b("material",w,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in w||(w.b4w_water_dst_noise_freq0=1.3,b("material",w,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in
w||(w.b4w_water_dst_noise_freq1=1,b("material",w,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in w||(w.b4w_water_dir_min_shore_fac=.4,b("material",w,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in w||(w.b4w_water_dir_freq=.5,b("material",w,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in w||(w.b4w_water_dir_noise_scale=.05,b("material",w,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in w||(w.b4w_water_dir_noise_freq=.07,b("material",w,"b4w_water_dir_noise_freq")),
"b4w_water_dir_min_noise_fac"in w||(w.b4w_water_dir_min_noise_fac=.5,b("material",w,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in w||(w.b4w_water_dst_min_fac=.2,b("material",w,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in w||(w.b4w_water_waves_hor_fac=5,b("material",w,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in w||(w.b4w_water_absorb_factor=6,b("material",w,"b4w_water_absorb_factor")),"b4w_water_fog_color"in w||(w.b4w_water_fog_color=new Float32Array(3),w.b4w_water_fog_color=
[.5,.7,.7],b("material",w,"b4w_water_fog_color")),"b4w_foam_factor"in w||(w.b4w_foam_factor=5,b("material",w,"b4w_foam_factor")),"b4w_generated_mesh"in w||(w.b4w_generated_mesh=!1,b("material",w,"b4w_generated_mesh")),"b4w_water_num_cascads"in w||(w.b4w_water_num_cascads=5,b("material",w,"b4w_water_num_cascads")),"b4w_water_subdivs"in w||(w.b4w_water_subdivs=64,b("material",w,"b4w_water_subdivs")),"b4w_water_detailed_dist"in w||(w.b4w_water_detailed_dist=1E3,b("material",w,"b4w_water_detailed_dist")),
"b4w_water_enable_caust"in w||(w.b4w_water_enable_caust=!1,b("material",w,"b4w_water_enable_caust")),"b4w_water_caust_scale"in w||(w.b4w_water_caust_scale=.25,b("material",w,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in w||(w.b4w_water_caust_brightness=.5,b("material",w,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in w||(w.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in w||(w.b4w_dynamic_grass_color="");"diffuse_intensity"in w||(w.diffuse_intensity=1,b("material",w,"diffuse_intensity"));
"b4w_use_ghost"in w||(w.b4w_use_ghost=!1);"b4w_collision_margin"in w||(w.b4w_collision_margin=.04,b("material",w,"b4w_collision_margin"));"b4w_collision_group"in w||(w.b4w_collision_group=128,b("material",w,"b4w_collision_group"));"b4w_collision_mask"in w||(w.b4w_collision_mask=127,b("material",w,"b4w_collision_mask"));"b4w_do_not_render"in w||(w.b4w_do_not_render=!1,b("material",w,"b4w_do_not_render"));"HALO"!=w.type||"b4w_halo_sky_stars"in w||(w.b4w_halo_sky_stars=!1,b("material",w,"b4w_halo_sky_stars"));
"HALO"!=w.type||"b4w_halo_stars_blend_height"in w||(w.b4w_halo_stars_blend_height=10,b("material",w,"b4w_halo_stars_blend_height"));"HALO"!=w.type||"b4w_halo_stars_min_height"in w||(w.b4w_halo_stars_min_height=0,b("material",w,"b4w_halo_stars_min_height"));"specular_shader"in w||(w.specular_shader="COOKTORR",b("material",w,"specular_shader"));"diffuse_shader"in w||(w.diffuse_shader="LAMBERT",b("material",w,"diffuse_shader"));"roughness"in w||(w.roughness=.5,b("material",w,"roughness"));"diffuse_fresnel"in
w||(w.diffuse_fresnel=.1,b("material",w,"diffuse_fresnel"));"diffuse_fresnel_factor"in w||(w.diffuse_fresnel_factor=.5,b("material",w,"diffuse_fresnel_factor"));"specular_slope"in w||(w.specular_slope=.2,b("material",w,"specular_slope"));"specular_toon_size"in w||(w.specular_toon_size=.5,b("material",w,"specular_toon_size"));"specular_toon_smooth"in w||(w.specular_toon_smooth=.1,b("material",w,"specular_toon_smooth"));"specular_alpha"in w||(w.specular_alpha=1,b("material",w,"specular_alpha"));"b4w_wettable"in
w||(w.b4w_wettable=!1,b("material",w,"b4w_wettable"));"b4w_refractive"in w||(w.b4w_refractive=!1,b("material",w,"b4w_refractive"));"b4w_refr_bump"in w||(w.b4w_refr_bump=0,b("material",w,"b4w_refr_bump"));"b4w_shallow_water_col"in w||(w.b4w_shallow_water_col=[0,.8,.3],b("material",w,"b4w_shallow_water_col"));"b4w_shore_water_col"in w||(w.b4w_shore_water_col=[0,.9,.2],b("material",w,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in w||(w.b4w_shallow_water_col_fac=1,b("material",w,"b4w_shallow_water_col_fac"));
"b4w_shore_water_col_fac"in w||(w.b4w_shore_water_col_fac=.5,b("material",w,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in w||(w.b4w_water_sss_strength=5.9,b("material",w,"b4w_water_sss_strength"));"b4w_water_sss_width"in w||(w.b4w_water_sss_width=.45,b("material",w,"b4w_water_sss_width"));"b4w_render_above_all"in w||(w.b4w_render_above_all=!1,b("material",w,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in w||(w.b4w_water_norm_uv_velocity=.05,b("material",w,"b4w_water_norm_uv_velocity"));
"specular_ior"in w||(w.specular_ior=1,b("material",w,"specular_ior"));"darkness"in w||(w.darkness=0,b("material",w,"darkness"));"diffuse_toon_size"in w||(w.diffuse_toon_size=0,b("material",w,"diffuse_toon_size"));"diffuse_toon_smooth"in w||(w.diffuse_toon_smooth=0,b("material",w,"diffuse_toon_smooth"));q=w.texture_slots;for(p=0;p<q.length;p++)m=q[p],"blend_type"in m||(m.blend_type="MIX",b("texture_slot",m,"blend_type"));if(w.node_tree){q=w.node_tree.nodes;for(p=0;p<q.length;p++)l(q[p]);w.node_tree.animation_data&&
c(w.node_tree.animation_data)}}m=a.node_groups;for(r=0;r<m.length;r++)for(q=m[r].node_tree.nodes,p=0;p<q.length;p++)l(q[p]);q=a.objects;for(r=0;r<q.length;r++){m=q[r];switch(m.type){case "MESH":"b4w_dynamic_geometry"in m||(m.b4w_dynamic_geometry=!1);"b4w_reflexible"in m||(m.b4w_reflexible=!1);"b4w_reflexible_only"in m||(m.b4w_reflexible_only=!1);"b4w_reflective"in m||(m.b4w_reflective=!1);"b4w_reflection_type"in m||(m.b4w_reflection_type="PLANE",b("object",m,"b4w_reflection_type"));"b4w_wind_bending"in
m||(m.b4w_wind_bending=!1,b("object",m,"b4w_wind_bending"));"b4w_wind_bending_angle"in m||(m.b4w_wind_bending_angle=10,m.b4w_wind_bending_freq=.25,b("object",m,"wind bending params"));"b4w_detail_bending_amp"in m||(m.b4w_detail_bending_amp=.1,m.b4w_branch_bending_amp=.3,b("object",m,"detail bending params"));"b4w_detail_bending_freq"in m||(m.b4w_detail_bending_freq=1,b("object",m,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in m||(m.b4w_main_bend_stiffness_col="",b("object",m,"b4w_main_bend_stiffness_col"));
"b4w_detail_bend_colors"in m||(m.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",m,"b4w_detail_bend_colors"));"b4w_caustics"in m||(m.b4w_caustics=!1);"vertex_groups"in m&&m.vertex_groups.length&&m.data&&0==m.data.vertex_groups.length&&(m.data.vertex_groups=m.vertex_groups,delete m.vertex_groups,b("object",m,"vertex_groups"));"b4w_vertex_anim"in m&&m.b4w_vertex_anim.length&&m.data&&0==m.data.b4w_vertex_anim.length&&(m.data.b4w_vertex_anim=m.b4w_vertex_anim,
delete m.b4w_vertex_anim,b("object",m,"b4w_vertex_anim"));"b4w_do_not_render"in m||(m.b4w_do_not_render=!1);"use_ghost"in m.game||(m.game.use_ghost=!1);"use_sleep"in m.game||(m.game.use_sleep=!1);"velocity_min"in m.game||(m.game.velocity_min=0);"velocity_max"in m.game||(m.game.velocity_max=0);"collision_group"in m.game||(m.game.collision_group=1);"collision_mask"in m.game||(m.game.collision_mask=255);"b4w_vehicle_settings"in m?m.b4w_vehicle_settings&&("steering_ratio"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.steering_ratio=
10),"steering_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.steering_max=1),"inverse_control"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.inverse_control=!1),"force_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.force_max=1500),"brake_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.brake_max=100),"speed_ratio"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.max_speed_angle=Math.PI),
"delta_tach_angle"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in m.b4w_vehicle_settings||
(m.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.floating_factor=3),"floating_factor"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.water_rot_damp=.9)):(m.b4w_vehicle_settings=
null,b("object",m,"b4w_vehicle_settings"));"b4w_floating_settings"in m?m.b4w_floating_settings&&("floating_factor"in m.b4w_floating_settings||(m.b4w_floating_settings.floating_factor=3),"water_lin_damp"in m.b4w_floating_settings||(m.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in m.b4w_floating_settings||(m.b4w_floating_settings.water_rot_damp=.8)):(m.b4w_floating_settings=null,b("object",m,"b4w_floating_settings"));"b4w_character_settings"in m?m.b4w_character_settings&&("walk_speed"in
m.b4w_character_settings||(m.b4w_character_settings.walk_speed=4),"run_speed"in m.b4w_character_settings||(m.b4w_character_settings.run_speed=8),"step_height"in m.b4w_character_settings||(m.b4w_character_settings.step_height=.25),"jump_strength"in m.b4w_character_settings||(m.b4w_character_settings.jump_strength=5),"waterline"in m.b4w_character_settings||(m.b4w_character_settings.waterline=0)):(m.b4w_character_settings=null,b("object",m,"b4w_character_settings"));"b4w_selectable"in m||(m.b4w_selectable=
!1,b("object",m,"b4w_selectable"));"b4w_outlining"in m||(m.b4w_outlining=!1,b("object",m,"b4w_outlining"));"b4w_outline_on_select"in m||(m.b4w_outline_on_select=!1,b("object",m,"b4w_outline_on_select"));"b4w_billboard"in m||(m.b4w_billboard=!1,b("object",m,"b4w_billboard"));"b4w_billboard_geometry"in m||(m.b4w_billboard_geometry="SPHERICAL",b("object",m,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in m||(m.b4w_pres_glob_orientation=!1,b("object",m,"b4w_pres_glob_orientation"));"b4w_outline_settings"in
m||("b4w_glow_settings"in m?m.b4w_outline_settings=m.b4w_glow_settings:(m.b4w_outline_settings={},m.b4w_outline_settings.outline_duration=1,m.b4w_outline_settings.outline_period=1,m.b4w_outline_settings.outline_relapses=0),b("object",m,"b4w_outline_settings"));"b4w_lod_transition"in m||(m.b4w_lod_transition=.01,b("object",m,"b4w_lod_transition"));"lod_levels"in m||(m.lod_levels=[],b("object",m,"lod_levels"));"b4w_animation_mixing"in m||(m.b4w_animation_mixing=!1,b("object",m,"b4w_animation_mixing"));
break;case "EMPTY":"b4w_anchor"in m||(m.b4w_anchor=null,b("object",m,"b4w_anchor")),!m.b4w_anchor||"max_width"in m.b4w_anchor||(m.b4w_anchor.max_width=250)}"collision_margin"in m.game||(m.game.collision_margin=.04,b("object",m,"collision_margin"));"b4w_anim_behavior"in m||(m.b4w_anim_behavior=m.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",m,"b4w_anim_behavior"));if(!("rotation_quaternion"in m)){p=[0,0,0,1];f.bg(m.rotation_euler,p);var h=p,w=p[0],d=p[1],x=p[2];h[0]=p[3];h[1]=w;h[2]=d;h[3]=
x;m.rotation_quaternion=p;b("object",m,"rotation_quaternion")}"webgl_do_not_batch"in m&&(m.b4w_do_not_batch=m.webgl_do_not_batch)&&y("object",m,"webgl_do_not_batch");"b4w_shadow_cast_only"in m||(m.b4w_shadow_cast_only=!1,b("object",m,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in m||(m.b4w_correct_bounding_offset="AUTO",b("object",m,"b4w_correct_bounding_offset"));h=m.particle_systems;for(p=0;p<h.length;p++)w=h[p],d=w.settings,"use_rotation_dupli"in d||(d.use_rotation_dupli=!1,b("object",
d,"use_rotation_dupli")),"use_whole_group"in d||(d.use_whole_group=!1,b("object",d,"use_whole_group")),w.transforms||(w.transforms=new Float32Array,b("particle_system",w,"transforms")),"b4w_billboard_align"in d||(d.b4w_billboard_align="VIEW",b("particle_settings",d,"b4w_billboard_align")),"b4w_dynamic_grass"in d||(d.b4w_dynamic_grass=!1,b("object",d,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in d||(d.b4w_dynamic_grass_scale_threshold=.01,b("object",d,"b4w_dynamic_grass_scale_threshold")),
"b4w_initial_rand_rotation"in d||(d.b4w_initial_rand_rotation=!1,b("particle_settings",d,"b4w_initial_rand_rotation")),"b4w_rotation_type"in d||(d.b4w_rotation_type="Z",b("particle_settings",d,"b4w_rotation_type")),"b4w_rand_rotation_strength"in d||(d.b4w_rand_rotation_strength=1,b("particle_settings",d,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in d||(d.b4w_hair_billboard=!1,b("particle_settings",d,"b4w_hair_billboard")),"b4w_hair_billboard_type"in d||(d.b4w_hair_billboard_type="BASIC",b("particle_settings",
d,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in d||(d.b4w_hair_billboard_jitter_amp=0,b("particle_settings",d,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in d||(d.b4w_hair_billboard_jitter_freq=0,b("particle_settings",d,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in d||(d.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",d,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in d||(d.b4w_wind_bend_inheritance="PARENT",b("particle_settings",
d,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in d||(d.b4w_shadow_inheritance="PARENT",b("particle_settings",d,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in d||(d.b4w_reflection_inheritance="PARENT",b("particle_settings",d,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in d||(d.b4w_vcol_from_name="",b("particle_settings",d,"b4w_vcol_from_name")),"b4w_vcol_to_name"in d||(d.b4w_vcol_to_name="",b("particle_settings",d,"b4w_vcol_to_name")),"b4w_coordinate_system"in d||(d.b4w_coordinate_system=
"LOCAL",b("particle_settings",d,"b4w_coordinate_system")),"b4w_allow_nla"in d||(d.b4w_allow_nla=!0,b("particle_settings",d,"b4w_allow_nla")),"b4w_enable_soft_particles"in d||(d.b4w_enable_soft_particles=!1,b("particle_settings",d,"b4w_enable_soft_particles")),"b4w_particles_softness"in d||(d.b4w_particles_softness=1,b("particle_settings",d,"b4w_particles_softness"));"constraints"in m||(m.constraints=[],b("object",m,"constraints"));h=m.modifiers;for(p=0;p<h.length;p++){a:{w=h[p];switch(w.type){case "ARRAY":if(!("fit_type"in
w)){g.error("WARNING Incomplete modifier "+String(w.type)+' for "'+m.name+'", reexport "'+a.b4w_filepath_blend+'" scene');w=!1;break a}}w=!0}w||(h.splice(p,1),p--)}"animation_data"in m||(m.animation_data={action:null,nla_tracks:[]},b("object",m,"animation_data"));m.animation_data&&("action"in m.animation_data||(m.animation_data.action=null,g.warn("no action in animation data "+m.name)),"nla_tracks"in m.animation_data||(m.animation_data.nla_tracks=[],g.warn("no NLA in animation data "+m.name)),c(m.animation_data));
"b4w_collision_id"in m||(m.b4w_collision_id="",b("material",m,"b4w_collision_id"));if(0>m.scale[0]||0>m.scale[1]||0>m.scale[2])g.warn("negative scale for object "+m.name+", using positive scale instead"),m.scale[0]=Math.abs(m.scale[0]),m.scale[1]=Math.abs(m.scale[1]),m.scale[2]=Math.abs(m.scale[2]);p=m.scale;0==p[0]&&0==p[1]&&0==p[2]?p=!0:(h=Math.abs((p[1]-p[2])/p[1]),p=.005>Math.abs((p[0]-p[1])/p[0])&&.005>h);p||g.warn("non-uniform scale for object "+m.name)}for(var u in J)r=J[u],p=u.match(/.*?(?=>>|$)/i)[0],
g.warn('Property "'+String(p)+'" is '+r.FA+' for "'+r.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.GF=function(a,b){"num_channels"in a||(a.num_channels=1,g.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.UE=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var g=b[c].type;if("ARRAY"==g||"CURVE"==g){b=!0;break a}}b=!1}if(!b)return null;b=h(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var l=a[c];switch(l.type){case "ARRAY":for(var g=
b,m=l,w=0,d=0,t=0,u=new Float32Array(16),l=[],y=1;y<m.count;y++){m.use_constant_offset&&(w+=m.constant_offset_displace[0],d+=m.constant_offset_displace[1],t+=m.constant_offset_displace[2]);if(m.use_relative_offset)var z=g.b4w_bounding_box,w=w+(z.max_x-z.min_x)*m.relative_offset_displace[0],d=d+(z.max_y-z.min_y)*m.relative_offset_displace[1],t=t+(z.max_z-z.min_z)*m.relative_offset_displace[2];f.sM(w,d,t,u);for(var G=z=h(g),e=u,H=0;H<G.submeshes.length;H++){var k=G.submeshes[H];f.wg(k.position,e,k.position,
0);f.tN(k.normal,e,k.normal);f.nM(k.tangent,e,k.tangent)}l.push(z)}for(y=0;y<l.length;y++)for(m=g,w=l[y],d=0;d<m.submeshes.length;d++){t=m.submeshes[d];u=w.submeshes[d];z=t.base_length;G=t.indices.length;t.base_length+=u.base_length;for(var J in t)if("base_length"!=J)if("indices"==J)for(t[J]=f.wM(t[J],u[J]),e=G;e<t.indices.length;e++)t.indices[e]+=z;else"vertex_colors"!=J&&(t[J]=f.BH(t[J],u[J]))}break;case "CURVE":for(var g=b,y=x.HG(l.object),m=new Float32Array(16),d=y.jg?4:3,w=new Float32Array(d),
d=new Float32Array(d),t=new Float32Array(3),u=new Float32Array(4),z=new Float32Array(4),G=new Float32Array(3),e=new Float32Array(3),H=new Float32Array(3),k=new Float32Array(4),Q=new Float32Array(4),aa=0;aa<g.submeshes.length;aa++){var U=g.submeshes[aa],ba=U.position,T=U.normal,U=U.tangent,ea;a:switch(ea=l.deform_axis,ea){case "POS_X":case "NEG_X":ea=0;break a;case "POS_Y":case "NEG_Y":ea=1;break a;case "POS_Z":case "NEG_Z":ea=2;break a;default:throw"Wrong deform axis value "+ea;}G[0]=0;G[1]=0;G[2]=
0;G[ea]=1;for(var P=x.aM(y),S=0;S<ba.length/3;S++){H[0]=ba[3*S];H[1]=ba[3*S+1];H[2]=ba[3*S+2];var da=H[ea],ka=x.$L(y,da);x.bM(y,ka,w);t[0]=w[0];t[1]=w[1];t[2]=w[2];x.ZL(y,ka,d);e[0]=d[0];e[1]=0;e[2]=d[2];A.normalize(e,e);p.rotationTo(G,e,u);0>da?(w[0]=e[0],w[1]=e[1],w[2]=e[2],A.scale(w,da,w),A.add(t,w,t)):da>P&&(w[0]=e[0],w[1]=e[1],w[2]=e[2],A.scale(w,da-P,w),A.add(t,w,t));v.fromRotationTranslation(u,t,m);y.jg&&(p.setAxisAngle(G,w[3],z),A.transformQuat(H,z,H));H[ea]=0;A.transformMat4(H,m,H);ba[3*
S]=H[0];ba[3*S+1]=H[1];ba[3*S+2]=H[2];T.length&&(k[0]=T[3*S],k[1]=T[3*S+1],k[2]=T[3*S+2],k[3]=0,F.transformMat4(k,m,k),T[3*S]=k[0],T[3*S+1]=k[1],T[3*S+2]=k[2]);U.length&&(Q[0]=U[3*S],Q[1]=U[3*S+1],Q[2]=U[3*S+2],Q[3]=0,F.transformMat4(Q,m,Q),U[3*S]=Q[0],U[3*S+1]=Q[1],U[3*S+2]=Q[2])}}}r.JK(b)}return b};a.vQ=function(){return{name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,
fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,
b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.dF=function(a,b){for(var c=b.b4w_logic_nodes,f=0;f<c.length;f++)for(var h=c[f],m=0;m<
h.length;m++){var l=h[m],d={register1:"variable1",register2:"variable2",registerd:"variabled"},p;for(p in d)p in l&&(l[d[p]]=l[p]);switch(l.type){case "SELECT":for(d=0;d<a.length;d++){var r=a[d];r.name==l.object&&(r.b4w_selectable=!0)}l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=!1);break;case "SELECT_PLAY":g.warn('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport scene "'+b.name+'"');l.object.ge=!0;break;case "SHOW":case "HIDE":case "PLAY_ANIM":case "SET_SHADER_NODE_PARAM":for(d=
0;d<a.length;d++)r=a[d],r.name==l.object&&(r.b4w_do_not_batch=!0)}}}};b4w.module.__curve=function(a,t){function l(a,b,c,l,g){var p=l.length;g||(g=new Float32Array(p));for(var f=p+a,t=new Float32Array(f),y=1;y<=f-1;y++)t[y-1]=b>=c[y-1]&&b<c[y+1-1]?1:0;for(var H=2;H<=a;H++)for(y=1;y<=f-H;y++)t[y-1]=(0!=t[y-1]?(b-c[y-1])*t[y-1]/(c[y+H-1-1]-c[y-1]):0)+(0!=t[y+1-1]?(c[y+H-1]-b)*t[y+1-1]/(c[y+H-1]-c[y+1-1]):0);b==c[f-1]&&(t[p-1]=1);a=0;for(y=1;y<=p;y++)a+=t[y-1]*l[y-1];for(y=1;y<=p;y++)g[y-1]=0!=a?t[y-1]*l[y-1]/a:0;return g}function c(a){a=a.no;return a[a.length-1]}function b(a){a=
a.dx;return a[a.length-1]}t("__print");var y=t("__util");a.HG=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var v=a.order_u;b.qg=v;a=a.points;var g=a.length/5,p=[],f=g+v,g=g+2;p[0]=0;for(var t=2;t<=f;t++)p[t-1]=t>v&&t<g?p[t-2]+1:p[t-2];b.no=p;if("2D"==c.dimensions)b.jg=!1;else if("3D"==c.dimensions)b.jg=!0;else throw"Wrong curve dimensions";v=[];p=[];for(c=0;c<a.length;c+=5)v.push(a[c]),v.push(a[c+1]),v.push(a[c+2]),b.jg&&v.push(a[c+3]),p.push(a[c+
4]);b.Mq=v;b.Lu=p;a=[];for(var c=b.Mq,v=b.jg?4:3,p=b.Lu,f=b.no,g=b.qg,t=c.length/v,y=t+g,H=0,J=f[y-1]/999,D=0;1E3>D;D++){5E-6>f[y-1]-H&&(H=f[y-1]);for(var n=l(g,H,f,p),C=0;C<v;C++)for(var B=a[v*D+C]=0;B<t;B++)a[v*D+C]+=n[B]*c[v*B+C];H+=J}v=b.jg?4:3;p=new Float32Array(1E3);p[0]=0;for(c=1;1E3>c;c+=1)f=a[(c-1)*v],g=a[(c-1)*v+1],t=a[(c-1)*v+2],y=a[c*v],H=a[c*v+1],J=a[c*v+2],p[c]=p[c-1]+Math.sqrt((y-f)*(y-f)+(H-g)*(H-g)+(J-t)*(J-t));b.dx=p;return b};a.bM=function(a,b,x){x||(x=[]);var v=b,g=Math.max(v,
0);b=g=Math.min(v,c(a));var v=a.Mq,g=a.jg?4:3,p=a.Lu,f=a.no,t=a.qg;a=v.length/g;var y=a+t;5E-6>f[y-1]-b&&(b=f[y-1]);y=new Float32Array(a);l(t,b,f,p,y);for(b=0;b<g;b++)for(p=x[b]=0;p<a;p++)x[b]+=y[p]*v[g*p+b]};a.ZL=function(a,b,c){c||(c=[]);var l=a.Mq,g=a.jg?4:3,p=a.Lu,f=a.no,t=a.qg;a=l.length/g;var y=a+t;5E-6>f[y-1]-b&&(b=f[y-1]);var y=new Float32Array(a),H=b;b=y;var J=p.length;b||(b=new Float32Array(J));var D=new Float32Array(J),n=new Float32Array(J),C=D,B=n;C||(C=new Float32Array(J));B||(B=new Float32Array(J));
for(var q=J+t,m=new Float32Array(q),w=new Float32Array(q),d=1;d<=q-1;d++)m[d-1]=H>=f[d-1]&&H<f[d+1-1]?1:0;H==f[q-1]&&(m[J-1]=1);for(var I=2;I<=t;I++)for(d=1;d<=q-I;d++){var u=0!=m[d-1]?m[d-1]/(f[d+I-1-1]-f[d-1]):0,E=0!=m[d+1-1]?-m[d+1-1]/(f[d+I-1]-f[d+1-1]):0,z=0!=w[d-1]?(H-f[d-1])*w[d-1]/(f[d+I-1-1]-f[d-1]):0,G=0!=w[d+1-1]?(f[d+I-1]-H)*w[d+1-1]/(f[d+I-1]-f[d+1-1]):0;m[d-1]=(0!=m[d-1]?(H-f[d-1])*m[d-1]/(f[d+I-1-1]-f[d-1]):0)+(0!=m[d+1-1]?(f[d+I-1]-H)*m[d+1-1]/(f[d+I-1]-f[d+1-1]):0);w[d-1]=u+E+z+G}for(d=
1;d<=J;d++)C[d-1]=m[d-1],B[d-1]=w[d-1];f=0;for(t=1;t<=J;t++)f+=D[t-1]*p[t-1];H=0;for(t=1;t<=J;t++)H+=n[t-1]*p[t-1];for(t=1;t<=J;t++)b[t-1]=0!=f?n[t-1]*p[t-1]/f+D[t-1]*p[t-1]*H/(f*f):0;for(p=0;p<g;p++)for(f=c[p]=0;f<a;f++)c[p]+=y[f]*l[g*f+p]};a.uU=c;a.aM=b;a.$L=function(a,l){if(0>=l)return 0;var x=c(a);if(l>=b(a))return x;var v=a.dx,g=y.cn(v,l,0,v.length-1);return x*(g+(l-v[g])/(v[g+1]-v[g]))/1E3}};b4w.module.__scenegraph=function(a,t){function l(a){a=ta.Xf(a);a.pf=null;a.Cb=null;a.Gd=null;return a}function c(a,c){var d=[];L.We(a,function(b,c,e){-1<d.indexOf(e)?L.TK(a,b,c,e,y(e)):d.push(e)});L.V(a,function(b,e){for(var f=0;f<e.va.length;f++){var g=e.va[f];c||"MAIN_PLANE_REFLECT"!=e.type&&"MAIN_CUBE_REFLECT"!=e.type&&"MAIN_XRAY"!=e.type||(g.qi=!0);-1<d.indexOf(g)?e.va[f]=y(g):d.push(g)}"ANTIALIASING"==e.type&&L.Kf(a,b,function(a,b){if("MOTION_BLUR"==b.type)for(var c=0;c<b.va.length;c++){var d=
b.va[c];d.la=O.t;d.ka=O.t}});c||L.Kf(a,b,function(a,b,c){"DEPTH"==c.from&&(c.qi=!0)})});L.V(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],g=0;g<c.length;g++)if(c[g].la==O.t){f=c[g];break}for(var h=c[0],g=0;g<c.length;g++)if(c[g].ka==O.t){h=c[g];break}for(var m=c[0],g=0;g<c.length;g++)if(!c[g].qi){m=c[g];break}for(g=0;g<c.length;g++)c[g].la=f.la,c[g].ka=h.ka,c[g].qi=m.qi}})}function b(a,c,d){L.Kf(a,c,function(c,e,f){f.mb&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&
d[f.from].push(f),b(a,c,d))});L.Ng(a,c,function(a,b,c){c.mb&&(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=L.Za(a,c);if("MOTION_BLUR"==c.type)for(var e=0;e<c.va.length;e++){var f=c.va[e];d[f.from].push(f)}}function y(a){if(a.Ga)throw"Failed to clone slink with attached texture";return pb.oh(a)}function h(a){var b=L.hu(a),c=[];L.V(b,function(a,d){switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var e=[];break;
default:e=c}for(var f=0;f<d.va.length;f++){var h=d.va[f],m=p(e,h,x(h));h.Ga=m;d.Ue[f]=m}for(f=0;f<d.Ue.length;f++)m=d.Ue[f],g(e,m);switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":e=[]}L.Ng(b,a,function(c,d,f){if(!f.Ga){if((c=v(b,a,f.from))&&f.mb&&!f.Ga){d=e;for(var g=c,h=0;h<d.length;h++){var m=d[h];m.eu===g&&m.Wl++}}else c=p(e,f,x(f));f.Ga=c}});L.Kf(b,a,function(a,b,c){g(e,c.Ga)});L.Ng(b,a,function(a,b,c){c.Ga&&"NONE"==c.to&&g(e,c.Ga)})})}
function r(a){A(a,function(b,c,d){b.jk&&(na(a,d,"SMAA_NEIGHBORHOOD_BLENDING")&&"SMAA_NEIGHBORHOOD_BLENDING"!=d.type||na(a,d,"ANTIALIASING")||"ANCHOR_VISIBILITY"==d.type)&&(b.Gg*=Ga.render_resolution_factor)})}function x(a){a=pb.oh(a);delete a.to;delete a.mb;delete a.Ga;return JSON.stringify(a)}function v(a,b,c){var d=null;L.Kf(a,b,function(a,b,e){if(e.mb&&e.from==e.to&&e.from==c&&e.Ga)return d=e.Ga,!0});L.Ng(a,b,function(a,b,e){if(e.mb&&e.from==c&&e.Ga)return d=e.Ga,!0});return d}function g(a,b){for(var c=
0;c<a.length;c++){var d=a[c];d.eu===b&&d.Wl&&d.Wl--}}function p(a,b,c){for(var d=null,e=0;e<a.length;e++){var g=a[e];if(g.id==c&&0===g.Wl){d=g;break}}if(d&&!Ga.MJ)return d.Wl++,d.eu;b=f(b);a.push({id:c,Wl:1,eu:b});return b}function f(a){var b=a.Gg*a.size;switch(a.from){case "COLOR":var c=O.vn("COLOR",O.Bi);O.resize(c,b,b);O.em(c,a.la,a.ka);return c;case "DEPTH":return a.qi?(c=O.vn("DEPTH_RBUF",O.Ai),O.resize(c,b,b)):(c=O.vn("DEPTH_TEX",O.xk),O.resize(c,b,b),O.em(c,a.la,a.ka)),c;case "CUBEMAP":return c=
O.pG(b);case "SCREEN":return null;default:throw"Wrong slink param: "+a.from;}}function A(a,b){var c=!1;L.We(a,function(d,e,f){if(f&&(d=L.Za(a,d),e=L.Za(a,e),b(f,!1,d,e)))return c=!0});c||L.V(a,function(a,c){for(var d=0;d<c.va.length;d++)if(b(c.va[d],!0,c,null))return!0})}function F(a){L.V(a,function(b,c){if("SINK"!=c.type){var d=c.j;L.Ng(a,b,function(a,b,c){c.mb&&c.Ga&&(Z.To(d,c.from,c.Ga),c.from==c.to&&b.j&&Z.To(b.j,c.from,c.Ga))});for(var e=0;e<c.va.length;e++){var f=c.va[e];f.mb&&f.from==f.to&&
Z.To(d,f.from,c.Ue[e])}!d.Cb&&!d.Gd||d.pf||(d.pf=la.SK(d.Cb,d.Gd))}})}function H(a){var b=null,c=0;L.V(a,function(a,d){if(d.type==qa.lM){if(c==qa.kM)return b=d,!0;c++}});return b}function J(a,b){var c=L.Vh(a,b),d=w("NONE"),e=L.u(a,d),f=L.Dy(a)[0];L.We(a,function(b,c){c==f&&L.KK(a,b,f,b,e)});L.We(a,function(e,f,g){if(e==c)return L.n(a,b,d,B(qa.OL,"u_color",g.size,g.Gg,g.jk)),!0});L.gc(a,e,f,B("SCREEN","NONE",.5,.5,!0))}function D(a,b){a.Hl=b;a.rs=new Float32Array(3*b);a.po=new Float32Array(3*b);a.qs=
new Float32Array(3*b);a.ss=new Float32Array(0==b%2?2*b:2*b+2)}function n(a,b,c){var d=C("SHADOW_CAST");d.Tq=a;d.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.Mh){case "SPOT":case "POINT":d.j=Z.Fb(Z.ec);Z.Xo(d.j,180*b.Hg/Math.PI,.1,2*b.distance);break;default:d.j=Z.Fb(Z.$g)}D(d,c);return d}function C(a){a={type:a,$a:"",Ma:!1,bA:!1,eq:!1,vo:!1,Uk:0,time:0,j:null,Tk:null,Vq:[],p:[],va:[],Ue:[],Lf:new Float32Array(3),NC:new Float32Array(3),Jc:new Float32Array(3),wc:new Float32Array(4),
Ln:new Float32Array(4),dd:new Float32Array(16),AB:0,ag:0,Hl:0,rs:null,po:null,qs:null,ss:null,ig:new Float32Array(3),Wg:new Float32Array(3),BB:new Float32Array(4),SB:new Float32Array([0,0,0]),Zt:new Float32Array(3),TB:new Float32Array(4),zB:new Float32Array(3),Ll:0,jr:0,Al:!1,Af:new Float32Array(3),vi:0,Bb:null,Bp:!1,Dg:new Float32Array(2),Eg:new Float32Array(2),Rj:0,vj:0,xq:0,re:null,Ug:0,yi:0,Tg:0,gf:!1,ow:0,pw:new Float32Array(2),nw:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,
rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Sj:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,Yj:0,Xj:0,Wj:0,KB:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,uj:0,Mo:0,bk:0,Tq:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,sC:null,dw:null,ci:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,
nq:0,qr:0,mb_decay_threshold:0,mb_factor:0,Jz:0,Ho:"",lJ:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,fu:new Float32Array(2),ab:new Float32Array(2),yb:!0,vc:!0,qa:!0,wa:!0,$b:!0,ya:!0,Jf:1};a.ab[0]=1;a.ab[1]=1;return a}function B(a,b,c,d,e){return{from:a,to:b,size:c,Gg:d,jk:e,mb:!0,Ga:null,qi:!1,la:O.Zc,ka:O.Zc}}function q(a,b){for(var c=0,d=X(a,b),e=0;e<d.length;e++){var f=d[e];"SHADOW_CAST"==f.type&&(f=f.j,b.pK=f.pb/(f.pb-f.rb),
b.sC=f.Ba,b.dw=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.ci=b.ci||[],b.ci[c]=f.Fa,c++)}}function m(){var a=C("GRASS_MAP");a.j=Z.Fb(Z.Qf);return a}function w(a){var b=C("POSTPROCESSING");b.qa=!1;b.wa=!1;b.$b=!1;b.j=Z.Fb(Z.Pb);b.Ho=a;switch(a){case "NONE":b.ab[0]=1;b.ab[1]=1;break;case "GRAYSCALE":b.ab[0]=1;b.ab[1]=1;break;case "X_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_BLUR":b.ab[0]=0;b.ab[1]=1;break;case "X_GLOW_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_GLOW_BLUR":b.ab[0]=0;b.ab[1]=
1;break;case "X_EXTEND":b.ab[0]=1;b.ab[1]=0;break;case "Y_EXTEND":b.ab[0]=0;b.ab[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function d(a){var b=C("BLOOM_BLUR");b.qa=!1;b.wa=!1;b.$b=!1;b.j=Z.Fb(Z.Pb);b.Ho=a;switch(a){case "X_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_BLUR":b.ab[0]=0;b.ab[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function I(a,b){var c=C("GLOW_COMBINE");c.qa=!1;c.wa=!1;c.$b=!1;c.small_glow_mask_coeff=b.hg.small_glow_mask_coeff;
c.large_glow_mask_coeff=b.hg.large_glow_mask_coeff;c.small_glow_mask_width=b.hg.small_glow_mask_width;c.large_glow_mask_width=b.hg.large_glow_mask_width;c.j=a;return c}function u(a,b,c,d,e,f,g,h,m){var k=C("MAIN_"+a);if("OPAQUE"===a)k.qa=!0,k.wa=c,k.Ma=!1;else if("BLEND"===a)k.qa=!1,k.wa=!1,k.Ma=!0;else if("XRAY"===a)k.qa=!1,k.wa=!0,k.Ma=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)k.qa=!0,k.wa=!0,k.Ma=!1;else if("GLOW"===a)k.qa=!0,k.wa=!1,k.Ma=!1;else throw"wrong main subscene type";k.Ma&&
h&&(k.self_shadow_normal_offset=h.self_shadow_normal_offset);k.j=b;if(a=g.Nt)k.BB.set([a.mF,a.RI,a.GN,a.FN]),k.zB.set(a.color),k.AB=a.Pa;k.ig.set(g.ig);k.Wg.set(g.Wg);k.ag=g.ag;k.wc=f.wc;k.Ln=f.Ln;d&&(k.Bb=d,d.wc&&(k.re=new Float32Array(d.wc)),k.Ug=d.waves_height,k.yi=d.waves_length,k.Tg=d.Tg,d.gf&&m&&(k.gf=!0,k.ow=d.DF,k.pw.set(d.EF),k.nw=d.CF),d.hp&&(k.Bp=!0,f=d.ML,k.Dg[0]=(f[0]+f[1])/2,k.Dg[1]=(f[2]+f[3])/2,k.Eg[0]=f[0]-f[1],k.Eg[1]=f[2]-f[3],k.Rj=d.Rj,k.vj=d.vj));D(k,e);return k}function E(a,
b,c){var d=C("COLOR_PICKING");b&&(d.type+="_XRAY",d.qa=!1,d.wa=!0);d.vc=!1;d.j=a;D(d,c);return d}function z(a){var b=C("WIREFRAME");b.yb=!1;b.qa=!1;b.wa=!1;b.j=a;return b}function G(a){var b=C("ANCHOR_VISIBILITY");b.qa=!0;b.wa=!1;b.j=a;return b}function e(a,b){var c=C("DEPTH");c.j=a;D(c,b);return c}function K(a,b,c){var d=C("SSAO");d.qa=!1;d.wa=!1;d.$b=!1;d.j=a;d.wc=b.wc;d.re=new Float32Array(b.wc);d.Yj=c.radius_increase;d.ssao_hemisphere=c.QI;d.Xj=c.influence;d.Wj=c.dist_factor;d.KB=c.cL;return d}
function k(a,b){var c=C("SSAO_BLUR");c.qa=!1;c.wa=!1;c.$b=!1;c.j=a;c.ssao_blur_depth=b.pF;c.ssao_blur_discard_value=b.iw;return c}function M(){var a=C("ANTIALIASING");a.qa=!1;a.wa=!1;a.$b=!1;a.Jf=1/Ga.render_resolution_factor;a.j=Z.Fb(Z.Pb);return a}function Q(a){var b=C(a);b.qa="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.wa=!1;b.$b=!1;b.Jf=1/Ga.render_resolution_factor;b.j=Z.Fb(Z.Pb);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.mJ=new Float32Array(4));return b}function aa(a,
b,c,d){var e=C("COMPOSITING");e.qa=!1;e.wa=!1;e.$b=!1;e.j=Z.Fb(Z.Pb);e.brightness=a;e.contrast=b;e.exposure=c;e.saturation=d;return e}function U(a,b){var c=C("MOTION_BLUR");c.qa=!1;c.wa=!1;c.$b=!1;c.j=Z.Fb(Z.Pb);c.eq=!0;c.mb_decay_threshold=a;c.mb_factor=b;return c}function ba(a){var b=C("DOF");b.qa=!1;b.wa=!1;b.$b=!1;b.j=a;b.Jf=b.j.dof_power;return b}function T(a,b){var c=C("OUTLINE_MASK");c.$b=!1;c.j=a;D(c,b);return c}function ea(a){var b=C("OUTLINE");Ra.outlining_overview_mode?b.Af.set(Ra.Af):
b.Af.set(a.Af);b.Ll=a.Ll;b.qr=5;b.nq=3;b.$b=!1;b.j=Z.Fb(Z.Pb);return b}function P(){var a=C("REFRACT");a.qa=!1;a.wa=!1;a.$b=!1;a.j=Z.Fb(Z.Pb);return a}function S(a,b,c,d,e,f,g){var h=C("GOD_RAYS");h.qa=!1;h.wa=!1;h.$b=!1;h.ig=new Float32Array([1,1,1]);h.Wg=new Float32Array([1,1,1]);h.ag=1;h.bA=d;h.vi=b;h.Mo=e;h.uj=c;h.bk=g;h.j=a;D(h,f);return h}function da(a,b){var c=C("GOD_RAYS_COMBINE");c.qa=!1;c.wa=!1;c.$b=!1;c.j=Z.Fb(Z.Pb);c.god_rays_intensity=a;D(c,b);return c}function ka(a,b){var c=C("SKY");
c.vc=!1;c.qa=!1;c.wa=!1;c.$b=!1;var d=Z.Fb(Z.Pb);d.width=kb.xn;d.height=kb.xn;c.j=d;c.Tk=pb.MH();D(c,a);c.ig=new Float32Array([1,1,1]);c.Wg=new Float32Array([1,1,1]);c.ag=1;c.Sj.set(b.Sj);c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;
c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;return c}function ca(){var a=C("COPY");a.qa=!1;a.wa=!1;a.j=Z.Fb(Z.Pb);return a}function ia(){var a=C("ANAGLYPH");a.qa=!1;a.wa=!1;a.j=Z.Fb(Z.Pb);return a}function fa(){var a=C("LUMINANCE");a.qa=!1;a.wa=!1;a.j=Z.Fb(Z.Pb);return a}function R(){var a=C("AVERAGE_LUMINANCE");a.qa=!1;a.wa=!1;a.j=Z.Fb(Z.Pb);return a}function ra(a,b,c,d){var e=C("LUMINANCE_TRUNCED");e.qa=
!1;e.wa=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.j=d;D(e,c);return e}function sa(a){var b=C("BLOOM");b.qa=!1;b.wa=!1;b.j=Z.Fb(Z.Pb);b.bloom_blur=a;return b}function oa(){var a=C("SINK");a.vc=!1;return a}function na(a,b,c){if(b.type===c)return!0;b=ga(a,b);for(var d=0;d<b.length;d++)if(na(a,b[d],c))return!0;return!1}function N(a,b,c){if(b.type===c)return!0;b=X(a,b);for(var d=0;d<b.length;d++)if(N(a,b[d],c))return!0;return!1}function X(a,b){var c=L.Vh(a,b);if(c==L.fv)throw"Subscene not in graph";for(var d=
[],e=L.$r(a,c),f=0;f<e;f++){var g=L.sl(a,c,f);g!=c&&d.push(L.Za(a,g))}return d}function ga(a,b){var c=L.Vh(a,b);if(c==L.fv)throw"Subscene not in graph";for(var d=[],e=L.rg(a,c),f=0;f<e;f++){var g=L.dg(a,c,f);g!=c&&d.push(L.Za(a,g))}return d}function V(a){var b=[],c=[];A(a,function(a){a.Ga&&-1==b.indexOf(a.Ga)&&(b.push(a.Ga),c.push(a.Ga,b.length-1))});return c}function ha(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.jk){var d=a.Gg;Math.round(d)!=d&&(d=d.toFixed(2));d=(1==
d?"":d)+"S";c+=d+"x"+d}else c+=a.size+"x"+a.size;if("SCREEN"!=a.from){c+=" ";if(a.qi)c+="RR";else{var d=a.la,e=a.ka,f="";d==O.t?f+="L":d==O.Zc&&(f+="N");e==O.t?f+="L":e==O.Zc&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.Ga&&(c+=" "+b[d+1])}return c+")\\n"}var Z=t("__camera"),W=t("__config"),ja=t("__debug"),L=t("__graph"),ta=t("__obj_util"),la=t("__renderer"),O=t("__textures"),pb=t("__util"),qa=W.br,Ga=W.r,Ra=W.Db,kb=W.Mj;a.VF=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;
default:return!0}};a.vM=A;a.BG=function(a,b,f){function g(c,d){var e=l(Ha[d]);b.S.push(e);e=u(c,e,!1,ha,ga,Pb,Lc,Qb,a.ni);v.push(e);L.u(p,e);L.n(p,x[d],e,y[d]);"XRAY"==c?e.va.push(B("DEPTH","DEPTH",1,1,!0)):L.n(p,x[d],e,A[d]);Ya&&(L.n(p,Ya,e,lb),L.n(p,Ya,e,Kb));if(Ob){for(var f=0;f<V.length;f++)L.n(p,V[f],e,la[f]);if(Uc.Dc&&hb||Fc||Gb){var f=Rb[d],h=l(f.j);b.S.push(h);var m=C("DEPTH_PACK");m.qa=!1;m.wa=!1;m.j=h;L.u(p,m);var h=B("DEPTH","u_depth",1,1,!0),k=B("COLOR","u_scene_depth",1,1,!0);k.la=O.Zc;
k.ka=O.Zc;L.n(p,f,m,h);L.n(p,m,e,k)}}if(D.length)for(m=D.length/Ha.length,f=0;f<m;f++)h=m*d+f,L.n(p,D[h],e,N[h]);if(na.length)for(f=0;f<na.length;f++)L.n(p,na[f],e,W[f]);ta.length&&L.n(p,ta[d],e,X[d]);return e}var p=L.create(),x=[],v=[],t=[],y=[],A=[],D=[],N=[],ta=[],X=[],V=[],la=[],na=[],W=[],ga=a.pJ,ha=a.Bb,Fc=a.Cg,Gb=a.PL,Va=a.Re,Xb=a.hj,Uc=a.VJ,Hb=a.Kj,wc=a.oF,Mc=a.Uh,nc=a.Oi,Kc=a.antialiasing,Lc=a.Nu,Pb=a.LC,Qb=a.rc,xc=a.ZJ,gc=a.FF,vc=a.II,Yc=a.mK,bd=a.Vi,Ob=a.aH,hb=a.Dc,$a=Boolean(f.length),
Ha=[];if(a.anaglyph_use&&!$a){var cc=b.S[0],xb=l(cc);Z.Fz(cc,Z.Qb);Z.Fz(xb,Z.Xb);Ha.push(cc,xb);b.S.push(xb)}else{var ya=b.S[0];Ha.push(ya)}if(Qb){Z.tu(Ha[0],Qb);for(var rb=Qb.csm_num,Y=0;Y<rb;Y++){var cb=n(Y,Qb,ga);L.u(p,cb);V.push(cb);var za=Qb.csm_resolution,ya=cb.j;ya.width=za;ya.height=za;cb.qa=!1;la.push(B("DEPTH","u_shadow_map"+Y,za,1,!1));(ja.ww()||Ga.Bx)&&cb.va.push(B("COLOR","COLOR",za,1,!1))}}if(Hb&&Hb.Vz&&!$a)for(Y=0;Y<Hb.Vz;Y++){ya=Z.Fb(Z.ec);ya.width=a.sh;ya.height=a.sh;Z.Xo(ya,90,.1,
100);Z.zg(ya,ya.Ia);var ua=u("CUBE_REFLECT",ya,!1,ha,ga,Pb,Lc,null,a.ni);ua.Tk=pb.QH();for(var Da=0;6>Da;Da++)ua.Vq.push(Z.sG());L.u(p,ua);var Ea=B("CUBEMAP","u_cube_reflection",a.sh,1,!1);Ea.la=O.t;Ea.ka=O.t;var Ra=B("DEPTH","DEPTH",a.sh,1,!1);W.push(Ea);ua.va.push(Ra);na.push(ua);Hb.Yf.push(ua)}if(Hb&&0<Hb.BA.length&&!$a)for(Y=0;Y<Ha.length;Y++)for(Da=0;Da<Hb.BA.length;Da++)ya=l(Ha[Y]),ya.Bc=new Float32Array(4),b.S.push(ya),ua=u("PLANE_REFLECT",ya,!1,ha,ga,Pb,Lc,null,a.ni),L.u(p,ua),Ea=B("COLOR",
"u_plane_reflection",1,a.Sl,!0),Ea.la=O.t,Ea.ka=O.t,Ra=B("DEPTH","DEPTH",1,a.Sl,!0),N.push(Ea),ua.va.push(Ra),D.push(ua),Hb.ug.push(ua);x=[];v=[];if(a.Rb){var Ya=m();L.u(p,Ya);za=kb.Vn;Ya.j.width=za;Ya.j.height=za;var lb=B("DEPTH","u_grass_map_depth",za,1,!1);lb.la=O.t;lb.ka=O.t;var Kb=B("COLOR","u_grass_map_color",za,1,!1);Kb.la=O.t;Kb.ka=O.t}else Kb=lb=Ya=null;for(var Db=[],oc=[],Rb=[],Yb=[],Y=0;Y<Ha.length;Y++){var ya=Ha[Y],ab={};A.push(B("DEPTH","DEPTH",1,1,!0));if(Ob){var yb=l(ya);b.S.push(yb);
ab=e(yb,ga);Rb.push(ab);L.u(p,ab);if(Qb){ab.self_shadow_normal_offset=Qb.self_shadow_normal_offset;for(Da=0;Da<V.length;Da++)cb=V[Da],L.n(p,cb,ab,la[Da]);var dc=B("COLOR","u_color",1,1,!0),yc=B("DEPTH","u_depth",1,1,!0);if(Va){var Lb=l(ya);b.S.push(Lb);var sb=a.dM,tb=K(Lb,Pb,sb);L.u(p,tb);var Oa=B("COLOR","u_ssao_mask",1,1,!0);L.n(p,ab,tb,dc);L.n(p,ab,tb,yc);var Wa=l(ya);b.S.push(Wa);var Eb=k(Wa,sb);L.u(p,Eb);var ec=B("COLOR","u_shadow_mask",1,1,!0);L.n(p,tb,Eb,Oa);L.n(p,ab,Eb,yc)}}else ja.ww()&&
ab.va.push(B("COLOR","COLOR",1,1,!0));Ya&&(L.n(p,Ya,ab,lb),L.n(p,Ya,ab,Kb))}ua=u("OPAQUE",ya,!Ob,ha,ga,Pb,Lc,null,a.ni);L.u(p,ua);v.push(ua);oc.push(ua);Ob&&(L.n(p,ab,ua,A[Y]),Oa?L.n(p,Eb,ua,ec):Qb&&L.n(p,ab,ua,B("COLOR","u_shadow_mask",1,1,!0)));var pc=B("COLOR","u_color",1,1,!0);y.push(B("COLOR","COLOR",1,1,!0));Ya&&(L.n(p,Ya,ua,lb),L.n(p,Ya,ua,Kb));if(D.length)for(var db=D.length/Ha.length,Da=0;Da<db;Da++){var qc=db*Y+Da;L.n(p,D[qc],ua,N[qc])}if(na.length)for(Da=0;Da<na.length;Da++)L.n(p,na[Da],
ua,W[Da])}x=v;v=[];if(!$a&&a.dG){ya=l(x[0].j);b.S.push(ya);var Mb=E(ya,!1,ga);L.u(p,Mb);if(a.Nf){ya=l(x[0].j);b.S.push(ya);var eb=E(ya,!0,ga);L.u(p,eb);L.n(p,Mb,eb,B("COLOR","COLOR",1,1,!0));L.n(p,Mb,eb,B("DEPTH","DEPTH",1,1,!0))}}else Mb=null;if(Uc.Dc&&!$a)for(Y=0;Y<Ha.length;Y++){var Ia=P();L.u(p,Ia);L.n(p,x[Y],Ia,pc);ta.push(Ia);X.push(B("COLOR","u_refractmap",1,1,!0))}if(a.Or){for(Y=0;Y<Ha.length;Y++)ua=g("BLEND",Y),Db.push(ua);x=v;v=[]}if(a.sf){for(Y=0;Y<Ha.length;Y++){var zb=l(Ha[Y]);b.S.push(zb);
var fb=u("GLOW",zb,!1,ha,ga,Pb,Lc);L.u(p,fb);L.n(p,oc[Y],fb,A[Y]);var Ja=w("X_GLOW_BLUR");Ja.$a="GLOW_MASK_SMALL";Ja.Jf=a.hg.small_glow_mask_width;var Ba=B("COLOR","u_color",1,1,!0);Ba.la=O.t;Ba.ka=O.t;L.u(p,Ja);L.n(p,fb,Ja,Ba);var mb=w("Y_GLOW_BLUR");mb.$a="GLOW_MASK_SMALL";mb.Jf=a.hg.small_glow_mask_width;var wa=B("COLOR","u_color",1,.5,!0);wa.la=O.t;wa.ka=O.t;L.u(p,mb);L.n(p,Ja,mb,wa);var bb=w("X_GLOW_BLUR");bb.$a="GLOW_MASK_LARGE";bb.Jf=a.hg.large_glow_mask_width;var Sa=B("COLOR","u_color",1,
.5,!0);Sa.la=O.t;Sa.ka=O.t;L.u(p,bb);L.n(p,mb,bb,Sa);var ib=w("Y_GLOW_BLUR");ib.$a="GLOW_MASK_LARGE";ib.Jf=a.hg.large_glow_mask_width;var Ka=B("COLOR","u_color",1,.25,!0);Ka.la=O.t;Ka.ka=O.t;L.u(p,ib);L.n(p,bb,ib,Ka);var ub=l(Ha[Y]);b.S.push(ub);var Ta=I(ub,a);L.u(p,Ta);a.Or?L.n(p,Db[Y],Ta,B("COLOR","u_src_color",1,1,!0)):L.n(p,oc[Y],Ta,B("COLOR","u_src_color",1,1,!0));var hc=B("COLOR","u_glow_mask_small",1,.5,!0);hc.la=O.t;hc.ka=O.t;L.n(p,mb,Ta,hc);var Ab=B("COLOR","u_glow_mask_large",1,.25,!0);
Ab.la=O.t;Ab.ka=O.t;L.n(p,ib,Ta,Ab);t.push(Ta)}x=t;v=[]}if(!a.Or){for(Y=0;Y<Ha.length;Y++)ua=g("BLEND",Y),Db.push(ua);x=v;v=[]}if(a.Nf){for(Y=0;Y<Ha.length;Y++){var nb=g("XRAY",Y);Yb.push(nb)}x=v;v=[]}if(Ga.wireframe_debug){for(Y=0;Y<Ha.length;Y++){ya=l(Ha[Y]);b.S.push(ya);var Fb=z(ya);v.push(Fb);L.u(p,Fb);L.n(p,x[Y],Fb,y[Y]);L.n(p,x[Y],Fb,A[Y]);Ya&&(L.n(p,Ya,Fb,lb),L.n(p,Ya,Fb,Kb))}x=v;v=[]}if(!$a&&a.wE){ya=l(Ha[0]);b.S.push(ya);var ob=G(ya);L.u(p,ob);L.n(p,x[0],ob,A[0])}if(Xb&&Ob&&!$a){for(Y=0;Y<
Ha.length;Y++){var Bb=vc.uj,zc=vc.cs,Xa=vc.bk,Ca=x[Y],Ua=ha?1:0,Ac=B("DEPTH","u_input",1,1,!0);Ac.la=O.t;Ac.ka=O.t;var Ib=B("COLOR","u_input",1,.25,!0);Ib.la=O.t;Ib.ka=O.t;var rc=Bb/Xa,Pa=l(Ha[Y]);b.S.push(Pa);var Jb=S(Pa,Ua,Bb,!0,rc,ga,Xa);L.u(p,Jb);L.n(p,Ca,Jb,Ac);var rc=Bb/Xa*.5,fc=l(Ha[Y]);b.S.push(fc);var Za=S(fc,Ua,Bb,!1,rc,ga,Xa);L.u(p,Za);L.n(p,Jb,Za,Ib);var rc=Bb/Xa*.25,Cb=l(Ha[Y]);b.S.push(Cb);var Nc=S(Cb,Ua,Bb,!1,rc,ga,Xa);L.u(p,Nc);L.n(p,Za,Nc,Ib);var ic=da(zc,ga);v.push(ic);L.u(p,ic);
L.n(p,Ca,ic,B("COLOR","u_main",1,1,!0));L.n(p,Nc,ic,B("COLOR","u_god_rays",1,1,!0))}x=v;v=[]}if(wc&&!$a){for(Y=0;Y<Ha.length;Y++){var Ca=x[Y],Sb=fa();L.u(p,Sb);L.n(p,Ca,Sb,B("COLOR","u_input",1,1,!0));var Tb=R();L.u(p,Tb);Tb.j.width=Ga.cl?2:1;Tb.j.height=Ga.cl?2:1;var jc=B("COLOR","u_input",1,.25,!0);jc.la=O.t;jc.ka=O.t;var Oc=B("COLOR","u_luminance",1,.25,!0);Oc.la=O.t;Oc.ka=O.t;L.n(p,Sb,Tb,jc);var Vc=wc.key,Zb=wc.hH,kc=l(Ha[Y]);b.S.push(kc);var vb=ra(Vc,Zb,ga,kc);L.u(p,vb);L.n(p,Ca,vb,B("COLOR",
"u_main",1,1,!0));L.n(p,Sb,vb,Oc);L.n(p,Tb,vb,B("COLOR","u_average_lum",1,1,!1));var La=B("COLOR","u_color",1,.25,!0);La.la=O.t;La.ka=O.t;Ja=d("X_BLUR");L.u(p,Ja);L.n(p,vb,Ja,La);mb=d("Y_BLUR");L.u(p,mb);L.n(p,Ja,mb,La);var Qa=sa(wc.blur);L.u(p,Qa);var $b=B("COLOR","u_bloom",1,.25,!0);$b.la=O.t;$b.ka=O.t;L.n(p,mb,Qa,$b);L.n(p,Ca,Qa,B("COLOR","u_main",1,1,!0));v.push(Qa)}x=v;v=[]}if(Mc&&!$a){for(Y=0;Y<x.length;Y++){var wd=x[Y],cd=U(xc.mb_decay_threshold,xc.mb_factor);v.push(cd);L.u(p,cd);L.n(p,wd,
cd,B("COLOR","u_mb_tex_curr",1,1,!0));cd.va.push(B("COLOR","u_mb_tex_accum",1,1,!0))}x=v;v=[]}if(bd&&Ob&&!$a){for(Y=0;Y<x.length;Y++){var Ca=x[Y],sc=l(Ha[Y]);b.S.push(sc);La=B("COLOR","u_color",1,1,!0);La.la=O.t;La.ka=O.t;var Nb=w("X_BLUR");L.u(p,Nb);L.n(p,Ca,Nb,La);var ac=w("Y_BLUR");L.u(p,ac);L.n(p,Nb,ac,La);var ab=Db[Y],Bc=ba(sc);sc.dof_distance=b.dof_distance;sc.nf=b.nf;sc.dof_front=b.dof_front;sc.dof_rear=b.dof_rear;sc.dof_power=b.dof_power;sc.dof_on=1;v.push(Bc);L.u(p,Bc);L.n(p,Ca,Bc,B("COLOR",
"u_sharp",1,1,!0));L.n(p,ac,Bc,B("COLOR","u_blurred",1,1,!0));L.n(p,ab,Bc,B("DEPTH","u_depth",1,1,!0))}x=v;v=[]}if(!$a&&a.outline){for(Y=0;Y<Ha.length;Y++){var Ca=x[Y],rd=l(Ha[Y]);b.S.push(rd);var Ub=T(rd,ga);L.u(p,Ub);var Pc=w("X_EXTEND"),xd=B("COLOR","u_color",1,1,!0),Wc=B("COLOR","u_outline_mask",1,1,!0);Pc.Al=!0;L.u(p,Pc);L.n(p,Ub,Pc,xd);var Qc=B("COLOR","u_color",1,.5,!0);Qc.la=O.t;Qc.ka=O.t;var Gc=w("Y_EXTEND");Gc.Al=!0;L.u(p,Gc);L.n(p,Pc,Gc,Qc);Nb=w("X_BLUR");Nb.Al=!0;L.u(p,Nb);L.n(p,Gc,Nb,
Qc);var Dc=B("COLOR","u_color",1,.25,!0);Dc.la=O.t;Dc.ka=O.t;var Ec=B("COLOR","u_outline_mask_blurred",1,.25,!0);Ec.la=O.t;Ec.ka=O.t;ac=w("Y_BLUR");ac.Al=!0;L.u(p,ac);L.n(p,Nb,ac,Dc);var Hc=ea(Yc);L.u(p,Hc);L.n(p,Ca,Hc,B("COLOR","u_outline_src",1,1,!0));L.n(p,Ub,Hc,Wc);L.n(p,ac,Hc,Ec);v.push(Hc)}x=v;v=[]}if(nc&&!$a){for(Y=0;Y<x.length;Y++){var Ca=x[Y],Rc=aa(gc.brightness,gc.contrast,gc.exposure,gc.saturation);L.u(p,Rc);L.n(p,Ca,Rc,B("COLOR","u_color",1,1,!0));v.push(Rc)}x=v;v=[]}if(Kc){for(Y=0;Y<
x.length;Y++)if(Ca=x[Y],Ga.smaa){var Ic=B("COLOR","u_color",1,1,!0);Ic.la=O.t;Ic.ka=O.t;var Sc=Q("SMAA_EDGE_DETECTION");L.u(p,Sc);L.n(p,Ca,Sc,Ic);var Zc=Q("SMAA_BLENDING_WEIGHT_CALCULATION");L.u(p,Zc);L.n(p,Sc,Zc,Ic);var jd=B("COLOR","u_search_tex",1,1,!1),kd=B("COLOR","u_area_tex",1,1,!1);jd.la=O.t;jd.ka=O.t;kd.la=O.t;kd.ka=O.t;Zc.va.push(jd);Zc.va.push(kd);var dd=Q("SMAA_NEIGHBORHOOD_BLENDING");L.u(p,dd);L.n(p,Ca,dd,Ic);var ld=B("COLOR","u_blend",1,1,!0);ld.la=O.t;ld.ka=O.t;L.n(p,Zc,dd,ld);v.push(dd)}else{var ed=
M();L.u(p,ed);var fd=B("COLOR","u_color",1,1,!0);fd.la=O.t;fd.ka=O.t;L.n(p,Ca,ed,fd);if(1<Ga.render_resolution_factor){var md=w("NONE");L.u(p,md);L.n(p,ed,md,fd);v.push(md)}else v.push(ed)}x=v;v=[]}if(a.anaglyph_use&&!$a){var gd=ia();L.u(p,gd);L.n(p,x[0],gd,B("COLOR","u_sampler_left",1,1,!0));L.n(p,x[1],gd,B("COLOR","u_sampler_right",1,1,!0));v.push(gd)}else v.push(x[0]);var yd=L.Vh(p,x[0]);if("MOTION_BLUR"==x[0].type)var nd=!0;else nd=!1,L.Kf(p,yd,function(a,b,c){if(c.from==c.to)return nd=!0});if(nd){var Tc=
ca();L.u(p,Tc);L.n(p,x[0],Tc,B("COLOR","u_color",1,1,!0));x=v;v=[];v.push(Tc)}Mb&&(eb?v.push(eb):v.push(Mb));ob&&v.push(ob);if(!$a&&a.jp.procedural_skydome){var sd=ka(ga,a.jp);L.u(p,sd);v.push(sd)}var Jc=oa();L.u(p,Jc);for(Y=0;Y<v.length;Y++){var $c=v[Y];switch($c.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":L.n(p,$c,Jc,B("COLOR","NONE",1,1,!0));L.n(p,$c,Jc,B("DEPTH","NONE",1,1,!0));break;case "SKY":L.n(p,$c,Jc,B("CUBEMAP","u_sky",kb.xn,1,!1));break;case "ANCHOR_VISIBILITY":L.n(p,$c,Jc,B("COLOR",
"NONE",1,1,!0));break;default:if($a){var td=f[0].k,ad=B("COLOR","OFFSCREEN",1,1,!0);ad.Ga=td;L.n(p,v[Y],Jc,ad);for(Da=1;Da<f.length;Da++){var ud=f[Da].k,Tc=ca();L.u(p,Tc);L.n(p,v[Y],Tc,B("COLOR","u_color",1,1,!0));ad=B("COLOR","OFFSCREEN",1,ud.mi/td.mi,!0);ad.Ga=ud;L.n(p,Tc,Jc,ad)}}else L.n(p,v[Y],Jc,B("SCREEN","NONE",1,1,!0))}}if(qa.enabled){var vd=H(p);vd&&J(p,vd)}c(p,Ob);1<Ga.render_resolution_factor&&r(p);h(p);F(p);if(Qb){for(Y=0;Y<Rb.length;Y++)q(p,Rb[Y]);for(Y=0;Y<Db.length;Y++)q(p,Db[Y]);for(Y=
0;Y<Yb.length;Y++)q(p,Yb[Y])}return p};a.tS=C;a.sd=function(a,b,c){var d=a.Jf;a.fu[0]=b*a.ab[0]*d;a.fu[1]=c*a.ab[1]*d};a.qc=function(a,b){a.Jf=b};a.YQ=function(a){var b=null;L.V(a,function(a,c){return c.j&&null===c.j.pf?(b=c,!0):!1});return b};a.Xa=function(a,b,c){a=X(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};a.kS=na;a.nS=N;a.sI=X;a.MR=ga;a.Ya=function(a,b){var c=null;L.V(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.SG=function(a){var b="digraph scenegraph {\n",
b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=V(a);L.V(a,function(a,d){var e=b+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(f+=" ("+d.Ho.replace(/_/g," ")+")");if(d.j){for(var f=f+"\\n",g=0;g<c.length;g+=2)c[g]==d.j.Cb&&(f+="C"+c[g+1]+" ");for(g=0;g<c.length;g+=2)c[g]==d.j.Gd&&(f+="D"+c[g+1])}d.va.length&&(f+="\\n-----\\n");for(g=0;g<d.va.length;g++)f+=ha(d.va[g],c);g="SINK"==d.type?"dotted":d.vc?
"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});L.We(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+ha(e,c)+'" style="'+(e.mb?"solid":"dotted")+'"];\n'});return b+="}"};a.CG=function(a){a=L.rM(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.vc&&b.push(d)}return b}};b4w.module.__hud=function(a,t){function l(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');if(a.k){var c=0,g=0;x.V(a.k.zb,function(a,f){if("SINK"==f.type)b(" (F)",f.type);else{var h=f.type,l=Math.round(f.j.width)+"x"+Math.round(f.j.height),p=f.p.length,r=f.Uk;"MAIN_CUBE_REFLECT"==f.type&&(p*=6);var q=f.vc&&f.yb;q?b(" (A)",h,f.Hl,l,r,"of",p):b(" (P)",h,f.Hl,l,r,"of",p);f.Uk=0;q&&(c+=p,g+=r)}});return[c,g]}b("No INFO")}function b(){for(var a=
80+20*p[0],b=arguments[0],c=1;c<arguments.length;c++){for(var h="",l=0;l<v[c]-String(arguments[c]).length;l++)h+=" ";b+=h+arguments[c]}p[0]++;g.fillText(b,30,a)}function y(a,b,c){b*=a.Wa;c.x=a.x+b;c.y=a.y;c.Wa=a.Wa-2*b;c.Ka=a.Ka}function h(a){return a.x+a.Wa/2}function r(a){var b=g,c={x:0,y:0,Wa:0,Ka:0},h=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Wa=h;c.Ka=b;y(c,.01,c);h=.02*c.Ka;c.x=c.x;c.y+=h;c.Wa=c.Wa;c.Ka-=2*h;h=c.Wa/8;c.x+=h*a;c.y=c.y;c.Wa=h;c.Ka=c.Ka;y(c,.02,c);return c}var x=t("__graph");
t("__print");var v=[5,19,3,10,4,3,5],g=null,p=[0,0];a.Kc=function(a){a=a.getContext("2d");l(a);return g=a};a.jk=function(){g&&l(g)};a.reset=function(){var a=g;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),p[0]=0,p[1]=0)};a.NL=function(a,h){var l=g;if(l){l.textAlign="left";l.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/h).toFixed(2));p[0]++;for(var r=l=0,x=0;x<a.length;x++){var v=c(a[x]),l=l+v[0],r=r+v[1];p[0]++}b(" -----------------------------------------------");
b("    ","TOTAL ACTIVE","","",r,"of",l)}};a.print=function(){var a=g;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.hT=function(a,b,c,l,p,x,n){var v=g;if(v){b=r(b);var t=b.Ka/5;b.x=b.x;b.y+=4*t;b.Wa=b.Wa;b.Ka=t;v.textAlign="center";v.fillStyle="#00FF00";g.fillText(a,h(b),b.y-10);v.strokeStyle="#00FF00";v.lineWidth=.5;v.beginPath();v.moveTo(b.x,b.y);v.lineTo(b.x+b.Wa,b.y);v.lineTo(b.x+b.Wa,b.y+b.Ka);v.lineTo(b.x,b.y+b.Ka);v.closePath();v.stroke();if(!x&&!n)for(x=
1E6,n=-1E6,a=0;a<c.length;a++)x=Math.min(x,c[a]),n=Math.max(n,c[a]);v.textAlign="right";g.fillText(String(x),b.x-10,b.y+b.Ka);g.fillText(String(n),b.x-10,b.y);v.textAlign="center";g.fillText(String(l),b.x,b.y+b.Ka+15);g.fillText(String(p),b.x+b.Wa,b.y+b.Ka+15);v.strokeStyle="#FF0000";v.lineWidth=1.5;v.beginPath();l=b.Wa/(c.length-1);n=b.Ka/(n-x);for(a=0;a<c.length;a++)p=b.x+l*a,t=b.y+b.Ka-(c[a]-x)*n,0==a?v.moveTo(p,t):v.lineTo(p,t);v.stroke()}};a.KQ=function(a,b,c,l,p,x,n){var v=g;if(v)for(v.textAlign=
"center",v.fillStyle="#00FF00",v.font="bold 12px Courier",c=r(c),g.fillText(b?"["+a+"]":a,h(c),c.y),0<=x&&g.fillText(x?"[M]":"[ ]",h(c)-15,c.y+30),0<=n&&g.fillText(n?"[S]":"[ ]",h(c)+15,c.y+30),a={x:0,y:0,Wa:0,Ka:0},b=0;b<l.length;b++){x=l[b];var t="VOLUME"==x[0];if(t){n=c.y+350;var q=c.Wa,m=a;m.x=c.x;m.y=n;m.Wa=q;m.Ka=250}else{n=c.y+10+50*b;var q=c.Wa,m=c.Ka,w=a;w.x=c.x;w.y=n;w.Wa=q;w.Ka=m}n=v;var q=a,w=b==p,d=x[0],m=x[1],y=x[2],u=x[3],E=(u-y)/x[4],E=1>E?Math.floor(1/E-1E-5).toFixed(0).length:0;
x=x[5]?Math.log(m/y)/Math.log(u/y):(m-y)/(u-y);n.textAlign="center";w?n.fillText("["+d+"]",h(q),q.y):n.fillText(d,h(q),q.y);n.strokeStyle="#00FF00";n.lineWidth=t?3:1;t?(n.textAlign="right",n.fillText(u.toFixed(E),h(q)-10,q.y+15),n.textAlign="right",n.fillText(y.toFixed(E),h(q)-10,q.y+q.Ka-15)):(n.textAlign="right",n.fillText(y.toFixed(E),q.x+28,q.y+15),n.textAlign="left",n.fillText(u.toFixed(E),q.x+q.Wa-28,q.y+15));n.beginPath();if(t){var z=q.y+15+(q.Ka-30)*(1-x);n.moveTo(h(q),q.y+15);n.lineTo(h(q),
q.y+q.Ka-15);n.moveTo(h(q)-5,q.y+15);n.lineTo(h(q)+5,q.y+15);n.moveTo(h(q)-5,q.y+q.Ka-15);n.lineTo(h(q)+5,q.y+q.Ka-15);n.moveTo(h(q)-5,z);n.lineTo(h(q)+5,z)}else{var G=q.x+30+(q.Wa-60)*x;n.moveTo(q.x+30,q.y+15);n.lineTo(q.x+q.Wa-30,q.y+15);n.moveTo(q.x+30,q.y+15-5);n.lineTo(q.x+30,q.y+15+5);n.moveTo(q.x+q.Wa-30,q.y+15-5);n.lineTo(q.x+q.Wa-30,q.y+15+5);n.moveTo(G,q.y+15-5);n.lineTo(G,q.y+15+5)}n.stroke();"EQ_Q"==d?(x=Math.log(1+1/(2*m*m)+Math.sqrt((2+1/(m*m))*(2+1/(m*m))/4-1))/Math.log(2),t?(n.textAlign=
"left",n.fillText(m.toFixed(E),h(q)+10,z),n.textAlign="left",n.fillText("("+x.toFixed(E+1)+")",h(q)+10,z+10)):(n.textAlign="right",n.fillText(m.toFixed(E),G,q.y+30),n.textAlign="left",n.fillText("("+x.toFixed(E+1)+")",G,q.y+30))):t?(n.textAlign="left",n.fillText(m.toFixed(E),h(q)+10,z)):(n.textAlign="center",n.fillText(m.toFixed(E),G,q.y+30))}}};b4w.module.__prerender=function(a,t){function l(a,c){var g=a.he,h=c.j;g.mo=!1;var l;if(!(l=!g||g.jj)){var x=h.cg,v=g.Zb.G;l=g.mg;x=Math.sqrt((v[0]-x[0])*(v[0]-x[0])+(v[1]-x[1])*(v[1]-x[1])+(v[2]-x[2])*(v[2]-x[2]));v=g.Ph*g.Zb.Va;l=!(x>=g.Fl&&x<l+v)}if(l)return!1;g.mo=!0;(l="OUTLINE_MASK"==c.type&&!Boolean(g.bi))||(h=h.ml,g.Ui?l=!1:("STATIC"===g.type?(l=g.Zb,g=l.G,g=r.YL(g,h,l.Va)):(l=g.jh,g=l.G,g=r.kH(g,h,l.ze,l.Ae,l.Be)),l=g));return l?!1:"WIREFRAME"==c.type?a.C.wireframe_mode==b.Lm?a.C.th:!a.C.th:
!0}var c=t("__config"),b=t("__debug"),y=t("__geometry"),h=t("__renderer"),r=t("__util"),x=t("__vec3"),v=c.r,g="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.Xs=function(a){if(-1<g.indexOf(a.type)){for(var b=!1,c=a.p,r=0;r<c.length;r++){var t=c[r];if("MAIN_CUBE_REFLECT"==a.type)for(var J=0;6>J;J++)a.j.ml=a.Vq[J],t.ir[J]=l(t,a),t.ir[J]&&(b=!0);else t.yb=l(t,a),t.yb&&(b=!0)}switch(a.type){case "WIREFRAME":break;
default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||b?a.yb=!0:(a.yb&&h.clear(a),a.yb=!1)}}if("MAIN_BLEND"==a.type&&v.alpha_sort&&a.p){b=a.j.cg;c=x.dist(b,a.NC)>v.alpha_sort_threshold;for(r=0;r<a.p.length;r++)if(J=a.p[r],t=J.he,t.wr||c){var D=J.C;if(D&&D.Ma&&D.Of!=y.bf){D=D.ca;if(!D||!J.yb)continue;(J=D.ao)&&J.type==y.Av&&y.GM(D,t.ea,b)}t.wr=!1}c&&x.copy(b,a.NC)}}};b4w.module.camera=function(a,t){function l(a,b){if(!v.jd(a))return p.error("get_eye(): Wrong object"),null;b||(b=new Float32Array(3));F.copy(a.f.i,b);return b}function c(a,c){b.Kb(a)?(F.copy(c,a.f.mc),f.q(a),g.H(a)):p.error("set_pivot(): Wrong object or camera move style")}var b=t("__camera");t("__config");var y=t("__constraints"),h=t("__container"),r=t("__mat3"),x=t("__mat4"),v=t("__obj_util"),g=t("__physics"),p=t("__print"),f=t("__transform"),A=t("__util"),F=t("__vec3"),H=t("__vec4"),J=new Float32Array(2),
D=new Float32Array(3),n=new Float32Array(3),C=new Float32Array(4),B=new Float32Array(9);a.Rd=b.Rd;a.eP=b.Rd;a.Da=b.Da;a.Wb=b.Wb;a.Ob=b.Ob;a.jd=function(a){p.error("camera.is_camera() deprecated, use objects.is_camera() instead");return v.jd(a)};a.Kb=b.Kb;a.kd=b.kd;a.qb=b.qb;a.uL=function(a,c){if(v.jd(a))if(c!=b.Rd&&c!=b.Wb&&c!=b.Ob&&c!=b.Da)p.error("set_move_style(): Wrong camera move style");else{a.f.Ha=c;a.f.yc=null;a.f.Fc=null;a.f.Tb=null;a.f.ub=!1;b.VI(a);switch(c){case b.Da:var h=l(a,D),d=A.za(a.f.quat,
A.dc,n),h=F.scaleAndAdd(h,d,10,d);F.copy(h,a.f.mc)}f.q(a);g.H(a)}else p.error("set_move_style(): Wrong object")};a.be=function(a){return v.jd(a)?b.be(a):(p.error("get_move_style(): Wrong object"),null)};a.DL=function(a,c){if(b.Kb(a)||b.kd(a)||b.qb(a)){var f=a.f;f.Fu=A.da(c[0],0,Infinity);f.Eu=A.da(c[1],0,Infinity);f.Gu=A.da(c[2],0,1)}else p.error("set_velocity_params(): Wrong object or camera move style")};a.wl=function(a,c){if(!b.Kb(a)&&!b.kd(a)&&!b.qb(a))return p.error("get_velocity_params(): Wrong object or camera move style"),
null;c||(c=new Float32Array(3));var f=a.f;c[0]=f.Fu;c[1]=f.Eu;c[2]=f.Gu;return c};a.TT=function(a,c,h,d){var l=a.f;b.xH(c,h,d,l.i,l.quat);f.q(a);g.H(a)};a.ey=l;a.aU=c;a.jU=function(a,c,h){b.Kb(a)?(F.copy(c,a.f.i),F.copy(h,a.f.mc),f.q(a),g.H(a)):p.error("set_trans_pivot(): Wrong object or camera move style")};a.Lr=function(a,c){if(!b.Kb(a))return p.error("get_pivot(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));F.copy(a.f.mc,c);return c};a.sT=function(b,c,f){p.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");
a.Cf(b,c,f)};a.cK=function(a,c,h){if(b.Kb(a)){var d=a.f;if(d.pC){var l=r.fromMat4(d.ea,B),u=F.subtract(d.i,d.mc,n);D[0]=c;D[1]=0;D[2]=h;F.scale(D,F.len(u),D);F.transformMat3(D,l,D);F.add(d.mc,D,d.mc);F.add(d.i,D,d.i);f.q(a);g.H(a)}}else p.error("move_pivot(): wrong object")};a.rT=function(b,c){p.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");a.ji(b,c,0)};a.BR=function(a){p.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return b.qb(a)?
-b.ae(a,J)[1]:(p.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.LT=function(a,c){p.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(b.qb(a))if(a.f.ub){var h=b.ae(a,J);(h=-c-h[1])&&b.ji(a,0,h);f.q(a);g.H(a)}else p.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else p.error("set_hover_cam_angle(): wrong object or camera move style")};a.pI=function(a,c){if(!b.qb(a))return p.error("get_hover_angle_limits(): wrong object"),
null;a.f.Tb?(c||(c=new Float32Array(2)),c[0]=a.f.Tb.fb,c[1]=a.f.Tb.tb):p.error("get_hover_angle_limits(): camera hasn't angle limits");return c};a.bI=function(a){var c;if(!b.qb(a)&&!b.Kb(a))return p.error("get_cam_dist_limits(): wrong object"),null;a.f.ub?(c||(c=new Float32Array(2)),c[0]=a.f.vh,c[1]=a.f.mf):p.error("get_cam_dist_limits(): camera hasn't distance limits");return c};a.EU=function(b,c){p.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.Xr(b,c)};a.Xr=
function(a,c){if(b.qb(a)){var h=a.f;if(h.ub){var d=F.subtract(c,h.i,D);F.add(d,h.zc,h.zc)}f.Pe(a,c);f.q(a);g.H(a)}else p.error("hover_cam_set_translation(): wrong object")};a.MT=function(a,c){if(b.qb(a)){var h=a.f;if(h.ub&&h.Tb){var d=F.subtract(c,h.zc,D),d=F.add(d,h.i,d);f.Pe(a,d)}F.copy(c,h.zc);f.q(a);g.H(a)}else p.error("set_hover_pivot(): Wrong object or camera move style")};a.qI=function(a,c){if(!b.qb(a))return p.error("get_hover_cam_pivot(): wrong object"),null;c||(c=new Float32Array(3));F.copy(a.f.zc,
c);return c};a.Ur=function(a){return b.Kb(a)||b.qb(a)?a.f.ub:(p.error("has_distance_limits(): wrong object"),null)};a.DP=function(a,c,h,d){switch(b.be(a)){case b.Da:case b.Wb:d|=f.Im;break;case b.Ob:if(c>h){p.error("apply_vertical_limits(): wrong vertical limits");return}break;default:p.error("apply_vertical_limits(): wrong object");return}a.f.Fc={fb:c,tb:h};b.EK(a,d==f.Hm);f.q(a);g.H(a)};a.oQ=function(a){a.f.Fc=null};a.dS=function(a,c){if(!b.Kb(a)&&!b.kd(a)&&!b.qb(a))return p.error("get_vertical_limits(): wrong object"),
null;var f=a.f;c=c||new Float32Array(2);return f.Fc?(c[0]=f.Fc.fb,c[1]=f.Fc.tb,c):null};a.oS=function(a){return b.Kb(a)||b.kd(a)||b.qb(a)?Boolean(a.f.Fc):(p.error("has_vertical_limits(): wrong object"),null)};a.BP=function(a,c,h,d){switch(b.be(a)){case b.Da:case b.Wb:d|=f.Im;break;case b.Ob:if(c>h){p.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:p.error("apply_horizontal_limits(): wrong object");return}a.f.yc={left:c,right:h};b.AK(a,d==f.Hm);f.q(a);g.H(a)};a.lQ=
function(a){a.f.yc=null};a.oI=function(a,c){if(!b.Kb(a)&&!b.kd(a)&&!b.qb(a))return p.error("get_horizontal_limits(): wrong object"),null;var f=a.f;c=c||new Float32Array(2);return f.yc?(c[0]=f.yc.left,c[1]=f.yc.right,c):null};a.NI=function(a){return b.Kb(a)||b.kd(a)||b.qb(a)?Boolean(a.f.yc):(p.error("has_horizontal_limits(): wrong object"),null)};a.CP=function(a,c,h){b.qb(a)?c<h?p.error("apply_hover_angle_limits(): wrong hover angle limits"):(c=A.cf(c,-Math.PI,Math.PI),h=A.cf(h,-Math.PI,Math.PI),c=
A.da(c,-Math.PI/2,0),h=A.da(h,-Math.PI/2,0),a.f.Tb={fb:c,tb:h},b.SI(a),f.q(a),g.H(a)):p.error("apply_hover_angle_limits(): wrong object")};a.mQ=function(a){b.qb(a)?a.f.Tb=null:p.error("clear_hover_angle_limits(): wrong object")};a.yP=function(a,c,h){if(b.Kb(a)||b.qb(a))if(c>h)p.error("apply_distance_limits(): wrong distance limits");else{var d=a.f;d.ub=!0;d.mf=c;d.vh=h;f.q(a);g.H(a)}else p.error("apply_distance_limits(): wrong object")};a.iQ=function(a){b.Kb(a)||b.qb(a)?a.f.ub=!1:p.error("clear_distance_limits(): wrong object")};
a.GT=function(b,c,f){p.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rd(b,c,Math.PI/2-f)};a.BS=function(a){A.za(a.f.quat,A.dc,D);return 0<=D[1]?!0:!1};a.Lj=function(c,h,l,d,n){switch(a.be(c)){case b.Rd:break;case b.Da:b.Cf(c,h,l,d,n);break;case b.Wb:b.rd(c,h,l,d,n);break;case b.Ob:b.ji(c,h,l,d,n);break;default:p.error("rotate_camera(): Wrong object")}f.q(c);g.H(c)};a.Cf=function(a,c,h,d,l){b.Kb(a)?(b.Cf(a,c,h,d,l),f.q(a),g.H(a)):p.error("rotate_target_camera(): wrong object")};
a.rd=function(a,c,h,d,l){b.kd(a)?(b.rd(a,c,h,d,l),f.q(a),g.H(a)):p.error("rotate_eye_camera(): wrong object")};a.ji=function(a,c,h,d,l){b.qb(a)?(b.ji(a,c,h,d,l),f.q(a),g.H(a)):p.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,f){p.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rd(b,c,-f)};a.ae=function(a,c){c||(c=new Float32Array(2));b.ae(a,c);return c};a.Qn=function(a,c){c||(c=new Float32Array(2));b.Qn(a,c);return c};a.Px=function(a,c){p.error("get_angles() deprecated, use get_camera_angles() instead");
c||(c=new Float32Array(2));b.Px(a,c);return c};a.lB=function(a,c){for(var f=a.f.S,d=0;d<f.length;d++){var g=f[d];g.type!=b.Qb&&g.type!=b.Xb||b.BL(g,c,g.Te)}};a.Iy=function(a){a=a.f.S;for(var c=0;c<a.length;c++){var f=a[c];if(f.type==b.Qb||f.type==b.Xb)return f.jm}return 0};a.ES=function(a){p.error("is_underwater() deprecated, always returns false");return a.f.eC};a.FU=function(a,c,f,d){a=a.f.S;for(var g=0;g<a.length;g++){var h=a[g];h.Bc||b.zg(h,h.Ia);var l=D;l[0]=-c;l[1]=-f;l[2]=0;x.translate(h.Fa,
l,h.Fa);x.rotateZ(h.Fa,d,h.Fa);x.multiply(h.Fa,h.Ba,h.qe);b.mw(h);b.vq(h)}};a.lI=function(a){return A.Lo(a.f.S[0].hd)};a.IT=function(a,c){for(var f=a.f.S,d=0;d<f.length;d++){var g=f[d];g.hd=A.ZG(c);g.Bc||b.zg(g,g.Ia);x.multiply(g.Fa,g.Ba,g.qe);b.mw(g);b.vq(g)}};a.rn=function(a,b){b||(b=A.jb);y.rn(a,b)};a.UU=function(a,h){if(b.Kb(a)){f.Tn(h,!1,D);c(a,D);f.q(a);var l=f.Kr(h),d=b.WH(a)/2,l=l/Math.sin(d),d=f.iK(a,D);f.md(a,0,l-d,0);f.q(a);g.H(a)}else p.error("zoom_object(): wrong object")};a.$T=function(c,
f){if(v.jd(c)&&a.lz(c)){var g=c.f;if(b.Kb(c)){var d=F.dist(g.i,g.mc);g.lj=f/2*g.kj/d}else b.qb(c)&&a.Ur(c)?(d=F.distance(g.i,g.zc),g.lj=f/2*g.kj/d):c.f.S[0].top=f/2;b.RM(c)}else p.error("set_ortho_scale(): wrong object")};a.LR=function(b){return v.jd(b)&&a.lz(b)?2*b.f.S[0].top:(p.error("get_ortho_scale(): wrong object"),null)};a.lz=function(a){return v.jd(a)?a.f.S[0].type==b.Bd:(p.error("is_ortho_camera(): wrong object"),null)};a.TP=function(a,c,f,d){d||(d=new Float32Array(3));var g=a.f.S[0];switch(g.type){case b.ec:case b.af:case b.Qb:case b.Xb:var l=
Math.tan(g.hd*Math.PI/360),n=l*g.Ia;c=h.zq(c,f,J,g);C[0]=(2*c[0]/g.width-1)*n;C[1]=-1;C[2]=(2*c[1]/g.height-1)*l;C[3]=0;H.transformMat4(C,a.f.ea,C);d[0]=C[0];d[1]=C[1];d[2]=C[2];F.normalize(d,d);return d;default:return p.error("Non-compatible camera"),d}};a.Zs=function(a,c,f){f||(f=new Float32Array(2));return b.Zs(a,c,f)}};b4w.module.config=function(a,t){var l=t("__config");a.Zg=l.Zg;a.Yg=l.Yg;a.zi=l.zi;a.qv=l.qv;a.set=l.set;a.get=l.get;a.reset=l.reset;a.Hy=l.Hy};b4w.module.constraints=function(a,t){var l=t("__camera"),c=t("__constraints"),b=t("__obj_util"),y=t("__physics"),h=t("__print"),r=t("__transform");a.uP=function(a,b,g,h,f){f=f||1;b instanceof Array&&2==b.length?c.KE(a,b[0],b[1],g,h,f):c.Lv(a,b,g,h,f);r.q(a);y.H(a)};a.sP=function(a,b,g,h){c.JE(a,b,g,h);r.q(a);y.H(a)};a.tP=function(a,b,g,p,f,t,F,H){l.kd(a)?(c.IE(a,b,g,p,f,t,F,H),r.q(a),y.H(a)):h.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.rP=function(a,
b,g,p){if(l.kd(a)){if(!p||0>p)p=.25;c.HE(a,b,g,p);r.q(a);y.H(a)}else h.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.ME=function(a,b){c.NE(a,b);r.q(a);y.H(a)};a.oP=function(a,b,g){c.CE(a,b,g);r.q(a);y.H(a)};a.vP=function(a,b,g,h){c.OE(a,b,g,h);r.q(a);y.H(a)};a.wP=function(a,b){3==b.length?c.QE(a,b):c.PE(a,b);r.q(a);y.H(a)};a.pP=function(a,b,g,h){3==b.length?c.EE(a,b,g,h):c.DE(a,b,g,h);r.q(a);y.H(a)};a.Mv=function(a,b,g){c.Mv(a,b,g);r.q(a);y.H(a)};
a.remove=function(a){a.Na&&c.remove(a)};a.ty=function(a){h.error("constraints.get_parent() deprecated, use objects.get_parent() instead");return b.ty(a)}};b4w.module.container=function(a,t){var l=t("__container"),c=t("__print");a.Fr=l.Fr;a.Je=l.Je;a.eo=function(a,t){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&t&&l.eo(a,t)};a.RA=l.RA;a.gC=l.gC;a.kn=l.kn;a.vr=l.vr};b4w.module.controls=function(a,t){var l=t("__controls"),c=t("__print");a.na=l.na;a.Np=l.Np;a.ue=l.ue;a.te=l.te;a.Mp=l.Mp;a.oO=8;a.ZO=9;a.wO=13;a.WO=16;a.sO=17;a.mO=18;a.SO=19;a.qO=20;a.yO=27;a.YO=32;a.av=37;a.dv=38;a.bv=39;a.$u=40;a.dO=49;a.eO=50;a.fO=51;a.gO=52;a.hO=53;a.iO=54;a.jO=55;a.kO=56;a.lO=57;a.Yu=65;a.nO=66;a.jD=67;a.Zu=68;a.vO=69;a.kD=70;a.AO=71;a.CO=72;a.DO=73;a.EO=74;a.lD=75;a.mD=76;a.FO=77;a.GO=78;a.RO=79;a.oD=80;a.UO=81;a.pD=82;a.cv=83;a.rD=84;a.$O=85;a.aP=86;a.ev=87;a.bP=88;a.cP=89;
a.dP=90;a.HO=96;a.IO=97;a.JO=98;a.KO=99;a.LO=100;a.MO=101;a.NO=102;a.OO=103;a.PO=104;a.QO=105;a.uO=110;a.VO=186;a.xO=187;a.rO=188;a.tO=189;a.TO=190;a.zO=191;a.BO=192;a.nD=219;a.pO=220;a.qD=221;a.XO=222;a.Fm=l.Fm;a.Em=l.Em;a.Dm=l.Dm;a.Oq=l.Oq;a.xb=l.xb;a.Nq=function(a,c,h){return l.Nq(a,c||"ANY",h||!1)};a.Rw=l.Rw;a.Yw=function(a,c,h,r,x,v,g){return l.Yw(a,c,h,r||"ANY",x||!1,v||!1,g||!1)};a.un=l.un;a.Qq=l.Qq;a.Ri=l.Ri;a.Rk=l.Rk;a.wn=l.wn;a.Ww=l.Ww;a.ax=l.ax;a.Tw=l.Tw;a.Uw=l.Uw;a.$w=function(a,c){return l.$w(a,
c||!1)};a.GA=l.GA;a.Pi=l.Pi;a.Zw=l.Zw;a.Sq=function(a,c){return l.Sq(a,c||!1)};a.CT=function(a,c){l.hL(a,c)};a.qR=function(a){return a.value};a.Ic=l.Ic;a.Ke=l.Ke;a.U=function(a,c,h,r,x,v,g){x=x||l.ix;l.U(a,c,h,r,x,v,void 0===g?null:g)};a.Qi=function(a,c,h,r,x){var v;r=l.xb(r);l.U(a,c,h,[r],l.ix,x,void 0===v?null:v)};a.fQ=function(a){return l.Li(a,null)};a.Li=l.Li;a.lT=function(a){c.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");l.Bf(a,null)};a.Bf=l.Bf;a.reset=
l.reset;a.ht=l.ht;a.it=function(a,c,h){l.it(a,c,!!h)};a.kt=l.kt;a.jt=l.jt;a.gt=l.gt;a.ou=l.ou;a.pu=l.pu;a.ru=l.ru;a.qu=l.qu;a.nu=l.nu};b4w.module.data=function(a,t){var l=t("__data");t("__print");t("__util");a.load=l.load;a.yp=function(a){l.yp(a|0)};a.YA=l.YA;a.uf=l.uf;a.KS=l.load;a.Y=a.yp};b4w.module.__data=function(a,t){function l(a,b){jb[b.id]=null;Fa[b.id]=null}function c(a,b,c){var d;a instanceof ArrayBuffer&&(a=na.Py(a));d=a.width;a=a.height;la.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(gb)&&c&&la.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){d=b.s;if(!d)throw"Nothing requested";R.vc([[d,R.Jp,d]],function(d,f,g,h){if(d){la.log("%cLOAD METADATA","color: #616",h);f=Aa.NB(d.b4w_format_version);switch(Aa.xC(f,
va.Th)){case -1:f[0]<va.Th[0]?Aa.fa("JSON version is too old relative to B4W engine: "+Aa.Qg(f)+", required: "+Aa.Qg(va.Th)+". Reexport scene with the latest B4W addon to fix it."):la.warn("JSON version is a bit old relative to B4W engine: "+ +Aa.Qg(f)+", required: "+Aa.Qg(va.Th)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>va.Th[0]?Aa.fa("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
la.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}va.vs=f;for(var k in d)a[k]=d[k];0===b.id&&(xa=a);(d=a.binaries[0].binfile)?b.fw=d:(X.Mt(b,"load_binaries"),X.Mt(b,"prepare_bindata"));a==xa||X.Mt(b,"start_nla");d=a==xa;if(a.b4w_export_errors)for(k=0;k<a.b4w_export_errors.length;k++)f=a.b4w_export_errors[k],(d&&"PRIMARY"==f.type||"ALL"==f.type)&&la.rH(f.text);d=a==xa;if(a.b4w_export_warnings)for(k=0;k<a.b4w_export_warnings.length;k++)f=
a.b4w_export_warnings[k],(d&&"PRIMARY"==f.type||"ALL"==f.type)&&la.sH(f.text);e(b,c)}else X.Ev(b)},null,function(a){f(b,c,a)})}function y(a,b,c,d,e,f){d=P(b.s)+b.fw;if(!d)throw"Binary data is missing";R.vc([[d,R.wm,d]],function(d,f,g,h){d?(la.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,d=x(d),f=Aa.NB(a.b4w_format_version),d[0]!=f[0]&&Aa.fa("BIN version does not match to JSON version: "+Aa.Qg(d)+", required: "+Aa.Qg(va.Th)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&la.warn("BIN version does not match to JSON version: "+
+Aa.Qg(d)+", required: "+Aa.Qg(va.Th)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):X.Ev(b)},null,function(a){f(b,c,a)})}function h(a,b,c,d,e){Ra.TF()&&e(b,c)}function r(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,h=a.meshes;a=a.actions;for(var k=Aa.OF(),m=x(d),m=5<=m[0]&&4<m[1]?12:0,l=["indices"],n=["normal","tangent"],p=["color","group"],q=["position","texcoord","texcoord2"],r=0;r<h.length;r++)for(var u=h[r].submeshes,w=0;w<u.length;w++)for(var t in u[w]){var y=
u[w][t][1];if(-1!=l.indexOf(t)){var z=4*u[w][t][0]+f["int"]+m,B=u[w],A=t,C=d;if(k)var D=new Uint32Array(C,z,y);else for(var D=new Uint32Array(y),C=new DataView(C),E=0;E<y;E++)D[E]=C.getUint32(z+4*E,!0);B[A]=D}else if(-1!=q.indexOf(t))z=4*u[w][t][0]+f["float"]+m,u[w][t]=v(d,z,y,k);else if(-1!=n.indexOf(t)){z=2*u[w][t][0]+f["short"]+m;B=u[w];A=t;C=d;D=new Float32Array(y);C=new DataView(C);for(E=0;E<y;E++)D[E]=C.getInt16(z+2*E,!0)/32767;B[A]=D}else if(-1!=p.indexOf(t)){z=2*u[w][t][0]+f.ushort+m;B=u[w];
A=t;C=d;D=new Float32Array(y);C=new DataView(C);for(E=0;E<y;E++)D[E]=C.getUint16(z+2*E,!0)/65535;B[A]=D}}for(t=0;t<g.length;t++)for(h=g[t].particle_systems,l=0;l<h.length;l++)n=h[l],n.transforms=v(d,4*n.transforms[0]+f["float"]+m,n.transforms[1],k);for(g=0;g<a.length;g++){t=a[g];h=t.fcurves;l=t.frame_range;p=l[0];q=l[1];r=fa.ZH(p,q);l=null;0>r&&(r=0);var w=u=!1,F;for(F in h)u|=-1<F.indexOf("rotation_euler"),w|=-1<F.indexOf("rotation_quaternion");n=[];for(F in h)if(u&&w&&-1<F.indexOf("rotation_euler"))delete h[F];
else{var y=h[F],G;for(G in y)z=y[G],B=v(d,f["float"]+4*z.bin_data_pos[0]+m,z.bin_data_pos[1],k),A=new Float32Array(r),null===l&&(l=new Int8Array(r)),fa.YE(z,B,A,l,p,q),z.bd=A;-1<F.indexOf("rotation_euler")&&(fa.zH(h[F]),n.push(F))}for(p=0;p<n.length;p++)q=n[p],r=q.replace("euler","quaternion"),h[r]=h[q],delete h[q];t.qE=l}e(b,c)}function x(a){var b=new Uint8Array(a,0,4),c=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<b.length;d++)if("B4WB"[d]!=String.fromCharCode(b[d])){c=
5;a=4;break}return[c,a]}function v(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function g(a,b,c,d,e){var f=a.cameras,g=a.groups,h=a.materials,k=a.meshes,m=a.node_groups,l=a.objects,p=a.particles,q=a.scenes,r=a.speakers,u=a.textures,w=a.worlds;m||(la.warn('"node_groups" datablock undefined. reexport main scene.'),m=a.node_groups=[]);for(var x="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),
v={},t=0;t<x.length;t++)for(var y=a[x[t]],B=0;B<y.length;B++){var C=y[B];v[C.uuid]=C}for(var E=0;E<q.length;E++){for(var F=q[E],G=F.objects,I=0;I<G.length;I++)n(G,I,v);F.camera&&n(F,"camera",v);F.world&&n(F,"world",v)}for(E=0;E<g.length;E++)for(var K=g[E].objects,I=0;I<K.length;I++)n(K,I,v);for(E=0;E<l.length;E++){var H=l[E];H.dupli_group&&n(H,"dupli_group",v);H.parent&&n(H,"parent",v);H.dg_parent&&n(H,"dg_parent",v);if(H.animation_data){var J=H.animation_data;J.action&&n(J,"action",v);if(J.nla_tracks)for(I=
0;I<J.nla_tracks.length;I++)for(var M=J.nla_tracks[I],N=0;N<M.strips.length;N++)M.strips[N].action&&n(M.strips[N],"action",v)}switch(H.type){case "MESH":if(!H.data)throw"mesh not found for object "+H.name;n(H,"data",v);for(var L=!1,Q=H.modifiers,I=0;I<Q.length;I++){var P=Q[I];"ARMATURE"==P.type?(L&&la.warn('Object "'+H.name+'" has more than one armature modifiers. Only the first one will be used.'),L=!0,n(P,"object",v)):"CURVE"==P.type&&n(P,"object",v)}var S=H.particle_systems;if(S)for(I=0;I<S.length;I++)n(S[I],
"settings",v);break;case "ARMATURE":n(H,"data",v);for(var T=H.pose.bones,R=H.data.bones,I=0;I<T.length;I++){var X=T[I];X.bone=R[X.bone];var U=X.constraints;if(U)for(N=0;N<U.length;N++){var V=U[N];V.target&&n(V,"target",v)}for(var aa=X.parent_recursive,N=0;N<aa.length;N++)aa[N]=T[aa[N]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":n(H,"data",v)}if(U=H.constraints)for(I=0;I<U.length;I++)V=U[I],V.target&&n(V,"target",v);var ba=H.lod_levels;if(ba)for(I=0;I<ba.length;I++){var ga=ba[I];ga.object&&
n(ga,"object",v)}}for(E=0;E<k.length;E++)for(var na=k[E].materials,I=0;I<na.length;I++)n(na,I,v);for(E=0;E<h.length;E++){for(var ea=h[E],ca=ea.texture_slots,I=0;I<ca.length;I++)n(ca[I],"texture",v);var W=ea.node_tree;W&&D(W,v)}for(E=0;E<m.length;E++)(W=m[E].node_tree)&&D(W,v);for(E=0;E<u.length;E++){var Z=u[E],ka=Z.type;"IMAGE"!=ka&&"ENVIRONMENT_MAP"!=ka||n(Z,"image",v)}for(E=0;E<f.length;E++){var ia=f[E];ia.dof_object&&n(ia,"dof_object",v)}for(E=0;E<r.length;E++){var ma=r[E];ma.sound&&n(ma,"sound",
v);if(ma.animation_data&&(J=ma.animation_data,J.action&&n(J,"action",v),J.nla_tracks))for(I=0;I<J.nla_tracks.length;I++)for(M=J.nla_tracks[I],N=0;N<M.strips.length;N++)M.strips[N].action&&n(M.strips[N],"action",v)}for(E=0;E<p.length;E++){for(var oa=p[E],ca=oa.texture_slots,I=0;I<ca.length;I++)n(ca[I],"texture",v);oa.dupli_group&&n(oa,"dupli_group",v);oa.dupli_object&&n(oa,"dupli_object",v)}for(E=0;E<w.length;E++)if(ca=w[E].texture_slots)for(I=0;I<ca.length;I++)n(ca[I],"texture",v);O.LF(a);for(var ra=
b.id,sa=a.textures,pb=a==xa?a.scenes[0].b4w_anisotropic_filtering:A().b4w_anisotropic_filtering,va=0;va<sa.length;va++)a==xa||"SCENE"!=sa[va].b4w_source_type||(sa[va].b4w_source_id=""),kb.KG(sa[va],pb,a.scenes,ra);for(var Ia={},Fa=a.objects,Ra=0;Ra<Fa.length;Ra++){var Ja=Fa[Ra];if("MESH"===Ja.type&&!Ja.particle_systems.length)for(var Ba=Ja.data,Ma=Ba.name,wa=Ba.submeshes,bb=Ba.materials,Sa=0;Sa<wa.length;Sa++)0!==wa[Sa].base_length||Ia[Ma]||(bb[Sa]&&la.warn('material "'+bb[Sa].name+'" is not assigned to any face (object "'+
Ja.name+'").'),Ia[Ma]=!0)}for(var ib=a.meshes,Ka=0;Ka<ib.length;Ka++){var ub=ib[Ka];ub.materials.length||ub.uv_textures.length&&la.warn('mesh "'+ub.name+'" has a UV map but has no exported material.')}a.materials.push({name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",
specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},
type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]});for(var Ta=a.meshes,jb=Aa.Ub("name","DEFAULT",a.materials),Ab=0;Ab<Ta.length;Ab++){var nb=Ta[Ab];0==nb.materials.length&&nb.materials.push(jb)}for(var Fb=a.actions,ob=b.id,Bb=
0;Bb<Fb.length;Bb++){var qb=Fb[Bb];qb.rE=ob;fa.zE(qb)}for(var Xa=a.scenes,Ca=0;Ca<Xa.length;Ca++){for(var Ua=Xa[Ca],gb=[],Ib=[],wb=Xa[Ca].objects,Pa=0;Pa<wb.length;Pa++){var Jb=wb[Pa];z(wb,Jb,gb,Ib);var fc=Jb.dupli_group;if(fc)for(var Za=fc.objects,Cb=0;Cb<Za.length;Cb++)z(Za,Za[Cb],gb,Ib)}for(Pa=0;Pa<Ib.length;Pa++)for(var Vb=Ib[Pa],ic=[Ua],Sb=0;Sb<ic.length;Sb++){for(var Tb=ic[Sb].objects,jc=0;jc<Tb.length;jc++){var Wb=Tb[jc].dupli_group;if(Wb){var bc=Wb.objects,Zb=bc.indexOf(Vb);-1<Zb&&bc.splice(Zb,
1)}}var Zb=Tb.indexOf(Vb);-1<Zb&&Tb.splice(Zb,1)}for(Pa=0;Pa<gb.length;Pa++)Aa.RE(gb[Pa][0],gb[Pa][1])}var kc=a==xa;!kc&&1<a.scenes.length&&(a.scenes=[qa.Jn(a.scenes)],la.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var vb=A(),La=kc?vb:qa.Jn(a.scenes);Na.oL(vb.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(vb),1),a.scenes.unshift(vb));for(var Qa=0;Qa<a.scenes.length;Qa++){var $b=a.scenes[Qa];$b.k={};$b.Dv=$b==La;$b.sE=kc;pa.enabled&&$b.b4w_enable_physics&&
(kc||!ta.Qo(A())&&$b==qa.Jn(a))&&ta.XI($b);kc?$b.b4w_enable_audio&&Ga.Xv($b):$b.b4w_enable_audio&&!vb.ja&&Ga.Xv(vb)}for(var mc=b.id,tc=A(),sc=a==xa,Nb=0;Nb<a.scenes.length;Nb++){var ac=a.scenes[Nb],Bc=qa.eG(ac);ha.MA(ac)&&O.dF(Bc,ac);for(var lc=0;lc<Bc.length;lc++){var Ub=Bc[lc];ja.MF(Ub,ac,a)&&(Ub.Cd||(Ub.Cd=[]),Ub.Cd.push(sc?ac:tc))}for(var Pc=Bc,uc=0;uc<Pc.length;uc++){var Wc=Pc[uc];if(Wc.Cd)for(var Qc=Wc.particle_systems,Gc=0;Gc<Qc.length;Gc++){var Dc=Qc[Gc].settings;if("HAIR"==Dc.type)if("OBJECT"==
Dc.render_type){var Ec=Dc.dupli_object;Ec.Cd||(Ec.Cd=Wc.Cd.slice())}else if("GROUP"==Dc.render_type)for(var Hc=Dc.dupli_group,Rc=0;Rc<Hc.objects.length;Rc++)Ec=Hc.objects[Rc],Ec.Cd||(Ec.Cd=Wc.Cd.slice())}}}for(var Ic=da(a,mc),Nb=0;Nb<Ic.length;Nb++)if(Ub=Ic[Nb],!sc&&Ub.parent&&-1<Xc.indexOf(Ub.parent.type)&&(Ub.parent=""),"MESH"==Ub.type){var Sc=O.UE(Ub);Sc&&(a.meshes.push(Sc),Ub.data=Sc)}e(b,c)}function p(a,b,c,d,e){d=da(a,b.id);for(var f=b.id,g=0;g<d.length;g++){var h=d[g];if(h.Cd){for(var k=L.Rq(h.name,
h.type,h.origin_name),m=0;m<h.Cd.length;m++)L.Wm(k,h.Cd[m]);k.La=h;h.ad=k;ja.pi(h,k);k.f.Hc=f;k.Bl=h.Cv||!1}}d=ja.On(b.id);for(f=0;f<d.length;f++)g=d[f],ha.pi(g.La,g);if(a==xa)for(f=b.id,g=0;g<a.scenes.length;g++)for(var h=a.scenes[g],k=0,m=ja.Ja(h,"LAMP",f),l=0;l<m.length;l++)L.Qa(m[l],h).El=k++;for(f=0;f<d.length;f++)g=d[f],g.Bl||(ja.PM(g),Wb.q(g));for(a=0;a<d.length;a++)if(f=d[a],"MESH"==f.type&&(g=f.Ym)){var g=g.f,h=f.f.Ki,k=[],n;for(n in h)m=h[n],k.push(4*m.cr,4*m.Tf);g.Iz.push(k);g.ip.push(f.f)}a=
n=-1;f=fa.py();for(g=0;g<d.length;g++)h=d[g],k=h.f,L.Lc(h)&&k.oj&&(h=k.zf,h>n&&(n=h),f>=h&&h>a&&(a=h));for(g=0;g<d.length;g++)h=d[g],k=h.f,L.Lc(h)&&k.oj&&(k.kl=!0,n<f?k.zf=n:k.zf<=f?k.zf=a:(la.warn('too many bones for "'+h.name+'" / '+k.zf+" bones (max "+f+" with blending, "+2*f+" without blending). Blending between frames will be disabled."),k.zf=n,k.kl=!1),k.kl=k.kl&&!bc.Gx);for(n=0;n<d.length;n++)if(a=d[n],f=a.La,L.Lc(a)&&(g=f.lod_levels.length))for(h=a,k=0;k<g;k++)if(m=f.lod_levels[k].object){m=
m.ad;m.f.Ph=a.f.Ph;h.f.mg=f.lod_levels[k].distance;m.f.Fl=f.lod_levels[k].distance;if(f.lod_levels[k+1])m.f.mg=f.lod_levels[k+1].distance;else{m.f.oo=!0;m.f.mg=1E4;break}h.f.oo=!1;h=m}else{h.f.oo=!0;h.f.mg=f.lod_levels[k].distance;break}for(n=0;n<d.length;n++)if(a=d[n],a.Mc)if(f=a.Xc,"CHASSIS"==f.Qc){a.l={};a.l.il=f.il;a.l.Gk=f.Gk;a.l.$t=f.$t;a.l.bu=f.bu;a.l.au=f.au;a.l.Mu=f.Mu;a.l.qt=f.qt;a.l.As=f.As;a.l.Xi=0;a.l.Fk=1;a.l.Zj=0;a.l.speed=0;a.l.ei=[];a.l.Vl=[];a.l.ak=null;h=(g=L.qf(a))?L.Hr(g,d):d;
for(g=0;g<h.length;g++)k=h[g],k.Mc&&(m=k.Xc,ta.cJ(k)&&f.name==m.name?(m=ta.EN(k.Xc.Qc),a.l.ei[m]=k,a.l.Vl[m]=new Float32Array(8)):ta.pz(k)&&f.name==m.name?(a.l.ak=k,a.l.$j=m.$j,a.l.im=m.im,a.l.yl=m.yl,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.MB=k,m=new Float32Array([1,0,0,0]),wb.transformMat4(m,k,m),a.l.LB=m):ta.oz(k)&&f.name==m.name?(a.l.Tt=k,a.l.gm=m.gm,a.l.wj=m.wj,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.JB=k,m=new Float32Array([1,0,0,
0]),wb.transformMat4(m,k,m),a.l.IB=m):ta.qz(k)&&f.name==m.name&&(a.l.cu=k,a.l.Vk=m.Vk,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.WB=k,m=new Float32Array([1,0,0,0]),wb.transformMat4(m,k,m),a.l.VB=m));if(4!=a.l.ei.length)throw"Not enough wheels for chassis "+a.name;}else if("HULL"==f.Qc)for(a.l={},a.l.ei=[],a.l.Vl=[],a.l.il=f.il,a.l.Gk=f.Gk,a.l.zh=f.zh,a.l.wi=f.wi,a.l.xi=f.xi,a.l.Xi=0,a.l.Fk=1,a.l.Zj=0,a.l.speed=0,a.l.ak=null,h=(g=L.qf(a))?L.Hr(g,d):d,g=0;g<h.length;g++)k=
h[g],k.Mc&&(m=k.Xc,ta.aJ(k)&&f.name==m.name?(a.l.ei.push(k),a.l.Vl.push(new Float32Array(8))):ta.pz(k)&&f.name==m.name?(a.l.ak=k,a.l.$j=m.$j,a.l.im=m.im,a.l.yl=m.yl,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.MB=k,m=new Float32Array([1,0,0,0]),wb.transformMat4(m,k,m),a.l.LB=m):ta.oz(k)&&f.name==m.name?(a.l.Tt=k,a.l.gm=m.gm,a.l.wj=m.wj,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.JB=k,m=new Float32Array([1,0,0,0]),wb.transformMat4(m,k,m),a.l.IB=
m):ta.qz(k)&&f.name==m.name&&(a.l.cu=k,a.l.Vk=m.Vk,m=ga.invert(a.f.ea,new Float32Array(16)),k=ga.multiply(m,k.f.ea,m),a.l.WB=k,m=new Float32Array([1,0,0,0]),wb.transformMat4(m,k,m),a.l.VB=m));for(n=0;n<d.length;n++)if(a=d[n],a.Kh&&(f=a.Zi,"MAIN_BODY"==f.Qc))for(a.Id={},a.Id.zh=f.zh,a.Id.wi=f.wi,a.Id.xi=f.xi,a.Id.en=[],g=(g=L.qf(a))?L.Hr(g,d):d,h=0;h<g.length;h++)k=g[h],k.Kh&&(m=k.Zi,ta.eJ(k)&&f.name==m.name&&(a.Id.en.push(k),k.qF=k.Zi.UB));e(b,c)}function f(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=
a.scenes[d];f.ah=f.camera.ad}d=A();for(var f=a==xa,g=0;g<a.scenes.length;g++){var h=f?a.scenes[g]:d,k=ja.Ja(h,"ALL",b.id),m=f?ja.Ja(h,"LAMP",b.id):ja.Ja(h,"LAMP",0),l=ja.Ja(h,"MESH",b.id),n=ja.Ja(h,"EMPTY",b.id);f&&(qa.FE(h,k,m,l,n),h.k.uk.length&&(b.Wr=!0));qa.GE(h,a.textures,b.id);for(var p=0;p<n.length;p++)ja.jC(n[p]);n=[];qa.So(h);ra.RH(h,l,m,n);k=qa.oy(h);if(f){p=h.k.jp;if(p.QK||p.procedural_skydome)p=ra.TH(h,p),n.push(p);qa.JH(k)}for(p=0;p<l.length;p++)ra.Sw(l[p],k,h);for(p=0;p<n.length;p++)ra.Sw(n[p],
k,h),ja.jK(n[p]);k=ja.Ja(h,"ALL",b.id);qa.eF(h,k,m)}for(d=0;d<a.scenes.length;d++)delete a.scenes[d].camera;d=a.materials;if(Vb.ar&&va.oC)for(a=0;a<d.length;a++){h=d[a];m=h.texture_slots;for(f=0;f<m.length;f++)if(l=m[f],n=l.texture,"IMAGE"==n.type||"ENVIRONMENT_MAP"==n.type)g=n.image,g.$c||(-1<g.filepath.indexOf(".dds")?g.$c=!0:(g.$c=!n.b4w_disable_compression&&!l.use_map_normal&&"ENVIRONMENT_MAP"!=n.type&&!n.b4w_shore_dist_map&&"MOVIE"!=g.source,g.$c&&(g.filepath+=".dds")));if(f=h.node_tree)for(h=
f.nodes,f=0;f<h.length;f++)g=h[f],"TEXTURE"==g.type&&(m=g.texture)&&(g=m.image)&&!g.$c&&(g.$c=m.k.Qm&&!m.b4w_disable_compression&&"MOVIE"!=g.source,g.$c&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.$c=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,c)}function A(){return qa.Jn(xa.scenes)}function F(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},m={},l=0;l<d.length;l++){var n=d[l];g[n.uuid]=n;k[n.uuid]=n}for(l=0;l<f.length;l++)n=f[l],h[n.uuid]=n,m[n.uuid]=
n;a=a.scenes;for(l=0;l<a.length;l++)H(a[l].objects,null,m,k);for(var p in k)p in g||d.push(k[p]);for(p in m)p in h||f.push(m[p]);e(b,c)}function H(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=c[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var k=c[g.uuid],m=k.constraints,g=0;g<m.length;g++){var l=Aa.oh(m[g]);l.name+="_CLONE";h.constraints.push(l)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(k.animation_data=Aa.oh(h.animation_data)),k.b4w_use_default_animation=
h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=Aa.rI(a,e[f]),-1<h&&a.splice(h,1);e={};if(b)for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],m=Aa.oh(h),h="origin_name"in h?h.origin_name:h.name,m.name=L.Kx(b.name,h),m.origin_name=h,m.dg_parent={uuid:b.uuid},J(m),c[m.uuid]=m,e[g.uuid]=m.uuid,g.uuid=m.uuid;for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,
m=d[g.uuid],k=Aa.oh(m),k.name=Aa.ik(m.name+"_CLONE"),k.uuid=V.cz("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,H(k.objects,h,c,d));if(b)for(f=0;f<a.length;f++){g=a[f];h=c[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(la.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);m=h.constraints;for(g=0;g<m.length;g++)b=m[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);if(b=h.pose)for(d=b.bones,g=0;g<d.length;g++)if(m=
d[g].constraints)for(k=0;k<m.length;k++)b=m[k],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var n in e)tc[n]=e[n]}function J(a){a.uuid=V.cz("Object"+a.name)}function D(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&
n(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in tc&&(e.lamp.uuid=tc[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&n(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];C(f,"from_node",c);C(f,"to_node",c);B(f,"from_socket",f.from_node.outputs);B(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&n(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&n(e.strips[f],
"action",b)}function n(a,b,c){(c=c[a[b].uuid])||la.error("Dangling link found:",b,a);a[b]=c}function C(a,b,c){c=Aa.Ub("name",a[b].name,c);a[b]=c}function B(a,b,c){c=Aa.Ub("identifier",a[b].identifier,c);a[b]=c}function q(a,b,d,e,f,g){if(!va.do_not_load_resources){for(var h=P(b.s),k=a.images,m={},l=[],n=0;n<k.length;n++){var p=k[n],q=p.uuid;if("FILE"===p.source||"MOVIE"===p.source){var r=w(p,a.textures);if(!r.length)la.warn("image ",p.name," has no users.");else if(!r[0].b4w_shore_dist_map){r=Aa.Gl(h+
p.filepath);if("FILE"===p.source){var u=p.$c?R.wm:R.xm;Vb.Bs&&va.Ap&&(r=R.hm(r),"dds"==r[1]?(r=R.hm(r[0]),r=r[0]+".min50."+r[1]+".dds"):r=r[0]+".min50."+r[1])}else"MOVIE"===p.source&&(va.cm?(r=R.hm(r),r=r[0]+".altconv.seq",u=R.ym):(r=R.hm(r),u=Ga.fr(r[1]),r=u!=r[1]?r[0]+".altconv."+u:r[0]+"."+u,u=R.zm));l.push([q,u,r]);m[q]=p}}}l.length?(e.dz=0,R.vc(l,function(f,h,k,n){if(f){if(k==R.zm||k==R.ym){if(k==R.zm)var p=f.videoWidth,q=f.videoHeight;else p=f.images[0].width,q=f.images[0].height;la.log("%cLOAD VIDEO "+
p+"x"+q,"color: #"+(2048<p||2048<q?"a00":1024<p||1024<q?"aa0":"0a0"),n);-1==n.indexOf(gb)&&la.warn("video",n,"is not from app root.")}else c(f,n,!0);h=m[h];n=w(h,a.textures);for(p=0;p<n.length;p++){var q=n[p],r=q.image.filepath;k==R.ym?(q.k.vt=f.Ie,kb.lm(q.k,f.images,h.$c,r,b.id)):kb.lm(q.k,f,h.$c,r,b.id)}}f=++e.dz/l.length;g(b,d,f)},function(){la.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})):f(b,d)}}function m(a,b,c,d,e){a=qa.wy();for(d=0;d<a.length;d++){var f=a[d];ha.MA(f)&&ha.SM(f,f.b4w_nla_cyclic,
b.id)}e(b,c)}function w(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function d(a,b,c,d,e,f){if(!va.do_not_load_resources){a=P(b.s);for(var g=[],h={},k=ja.On(b.id),m=0;m<k.length;m++){var l=k[m],n=l.La;if(L.pj(l)&&Ga.GB(l)!=Ga.Pu){var p=n.data.sound,n=p.uuid;"BACKGROUND_MUSIC"==Ga.Nr(l)?(n=Aa.Lx(),b.Tr=!0):"NONE"!=Ga.Nr(l)&&va.ez&&(b.as=!0);if(!(n in h)){h[n]=[];p=Aa.Gl(a+p.filepath);switch(Ga.GB(l)){case Ga.Ip:var q=R.Qu;break;case Ga.Ou:q=R.Ru}var p=R.hm(p),r=
Ga.er(p[1]),p=r!=p[1]?p[0]+".altconv."+r:p[0]+"."+r;g.push([n,q,p])}h[n].push(l)}}g.length?R.vc(g,function(a,e,k,m){if(a)for(la.log("%cLOAD SOUND","color: #0aa",m),-1==m.indexOf(gb)&&la.warn("sound",m,"is not from app root."),e=h[e],k=0;k<e.length;k++)Ga.VM(e[k],a);a=++d.TL/g.length;f(b,c,a)},function(){la.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)}):e(b,c)}}function I(a,b,c){a=ja.Ja(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];L.pj(d)&&(Ga.mj(d)||c)&&Ga.Us(d)}}function u(a){for(var b=a.k.uk,
c=0;c<b.length;c++){var d=b[c].k;a.b4w_use_nla&&b[c].b4w_nla_video||!b[c].use_auto_refresh||(kb.HA(d.name,d.Yc),kb.iA(d.name,d.Yc))}}function E(a,b,c,d,e){ha.start();la.log("%cSTART NLA","color: #0a0");e(b,c)}function z(a,b,c,d){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],h=g.object;if(h){var k=Aa.Kk(h);k.name=b.name+"_LOD_"+String(f+1);J(k);k.lod_levels=[];c.push([a,k]);d.push(h);g.object=k}}}function G(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!ta.WF(a.scenes[f])){d=
!1;break}d&&(e(b,c),la.log("%cPHYSICS READY","color: #0a0"))}function e(a,b,c,d,e){d=A();for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f],h=a==xa?ta.Qo(g):ta.Qo(d)||ta.Qo(g);a==xa||(g=d);if(pa.enabled&&h)for(h=0;h<uc.length;h++)for(var k=ja.Ja(g,uc[h],b.id),m=0;m<k.length;m++){var l=k[m];l.f.Hc==b.id&&(ta.Gi(l,g),b.Cz&&ta.L(l)&&ta.hr(l))}}e(b,c)}function K(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var m=h[k];if(m.k.Bb&&(m=m.k.Bb.hp)&&"FILE"===m.source){var l=m.uuid,
n=Aa.Gl(P(b.s)+m.filepath);e.push([l,m.$c?R.wm:R.xm,n]);g[l]=m}}e.length?R.vc(e,function(d,e,f,k){if(d){c(d,k,!0);e=g[e];k=w(e,a.textures);for(f=0;f<k.length;f++){var m=k[f];kb.lm(m.k,d,e.$c,m.image.filepath,b.id)}for(f=0;f<h.length;f++)if(k=h[f],k.k.Bb.hp===e){var l=d,n=document.createElement("canvas"),m=e.size[0],p=e.size[1];n.width=m;n.height=p;n=n.getContext("2d");n.drawImage(l,0,0);l=n.getImageData(0,0,m,p).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;for(var m=m*
p,p=new Float32Array(m),q=0;q<m;q++)p[q]=n[1]*l[4*q+2]+n[2]*l[4*q+3];k.k.It=p}}},function(){f(b,d)}):f(b,d)}function k(a,b,d,e,f){if(va.antialiasing&&va.smaa){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var k=qa.ia(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=R.xm;e.push(["SEARCH_TEXTURE",h,sa.Ac.smaa_search_texture_path]);e.push(["AREA_TEXTURE",h,sa.Ac.smaa_area_texture_path]);for(h=0;h<a.length;h++)if(g=
a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.va;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var m=g.Ga;else if("u_area_tex"==g.to)var l=g.Ga;break}e.length?R.vc(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?m:l,d.source="IMAGE",d.cw=!0,kb.lm(d,a,-1!=f.indexOf(".dds")?1:0,f,b.id),kb.em(d,kb.t,kb.t))},function(){f(b,d)}):f(b,d)}else f(b,d)}else f(b,d)}function M(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];a==xa||(e=A());for(var f=ja.Ja(e,"LAMP",b.id),g=0;g<
f.length;g++){var h=f[g];h.f.Hc==b.id&&d.Wp.push({Aa:e,Sa:h})}f=ja.Ja(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.f.Hc==b.id&&(b.Cz&&L.Lc(h)&&qa.Zn(h),d.Wp.push({Aa:e,Sa:h}))}}function Q(a,b,c,d,e,f){var g=d.Wp;e=d.Wz;if(g.length){a=g[e].Sa;e=g[e].Aa;var h=L.Qa(a,e);qa.Gi(e,a,!1);a.anchor&&ia.append(a);d=++d.Wz/g.length;"LAMP"==a.type&&ja.SL(e);g=h.Yf;null!=a.f.Fd&&g&&qa.iC(g,a.f.i);g=a.Yl;g.length&&e.k.Kj&&(e=h.ug,qa.lC(e,a.f.i,a.f.quat),L.mC(g,e.j.Bc))}else d=1;f(b,c,d)}function aa(a,
b,c,d,e){if(a==xa){a=qa.ej();d=qa.wy();for(var f=0;f<d.length;f++){var g=d[f];qa.DK(g,a);g.b4w_use_logic_editor&&Z.UI(g,b.id)}qa.So(a)}else qa.wu(A());a=ja.On(b.id);ja.QM(a);e(b,c)}function U(a,b,c,d,e){if(a==xa)for(d=0;d<a.scenes.length;d++)u(a.scenes[d]),I(a.scenes[d],b.id);else u(A()),I(A(),b.id);e(b,c)}function ba(a,b,c,d,e){va.kg&&(b.Wr||b.Tr||b.as)?Ma||T(a,e,b,c):e(b,c)}function T(a,b,c,d){var e=mc.parentElement;lc=e.style.zIndex;e.style.zIndex="999";Ma=document.createElement("div");Ma.style.position=
"relative";Ma.style.height="88px";Ma.style.width="88px";var f=Math.round(mc.offsetWidth/2-44);Ma.style.top=Math.round(mc.offsetHeight/2-44).toString()+"px";Ma.style.left=f.toString()+"px";Ma.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Ma.style.backgroundSize="88px";qb=document.createElement("div");qb.style.position="relative";qb.style.height=mc.offsetHeight.toString()+"px";qb.style.width=mc.offsetWidth.toString()+"px";qb.style.background="rgba(0, 0, 0, 0.5)";qb.style.zIndex="999";e.appendChild(qb);qb.appendChild(Ma);Ma.addEventListener("click",function(){c.Wr&&(kb.play(),kb.pause(),kb.reset());if(c.Tr){if(a==xa)for(var e=0;e<a.scenes.length;e++)I(a.scenes[e],c.id,!0);else I(A(),c.id,!0);Ga.pause()}c.as&&Ga.yK();ea();b(c,d)},!1)}
function ea(){if(Ma){var a=mc.parentElement;a.style.zIndex=lc;qb.removeChild(Ma);a.removeChild(qb);Ma=qb=null;lc=0}}function P(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function S(a,b,c){fa.Ra(b)&&fa.remove(b);ja.Mi(b);oa.Li(b)&&oa.Bf(b);ta.L(b)&&ta.MK(b);qa.OK(a,b,c);L.pj(b)&&Ga.VL(b);ia.ZI(b)&&ia.remove(b)}function da(a,b){if(!Fa[b]){for(var c=a.scenes,d=[],e=0;e<c.length;e++)ka(c[e].objects,0,a==xa,d);Fa[b]=[];for(e=0;e<d.length;e++)for(var f=d[e],c=0;c<f.length;c++)for(var g=
f[c],h=0;h<g.length;h++)Fa[b].push(g[h]);d=a.particles;for(e=0;e<d.length;e++){if(f=d[e].dupli_object)f.Cv=!0,Fa[b].push(f);if(c=d[e].dupli_group)for(g=c.objects,c=0;c<g.length;c++)f=g[c],f.Cv=!0,Fa[b].push(f)}}return Fa[b]}function ka(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ca(g);e[h]=e[h]||[];(c||-1==Xc.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&ka(g.objects,b+1,c,d)}}function ca(a){return(a=a.parent||fa.Vx(a))?1+ca(a):0}var ia=t("__anchors"),
fa=t("__animation"),R=t("__assets"),ra=t("__batch");t("__camera");var sa=t("__config"),oa=t("__controls"),na=t("__dds"),N=t("__extensions");t("__lights");var X=t("__loader"),ga=t("__mat4"),V=t("__md5"),ha=t("__nla"),Z=t("__logic_nodes"),W=t("__nodemat"),ja=t("__objects"),L=t("__obj_util"),ta=t("__physics"),la=t("__print"),O=t("__reformer"),pb=t("__renderer"),qa=t("__scenes"),Ga=t("__sfx"),Ra=t("__shaders"),kb=t("__textures"),Na=t("__time"),Wb=t("__transform"),Aa=t("__util"),wb=t("__vec4"),va=sa.r,
Vb=sa.ye,pa=sa.m,bc=sa.gh,ma=sa.A,jb=null,Fa=null,gb="",xa=null,tc={},Ma=null,qb=null,lc=0,Xc=["LAMP","CAMERA"],uc=["MESH","CAMERA","EMPTY"],mc=null;a.uf=function(a){return X.uf(a)};a.update=function(){X.TM(jb)};a.IL=function(a){mc=a};a.OM=function(a,b){if(Ma){qb.style.height=b.toString()+"px";qb.style.width=a.toString()+"px";var c=Math.round(a/2-44);Ma.style.top=Math.round(b/2-44).toString()+"px";Ma.style.left=c.toString()+"px"}};a.load=function(a,c,n,u,w){var x={load_main:{Ua:X.Ze,eb:!1,D:[],gb:!1,
hb:500,Ab:!1,nb:b},duplicate_objects:{Ua:X.Ad,eb:!1,D:["load_main"],gb:!1,hb:50,Ab:!1,nb:F},load_binaries:{Ua:X.Ze,eb:!1,D:["load_main"],gb:!1,hb:500,Ab:!1,nb:y},wait_for_shaders:{Ua:X.Ze,eb:!0,D:[],gb:!1,hb:50,Ab:!0,Vf:h},prepare_bindata:{Ua:X.Ad,eb:!1,D:["duplicate_objects","load_binaries"],gb:!1,hb:0,Ab:!1,nb:r},prepare_bpy_data:{Ua:X.Ad,eb:!1,D:["duplicate_objects","prepare_bindata"],gb:!1,hb:100,Ab:!1,nb:g},process_objects:{Ua:X.Ad,eb:!1,D:["prepare_bpy_data"],gb:!1,hb:100,Ab:!1,nb:p},process_scenes:{Ua:X.Ad,
eb:!1,D:["process_objects","wait_for_shaders"],gb:!1,hb:300,Ab:!1,nb:f},load_smaa_textures:{Ua:X.Ze,eb:!0,D:["process_scenes"],gb:!1,hb:10,Ab:!0,nb:k},load_shoremap:{Ua:X.Ze,eb:!0,D:["process_scenes"],gb:!1,hb:10,Ab:!0,nb:K},load_textures:{Ua:X.Ze,eb:!0,D:["process_scenes"],gb:!0,hb:500,Ab:!1,nb:q,nh:{dz:0}},update_scenes_nla:{Ua:X.Ad,eb:!1,D:["process_scenes","load_textures"],gb:!1,hb:20,Ab:!1,nb:m},wait_physics_workers:{Ua:X.Ze,eb:!0,D:["load_shoremap"],gb:!1,hb:20,Ab:!1,Vf:G},add_physics_objects:{Ua:X.Ad,
eb:!1,D:["wait_physics_workers"],gb:!1,hb:20,Ab:!1,nb:e},add_objects:{Ua:X.Ad,eb:!1,D:["add_physics_objects"],gb:!1,hb:800,Ab:!1,nb:M,Vf:Q,Hk:aa,nh:{Wp:[],Wz:0}},load_speakers:{Ua:X.Ze,eb:!0,D:["add_objects"],gb:!0,hb:30,Ab:!1,nb:d,nh:{TL:0}},mobile_media_start:{Ua:X.Ad,eb:!va.kg,D:["load_textures","update_scenes_nla","load_speakers"],gb:!0,hb:5,Ab:!1,nb:ba,Vf:ba},synchronize_media:{Ua:X.Ad,eb:!0,D:["mobile_media_start"],gb:!0,hb:70,Ab:!1,nb:U},start_nla:{Ua:X.Ad,eb:!0,D:["mobile_media_start"],gb:!1,
hb:5,Ab:!1,nb:E}},v=X.By();v||(v=X.DG(),jb={},Fa={},tc={});jb[v.Ve.length]={};return X.LG(x,a,c,n,l,u||ma.Zv,va.do_not_load_resources,w)};a.yp=function(a){var b=X.By();if(!b||!b.Ve.length||a&&!X.qM(b.Ve[a]))la.error("Unable to unload data!");else{if(0==a)la.log("%cUNLOAD ALL","color: #00a"),ia.Y(),fa.Y(),Ga.Y(),ha.Y(),qa.Y(),X.Y(),ta.Y(),ja.Y(),Aa.Y(),pb.Y(),W.Y(),Ra.Y(),oa.Y(),N.Y(),R.Y(),kb.Y(),Z.Y(),Fa=null,tc={},jb=xa=null;else{la.log("%cUNLOAD DATA "+a,"color: #00a");fa.LK(a);for(var b=qa.dj(),
c=0;c<b.length;c++)for(var d=b[c],e=ja.Ja(d,"ALL",a),f=e.length-1;0<=f;f--){var g=e[f];S(d,g,!0);e.splice(f,1);var h=ja.Ja(d,g.type,a),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}ea()}};a.CK=S;a.YA=function(a){gb=a}};b4w.module.__anchors=function(a,t){function l(a,f){var d=document.createElement("div"),h=d.style;h.position="absolute";h.backgroundColor="black";h.borderRadius="20px 20px 20px 0px";h.boxShadow="0px 0px 10px rgb(180, 180, 200)";h.opacity=1;h.padding="8px 12px";h.lineHeight="15px";h.visibility="hidden";h.fontSize="12px";var l=g.Je();l.appendChild(d);var n=p.tl(a),q=document.createElement("span"),r=q.style;q.innerHTML=n.title||a.name;r.fontWeight="bold";r.fontSize="12px";r.lineHeight="15px";r.color=
"#fff";r.fontFamily="Arial";y(q);d.appendChild(q);var e=n.description;if(e){var n=document.createElement("div"),x=n.style;x.position="absolute";x.bottom="0px";x.left="0px";x.backgroundColor="#000";x.borderRadius="20px 20px 20px 0px";x.boxShadow="0px 0px 10px rgb(180, 180, 200)";x.visibility="hidden";x.padding="8px 12px";x.overflow="hidden";x.lineHeight="15px";x.fontSize="12px";x.zIndex="2";d.appendChild(n);var k=document.createElement("span"),v=k.style;k.innerHTML=e;v.fontSize="12px";v.fontFamily=
"Arial";v.fontWeight="bold";v.lineHeight="15px";v.color="#fff";v.visibility="hidden";n.appendChild(k);var t=!1,B=!1;l.addEventListener("click",function(a){if(!(t||B||J))if(a.target!=q&&a.target!=d||"hidden"!=x.visibility||1!=h.opacity)"visible"==x.visibility&&(h.visibility="visible",r.visibility="visible",x.visibility="hidden",v.visibility="hidden");else{h.visibility="hidden";r.visibility="hidden";x.visibility="visible";t=B=!0;a=d.offsetWidth-24;var g=d.offsetHeight-16,k=Math.min(f,c(e)),m=b(e,k);
m==g&&(x.height=m+"px");k!=a?H.fh(a,k,200,function(a){a==k&&("visible"==x.visibility&&(v.visibility="visible"),t=!1);x.width=a+"px"}):t=!1;m!=g?H.fh(g,m,200,function(a){a==m&&("visible"==x.visibility&&(v.visibility="visible"),B=!1);x.height=a+"px"}):B=!1;B||t||(v.visibility="visible")}},!1)}return d}function c(a){var b=document.createElement("div"),c=document.createElement("span"),f=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily="Arial";c.style.fontWeight="bold";c.style.color="#fff";
c.style.visibility="hidden";f.lineHeight="15px";b.appendChild(c);f.position="absolute";f.visibility="hidden";f.fontSize="12px";f.display="inline-block";f.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function b(a,b){var c=document.createElement("div"),f=document.createElement("span"),g=c.style;f.innerHTML=a;f.style.fontSize="12px";f.style.fontFamily="Arial";f.style.fontWeight="bold";f.style.color="#fff";f.style.visibility="hidden";g.lineHeight=
"15px";c.appendChild(f);g.position="absolute";g.visibility="hidden";g.fontSize="12px";g.display="inline-block";g.width=b+"px";g.lineHeight="15px";document.body.appendChild(c);f=c.offsetHeight;document.body.removeChild(c);return f}function y(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";a.style.cursor="default"}function h(){for(var a=
0,b=0;b<D.length;b++)D[b].Ti&&a++;n=new Float32Array(3*a)}function r(a,b){return b.depth-a.depth}var x=t("__batch"),v=t("__camera"),g=t("__container"),p=t("__objects"),f=t("__print"),A=t("__renderer"),F=t("__scenes"),H=t("__time");t("__util");t("__config");var J=!1,D=[],n=new Float32Array(0),C=new Uint8Array(16),B=new Float32Array(2),q=new Float32Array(3);a.append=function(a){var b;a:{for(b=0;b<D.length;b++)if(D[b].Sa==a){b=!0;break a}b=!1}if(!b){b=a.anchor.Ti&&Boolean(F.ia(F.ej(),"ANCHOR_VISIBILITY"));
b={type:a.anchor.type,Sa:a,x:0,y:0,depth:0,Ei:"out",Ti:b,element:null,yj:null,yE:a.anchor.YJ,Kv:0,Fn:a.anchor.Fn};switch(b.type){case "ANNOTATION":b.element=l(a,b.yE);b.Kv=b.element.offsetHeight;break;case "ELEMENT":b.element=document.getElementById(a.anchor.Fn),b.element||(f.warn("Anchor HTML element was not found, making it generic"),b.type="GENERIC")}D.push(b);h()}};a.remove=function(a){for(var b=0;b<D.length;b++){var c=D[b];if(c.Sa==a){"ANNOTATION"==c.type&&(a=c,g.Je().removeChild(a.element));
D.splice(b,1);h();break}}};a.update=function(){for(var a=0,b=D.length;b--;){var c=D[b];c.Ti&&(n.set(c.Sa.f.i,3*a),a++);var f,g=c,h=q;f=F.ql(F.ej());f=h=v.Zs(f,g.Sa.f.i,h);g=f[0];h=f[1];f=f[2];if(g!=c.x||h!=c.y||f!=c.depth){switch(c.type){case "ANNOTATION":var l=c.element;l.style.left=Math.floor(g)+"px";l.style.top=Math.floor(h-c.Kv)+"px";break;case "ELEMENT":var l=c.element,p=l.getBoundingClientRect();l.style.cssText+="left:"+Math.floor(g-p.width/2)+"px;top:"+Math.floor(h-p.height/2)+"px;"}c.x=g;
c.y=h;c.depth=f;c.yj&&c.yj(g,h,c.Ei,c.Sa,l)}}D.sort(r);for(b=0;b<D.length;b++)c=D[b],"GENERIC"!=c.type&&(c.element.style.zIndex=b);0<a&&(a=F.ia(F.ej(),"ANCHOR_VISIBILITY").p[0].C,x.yM(a,n))};a.XM=function(){for(var a=g.Je(),b=D.length;b--;){var c=D[b],f=c.Sa,h=c.x,l=c.y,n=c.depth,n=0>h||0>l||0>n||1<n||F.gs(f)||h>=a.clientWidth||l>=a.clientHeight?"out":"visible";if(c.Ti&&"out"!=n){var n=c,p=F.ia(F.ej(),"ANCHOR_VISIBILITY").j,e=g.zq(n.x,n.y,B,p);A.AA(p.pf,e[0],p.height-e[1],2,2,C);n=1020==C[0]+C[4]+
C[8]+C[12]?"visible":"out"==n.Ei||0==C[0]+C[4]+C[8]+C[12]?"covered":n.Ei}if(n!=c.Ei){switch(c.type){case "ANNOTATION":case "ELEMENT":var q=c.element;if(!q)break;"out"==n?(q.style.visibility="hidden",q.children.length&&(q.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<q.children.length&&(p=q.children[1],p.style.visibility="hidden",p.children.length&&(p.children[0].style.visibility="hidden"))):"visible"==n?(q.style.visibility="visible",q.children.length&&(q.children[0].style.visibility=
"visible"),q.style.opacity=1):(q.style.visibility="visible",q.style.opacity=.1,q.children.length&&(q.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<q.children.length&&(p=q.children[1],p.style.visibility="hidden",p.children.length&&(p.children[0].style.visibility="hidden")))}c.Ei=n;c.yj&&c.yj(h,l,c.Ei,f,q)}}};a.NP=function(a,b){for(var c=0;c<D.length;c++)D[c].Sa==a&&(D[c].yj=b)};a.EQ=function(a){for(var b=0;b<D.length;b++)D[b].Sa==a&&(D[b].yj=null)};a.Y=function(){for(var a=0;a<D.length;a++){var b=
D[a];"ANNOTATION"==b.type&&g.Je().removeChild(b.element)}D.length=0};a.ZI=function(a){for(var b=0;b<D.length;b++)if(D[b].Sa==a)return!0;return!1};a.sR=function(a){for(var b=0;b<D.length;b++)if(D[b].Sa==a)return D[b].Fn;return!1};a.pause=function(){J=!0};a.ke=function(){J=!1}};b4w.module.__md5=function(a){function t(a,h){var v=a[0],g=a[1],p=a[2],f=a[3],v=c(v,g,p,f,h[0],7,-680876936),f=c(f,v,g,p,h[1],12,-389564586),p=c(p,f,v,g,h[2],17,606105819),g=c(g,p,f,v,h[3],22,-1044525330),v=c(v,g,p,f,h[4],7,-176418897),f=c(f,v,g,p,h[5],12,1200080426),p=c(p,f,v,g,h[6],17,-1473231341),g=c(g,p,f,v,h[7],22,-45705983),v=c(v,g,p,f,h[8],7,1770035416),f=c(f,v,g,p,h[9],12,-1958414417),p=c(p,f,v,g,h[10],17,-42063),g=c(g,p,f,v,h[11],22,-1990404162),v=c(v,g,p,f,h[12],7,1804603682),f=c(f,v,g,p,
h[13],12,-40341101),p=c(p,f,v,g,h[14],17,-1502002290),g=c(g,p,f,v,h[15],22,1236535329),v=b(v,g,p,f,h[1],5,-165796510),f=b(f,v,g,p,h[6],9,-1069501632),p=b(p,f,v,g,h[11],14,643717713),g=b(g,p,f,v,h[0],20,-373897302),v=b(v,g,p,f,h[5],5,-701558691),f=b(f,v,g,p,h[10],9,38016083),p=b(p,f,v,g,h[15],14,-660478335),g=b(g,p,f,v,h[4],20,-405537848),v=b(v,g,p,f,h[9],5,568446438),f=b(f,v,g,p,h[14],9,-1019803690),p=b(p,f,v,g,h[3],14,-187363961),g=b(g,p,f,v,h[8],20,1163531501),v=b(v,g,p,f,h[13],5,-1444681467),f=
b(f,v,g,p,h[2],9,-51403784),p=b(p,f,v,g,h[7],14,1735328473),g=b(g,p,f,v,h[12],20,-1926607734),v=l(g^p^f,v,g,h[5],4,-378558),f=l(v^g^p,f,v,h[8],11,-2022574463),p=l(f^v^g,p,f,h[11],16,1839030562),g=l(p^f^v,g,p,h[14],23,-35309556),v=l(g^p^f,v,g,h[1],4,-1530992060),f=l(v^g^p,f,v,h[4],11,1272893353),p=l(f^v^g,p,f,h[7],16,-155497632),g=l(p^f^v,g,p,h[10],23,-1094730640),v=l(g^p^f,v,g,h[13],4,681279174),f=l(v^g^p,f,v,h[0],11,-358537222),p=l(f^v^g,p,f,h[3],16,-722521979),g=l(p^f^v,g,p,h[6],23,76029189),v=
l(g^p^f,v,g,h[9],4,-640364487),f=l(v^g^p,f,v,h[12],11,-421815835),p=l(f^v^g,p,f,h[15],16,530742520),g=l(p^f^v,g,p,h[2],23,-995338651),v=y(v,g,p,f,h[0],6,-198630844),f=y(f,v,g,p,h[7],10,1126891415),p=y(p,f,v,g,h[14],15,-1416354905),g=y(g,p,f,v,h[5],21,-57434055),v=y(v,g,p,f,h[12],6,1700485571),f=y(f,v,g,p,h[3],10,-1894986606),p=y(p,f,v,g,h[10],15,-1051523),g=y(g,p,f,v,h[1],21,-2054922799),v=y(v,g,p,f,h[8],6,1873313359),f=y(f,v,g,p,h[15],10,-30611744),p=y(p,f,v,g,h[6],15,-1560198380),g=y(g,p,f,v,h[13],
21,1309151649),v=y(v,g,p,f,h[4],6,-145523070),f=y(f,v,g,p,h[11],10,-1120210379),p=y(p,f,v,g,h[2],15,718787259),g=y(g,p,f,v,h[9],21,-343485551);a[0]=v+a[0]&4294967295;a[1]=g+a[1]&4294967295;a[2]=p+a[2]&4294967295;a[3]=f+a[3]&4294967295}function l(a,b,c,h,l,f){b=(b+a&4294967295)+(h+f&4294967295)&4294967295;return(b<<l|b>>>32-l)+c&4294967295}function c(a,b,c,h,p,f,t){return l(b&c|~b&h,a,b,p,f,t)}function b(a,b,c,h,p,f,t){return l(b&h|c&~h,a,b,p,f,t)}function y(a,b,c,h,p,f,t){return l(c^(b|~h),a,b,p,
f,t)}var h="0123456789abcdef".split("");a.cz=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var g;for(g=64;g<=b.length;g+=64){for(var l=b.substring(g-64,g),f=[],y=void 0,y=0;64>y;y+=4)f[y>>2]=l.charCodeAt(y)+(l.charCodeAt(y+1)<<8)+(l.charCodeAt(y+2)<<16)+(l.charCodeAt(y+3)<<24);t(a,f)}b=b.substring(g-64);l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(g=0;g<b.length;g++)l[g>>2]|=b.charCodeAt(g)<<(g%4<<3);l[g>>2]|=128<<(g%4<<3);if(55<g)for(t(a,l),g=0;16>g;g++)l[g]=0;l[14]=8*
c;t(a,l);for(b=0;b<a.length;b++){c=a[b];g="";for(l=0;4>l;l++)g+=h[c>>8*l+4&15]+h[c>>8*l&15];a[b]=g}return a.join("")}};b4w.module.__logic_nodes=function(a,t){function l(){return function(a,b,c,f){c=f[0];var h=f[1];f=f[2];for(var g=0;g<c.OA;g++)if(v.Ic(a,b,g)&&g==c.NA){if(h.Bj&&h.Cj==c.oM)c.state=-1;else if(!f.Lg.mq||c.Vd.no_wait)c.state=1;return}c.state=0}}function c(a,b,c){switch(b.state){case 1:r.error("Unknown node type: "+a.type);break;case 2:c.Oa=a.sb}}function b(a){return y.ce(y.Pf,a.fH,0)}var y=t("__objects"),h=t("__scenes"),r=t("__print"),x=t("__nla");t("__config");var v=t("__controls"),g=t("__util"),p=t("__animation"),
f=t("__assets"),A=t("__batch"),F=t("__geometry"),H=t("__time"),J=[],D={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.Oa=a.sb}},HIDE:function(a,c,f){switch(c.state){case 1:a.Sa=b(a);break;case 2:h.Zn(a.Sa),f.Oa=a.sb}},SHOW:function(a,c,f){switch(c.state){case 1:a.Sa=b(a);break;case 2:h.Jt(a.Sa),f.Oa=a.sb}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:a:{b=location.href.toString();if(-1!=b.indexOf("?")){b=b.split("?")[1].split("&");for(var f=0;f<b.length;f++){var h=b[f].split("=");if(1<h.length&&
h[0]==a.oK){b=Number(h[1]);break a}}}b=0}c.bc[a.ok]=b;c.Oa=a.sb}},SELECT:function(a,c,f){switch(c.state){case 1:f=c.Qh[f.pM];var h=b(a),g=y.yI(),p=g.indexOf(h);if(-1==p)r.error("logic script error: non-selectable object:",a.dupli_name_list[a.dupli_name_list.length-1]);else{a.state=-1;a.OA=g.length;a.NA=p;for(var p=[],d=0;d<g.length;d++)p.push(v.Sq(g[d],!0));v.U(h,"LOGIC_NODES_SELECT_"+a.label,v.ue,p,v.WG,l(),[a,c,f])}break;case 2:if(-1<a.state){f.Oa=a.state?a.DB:a.sb;a.state=-1;break}a.Vd.not_wait&&
(f.Oa=a.sb)}},PLAY:function(a,b,c,f,h,g){switch(b.state){case 1:b.Mz=!1;break;case 2:if(b.Bj&&!a.xl){if(b.Wq==b.Cj)break;b.Bj=!1;for(h=0;h<b.Qh.length;h++){var d=b.Qh[h];d==b.Cj&&(d.Lg.Oa=d.K[d.Lg.Oa].sb)}h=b.Cj.K;for(d=0;d<h.length;d++)h[d].xl=!1}f=x.uF(b.Aa.X,f,!1,g);a.xl?f>=a.aa&&(a.xl=!1,b.Bj=!1,b.Cj=null,c.Oa=a.sb):(x.cB(b.Aa,x.ly(b.Aa)+(a.J-f)),a.xl=!0,b.Cj=b.Wq,b.Bj=!0)}},REDIRECT:function(a,b){switch(b.state){case 2:window.location.href=a.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:b=
-1==a.Cp?a.Ks:c.bc[a.Cp];var f=-1==a.Dp?a.Uz:c.bc[a.Dp];switch(a.lK){case "ADD":c.bc[a.ok]=b+f;break;case "MUL":c.bc[a.ok]=b*f;break;case "SUB":c.bc[a.ok]=b-f;break;case "DIV":0==f&&g.fa("Division by zero in Logic script"),c.bc[a.ok]=b/f}c.Oa=a.sb}},CONDJUMP:function(a,b,c){switch(b.state){case 2:b=-1==a.Cp?a.Ks:c.bc[a.Cp];var f=-1==a.Dp?a.Uz:c.bc[a.Dp],h=!1;switch(a.gG){case "EQUAL":b==f&&(h=!0);break;case "NOTEQUAL":b!=f&&(h=!0);break;case "LESS":b<f&&(h=!0);break;case "GREATER":b>f&&(h=!0);break;
case "LEQUAL":b<=f&&(h=!0);break;case "GEQUAL":b>=f&&(h=!0)}c.Oa=h?a.DB:a.sb}},REGSTORE:function(a,b,c){switch(b.state){case 2:c.bc[a.ok]=a.Ks,c.Oa=a.sb}},PLAY_ANIM:function(a,c,f){var h=p.Gm;""==!a.Td&&(h=p.kb);switch(c.state){case 1:a.Sa=b(a);break;case 2:switch(p.Lh(a.Sa,h)||0!=a.state||(a.state=1),a.state){case -1:""==a.Td?p.Xm(a.Sa):p.apply(a.Sa,a.Td,h);a.Vd.not_wait||(f.mq=!0);p.dm(a.Sa,p.vm,h);p.At(a.Sa,h);p.play(a.Sa,null,h);a.state=0;break;case 0:a.Vd.not_wait&&(f.Oa=a.sb,a.state=-1);break;
case 1:a.Vd.not_wait||(f.mq=!1);f.Oa=a.sb;a.state=-1;break;default:a.state=-1}}},SELECT_PLAY:function(a,b,c){switch(b.state){case 2:c.Oa=a.sb}},SEND_REQ:function(a,b,c){function h(a,b,c,f,g){for(var l in a)for(var n in g[0].fA)l==g[0].fA[n]&&(g[1][l]=a[l]);g[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;f.vc([[a.url,f.Jp,a.url,[a,c.bc]]],h,null,null);break;case 1:a.state=-1,c.Oa=a.sb}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.lc["id"+b]=y.ce(y.Pf,
a.Jl["id"+b],0);break;case 2:A.TI(a.lc.id0,a.ys.id0,a.lc.id1,a.ys.id1),c.Oa=a.sb}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Jl.id0&&(a.lc.id0=y.ce(y.Pf,a.Jl.id0,0),a.Js.id0.unshift(a.ys.id0));break;case 2:"ShaderNodeRGB"==a.tB&&y.vL(a.lc.id0,a.Js.id0,a.Vd.id0?c.bc[a.pk.id0]:a.Ah.id0,a.Vd.id1?c.bc[a.pk.id1]:a.Ah.id1,a.Vd.id2?c.bc[a.pk.id2]:a.Ah.id2),"ShaderNodeValue"==a.tB&&y.wL(a.lc.id0,a.Js.id0,a.Vd.id0?c.bc[a.pk.id0]:a.Ah.id0),c.Oa=a.sb}},DELAY:function(a,b,c,f,h){switch(b.state){case 2:-1==
a.state?(a.state=0,a.qp=0):0==a.state&&(a.qp+=h,a.Ah.dl<a.qp&&(a.state=-1,c.Oa=a.sb))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.lc.id0=y.ce(y.Pf,a.Jl.id0,0);c=a.Gq.sk;F.UF(b)?F.OI(b,c)||(r.error("Wrong key name:",c),a.ge=!0):(r.error("No shape keys in object:",b.name),a.ge=!0);break;case 2:F.XE(a.lc.id0,a.Gq.sk,a.Vd.skv?c.bc[a.pk.skv]:a.Ah.skv),c.Oa=a.sb}},OUTLINE:function(a,b,c){switch(b.state){case 1:b=a.lc.id0=y.ce(y.Pf,a.Jl.id0,0);b&&b.f&&b.f.Db||(r.error("Can't evaluate 'Outline' logic node: wrong object"),
a.ge=!0);break;case 2:b=a.lc.id0;switch(a.Gq.outline_operation){case "PLAY":var f=b.f.Ej;y.ih(b,f.Fj,f.Gj,f.Hj);break;case "STOP":y.Mi(b);break;case "INTENSITY":b.f.bi=a.Vd["in"]?c.bc[a.pk["in"]]:a.Ah["in"]}c.Oa=a.sb}}};a.UI=function(a,b){var f={Hc:b,eL:a.name,state:0,Bj:!1,Mz:!0,Cj:null,Aa:a,Wq:null,Qh:[]};a.lP=f;var h=a.b4w_logic_nodes,g=f.Qh;f.state=1;for(var l=0;l<h.length;l++){var d={K:[],Lg:{Aa:a,Oa:0,mq:!1,pM:l,bc:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};g.push(d);for(var p=g[g.length-1],
r=h[l],v=0;v<r.length;v++){var t=r[v],t={type:t.type,label:t.label,sb:t.slot_idx_order,DB:t.slot_idx_jump,J:t.frame_range[0],aa:t.frame_range[1],xl:!1,state:-1,OA:-1,NA:-1,gG:t.condition,Cp:t.variable1,Dp:t.variable2,Ks:t.number1,Uz:t.number2,ok:t.variabled,url:t.url,oK:t.param_name,lK:t.operation,ge:t.mute,fH:t.object,Sa:null,lc:{},Td:t.anim_name,fA:t.parse_resp_list,Jl:t.objects_paths,Js:t.nodes_paths,Ah:t.floats,Vd:t.bools,pk:t.variables,ys:t.materials_names,tB:t.shader_nd_type,Gq:t.common_usage_names,
oM:p,oA:D[t.type]?D[t.type]:c,Jo:!1,qp:0};p.K.push(t)}for(r=0;r<p.K.length;r++)t=p.K[r],t.oA(t,f,d.Lg,0,0)}f.state=2;J.push(f)};a.update=function(a,b){var c=x.BI();if(!(0>=c))for(var f=0;f<J.length;f++){for(var h=f,g=a,d=b,l=c,p=J[h],r=0;r<J[h].Qh.length;r++){p.Wq=J[h].Qh[r];var v=J[h].Qh[r],t=p,e=g,y=d,k=l,A=v.K;if(A.length){for(var D=0;D<A.length;D++)A[D].Jo=!1;for(D=0;D<A.length;D++){if(0<=v.Lg.Oa)var F=A[v.Lg.Oa];else break;if(F.Jo)break;if(F.ge)if("ENTRYPOINT"==F.type)break;else v.Lg.Oa=F.sb,
F.Jo=!0;else F.oA(F,t,v.Lg,e,y,k),F.Jo=!0}}}p.Bj||p.Mz||x.cB(p.Aa,x.ly(p.Aa)-H.Sb()*d)}};a.Y=function(){J=[]}};b4w.module.debug=function(a,t){function l(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var f=a[c];if(-1!=f.search(new RegExp(/^[A-Z.]+ /))){var d=f.split(" ")[0];d in b||(b[d]=0);b[d]++}}c=a=0;for(d in b)switch(d){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[d];break;default:a+=b[d]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);
if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.xr.ALU_OPS-a.xr.ALU_OPS});for(var b=0;b<a.length;b++){var c=a[b],h=c.xr,d=c.zN,g=y(c.OG),g=g?"\t\t("+g.join(", ")+")":"\t\t(NA)";f.groupCollapsed("FRAG --\x3e","ALU",h.ALU_OPS,"TEX",h.TEX_OPS,"\t\tVERT --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,g);f.groupCollapsed("directives");for(var g=c.ib.Zf,l=0;l<g.length;l++){var n=g[l];f.log(n[0],n[1])}f.groupEnd();f.groupCollapsed("vert src");
f.log(c.yN);f.groupEnd();f.groupCollapsed("vert stats");for(var p in d)"ALU_OPS"!=p&&"TEX_OPS"!=p&&f.log(p,d[p]);f.groupEnd();f.groupCollapsed("frag src");f.log(c.IH);f.groupEnd();f.groupCollapsed("frag stats");for(p in h)"ALU_OPS"!=p&&"TEX_OPS"!=p&&f.log(p,h[p]);f.groupEnd();f.groupEnd()}}function y(a){for(var b=A.dj(),c=0;c<b.length;c++)for(var f=b[c],d=v.Ja(f,"MESH",v.uc),h=0;h<d.length;h++){var l=g.Qa(d[h],f);if(l&&l.W.length)for(var l=l.W,n=0;n<l.length;n++){var p=l[n];if(p.Ec==a&&p.xf.length)return p.xf}}return null}
t("__batch");t("__config");var h=t("__controls"),r=t("__debug"),x=t("__extensions"),v=t("__objects"),g=t("__obj_util"),p=t("__physics"),f=t("__print"),A=t("__scenes"),F=t("__scenegraph"),H=t("__sfx"),J=t("__shaders"),D=t("__textures"),n=t("__util"),C=t("vec3");a.Mm=r.Mm;a.Up=r.Up;a.Nm=r.Nm;a.Tp=r.Tp;a.Lm=r.Lm;a.fT=function(){p.UG()};a.eT=function(a){f.log("O",p.AH(a));for(var b=p.VH().lb.p,c=0;c<b.length;c++){var h=b[c];h.m.v==a&&f.log("B",h)}};a.RU=function(){for(var a=A.o(),b=v.Ja(a,"MESH",v.uc),
a=[A.ia(a,"MAIN_OPAQUE"),A.ia(a,"MAIN_BLEND")],c=0;c<a.length;c++){var h=a[c],d=h.p;if(d.length){f.group(h.type,"DYNAMIC");for(var g=0;g<b.length;g++){var l=b[g],n=l.f;if("DYNAMIC"==n.type)for(var p=0;p<d.length;p++){var r=d[p];if(r.yb&&r.he==n){f.ws(l.name,l);break}}}f.groupEnd();f.groupCollapsed(h.type,"STATIC");for(g=0;g<b.length;g++)if(l=b[g],n=l.f,"DYNAMIC"!=n.type)for(p=0;p<d.length;p++)if(r=d[p],r.yb&&r.he==n){f.ws(l.name,l);break}f.groupEnd()}}};a.ZS=function(a){for(var b=A.o(),c=v.Ja(b,"MESH",
v.uc),h=0;h<c.length;h++){var d=c[h];if(d.name==a){f.log("Object",d);for(var g=A.Br(b),l=0;l<g.length;l++){for(var n=g[l],p=n.p,r=[],e=0;e<p.length;e++)p[e].he==d.f&&r.push(p[e]);f.log("Subscene "+n.type,r)}}}};a.$S=function(){var a=A.o();console.log("Armatures: "+v.Ja(a,"ARMATURE",v.uc).length);console.log("Cameras: "+v.Ja(a,"CAMERA",v.uc).length);console.log("Curves: "+v.Ja(a,"CURVE",v.uc).length);console.log("Empties: "+v.Ja(a,"EMPTY",v.uc).length);console.log("Lamps: "+v.Ja(a,"LAMP",v.uc).length);
console.log("Meshes: "+v.Ja(a,"MESH",v.uc).length);console.log("Speakers: "+v.Ja(a,"SPEAKER",v.uc).length)};a.Ms=function(){for(var a=0,b=A.o(),b=[A.ia(b,"MAIN_OPAQUE"),A.ia(b,"MAIN_BLEND")],c=0;c<b.length;c++){var f=b[c];if(f)for(var f=f.p,d=0;d<f.length;d++){var h=f[d].C;h&&(a+=h.Ms)}}return a};a.Il=function(){for(var a=0,b=A.o(),b=[A.ia(b,"MAIN_OPAQUE"),A.ia(b,"MAIN_BLEND")],c=0;c<b.length;c++){var f=b[c];if(f)for(var f=f.p,d=0;d<f.length;d++){var h=f[d].C;h&&(a+=h.Il)}}return a};a.TS=function(){for(var a=
A.o(),b=[A.ia(a,"MAIN_OPAQUE"),A.ia(a,"MAIN_BLEND")],b=b[0].p.length+b[1].p.length,a=A.RB(a,["MAIN_PLANE_REFLECT","MAIN_CUBE_REFLECT"]),c=0;c<a.length;c++)var f=a[c],b="MAIN_PLANE_REFLECT"==f.type?b+f.p.length:b+6*f.p.length;return b};a.WS=function(){return n.rl(J.Yx())};a.iR=function(){for(var a=A.o(),b=A.Br(a),a={},c=0;c<b.length;c++){var f=b[c];if("SINK"!=f.type&&"WIREFRAME"!=f.type)for(var d=f.p,h=0;h<d.length;h++){var g=d[h].C,l=d[h].he;g&&("COLOR_PICKING"!=f.type&&"OUTLINE_MASK"!=f.type||l.zo||
l.yo)&&(a[g.id]=g)}}var d=f=c=b=0,n;for(n in a)g=a[n],g=g.ca,g.zn&&(f++,d+=g.zn/1048576),b++,c+=g.hx/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:f,ibo_memory:d}};a.XS=function(){for(var a=[],b=0,c=A.o(),c=[A.ia(c,"MAIN_OPAQUE"),A.ia(c,"MAIN_BLEND")],f=0;f<c.length;f++){var d=c[f];if(d)for(var d=d.p,h=0;h<d.length;h++){var g=d[h].C;if(g)for(var g=g.T,l=0;l<g.length;l++){var n=g[l];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.vb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*
4/1048576/n.Iq,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.VS=function(){for(var a=[],b=0,c=A.o(),c=A.Br(c),f=0;f<c.length;f++){var d=c[f];if("SINK"!=d.type){var h=d.j,g=[h.Cb,h.Gd];g.push.apply(g,d.Ue);for(d=0;d<g.length;d++){var l=g[d];D.Cl(l)&&-1==a.indexOf(l)&&(a.push(l),b+=h.width*h.height*D.CI(l))}}}return{number:a.length,memory:b/1024/1024}};a.OJ=function(){var a=A.o();(a=A.ia(a,"MAIN_OPAQUE"))&&A.Ez(a.j,a,[1,1,0])};a.RJ=function(){var a=A.o(),b=A.ia(a,"MAIN_OPAQUE"),a=A.RB(a,["SHADOW_CAST"]);
if(b)for(var c=0;c<a.length;c++){var f=a[c],d;switch(c){case 0:d=[1,0,0];break;case 1:d=[0,1,0];break;case 2:d=[0,0,1];break;default:d=[1,0,1]}A.Ez(f.j,b,d)}};a.wT=function(){for(var a=A.dj(),b=0;b<a.length;b++)f.log("\n"+F.SG(A.oy(a[b])))};a.xT=function(){};a.rQ=h.debug;a.YS=function(a,b){return C.dist(a.f.i,b.f.i)};a.Kz=r.Kz;a.In=r.In;a.mA=r.mA;a.Vs=r.Vs;a.VQ=function(a,b){function c(){r.In("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.GP=function(){var a=new Float32Array(3),b=new Float32Array([0,
0,0,1]),c=new Float32Array([1,0,0]),f=new Float32Array([0,1,0]),d=new Float32Array([0,0,1]),h=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),l=new Float32Array([0,0,-1]);if(!n.Wf(a,n.yv))throw"Wrong VEC3_IDENT";if(!n.Wf(b,n.rv))throw"Wrong QUAT4_IDENT";if(!n.Wf(c,n.$e))throw"Wrong AXIS_X";if(!n.Wf(f,n.jb))throw"Wrong AXIS_Y";if(!n.Wf(d,n.se))throw"Wrong AXIS_Z";if(!n.Wf(h,n.Kp))throw"Wrong AXIS_MX";if(!n.Wf(g,n.dc))throw"Wrong AXIS_MY";if(!n.Wf(l,n.Xg))throw"Wrong AXIS_MZ";};a.SS=function(){for(var a=
H.ul(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==H.Nr(c)&&H.ge(c,!0)}};a.xw=function(a){r.xw(a)};a.FT=function(a){var b=A.o();if(b=A.ia(b,"WIREFRAME")){if("number"==typeof a.wireframe_mode)switch(a.wireframe_mode){case r.Mm:case r.Up:case r.Nm:case r.Tp:case r.Lm:A.HL(b,a.wireframe_mode);break;default:f.error("set_debug_params(): Wrong wireframe mode")}"object"==typeof a.wireframe_edge_color&&A.GL(b,a.wireframe_edge_color)}else throw"Wireframe subscene not found.";};a.tR=function(){return f.jI()};
a.fS=function(){return f.GI()};a.Ew=function(){return f.Ew()};a.mP=function(a){var h=J.Yx(),g=0,n;for(n in h)a&&-1===n.indexOf(a)||g++;var g="of "+g+" analyzing...",d={};for(n in h)if(!a||-1!==n.indexOf(a)){var p=h[n],r;var v=p.Iu;r=p.Ix;var t=x.$x();if(t){v=t.getTranslatedShaderSource(v);r=t.getTranslatedShaderSource(r);var t=c("/nvidia_vert",v),y=l(t),e=c("/nvidia_frag",r),A=l(e);r={yN:v,SU:t,zN:y,IH:r,$Q:e,xr:A}}else f.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),
r=void 0;t=p.ib;v=t.tk+" + "+t.$i;r.OG=p;r.ib=t;p=d[v]=d[v]||[];p.push(r);f.log(g)}for(v in d)f.group("%c"+v,"color: #800"),p=d[v],b(p),f.groupEnd()};a.zx=r.zx};b4w.module.main=function(a,t){function l(){}function c(){}function b(){}function y(){window.performance||(G.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(G.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});aa.mB(0)}function h(a,b){a.addEventListener("webglcontextlost",function(a){a.preventDefault();G.error("WebGL context lost");x()},!1);m.oe(b);var d=m.xy();d&&G.log("%cRENDERER INFO:","color: #00a",
b.getParameter(d.UNMASKED_VENDOR_WEBGL)+", "+b.getParameter(d.UNMASKED_RENDERER_WEBGL));e.oe(b);w.oe(b);Q.oe(b);M.oe(b);q.oe(b);B.IL(a);n.Kc(a);K.rB(a.width,a.height,1);k.Kc();c=f();g()}function r(){l=function(){}}function x(){v()||(ca=performance.now()/1E3,k.pause(),z.pause(),Q.pause(),A.pause())}function v(){return ia<ca}function g(){oa(g);var a=performance.now()/1E3;ka||(ka=a);var b=a-ka;if(!(b<1/P.fe)){for(var d=aa.gg(),e=0;e<fa.length;e++)fa[e](d,b);v()||(ia>ka&&(b-=ia-Math.max(ca,ka)),d+=b,
aa.mB(d),q.update(),H.update(),B.update(),p(d,b),c(b));ka=a}}function p(a,b){B.uf()&&(d.reset(),U.update(b),u.update(a,b),I.update(a,b),k.update(a,b),b&&F.update(b),B.uf()&&(z.update(a,b),B.uf()&&(l(b,a),B.uf()&&(C.update(a,b),B.uf()&&(A.update(),E.update(a,b),K.update(a,b),A.XM(),R&&(R(S.toDataURL()),R=null))))))}function f(){var a=60,c=0,d=P.Ex,e=P.CH;return function(f){f<1/P.fe||(a=ba.sc(1/f,a,f,d),f=z.mI(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var A=t("__anchors"),F=t("__animation"),H=t("__assets"),
J=t("__config"),D=t("__compat"),n=t("__container"),C=t("__controls"),B=t("__data"),q=t("__debug"),m=t("__extensions"),w=t("__geometry"),d=t("__hud"),I=t("__nla"),u=t("__logic_nodes"),E=t("__objects"),z=t("__physics"),G=t("__print"),e=t("__renderer"),K=t("__scenes"),k=t("__sfx"),M=t("__shaders"),Q=t("__textures"),aa=t("__time"),U=t("__transform");t("__armature");var ba=t("__util"),T=t("__version"),ea=J.context,P=J.r,S=null,da=null,ka=0,ca=0,ia=0,fa=[],R=null,ra=["webgl","experimental-webgl"],sa=null,
oa=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/P.fe)}}();a.Kc=function(a,b){J.yL();G.EL(P.console_verbose);var c=T.rm()+" "+T.type()+" ("+T.$q()+")";G.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;y();S=a;D.TE();for(var c=null,e=0;e<ra.length;e++){var f=ra[e];try{c=a.getContext(f,ea)}catch(g){}if(c)break}c&&
D.bH(c);if(!c)return null;sa=c;h(S,c);J.WE();D.qL(c);M.EJ();P.Zr&&(a.style["touch-action"]="none");G.log("%cSET PRECISION:","color: #00a",P.precision);b?(d.Kc(b),da=b):(J.r.show_hud_debug_info=!1,J.A.uo=!1);return c};a.zt=function(a){q.zt(a)};a.resize=function(a,b,c){!1!==c&&(S.style.width=a+"px",S.style.height=b+"px",da&&(da.style.width=a+"px",da.style.height=b+"px"));da&&(da.width=a,da.height=b,d.jk());if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))P.canvas_resolution_factor=
1;c=Math.floor(a*P.canvas_resolution_factor);b=Math.floor(b*P.canvas_resolution_factor);P.allow_hidpi&&1<window.devicePixelRatio&&(c*=window.devicePixelRatio,b*=window.devicePixelRatio);S.width=c;S.height=b;if(c>sa.drawingBufferWidth||b>sa.drawingBufferHeight){G.warn("Canvas size exceeds platform limits, downscaling");var e=Math.min(sa.drawingBufferWidth/c,sa.drawingBufferHeight/b);c*=e;b*=e;S.width=c;S.height=b}K.rB(c,b,c/a);K.oa()&&U.q(K.o().ah);p(aa.gg(),0);B.OM(S.width,S.height)};a.nL=function(a){b=
a};a.jQ=function(){b=function(){}};a.zL=function(a){l=a};a.nQ=function(){r()};a.hS=function(){return aa.gg()};a.iT=function(){G.error("redraw() deprecated");p(aa.gg(),0)};a.pause=x;a.ke=function(){v()&&(ia=performance.now()/1E3,k.ke(),z.ke(),Q.play(!0),A.ke())};a.lo=v;a.reset=function(){B.yp(0);da=S=null;ia=ca=ka=0;b=function(){};c=function(){};l=function(){};fa.length=0;sa=null;aa.reset()};a.UP=function(a){R=a};a.cI=function(){return S};a.mx=function(){return D.mx()};a.Um=function(a){for(var b=0;b<
fa.length;b++)if(fa[b]==a)return;fa.push(a)};a.NK=function(a){for(var b=0;b<fa.length;b++)if(fa[b]==a){fa.splice(b,1);break}}};b4w.module.physics=function(a,t){t("__config");var l=t("__ipc"),c=t("__physics"),b=t("__print"),y=t("__util");a.QC=0;a.MN=1;a.LN=2;a.Uu=3;a.sx=function(a){c.L(a)?c.sx(a):b.error("No physics for object "+a.name)};a.hr=function(a){c.L(a)?c.hr(a):b.error("No physics for object "+a.name)};a.mS=function(a){return c.L(a)};a.Vr=function(a){return c.Vr(a)};a.$y=function(a){return c.$y(a)};a.fB=function(a,l){c.L(a)?c.fB(a,l):b.error("No physics for object "+a.name)};a.ET=function(a,l,t){c.L(a)?c.w("set_damping",
a.m.v,l,t):b.error("No physics for object "+a.name)};a.nT=function(a){if(c.L(a)){var l=a.ie;c.w("set_damping",a.m.v,l.Zq,l.st)}else b.error("No physics for object "+a.name)};a.$o=function(a,l,t){c.L(a)?c.$o.apply(this,arguments):b.error("No physics for object "+a.name)};a.H=function(a){c.L(a)?c.H(a):b.error("No physics for object "+a.name)};a.Tv=function(a){c.L(a)?c.Tv.apply(this,arguments):b.error("No physics for object "+a.name)};a.Uv=function(a){c.L(a)?c.Uv.apply(this,arguments):b.error("No physics for object "+
a.name)};a.Ov=function(a,l,t,v){c.L(a)?c.Ov.apply(this,arguments):b.error("No physics for object "+a.name)};a.Sv=function(a,l,t,v){c.L(a)?c.Sv.apply(this,arguments):b.error("No physics for object "+a.name)};a.rk=function(a,l){c.L(a)?(c.Nc(a)||c.Oc(a)||b.error("Wrong object"),c.rk(a,y.da(l,-1,1))):b.error("No physics for object "+a.name)};a.QU=function(a,l,t){if(c.L(a)){c.Nc(a)||c.Oc(a)||b.error("Wrong object");l=y.da(l,0,1);var v=a.l.Xi;-1==t||1==t?v=Math.max(-1,Math.min(v+t*l,1)):0==t&&0<=v?(v-=
l,v=Math.max(0,v)):0==t&&0>v?(v+=l,v=Math.min(0,v)):b.error("Wrong steering direction");c.rk(a,y.da(v,-1,1))}else b.error("No physics for object "+a.name)};a.qk=function(a,l){c.L(a)?(c.Nc(a)||c.Oc(a)||b.error("Wrong object"),c.qk(a,y.da(l,-1,1))):b.error("No physics for object "+a.name)};a.PU=function(a,l,t){if(c.L(a)){c.Nc(a)||c.Oc(a)||b.error("Wrong object");l=y.da(l,0,1);var v=a.l.Zj;-1==t||1==t?v=Math.max(-1,Math.min(v+t*l,1)):0==t&&0<=v?(v-=l,v=Math.max(0,v)):0==t&&0>v?(v+=l,v=Math.min(0,v)):
b.error("Wrong steering direction");c.qk(a,y.da(v,-1,1))}else b.error("No physics for object "+a.name)};a.Du=function(a,l){c.L(a)?(c.Nc(a)||c.Oc(a)||b.error("Wrong object"),c.Du(a,y.da(l,0,1))):b.error("No physics for object "+a.name)};a.OU=function(a,l){if(c.L(a)){c.Nc(a)||c.Oc(a)||b.error("Wrong object");l=y.da(l,-1,1);var t=a.l.Fk;c.Du(a,y.da(t+t*l,0,1))}else b.error("No physics for object "+a.name)};a.Nc=function(a){return c.Nc(a)};a.Oc=function(a){return c.Oc(a)};a.aS=function(a){if(!c.L(a))return b.error("No physics for object "+
a.name),null;if(c.Nc(a)||c.Oc(a))return a.Xc.name;b.error("Wrong object");return null};a.cS=function(a){if(!c.L(a))return b.error("No physics for object "+a.name),null;if(c.Nc(a)||c.Oc(a))return a.l.Xi;b.error("Wrong object");return null};a.bS=function(a){if(!c.L(a))return b.error("No physics for object "+a.name),null;if(c.Nc(a)||c.Oc(a))return a.l.Zj;b.error("Wrong object")};a.$R=function(a){if(!c.L(a))return b.error("No physics for object "+a.name),null;if(c.Nc(a)||c.Oc(a))return a.l.Fk;b.error("Wrong object")};
a.Ly=function(a){if(!c.L(a))return b.error("No physics for object "+a.name),null;if(c.Nc(a)||c.Oc(a))return c.Ly(a);b.error("Wrong object")};a.Md=function(a){return c.Md(a)};a.yt=function(a,l,t){c.L(a)?c.yt(a,l,t):b.error("No physics for object "+a.name)};a.Uo=function(a,l){c.L(a)?c.Uo(a,l):b.error("No physics for object "+a.name)};a.WA=function(a,l){c.L(a)?c.WA(a,l):b.error("No physics for object "+a.name)};a.VA=function(a,l){c.L(a)?c.VA(a,l):b.error("No physics for object "+a.name)};a.SA=function(a,
l){c.L(a)?c.SA(a,l):b.error("No physics for object "+a.name)};a.sw=function(a){c.L(a)?c.sw(a):b.error("No physics for object "+a.name)};a.tw=function(a,l,t){c.L(a)?c.tw(a,l,t):b.error("No physics for object "+a.name)};a.lL=function(a,l){c.L(a)?c.lL(a,l):b.error("No physics for object "+a.name)};a.Vo=function(a,l,t){c.L(a)?c.Vo(a,l,t):b.error("No physics for object "+a.name)};a.UA=function(a,l){c.L(a)?c.UA(a,l):b.error("No physics for object "+a.name)};a.TA=function(a,l){c.L(a)?c.TA(a,l):b.error("No physics for object "+
a.name)};a.aq=function(a,l,t,v){c.L(a)?c.aq(a,l,t,v||!1):b.error("No physics for object "+a.name)};a.mt=function(a,l,t){c.L(a)?c.mt(a,l||"ANY",t):b.error("No physics for object "+a.name)};a.bq=function(a,l){c.L(a)?c.bq(a,l):b.error("No physics for object "+a.name)};a.Bq=function(a){c.L(a)?c.Bq(a):b.error("No physics for object "+a.name)};a.Vm=function(a,b,l,t,g,p){return c.Vm(a,b,l,t,g,p||!1,!1,!1,!1)};a.qP=function(a,b,l,t,g,p,f,y,F){return c.Vm(a,b,l,t,g,p||!1,f||!1,y||!1,F||!1)};a.nt=function(a){c.mz(a)?
c.nt(a):b.error("Wrong ray test ID")};a.rw=function(a,l,t){c.mz(a)?c.rw(a,l,t):b.error("Wrong ray test ID")};a.Nv=function(a,l,t,v,g,p,f,y,F,H){c.L(l)&&c.L(g)?c.Nv(a,l,t,v,g,p,f,y,F,H):b.error("Wrong objects")};a.Dw=function(a){c.L(a)&&c.LI(a)?c.Dw(a):b.error("Wrong object")};a.qA=function(a,l,t,v,g,p){c.L(a)&&c.L(v)?c.qA(a,l,t,v,g,p):b.error("Wrong objects")};a.HI=l.HI};b4w.module.scenes=function(a,t){var l=t("__batch"),c=t("__camera"),b=t("__data"),y=t("__graph"),h=t("__objects"),r=t("__obj_util"),x=t("__physics"),v=t("__print"),g=t("__scenes"),p=t("__util");a.uc=h.uc;a.So=function(a){var b=g.dj();g.So(p.Ub("name",a,b))};a.o=function(){return g.oa()?g.o().name:""};a.QR=function(){for(var a=g.dj(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.cj=function(){if(g.oa())return g.ql(g.o());v.error("No active scene");return!1};a.FR=function(a,b){var c=h.ce(h.Pp,
a,b|0);if(c)return c;v.error("get object "+a+": not found")};a.DR=function(a,b,c){if(a=h.ce(h.Op,a,b,c|0))return a;v.error("get object "+b+": not found")};a.ER=function(a,b){var c=h.ce(h.Pf,a,b|0);if(c)return c;v.error("get object "+a+": not found")};a.sy=function(a){return g.sy(a)};a.Rl=h.Rl;a.nK=function(a){return a&&a.f&&a.f.Db};a.xL=function(a,b){a&&a.f&&a.f.Db?a.f.bi=b:v.error("set_outline_intensity(): wrong object")};a.vI=function(a){a&&a.f&&a.f.Db||v.error("get_outline_intensity(): wrong object")};
a.ih=function(a,b,c,g){a&&a.f&&a.f.Db?h.ih(a,b,c,g):v.error("apply_outline_anim(): wrong object")};a.VE=function(a){if(a&&a.f&&a.f.Db){var b=a.f.Ej;h.ih(a,b.Fj,b.Gj,b.Hj)}else v.error("apply_outline_anim_def(): wrong object")};a.Mi=function(a){a&&a.f&&a.f.Db?h.Mi(a):v.error("clear_outline_anim(): wrong object")};a.Bt=g.Bt;a.uI=function(a){var b=g.o();if(b=g.ia(b,"OUTLINE"))a=a||new Float32Array(3),a.set(b.Af)};a.KT=function(b,c){v.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");
a.xL(b,c)};a.AR=function(b){v.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");a.vI(b)};a.zP=function(b,c,g,h){v.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.ih(b,c,g,h)};a.AP=function(b){v.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.VE(b)};a.kQ=function(b){v.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.Mi(b)};a.JT=function(b){v.error("set_glow_color() deprecated, use set_outline_color() instead");
a.Bt(b)};a.zR=function(b){v.error("get_glow_color() deprecated, use get_outline_color() instead");a.uI(b)};a.RR=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o(),b=g.ia(a,"SHADOW_CAST");if(!b)return null;var c=a.k.rc,h=g.ia(a,"MAIN_OPAQUE"),l=g.ia(a,"DEPTH"),p={};p.csm_resolution=c.csm_resolution;p.self_shadow_polygon_offset=b.self_shadow_polygon_offset;l&&(p.self_shadow_normal_offset=l.self_shadow_normal_offset);p.enable_csm=c.enable_csm;p.csm_num=c.csm_num;p.csm_first_cascade_border=
c.csm_first_cascade_border;p.first_cascade_blur_radius=c.first_cascade_blur_radius;p.csm_last_cascade_border=c.csm_last_cascade_border;p.last_cascade_blur_radius=c.last_cascade_blur_radius;p.fade_last_cascade=c.fade_last_cascade;p.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(p.csm_borders=g.fI(a,h.j),p.blur_radii=new Float32Array(c.csm_num),p.blur_radii.set(h.j.Fo.subarray(0,c.csm_num))):(p.csm_borders=null,p.blur_radii=null);return p};a.hU=function(a){if(g.oa()){var b=g.o();"number"==
typeof a.self_shadow_polygon_offset&&y.V(b.k.zb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var h=g.ia(b,"DEPTH");h&&("number"==typeof a.self_shadow_normal_offset&&(h.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(h.pcf_blur_radius=a.pcf_blur_radius));var p=g.ia(b,"MAIN_BLEND");p&&("number"==typeof a.self_shadow_normal_offset&&(p.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&
(p.pcf_blur_radius=a.pcf_blur_radius),p.ya=!0);p=b.k.rc;"number"==typeof a.csm_first_cascade_border&&(p.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(p.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(p.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(p.last_cascade_blur_radius=a.last_cascade_blur_radius);if(h){for(var r=h.p,t=0;t<r.length;t++){var n=
r[t];n.he.Vc&&(n=n.C,l.Vv(n,p),l.Vb(n))}h.ya=!0}h=b.ah.f.S;for(t=0;t<h.length;t++)c.tu(h[t],p);g.ut(b)}else v.error("No active scene")};a.dy=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.dy(a)};a.$A=function(a,b,c){if(g.oa()){var h=g.o();g.$A(h,parseFloat(a),b,c)}else v.error("No active scene")};a.jy=function(a){if(!g.oa())return v.error("No active scene"),!1;var b=g.o();return g.jy(b,a)};a.bB=function(a){if(g.oa()){var b=g.o();g.bB(b,a)}else v.error("No active scene")};
a.Gy=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.Gy(a)};a.kB=function(a){if(g.oa()){var b=g.o();g.kB(b,a)}else v.error("No active scene")};a.oR=function(){if(!g.oa())return v.error("No active scene"),null;var a=g.o(),a=g.ia(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.AT=function(a){if(g.oa()){var b=g.o();if(b=g.ia(b,"COMPOSITING"))"number"==typeof a.brightness&&
(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ya=!0}else v.error("No active scene")};a.Ey=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.Ey(a)};a.iB=function(a){if(g.oa()){var b=g.o();g.iB(b,a)}else v.error("No active scene")};a.ay=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.ia(a,"DOF")?
g.ay(a):null};a.ZA=function(a){if(g.oa()){var b=g.o();g.ZA(b,a)}else v.error("No active scene")};a.ny=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.ia(a,"GOD_RAYS")?g.ny(a):null};a.eB=function(a){if(g.oa()){var b=g.o();g.eB(b,a)}else v.error("No active scene")};a.Ux=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.ia(a,"BLOOM")?g.Ux(a):null};a.QA=function(a){if(g.oa()){var b=g.o();g.QA(b,a)}else v.error("No active scene")};a.my=function(){if(!g.oa())return v.error("No active scene"),
!1;var a=g.o();return g.ia(a,"GLOW_COMBINE")?g.my(a):null};a.dB=function(a){if(g.oa()){var b=g.o();g.dB(b,a)}else v.error("No active scene")};a.Qy=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.Qy(a)};a.qB=function(a){if(g.oa()){var b=g.o();h.qB(b,a)}else v.error("No active scene")};a.Oy=g.Oy;a.pB=function(a){if(g.oa()){var b=g.o();g.pB(b,a)}else v.error("No active scene")};a.Ny=function(a){if(g.oa()){var b=g.o();g.Ny(b,a)}else v.error("No active scene")};a.NU=function(){if(g.oa()){var a=
g.o();g.wu(a)}else v.error("No active scene")};a.Zn=function(a){r.fs(a)||r.ho(a)?g.Zn(a):v.error("show/hide is only supported for dynamic meshes/empties")};a.Jt=function(a){r.fs(a)||r.ho(a)?g.Jt(a):v.error("show/hide is only supported for dynamic meshes/empties")};a.gs=function(a){if(r.fs(a)||r.ho(a))return g.gs(a);v.error("show/hide is only supported for dynamic meshes/empties");return!1};a.mo=function(a){return a.f.mo};a.bQ=function(a){return g.oa()?h.kK(a,g.o()):(v.error("No active scene"),!1)};
a.eQ=function(a,b){return h.ce(h.Pp,a,b|0)?!0:!1};a.cQ=function(a,b,c){return h.ce(h.Op,a,b,c|0)?!0:!1};a.dQ=function(a,b){return h.ce(h.Pf,a,b|0)?!0:!1};a.On=function(a,b){var c=g.o();a||(a="ALL");b||0===b||(b=h.uc);return h.Ja(c,a,b)};a.IR=function(a){return a?a.Zh:(v.error("Wrong object name"),"")};a.JR=function(a){if(!a)return v.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Zh),a=r.qf(a);return b.reverse()};a.KR=function(a){return a&&a.type?a.type:(v.error("Wrong object"),"UNDEFINED")};
a.HR=function(a){v.error("scenes.get_object_dg_parent() deprecated, use objects.get_dg_parent() instead");return r.qf(a)};a.GR=function(a){return a.Wd.slice(0)};a.hy=function(){for(var a=h.Ja(g.o(),"MESH",h.uc),b=0;b<a.length;b++){var c=a[b];if(x.Md(c))return c}return null};a.Cy=function(a,b){b||0===b||(b=1);return g.Cy(a,b)};a.Wx=function(){return g.Wx()};a.YR=function(a){return r.Lc(a)?a.f.type:null};a.tl=function(){if(!g.oa())return v.error("No active scene"),!1;var a=g.o();return g.tl(a)};a.Gi=
function(a,b){if(a.f.es){if(b)var c=g.dj(),c=p.Ub("name",b,c);else c=g.o();g.Gi(c,a,!0)}else v.error('object "'+a.name+'" has been created not by coping.')};a.DA=function(a){if(a.f.es){var c=g.o();b.CK(c,a,!1);h.DA(a)}else v.error("Can't remove object \""+a.name+'". It was not copied.')};a.Gz=function(a){var b=g.o();if(b.timeline_markers&&a in b.timeline_markers)return g.Gz(b,a);v.error('"'+a+'" marker not found.');return 0};a.CR=function(){var a=g.o();return(a=g.ia(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,
mb_decay_threshold:a.mb_decay_threshold}:null};a.VT=function(a){var b=g.o();(b=g.ia(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):v.error("The motion blur subscene doesn't exist.")};a.BF=function(){var a=g.o();return Boolean(g.ia(a,"COLOR_PICKING"))}};b4w.module.transform=function(a,t){var l=t("__obj_util"),c=t("__physics"),b=t("__print"),y=t("__quat"),h=t("__transform"),r=t("__util"),x=new Float32Array(3),v=new Float32Array(4);a.Hm=h.Hm;a.Im=h.Im;a.Pe=function(a,p,f,r){l.xa(a)?(x[0]=p,x[1]=f,x[2]=r,h.Pe(a,x),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ap=function(a,p,f,r){l.xa(a)?(x[0]=p,x[1]=f,x[2]=r,h.ap(a,x),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Gt=function(a,p){l.xa(a)?(h.Pe(a,
p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.lU=function(a,p){l.xa(a)?(h.ap(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.kU=function(a,p,f,t,v){l.xa(a)?(x[0]=p,x[1]=f,x[2]=t,r.Mg(x,1,v.f.quat,v.f.i,x),h.Pe(a,x),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.de=function(a,b){b||(b=new Float32Array(3));h.de(a,b);return b};a.Jy=function(a,b){b||(b=new Float32Array(3));h.Jy(a,b);return b};a.Ff=function(a,p,f,r,t){l.xa(a)?
(v[0]=p,v[1]=f,v[2]=r,v[3]=t,h.Ff(a,v),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yo=function(a,p,f,r,t){l.xa(a)?(v[0]=p,v[1]=f,v[2]=r,v[3]=t,h.Yo(a,v),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.eU=function(){b.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.Ff};a.AL=function(a,p){l.xa(a)?(h.Ff(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.gU=function(a,p){l.xa(a)?(h.Yo(a,p),h.q(a),
c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.fU=function(){b.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.AL};a.eg=function(a,b){b||(b=new Float32Array(4));h.eg(a,b);return b};a.yy=function(a,b){b||(b=new Float32Array(4));h.yy(a,b);return b};a.OR=function(){b.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.eg};a.Ct=function(a,p,f,r){l.xa(a)?(x[0]=p,x[1]=f,x[2]=r,h.Ct(a,x),h.q(a),c.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.Dt=function(a,p,f,r){l.xa(a)?(x[0]=p,x[1]=f,x[2]=r,h.Dt(a,x),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.dU=function(a,p){l.xa(a)?(h.Ct(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.cU=function(a,p){l.xa(a)?(h.Dt(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Oe=function(a,c){l.xa(a)?(h.Oe(a,c),h.q(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Et=function(a,c){l.xa(a)?
(h.Et(a,c),h.q(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.fg=function(a){return h.fg(a)};a.Ay=function(a){return h.Ay(a)};a.MQ=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var p=0;p<a.Wd.length;p++)if(!l.xa(a.Wd[p])){b.error('Wrong object: "'+a.Wd[p].name+'" is not dynamic.');return}h.Pe(a,[0,0,0]);h.Ff(a,[0,0,0,1]);h.Oe(a,1);h.q(a);c.H(a)}};a.Kr=function(a){return l.Lc(a)?h.Kr(a):(b.error("Wrong object: "+a.name),0)};a.Tn=function(a,c,f){return l.Lc(a)?
h.Tn(a,c,f):(b.error("Wrong object: "+a.name),null)};a.md=function(a,p,f,r){l.xa(a)?(h.md(a,p,f,r),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.tT=function(a,p){if(l.xa(a)){var f=y.setAxisAngle(r.$e,p,v);h.rt(a,f);h.q(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.uT=function(a,p){if(l.xa(a)){var f=y.setAxisAngle(r.jb,p,v);h.rt(a,f);h.q(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.vT=function(a,p){if(l.xa(a)){var f=y.setAxisAngle(r.se,
p,v);h.rt(a,f);h.q(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ry=function(a){return h.ry(a)};a.Pj=function(a,p){l.xa(a)?(h.Pj(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.nB=function(a,p){l.xa(a)?(h.nB(a,p),h.q(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.vl=function(a,b){b||(b=new Float32Array(8));h.vl(a,b);return b};a.Ky=function(a,b){b||(b=new Float32Array(8));h.Ky(a,b);return b};a.distance=function(a,b){return h.distance(a,
b)}};b4w.module.util=function(a,t){var l=t("__obj_util"),c=t("__print"),b=t("__util"),y=t("__vec3");a.$e=new Float32Array([1,0,0]);a.jb=new Float32Array([0,1,0]);a.se=new Float32Array([0,0,1]);a.Kp=new Float32Array([-1,0,0]);a.dc=new Float32Array([0,-1,0]);a.Xg=new Float32Array([0,0,-1]);a.TQ=function(a){return new Float32Array(a||0)};a.assert=b.assert;a.uz=b.uz;a.Ub=b.Ub;a.ng=function(a){return b.ng(a)};a.bg=function(a,c){c||(c=new Float32Array(4));return b.bg(a,c)};a.uA=function(a,c){c||(c=new Float32Array(3));
return b.uA(a,c)};a.sign=b.sign;a.da=b.da;a.za=b.za;a.iS=function(a,c){return b.bt(a,b.dc,b.jb,b.Xg,c)};a.wq=function(a,c){return b.wq(a,c)};a.bt=function(a,l,t,v,g){return 0!=y.dot(t,v)?(c.error("Wrong in-plane direction"),null):b.bt(a,l,t,v,g)};a.bz=b.bz;a.sc=b.sc;a.Tj=b.Tj;a.ee=b.ee;a.Lq=b.Lq;a.tA=b.tA;a.wA=b.wA;a.MC=b.MC;a.ts=b.ts;a.Lc=function(a){c.error("util.is_mesh() deprecated, use objects.is_mesh() instead");return l.Lc(a)};a.Jh=function(a){c.error("util.is_armature() deprecated, use objects.is_armature() instead");
return l.Jh(a)};a.we=b.we;a.cf=b.cf;a.Ot=b.Ot;a.lerp=b.lerp};b4w.module.camera_anim=function(a,t){function l(a,b,c,d){b=g.we(a-b);a=g.we(c-a);if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;if(1E-6>Math.abs(a)||1E-6>2*Math.PI-Math.abs(a))a=0;d[0]=b;d[1]=a;return d}var c=t("camera"),b=t("controls"),y=t("print"),h=t("scenes"),r=t("time"),x=t("transform"),v=t("tsr"),g=t("util"),p=t("vec3"),f=t("quat"),A=new Float32Array(2),F=new Float32Array(2),H=new Float32Array(3),J=new Float32Array(3),D=new Float32Array(3),n=new Float32Array(4),C=new Float32Array(2),B=
new Float32Array(2),q=new Float32Array(8),m=new Float32Array(8),w=new Float32Array(8),d=!1,I=!1,u=!1,E=!1;a.CU=function(a,d,e,h,k,l,m,q){if(!c.kd(a))y.error("track_to_target(): wrong object");else if(a&&d){if(g.ee(d))var r=d;else r=D,x.Tn(d,!1,r);d=e||1;e=h||2;var t=k||1;k=l||1;J[0]=0;J[1]=-1;J[2]=0;var u=x.eg(a);l=g.za(u,J);h=c.ae(a,A);var v=x.de(a);p.subtract(r,v,H);p.normalize(H,H);var w=f.rotationTo(l,H,f.create());f.multiply(w,u,n);g.Lq(n,!1);p.subtract(r,v,J);var B=p.length(J)*(1-1/e),r=Math.asin(H[1]);
e=Math.acos(-H[2]/Math.abs(Math.cos(r)));0<H[0]&&(e=2*Math.PI-e);var C=e-h[0],E=r-h[1];D[0]=0;D[1]=0;D[2]=-1;e=x.eg(a);0>g.za(e,D)[1]?(E=0<l[1]?r-Math.PI+h[1]:r+Math.PI+h[1],C=0<C?-Math.PI+C:Math.PI+C):Math.abs(C)>Math.PI&&(C=0<C?C-2*Math.PI:C+2*Math.PI);var F=0,r=b.Pi();l=Math.abs(C/d);d=Math.abs(E/d);var I=l>d?l:d,fa=I+t,R=fa+k,ra=R+t,sa=C,oa=E,na=B,N=function(){b.Bf(a,"TRACK_TO_TARGET");m&&m()};b.U(a,"TRACK_TO_TARGET",b.na,[r],null,function(a,d,e){if(e)if(c.kd(a))if(e=b.Ic(a,d,0),F+=e,F<I){var f=
C/I*e;e*=E/I;d=F/I;d=6*d*(1-d);f*=d;e*=d;sa-=f;oa-=e;c.rd(a,f,e)}else F<fa?(sa&&(c.rd(a,sa,oa),sa=0,q&&q()),d=(F-I)/t,e=-B*e/t,na-=f,x.md(a,0,6*e*d*(1-d),0)):F<R?na&&(x.md(a,0,na,0),na=0):F<ra?(d=(F-R)/t,e=B*e/t,e=6*e*d*(1-d),x.md(a,0,e,0)):(x.Gt(a,v),N());else N()})}};a.aw=function(a){function d(a,h,p){if(1==p)if(p=c.be(a),p==c.Rd)e();else if(p!=c.Ob&&c.NI(a)){p=c.oI(a,B);if(null===k||p[0]!=k[0]||p[1]!=k[1]){k=k||C;k.set(p);m=Math.min(.2,g.we(k[1]-k[0])/2);p=k;var q=c.ae(f,A)[0];p=l(q,p[0],p[1],
F);n=.3*Math.min(1,p[0]/.2,p[1]/.2)}h=b.Ic(a,h,0);p=c.ae(a,A)[0];p=l(p,k[0],k[1],F);p[1]>m&&p[0]>m?n=.3*g.sign(n):p[1]<m?n-=Math.pow(.3,2)/.4*h:p[0]<m&&(n+=Math.pow(.3,2)/.4*h);c.Lj(a,h*n,0)}else k=null,h=b.Ic(a,h,0),c.Lj(a,.3*h,0)}function e(){b.Bf(f,"AUTO_ROTATE");b.Bf(f,"DISABLE_AUTO_ROTATE");a()}a=a||function(){};var f=h.cj();if(c.be(f)==c.Rd)y.error("auto_rotate(): wrong camera type");else{var k=null,m=0,n=0;if(b.Li(f,"AUTO_ROTATE"))e();else{var p=b.Ri("X"),q=b.Ri("Y"),r=b.un(),t=b.Rk(),u=b.wn(),
v=b.Pi();b.U(f,"DISABLE_AUTO_ROTATE",b.te,[p,q,r,t,u],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]},e);b.U(f,"AUTO_ROTATE",b.na,[v],function(a){return a[0]},d)}}};a.$I=function(){var a=h.cj();return b.Li(a,"AUTO_ROTATE")};a.HF=function(){var a=h.cj();return c.be(a)==c.Rd?!1:!0};a.RS=function(a,b,e,f,h){if(c.be(a)!=c.Rd)y.error("move_camera_to_point(): wrong camera type");else if(!d)if(a)if(b){e=e||1;f=f||.01;var l=g.ee(a)?a:x.vl(a,q),n=g.ee(b)?b:x.vl(b,m);b=p.distance(v.gj(l),v.gj(n))/e;
e=g.za(v.fj(l),g.dc,H);var t=g.za(v.fj(n),g.dc,J);e=Math.min(Math.abs(p.dot(e,t)),1);f=1E3*Math.max(b,Math.acos(e)/f);d=!0;var A=r.fh(0,1,f,function(b){var c=v.ds(l,n,g.Ot(b),w);u?(r.Jk(A),d=u=!1):(x.Pj(a,c),1==b&&(d=!1,h&&h()))})}else y.error("move_camera_to_point(): you must specify the point object");else y.error("move_camera_to_point(): you must specify the camera object")};a.Lj=function(a,b,d,f,h){if(!I)if(a)if(b||d){I=!0;var g=0,l=0,m=0!=b?b:d,n=r.fh(0,m,f||1E3,function(f){E?(r.Jk(n),I=E=!1):
(g-=f,l-=f,d&&b?c.Lj(a,g,l):d?c.Lj(a,0,l):b&&c.Lj(a,g,0),l=g=f,f==m&&(I=!1,h&&h()))})}else y.error("rotate_camera(): you must specify the rotation angle");else y.error("rotate_camera(): you must specify the camera object")};a.xU=function(){u=!0};a.yU=function(){E=!0};a.CS=function(){return d};a.DS=function(){return I}};b4w.module.time=function(a,t){var l=t("__time");a.Zo=l.Zo;a.Ni=l.Ni;a.gg=l.gg;a.fh=l.fh;a.Jk=l.Jk};b4w.module.tsr=function(a,t){t("__print");var l=t("__tsr");a.create=l.create;a.Hx=l.Hx;a.copy=l.copy;a.identity=l.identity;a.Fe=l.Fe;a.Ag=l.Ag;a.Oj=l.Oj;a.Oe=l.Oe;a.Ft=l.Ft;a.Nj=l.Nj;a.gj=l.gj;a.fg=l.fg;a.fj=l.fj;a.invert=l.invert;a.$B=function(a,b){b||(b=new Float32Array(16));l.$B(a,b);return b};a.Nn=l.Nn;a.multiply=l.multiply;a.Mg=l.Mg;a.bC=l.bC;a.hk=l.hk;a.rp=l.rp;a.oi=l.oi;a.sp=l.sp;a.translate=l.translate;a.ds=l.ds};b4w.module.sfx=function(a,t){var l=t("__obj_util"),c=t("__scenes"),b=t("__sfx"),y=t("__print");a.play=function(a,c,l){b.play(a,c,l)};a.Us=function(a){b.Us(a)};a.Lh=function(a){return b.Lh(a)};a.rU=function(a,c,l,t){y.error("speaker_play() deprecated, use play() or play_def() instead");b.Hb(a,c);t&&b.Tl(a,t);b.play(a,0,l)};a.tU=function(a){y.error("speaker_stop() deprecated, use stop() instead");b.stop(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.UL(a)};a.ke=function(a){b.WL(a)};a.sU=function(a,
c){y.error("speaker_playback_rate() deprecated, use playrate() instead");b.Tl(a,c)};a.Tl=function(a,c){b.Tl(a,c)};a.uy=function(a){return b.uy(a)};a.Hb=function(a,c){b.Hb(a,c)};a.mj=function(a){return b.mj(a)};a.Bz=function(a,c){b.Bz(a,c)};a.HB=function(a,c,l){b.HB(a,c,l)};a.My=function(a){return a&&"object"===typeof a?b.My(a):b.tI()};a.Ht=function(a,c){a&&"object"===typeof a?b.Ht(a,c):b.tL(c)};a.ge=function(a,c){a&&"object"===typeof a?b.ge(a,c):b.dK(c)};a.kz=function(a){return a&&"object"===typeof a?
b.kz(a):b.iJ()};a.ul=function(){return b.ul().slice(0)};a.VR=function(){y.error("get_speakers() deprecated, use get_speaker_objects() instead");return a.ul()};a.vw=b.vw;a.XA=function(a){b.XA(c.o(),a)};a.Zx=function(){return b.Zx(c.o())};a.px=function(a,c,l){a&&"object"===typeof a?b.px(a,c,l):b.eH(c,l)};a.fC=function(a){a&&"object"===typeof a?b.fC(a):b.xM()};a.Pv=b.Pv;a.Fw=b.Fw;a.er=b.er;a.fr=b.fr;a.gB=b.gB;a.vy=b.vy;a.aB=b.aB;a.gy=b.gy;a.fy=b.fy;a.by=function(a){if(a&&l.pj(a))return b.by(a);y.error('Object "'+
(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.storage=function(a,t){function l(a){y=a;try{h=window.localStorage}catch(c){b.warn("Applying chrome localStorage bug workaround"),h=null}h||(b.warn("localStorage is not available, initializing temporary storage"),h={})}function c(){return h[y]?JSON.parse(h[y]):{}}var b=t("__print"),y="",h=null;a.Kc=l;a.set=function(a,b){var l=c();l[a]=String(b);h[y]=JSON.stringify(l)};a.Y=function(){delete h[y]};a.get=function(a){var b=c();return b[a]?b[a]:""};a.debug=function(){b.log(c())};l("b4w")};"object"==typeof module&&module.pr&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,t){t("__print");var l=t("__version");a.version=l.version;a.rm=l.rm;a.type=l.type;a.fx=l.fx;a.$q=l.$q};"object"==typeof module&&module.pr&&b4w.module.version(exports);b4w.register("embed_main",function(a,t){function l(a,b){fa=document.querySelector("#circle_container");R=document.querySelector("#preloader_caption");ra=document.querySelector("#first_stage");sa=document.querySelector("#second_stage");oa=document.querySelector("#third_stage");na=document.querySelector("#load_container");N=document.querySelector("#preloader_container");X=document.querySelector("#opened_button");ga=document.querySelector("#logo_container");V=document.querySelector("#buttons_container");
ha=document.querySelector("#quality_buttons_container");Z=document.querySelector("#help_info_container");W=document.querySelector("#help_button");if(b){aa.pause();var d=document.querySelector("#rel_version");T.rm()&&(d.innerHTML=T.rm());d=document.querySelector("#fullscreen_on_button");e.PF()||d.parentElement.removeChild(d);d=ba.get("quality");d&&"CUSTOM"!=d||(d="HIGH",ba.set("quality",d));ha.className="control_panel_button";switch(d){case "LOW":ha.className="control_panel_button low_mode_button";
break;case "HIGH":ha.className="control_panel_button high_mode_button";break;case "ULTRA":ha.className="control_panel_button ultra_mode_button"}c();if(d=y())h(d),e.mH(),window.addEventListener("resize",w,!1),w()}else if((d=e.Un(!0))&&d.fallback_image){var f=document.createElement("div");f.className="image_wrapper";document.body.appendChild(f);N.style.display="none";f.style.backgroundImage="url("+d.fallback_image+")"}else if(d&&d.fallback_video){var f=document.createElement("div"),g=document.createElement("video");
f.className="video_wrapper";f.appendChild(g);g.autoplay=!0;for(var k=0;k<d.fallback_video.length;k++){var l=document.createElement("source");l.src=d.fallback_video[k];g.appendChild(l)}document.body.appendChild(f);N.style.display="none"}else G("Browser could not initialize WebGL")}function c(){window.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1};b();for(var a=0;a<L.length;a++){var c=L[a],d=document.getElementById(c.id);r(d);switch(c.type){case "simple_button":d&&d.addEventListener("mouseup",
c.callback,!1);break;case "menu_button":d&&d.addEventListener("mouseup",function(a){c.callback(a,c)},!1);break;case "trigger_button":(function(a){d&&d.addEventListener("mouseup",function(b){a.callback(b)},!1)})(c)}}}function b(){for(var a=document.querySelectorAll(".control_panel_button a"),b=0;b<a.length;b++){var c=a[b];c.hasAttribute("href")&&(c.href+=document.location.href);r(c.parentNode)}}function y(){var a=k.get("built_in_module_name");if(b4w.module_check(a)){var a=t(a).data.main_file,b=document.getElementById("built_in_scripts");
b.parentElement.removeChild(b);return a}a=e.Un();ga.style.display="block";if(a&&a.load)return a=a.load;G("Please specify a scene to load");return null}function h(a){e.hc(ga,"opacity",0,1,300,"","",function(){R.style.display="block";e.hc(R,"opacity",0,1,300,"","",function(){aa.ke();Q.load(a,I,u,!1)})})}function r(a){a&&(n()?(a.addEventListener("touchstart",function(){a.className+=" hover";q()},!1),a.addEventListener("touchend",function(){a.className=a.className.replace(" hover","");B()},!1)):(a.addEventListener("mouseenter",
function(){a.className+=" hover"},!1),a.addEventListener("mouseout",function(){a.className=a.className.replace(" hover","")},!1)))}function x(a){if(!C()){var b=a?a.target:document.querySelector("#auto_rotate_on_button");K.aw(function(){b&&f(b)});b&&f(b);aa.lo()&&(g(),A())}}function v(a){C()||(K.aw(),a&&f(a.target))}function g(a){C()||(aa.ke(),a&&f(a.target))}function p(){!F("buttons_container")&&ka&&B();var a=document.querySelector("#fullscreen_on_button")||document.querySelector("#fullscreen_off_button");
a&&f(a)}function f(a){var b=a.id,c;a:{for(c=0;c<L.length;c++)if(L[c].id==a.id){c=L[c];break a}c=null}var d=c.callback;a.id=c.id=c.$l;c.$l=b;F(a.id)||(a.className=a.className.replace(" hover",""));c.callback=c.Zl;c.Zl=d}function A(){var a=document.querySelector("#play_button")||document.querySelector("#pause_button");a&&f(a)}function F(a){var b=!1;if(document.querySelectorAll)for(var c=document.querySelectorAll(":hover"),d=0;d<c.length;d++)if(c[d].id==a){b=!0;break}return b}function H(){if(!C()){V.removeEventListener("mouseleave",
B);V.removeEventListener("mouseenter",q);document.body.removeEventListener("touchmove",B);m();var a=document.querySelector("#help_button"),b=document.querySelector("#tw_button"),c=function(a){ka=!0;e.hc(a,"marginRight",0,-45,50,"","px");e.hc(a,"opacity",1,0,50,"","",function(){a.nextElementSibling&&"opened_button"!=a.nextElementSibling.id?c(a.nextElementSibling):setTimeout(function(){S=ka=!1;D()},100)})},d=function(a){da=!0;e.hc(a,"marginBottom",0,-45,50,"","px");e.hc(a,"opacity",1,0,50,"","",function(){a.nextElementSibling&&
"opened_button"!=a.nextElementSibling.id?d(a.nextElementSibling):setTimeout(function(){P=da=!1;D()},100)})};c(a);d(b)}}function J(){q();if(!C())if(X.removeEventListener("mouseup",J),P||S)H();else{var a=document.querySelector("#fullscreen_on_button")||document.querySelector("#fullscreen_off_button")||document.querySelector("#quality_buttons_container"),b=document.querySelector("#vk_button"),c=function(a){ka=!0;a.style.marginRight="-45px";"help_button"==a.id&&ia?setTimeout(function(){ka=!1;S=!0;D()},
100):(a.style.display="block",e.hc(a,"marginRight",-45,0,50,"","px",function(){a.previousElementSibling?c(a.previousElementSibling):setTimeout(function(){ka=!1;S=!0;D()},100)}),e.hc(a,"opacity",0,1,50,"",""))},d=function(a){da=!0;a.style.marginBottom="-45px";a.style.display="block";e.hc(a,"marginBottom",-45,0,50,"","px",function(){a.previousElementSibling?d(a.previousElementSibling):setTimeout(function(){da=!1;P=!0;D()},100)});e.hc(a,"opacity",0,1,50,"","")};c(a);d(b);V.addEventListener("mouseleave",
B,!1);V.addEventListener("mouseenter",q,!1);document.body.addEventListener("touchmove",B,!1)}}function D(){C()||(X.addEventListener("mouseup",J,!1),(!F("buttons_container")&&(P||S)||n()&&(P||S))&&B())}function n(){return!!("ontouchstart"in window&&!isFinite(navigator.WJ)||navigator.WJ)}function C(){return da||ka}function B(){C()||(q(),ea=setTimeout(H,2E3))}function q(){clearTimeout(ea)}function m(a){if(!C()&&ca){ca=!1;a?(a.stopPropagation(),a=a.target):a=document.querySelectorAll(".active_elem")[0];
ha.style.marginRight="0px";for(var b=0,c=ha.children;b<c.length;b++)c[b].style.display="none",c[b].style.opacity=0;ha.className="control_panel_button "+a.id}}function w(){aa.resize(window.innerWidth,window.innerHeight)}function d(a){if(M.BF()){var b=a.clientX;a=a.clientY;var c=ja;c&&M.nK(c)&&M.Mi(c);ja=M.Rl(b,a)}}function I(a,b){if(b){aa.cI().addEventListener("mousedown",d,!1);var c=document.querySelector("#auto_rotate_on_button");K.HF()||c.parentElement.removeChild(c);e.lH();aa.zL(E);w();(c=e.Un())&&
"autorotate"in c&&x();c=M.tl();c.title&&(document.title=c.title)}else G("Could not load the scene")}function u(a){R.innerHTML=a+"%";33>a?(fa.style.display="block",ra.style.width=4.7*a+"px",fa.style.webkitTransform="rotate("+(3.6*a-503)+"deg)",fa.style.transform="rotate("+(3.6*a-503)+"deg)"):66>a?(ra.style.width="142px",sa.style.backgroundColor="#000",sa.style.marginTop="135px",0<135-4.5*(a-33)&&(sa.style.marginTop=135-3.5*(a-33)+"px"),fa.style.webkitTransform="rotate("+(3.6*a-503)+"deg)",fa.style.transform=
"rotate("+(3.6*a-503)+"deg)"):100!=a&&(sa.style.marginTop="0px",oa.style.backgroundColor="#000",oa.style.height="0px",75<a&&(oa.style.height=.1*a+"px"),fa.style.webkitTransform="rotate("+(3.6*a-503)+"deg)",fa.style.transform="rotate("+(3.6*a-503)+"deg)");100==a&&(U.ul().length||(a=document.querySelector("#sound_on_button"),a.parentElement.removeChild(a)),ra.parentElement.removeChild(ra),sa.parentElement.removeChild(sa),oa.parentElement.removeChild(oa),fa.parentElement.removeChild(fa),na.style.backgroundColor=
"#000",e.hc(R,"opacity",1,0,300,"","",function(){e.hc(na,"opacity",1,0,300,"","",function(){e.hc(ga,"opacity",1,0,300,"","",function(){e.hc(N,"opacity",1,0,300,"","",function(){N.parentElement.removeChild(N);J()})});X.style.display="block";e.hc(X,"transform",0,1,300,"scale(",")")})}))}function E(){}function z(a){if(k.get("quality")!=a){switch(a){case k.Zg:var b="LOW";break;case k.Yg:b="HIGH";break;case k.zi:b="ULTRA"}ba.set("quality",b);setTimeout(function(){window.location.reload()},100)}}function G(a){var b=
document.querySelector("#error_name"),c=document.querySelector("#error_info"),d=document.querySelector("#error_container");fa.style.display="none";b.innerHTML=a;c.innerHTML="For more info visit <a href=https://www.blend4web.com/troubleshooting>"+"https://www.blend4web.com/troubleshooting".replace("https://www.","")+"</a>";d.style.display="block";ga.style.opacity=1;ga.style.marginTop="-90px"}var e=t("app"),K=t("camera_anim"),k=t("config"),M=t("scenes"),Q=t("data"),aa=t("main"),U=t("sfx"),ba=t("storage"),
T=t("version"),ea=null,P=!1,S=!1,da=!1,ka=!1,ca=!1,ia=!1,fa,R,ra,sa,oa,na,N,X,ga,V,ha,Z,W,ja,L=[{type:"simple_button",id:"opened_button",callback:J},{type:"simple_button",id:"help_button",callback:function(){C()||(Z.className=n()?"touch":"",Z.style.display="block",W.style.display="none",ia=!0)}},{type:"simple_button",id:"close_help",callback:function(){ia&&(Z.style.display="none",W.style.display="block",ia=!1)}},{type:"trigger_button",id:"fullscreen_on_button",callback:function(){C()||e.VK(p,p)},
$l:"fullscreen_off_button",Zl:function(){C()||e.pH()}},{type:"trigger_button",id:"pause_button",callback:function(a){C()||(aa.pause(),a&&f(a.target),K.$I()&&(v(),(a=document.querySelector("#auto_rotate_on_button")||document.querySelector("#auto_rotate_off_button"))&&f(a)))},$l:"play_button",Zl:g},{type:"trigger_button",id:"auto_rotate_on_button",callback:x,$l:"auto_rotate_off_button",Zl:v},{type:"trigger_button",id:"sound_on_button",callback:function(a){C()||(U.ge(null,!0),f(a.target))},$l:"sound_off_button",
Zl:function(a){C()||(U.ge(null,!1),f(a.target))}},{type:"menu_button",id:"quality_buttons_container",callback:function(a,b){if(!C()){ca=!0;ha.style.marginRight="-30px";for(var c=b.YF,d=b.XF,e=0;e<c.length;e++){var f=document.getElementById(c[e]);0>ha.className.indexOf(c[e])?f.addEventListener("mouseup",d[e],!1):(f.className="active_elem",f.addEventListener("mouseup",m,!1))}ha.className="quality_buttons_container";e=0;for(c=ha.children;e<c.length;e++)c[e].style.display="block",c[e].style.opacity=1}},
YF:["low_mode_button","high_mode_button","ultra_mode_button"],XF:[function(){z(k.Zg)},function(){z(k.Yg)},function(){z(k.zi)}]}];a.Kc=function(){k.set("background_color",[.224,.224,.224,1]);var a="DEBUG"==T.type(),b=!1,c=!1,d=!1,f=!1,g=e.Un();g&&"compressed_textures"in g&&!m&&!a&&(f=d=!0);g&&"show_fps"in g&&(b=!0);g&&"alpha"in g&&(c=!0);g&&g.load?ba.Kc("b4w_webplayer:"+g.load):ba.Kc("b4w_webplayer:"+window.location.href);g=ba.get("quality");g&&"CUSTOM"!=g||(g="HIGH",ba.set("quality",g));switch(g){case "LOW":var h=
k.Zg;break;case "HIGH":h=k.Yg;break;case "ULTRA":h=k.zi}k.set("quality",h);var m=b4w.module_check(k.get("built_in_module_name"));e.Kc({canvas_container_id:"main_canvas_container",callback:l,gl_debug:a,physics_enabled:!m,show_fps:b,report_init_failure:!1,console_verbose:a,error_purge_elements:["control_panel"],alpha:c,key_pause_enabled:!1,fps_elem_id:"fps_container",fps_wrapper_id:"fps_wrapper",assets_dds_available:d,assets_min50_available:f})}});
window.addEventListener("load",function(){b4w.require("embed_main").Kc()},!1);var pd=["b4w","$","jQuery"],qd=[],zd;for(zd in window)-1!=pd.indexOf(zd)||zd in hd||qd.push(zd);qd.length&&console.error("globals detected:",qd);
